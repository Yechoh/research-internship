|| ?module? StdMenu


StdMenu.closeMenu !id_0 !ioState_1 = case (<{id.==_27}> id_0 id.windowMenuId) (True -> ioState_1) (False -> menuinternal.closemenu id_0 ioState_1) 
StdMenu.stdMenuFatalError !function_0 !error_1 = commondef.fatalError function_0 "StdMenu" error_1
StdMenu.openMenuElements !_vMenuElements_0 !m_1 !pos_2::I ls_3 new_4 !pState_5 = let _x_1_0 = iostate.ioStGetIdTable (select pState_5::iostate._PSt 1), it_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = id.getIdParent m_1 it_1_1, maybeParent_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybeParent_1_3) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)])) (False -> let parent_3_0 = Data.Maybe.fromJust maybeParent_1_3 in case (StdBool.not (<{device.==_2}> (select parent_3_0::id._IdParent 1) device.MenuDevice)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)])) (False -> let ioState_5_0 = select _x_1_0::_Tuple2 1, _x_5_1 = iostate.ioStGetIOId ioState_5_0, pid_5_2 = select _x_5_1::_Tuple2 0 in case (StdBool.not (<{systemid.==_5}> (select parent_3_0::id._IdParent 0) pid_5_2)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_5_1::_Tuple2 1)])) (False -> case (StdBool.not (<{id.==_27}> (select parent_3_0::id._IdParent 2) m_1)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_5_1::_Tuple2 1)])) (False -> let ioState_8_0 = select _x_5_1::_Tuple2 1, _x_8_1 = iostate.ioStGetDevice device.MenuDevice ioState_8_0 in case (StdBool.not (select _x_8_1::_Tuple3 0)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_8_1::_Tuple3 2)])) (False -> let ioState_10_0 = select _x_8_1::_Tuple3 2, _x_10_1 = iostate.ioStGetOSDInfo ioState_10_0, osd_10_2 = select _x_10_1::_Tuple2 0, maybeOSMenuBar_10_3 = osdocumentinterface.getOSDInfoOSMenuBar osd_10_2 in case (Data.Maybe.isNothing maybeOSMenuBar_10_3) (True -> StdMenu.stdMenuFatalError "openMenuElements" "OSMenuBar could not be retrieved from OSDInfo") (False -> let x_12_0 = 0, _x_12_1 = iostate.ioStGetReceiverTable (select _x_10_1::_Tuple2 1), _x_12_2 = iostate.getIOToolbox (select _x_12_1::_Tuple2 1), _x_12_3 = menuitems.addMenusItems _vMenuElements_0 (_Tuple2 m_1 Data.Maybe.Nothing) (<{StdMenu._c;51;16_88}> (<{StdInt.<_17}> x_12_0 pos_2) pos_2 x_12_0) ls_3 new_4 pid_5_2 (select _x_12_1::_Tuple2 0) (select _x_1_2::_Tuple2 1) (devicesystemstate.menuSystemStateGetMenuHandles (select _x_8_1::_Tuple3 1)) (Data.Maybe.fromJust maybeOSMenuBar_10_3) (update pState_5::iostate._PSt [1:select _x_12_2::_Tuple2 1]), _x_12_4 = select _x_12_3::_Tuple4 0, pState_12_5 = select _x_12_3::_Tuple4 3, osMenuBar_12_6::I = select _x_12_3::_Tuple4 2 in <{_Tuple2!3}> (select _x_12_4::_Tuple3 0) (update pState_12_5::iostate._PSt [1:iostate.ioStSetReceiverTable (select _x_12_4::_Tuple3 1) (iostate.ioStSetIdTable (select _x_12_4::_Tuple3 2) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_12_3::_Tuple4 1)) (iostate.ioStSetOSDInfo (osdocumentinterface.setOSDInfoOSMenuBar osMenuBar_12_6 osd_10_2) (iostate.setIOToolbox (osmenu.osDrawMenuBar osMenuBar_12_6 (select _x_12_2::_Tuple2 0)) (select pState_12_5::iostate._PSt 1)))))])) ) ) ) ) ) 
<{StdMenu._c;51;16_88}>::I !_x_0::B pos_1::I x_2::I = case _x_0 (True -> pos_1) (_ -> x_2)
StdMenu.openSubMenuElements !_vMenuElements_0 !s_1 !pos_2::I ls_3 new_4 !pState_5 = let _x_1_0 = iostate.ioStGetIdTable (select pState_5::iostate._PSt 1), it_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = id.getIdParent s_1 it_1_1, maybeParent_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybeParent_1_3) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)])) (False -> let parent_3_0 = Data.Maybe.fromJust maybeParent_1_3 in case (StdBool.not (<{device.==_2}> (select parent_3_0::id._IdParent 1) device.MenuDevice)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)])) (False -> let ioState_5_0 = select _x_1_0::_Tuple2 1, _x_5_1 = iostate.ioStGetIOId ioState_5_0, pid_5_2 = select _x_5_1::_Tuple2 0 in case (StdBool.not (<{systemid.==_5}> (select parent_3_0::id._IdParent 0) pid_5_2)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_5_1::_Tuple2 1)])) (False -> let ioState_7_0 = select _x_5_1::_Tuple2 1, _x_7_1 = iostate.ioStGetDevice device.MenuDevice ioState_7_0 in case (StdBool.not (select _x_7_1::_Tuple3 0)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5::iostate._PSt [1:iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_7_1::_Tuple3 2)])) (False -> let ioState_9_0 = select _x_7_1::_Tuple3 2, _x_9_1 = iostate.ioStGetOSDInfo ioState_9_0, osd_9_2 = select _x_9_1::_Tuple2 0, maybeOSMenuBar_9_3 = osdocumentinterface.getOSDInfoOSMenuBar osd_9_2 in case (Data.Maybe.isNothing maybeOSMenuBar_9_3) (True -> StdMenu.stdMenuFatalError "openSubMenuElements" "OSMenuBar could not be retrieved from OSDInfo") (False -> let x_11_0 = 0, _x_11_1 = iostate.ioStGetReceiverTable (select _x_9_1::_Tuple2 1), _x_11_2 = iostate.getIOToolbox (select _x_11_1::_Tuple2 1), _x_11_3 = menuitems.addMenusItems _vMenuElements_0 (_Tuple2 (select parent_3_0::id._IdParent 2) (Data.Maybe.Just s_1)) (<{StdMenu._c;51;16_89}> (<{StdInt.<_17}> x_11_0 pos_2) pos_2 x_11_0) ls_3 new_4 pid_5_2 (select _x_11_1::_Tuple2 0) (select _x_1_2::_Tuple2 1) (devicesystemstate.menuSystemStateGetMenuHandles (select _x_7_1::_Tuple3 1)) (Data.Maybe.fromJust maybeOSMenuBar_9_3) (update pState_5::iostate._PSt [1:select _x_11_2::_Tuple2 1]), _x_11_4 = select _x_11_3::_Tuple4 0, pState_11_5 = select _x_11_3::_Tuple4 3, osMenuBar_11_6::I = select _x_11_3::_Tuple4 2 in <{_Tuple2!3}> (select _x_11_4::_Tuple3 0) (update pState_11_5::iostate._PSt [1:iostate.ioStSetReceiverTable (select _x_11_4::_Tuple3 1) (iostate.ioStSetIdTable (select _x_11_4::_Tuple3 2) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_11_3::_Tuple4 1)) (iostate.ioStSetOSDInfo (osdocumentinterface.setOSDInfoOSMenuBar osMenuBar_11_6 osd_9_2) (iostate.setIOToolbox (osmenu.osDrawMenuBar osMenuBar_11_6 (select _x_11_2::_Tuple2 0)) (select pState_11_5::iostate._PSt 1)))))])) ) ) ) ) 
<{StdMenu._c;51;16_89}>::I !_x_0::B pos_1::I x_2::I = case _x_0 (True -> pos_1) (_ -> x_2)
StdMenu.anon_33 !_x_0 = case _x_0 (_Tuple4 _x_1_0 maybe_1_1 _x_1_2 _x_1_3 -> _Tuple2 (Data.Maybe.isJust maybe_1_1) (Data.Maybe.fromJust maybe_1_1)) 
StdMenu.accessMenuSystemState !redrawMenus_0::B !f_1 !ioState_2 = let _x_1_0 = iostate.ioStGetOSDInfo ioState_2, osd_1_1 = select _x_1_0::_Tuple2 0, maybeOSMenuBar_1_2 = osdocumentinterface.getOSDInfoOSMenuBar osd_1_1 in case (Data.Maybe.isNothing maybeOSMenuBar_1_2) (True -> StdMenu.stdMenuFatalError "accessMenuSystemState" "could not retrieve OSMenuBar from IOSt") (False -> let ioState_3_0 = select _x_1_0::_Tuple2 1, _x_3_1 = iostate.ioStGetDevice device.MenuDevice ioState_3_0 in case (StdBool.not (select _x_3_1::_Tuple3 0)) (True -> <{_Tuple2!3}> Data.Maybe.Nothing (select _x_3_1::_Tuple3 2)) (False -> case (StdBool.not redrawMenus_0) (True -> let _x_6_0 = iostate.getIOToolbox (select _x_3_1::_Tuple3 2), _x_6_1 = f_1 (Data.Maybe.fromJust maybeOSMenuBar_1_2) (devicesystemstate.menuSystemStateGetMenuHandles (select _x_3_1::_Tuple3 1)) (select _x_6_0::_Tuple2 0) in <{_Tuple2!3}> (Data.Maybe.Just (select _x_6_1::_Tuple3 0)) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_1::_Tuple3 1)) (iostate.setIOToolbox (select _x_6_1::_Tuple3 2) (select _x_6_0::_Tuple2 1)))) (False -> let osMenuBar_6_0 = Data.Maybe.fromJust maybeOSMenuBar_1_2, _x_6_1 = iostate.getIOToolbox (select _x_3_1::_Tuple3 2), _x_6_2 = f_1 osMenuBar_6_0 (devicesystemstate.menuSystemStateGetMenuHandles (select _x_3_1::_Tuple3 1)) (select _x_6_1::_Tuple2 0) in <{_Tuple2!3}> (Data.Maybe.Just (select _x_6_2::_Tuple3 0)) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_2::_Tuple3 1)) (iostate.setIOToolbox (osmenu.osDrawMenuBar osMenuBar_6_0 (select _x_6_2::_Tuple3 2)) (iostate.ioStSetOSDInfo (osdocumentinterface.setOSDInfoOSMenuBar osMenuBar_6_0 osd_1_1) (select _x_6_1::_Tuple2 1))))) ) ) 
StdMenu.anon_34 io_0 m_1 id_2 = _Tuple2 id_2 (id._IdParent io_0 device.MenuDevice m_1)
StdMenu.openRadioMenuItems !r_0 !pos_1::I !radio_2 !ioState_3 = let _x_1_0 = iostate.ioStGetIdTable ioState_3, idtable_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = id.getIdParent r_0 idtable_1_1, maybeParent_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybeParent_1_3) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1))) (False -> let parent_3_0 = Data.Maybe.fromJust maybeParent_1_3 in case (StdBool.not (<{device.==_2}> (select parent_3_0::id._IdParent 1) device.MenuDevice)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1))) (False -> let ioState_5_0 = select _x_1_0::_Tuple2 1, _x_5_1 = iostate.ioStGetIOId ioState_5_0, io_5_2 = select _x_5_1::_Tuple2 0 in case (StdBool.not (<{systemid.==_5}> (select parent_3_0::id._IdParent 0) io_5_2)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_5_1::_Tuple2 1))) (False -> case (StdList.isEmpty radio_2) (True -> <{_Tuple2!3}> StdIOCommon.NoError (iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_5_1::_Tuple2 1))) (False -> let radio_8_0 = commondef.filterMap StdMenu.anon_33 radio_2, idtable_8_1 = select _x_1_2::_Tuple2 1, _x_8_2 = id.okMembersIdTable radio_8_0 idtable_8_1 in case (StdBool.not (select _x_8_2::_Tuple2 0)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorIdsInUse (iostate.ioStSetIdTable (select _x_8_2::_Tuple2 1) (select _x_5_1::_Tuple2 1))) (False -> let m_10_0 = select parent_3_0::id._IdParent 2, x_10_1::I = 0, _x_10_2 = StdMenu.accessMenuSystemState True (menuitems.addMenuRadioItems (_Tuple2 m_10_0 r_0) (<{StdMenu._c;51;16_90}> (<{StdInt.<_17}> x_10_1 pos_1) pos_1 x_10_1) radio_2) (select _x_5_1::_Tuple2 1) in <{_Tuple2!3}> (<{StdMenu._c;533;31_91}> (select _x_10_2::_Tuple2 0)) (iostate.ioStSetIdTable (select (id.addIdsToIdTable (StdList.map (StdMenu.anon_34 io_5_2 m_10_0) radio_8_0) (select _x_8_2::_Tuple2 1))::_Tuple2 1) (select _x_10_2::_Tuple2 1))) ) ) ) ) 
<{StdMenu._c;533;31_91}> !_x_0 = case _x_0 (Data.Maybe.Nothing -> StdIOCommon.ErrorUnknownObject) (Data.Maybe.Just err_1_0 -> err_1_0) 
<{StdMenu._c;51;16_90}>::I !_x_0::B pos_1::I x_2::I = case _x_0 (True -> pos_1) (_ -> x_2)
StdMenu.anon_35::B !id_0 = StdBool.not (id.isSpecialId id_0)
StdMenu.closeMenuElements !m_0 !ids_1 !ioState_2 = let ids_1_0 = StdList.filter StdMenu.anon_35 ids_1 in case (StdList.isEmpty ids_1_0) (True -> ioState_2) (False -> menuinternal.closemenuelements m_0 ids_1_0 ioState_2) 
StdMenu.closeMenuIndexElements !m_0 !indices_1 !ioState_2 = let _x_1_0 = iostate.ioStGetIdTable ioState_2, idtable_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = id.getIdParent m_0 idtable_1_1, maybeParent_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybeParent_1_3) (True -> iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)) (False -> let parent_3_0 = Data.Maybe.fromJust maybeParent_1_3 in case (StdBool.not (<{device.==_2}> (select parent_3_0::id._IdParent 1) device.MenuDevice)) (True -> iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)) (False -> let idtable_5_0 = select _x_1_2::_Tuple2 1, ioState_5_1 = select _x_1_0::_Tuple2 1, ioState_5_2 = iostate.ioStSetIdTable idtable_5_0 ioState_5_1, _x_5_3 = iostate.ioStGetIOId ioState_5_2, io_5_4 = select _x_5_3::_Tuple2 0 in case (case (StdBool.not (<{systemid.==_5}> (select parent_3_0::id._IdParent 0) io_5_4)) (True -> True) (False -> StdBool.not (<{id.==_27}> (select parent_3_0::id._IdParent 2) m_0)) ) (True -> select _x_5_3::_Tuple2 1) (False -> menuinternal.closemenuindexelements False False io_5_4 (_Tuple2 m_0 Data.Maybe.Nothing) indices_1 (select _x_5_3::_Tuple2 1)) ) ) 
StdMenu.closeSubMenuIndexElements !s_0 !indices_1 !ioState_2 = let _x_1_0 = iostate.ioStGetIdTable ioState_2, idtable_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = id.getIdParent s_0 idtable_1_1, maybeParent_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybeParent_1_3) (True -> iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)) (False -> let parent_3_0 = Data.Maybe.fromJust maybeParent_1_3 in case (StdBool.not (<{device.==_2}> (select parent_3_0::id._IdParent 1) device.MenuDevice)) (True -> iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)) (False -> let idtable_5_0 = select _x_1_2::_Tuple2 1, ioState_5_1 = select _x_1_0::_Tuple2 1, ioState_5_2 = iostate.ioStSetIdTable idtable_5_0 ioState_5_1, _x_5_3 = iostate.ioStGetIOId ioState_5_2, io_5_4 = select _x_5_3::_Tuple2 0 in case (StdBool.not (<{systemid.==_5}> (select parent_3_0::id._IdParent 0) io_5_4)) (True -> select _x_5_3::_Tuple2 1) (False -> menuinternal.closemenuindexelements False False io_5_4 (_Tuple2 (select parent_3_0::id._IdParent 2) (Data.Maybe.Just s_0)) indices_1 (select _x_5_3::_Tuple2 1)) ) ) 
StdMenu.closeRadioMenuIndexElements !r_0 !indices_1 !ioState_2 = let _x_1_0 = iostate.ioStGetIdTable ioState_2, idtable_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = id.getIdParent r_0 idtable_1_1, maybeParent_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybeParent_1_3) (True -> iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)) (False -> let parent_3_0 = Data.Maybe.fromJust maybeParent_1_3 in case (StdBool.not (<{device.==_2}> (select parent_3_0::id._IdParent 1) device.MenuDevice)) (True -> iostate.ioStSetIdTable (select _x_1_2::_Tuple2 1) (select _x_1_0::_Tuple2 1)) (False -> let idtable_5_0 = select _x_1_2::_Tuple2 1, ioState_5_1 = select _x_1_0::_Tuple2 1, ioState_5_2 = iostate.ioStSetIdTable idtable_5_0 ioState_5_1, _x_5_3 = iostate.ioStGetIOId ioState_5_2, io_5_4 = select _x_5_3::_Tuple2 0 in case (StdBool.not (<{systemid.==_5}> (select parent_3_0::id._IdParent 0) io_5_4)) (True -> select _x_5_3::_Tuple2 1) (False -> menuinternal.closemenuindexelements False True io_5_4 (_Tuple2 (select parent_3_0::id._IdParent 2) (Data.Maybe.Just r_0)) indices_1 (select _x_5_3::_Tuple2 1)) ) ) 
StdMenu.hasModalDialog_29 !ioState_0 = let _x_1_0 = iostate.ioStGetDevice device.WindowDevice ioState_0 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> <{_Tuple2!3}> False (select _x_1_0::_Tuple3 2)) (False -> let _x_3_0 = windowaccess.getWindowHandlesActiveModalDialog (devicesystemstate.windowSystemStateGetWindowHandles (select _x_1_0::_Tuple3 1)) in <{_Tuple2!3}> (Data.Maybe.isJust (select _x_3_0::_Tuple2 0)) (iostate.ioStSetDevice (devicesystemstate.WindowSystemState (select _x_3_0::_Tuple2 1)) (select _x_1_0::_Tuple3 2))) 
StdMenu.enablemenus_28::I osMenuBar_0 !i_1::I !osmenubar_2 !tb_3::I = case (<{StdInt.<_17}> i_1 0) (True -> tb_3) (False -> StdMenu.enablemenus_28 osMenuBar_0 (<{StdInt.-_7}> i_1 1) osMenuBar_0 (osmenu.osEnableMenu i_1 osMenuBar_0 tb_3)) 
StdMenu.enablemenusystem_30 !di_0 !osMenuBar_1 !menus_2 !tb_3::I = case menus_2 (menuhandle._MenuHandles mMenus_1_0 mKeys_1_1 mEnabled_1_2 mNrMenuBound_1_3 mPopUp_1_4 -> case mEnabled_1_2 (True -> <{_Tuple2!3}> menus_2 tb_3) (False -> let _x_3_0 = commondef.ulength mMenus_1_0 in <{_Tuple2!3}> (update menus_2::menuhandle._MenuHandles [0:select _x_3_0::_Tuple2 1,2:True]) (StdMenu.enablemenus_28 osMenuBar_1 (select _x_3_0::_Tuple2 0) osMenuBar_1 tb_3)) ) 
StdMenu.changeMenuSystemState !redrawMenus_0::B !f_1 !ioState_2 = let _x_1_0 = iostate.ioStGetOSDInfo ioState_2, osd_1_1 = select _x_1_0::_Tuple2 0, maybeOSMenuBar_1_2 = osdocumentinterface.getOSDInfoOSMenuBar osd_1_1 in case (Data.Maybe.isNothing maybeOSMenuBar_1_2) (True -> StdMenu.stdMenuFatalError "changeMenuSystemState" "could not retrieve OSMenuBar from IOSt") (False -> let ioState_3_0 = select _x_1_0::_Tuple2 1, _x_3_1 = iostate.ioStGetDevice device.MenuDevice ioState_3_0 in case (StdBool.not (select _x_3_1::_Tuple3 0)) (True -> select _x_3_1::_Tuple3 2) (False -> case (StdBool.not redrawMenus_0) (True -> let _x_6_0 = iostate.getIOToolbox (select _x_3_1::_Tuple3 2), _x_6_1 = f_1 (Data.Maybe.fromJust maybeOSMenuBar_1_2) (devicesystemstate.menuSystemStateGetMenuHandles (select _x_3_1::_Tuple3 1)) (select _x_6_0::_Tuple2 0) in iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_1::_Tuple2 0)) (iostate.setIOToolbox (select _x_6_1::_Tuple2 1) (select _x_6_0::_Tuple2 1))) (False -> let osMenuBar_6_0 = Data.Maybe.fromJust maybeOSMenuBar_1_2, _x_6_1 = iostate.getIOToolbox (select _x_3_1::_Tuple3 2), _x_6_2 = f_1 osMenuBar_6_0 (devicesystemstate.menuSystemStateGetMenuHandles (select _x_3_1::_Tuple3 1)) (select _x_6_1::_Tuple2 0) in iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_2::_Tuple2 0)) (iostate.setIOToolbox (osmenu.osDrawMenuBar osMenuBar_6_0 (select _x_6_2::_Tuple2 1)) (iostate.ioStSetOSDInfo (osdocumentinterface.setOSDInfoOSMenuBar osMenuBar_6_0 osd_1_1) (select _x_6_1::_Tuple2 1)))) ) ) 
StdMenu.enableMenuSystem !ioState_0 = let _x_1_0 = StdMenu.hasModalDialog_29 ioState_0 in case (select _x_1_0::_Tuple2 0) (True -> select _x_1_0::_Tuple2 1) (False -> let ioState_3_0 = select _x_1_0::_Tuple2 1, _x_3_1 = iostate.ioStGetDocumentInterface ioState_3_0, di_3_2 = select _x_3_1::_Tuple2 0 in case (<{StdIOCommon.==_39}> di_3_2 StdIOCommon.NDI) (True -> select _x_3_1::_Tuple2 1) (False -> StdMenu.changeMenuSystemState True (StdMenu.enablemenusystem_30 di_3_2) (select _x_3_1::_Tuple2 1)) ) 
StdMenu.disablemenus_31::I !i_0::I !osMenuBar_1 !tb_2::I = case (<{StdInt.<_17}> i_0 0) (True -> tb_2) (False -> StdMenu.disablemenus_31 (<{StdInt.-_7}> i_0 1) osMenuBar_1 (osmenu.osDisableMenu i_0 osMenuBar_1 tb_2)) 
StdMenu.disablemenusystem_32 !di_0 !osMenuBar_1 !menus_2 !tb_3::I = case menus_2 (menuhandle._MenuHandles mMenus_1_0 mKeys_1_1 mEnabled_1_2 mNrMenuBound_1_3 mPopUp_1_4 -> case (StdBool.not mEnabled_1_2) (True -> <{_Tuple2!3}> menus_2 tb_3) (False -> let _x_3_0 = commondef.ulength mMenus_1_0 in <{_Tuple2!3}> (update menus_2::menuhandle._MenuHandles [0:select _x_3_0::_Tuple2 1,2:False]) (StdMenu.disablemenus_31 (select _x_3_0::_Tuple2 0) osMenuBar_1 tb_3)) ) 
StdMenu.disableMenuSystem !ioState_0 = let _x_1_0 = iostate.ioStGetDocumentInterface ioState_0, di_1_1 = select _x_1_0::_Tuple2 0 in case (<{StdIOCommon.==_39}> di_1_1 StdIOCommon.NDI) (True -> select _x_1_0::_Tuple2 1) (False -> StdMenu.changeMenuSystemState True (StdMenu.disablemenusystem_32 di_1_1) (select _x_1_0::_Tuple2 1)) 
<{StdMenu.<>_41}>::B !_vEq_0 !x_1 !y_2 = StdBool.not (select (select _vEq_0::<{StdClass.Eq;}> 0)::<{StdOverloaded.==;}> 0 x_1 y_2)
<{StdMenu.<>_86}>::B !x_0 !y_1 = StdBool.not (<{id.==_27}> x_0 y_1)
StdMenu.enableMenus !ids_0 !ioState_1 = let ids_1_0 = StdList.filter (<{StdMenu.<>_86}> id.windowMenuId) ids_0 in case (StdList.isEmpty ids_1_0) (True -> ioState_1) (False -> menuinternal.enablemenus ids_1_0 ioState_1) 
<{StdMenu.<>_42}>::B !_vEq_0 !x_1 !y_2 = StdBool.not (select (select _vEq_0::<{StdClass.Eq;}> 0)::<{StdOverloaded.==;}> 0 x_1 y_2)
<{StdMenu.<>_87}>::B !x_0 !y_1 = StdBool.not (<{id.==_27}> x_0 y_1)
StdMenu.disableMenus !ids_0 !ioState_1 = let ids_1_0 = StdList.filter (<{StdMenu.<>_87}> id.windowMenuId) ids_0 in case (StdList.isEmpty ids_1_0) (True -> ioState_1) (False -> menuinternal.disablemenus ids_1_0 ioState_1) 
StdMenu.accessmenuhandles_27 !id_0 !f_1 !_x_2 = case _x_2 (_predefined._Cons mH_1_0 mHs_1_1 -> let _x_2_0 = menuaccess.menuStateHandleGetMenuId mH_1_0 in case (<{id.==_27}> id_0 (select _x_2_0::_Tuple2 0)) (True -> let _x_4_0 = f_1 (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (Data.Maybe.Just (select _x_4_0::_Tuple2 0)) (_predefined._Cons (select _x_4_0::_Tuple2 1) mHs_1_1)) (False -> let _x_4_0 = StdMenu.accessmenuhandles_27 id_0 f_1 mHs_1_1 in <{_Tuple2!3}> (select _x_4_0::_Tuple2 0) (_predefined._Cons (select _x_2_0::_Tuple2 1) (select _x_4_0::_Tuple2 1))) ) (_ -> <{_Tuple2!3}> Data.Maybe.Nothing _predefined._Nil)
StdMenu.accessMenuHandles !id_0 !f_1 !ioState_2 = let _x_1_0 = iostate.ioStGetDevice device.MenuDevice ioState_2 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> <{_Tuple2!3}> Data.Maybe.Nothing (select _x_1_0::_Tuple3 2)) (False -> let mHs_3_0 = devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1), _x_3_1 = StdMenu.accessmenuhandles_27 id_0 f_1 (select mHs_3_0::menuhandle._MenuHandles 0) in <{_Tuple2!3}> (select _x_3_1::_Tuple2 0) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update mHs_3_0::menuhandle._MenuHandles [0:select _x_3_1::_Tuple2 1])) (select _x_1_0::_Tuple3 2))) 
StdMenu.getMenuSelectState !id_0 !ioState_1 = let _x_1_0 = StdMenu.accessMenuHandles id_0 menuaccess.menuStateHandleGetSelect ioState_1, optSelect_1_1 = select _x_1_0::_Tuple2 0 in case (Data.Maybe.isNothing optSelect_1_1) (True -> <{_Tuple2!3}> Data.Maybe.Nothing (select _x_1_0::_Tuple2 1)) (False -> case (Data.Maybe.fromJust optSelect_1_1) (True -> <{_Tuple2!3}> (Data.Maybe.Just StdIOCommon.Able) (select _x_1_0::_Tuple2 1)) (False -> <{_Tuple2!3}> (Data.Maybe.Just StdIOCommon.Unable) (select _x_1_0::_Tuple2 1)) ) 
StdMenu.getIdType_36 !msH_0 = let _x_1_0 = menuaccess.menuStateHandleGetMenuId msH_0 in <{_Tuple2!2}> (_Tuple2 (select _x_1_0::_Tuple2 0) "Menu") (select _x_1_0::_Tuple2 1)
StdMenu.getMenus !ioState_0 = let _x_1_0 = iostate.ioStGetDevice device.MenuDevice ioState_0 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> <{_Tuple2!3}> _predefined._Nil (select _x_1_0::_Tuple3 2)) (False -> let mHs_3_0 = devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1), _x_3_1 = commondef.accessList StdMenu.getIdType_36 (select mHs_3_0::menuhandle._MenuHandles 0) in <{_Tuple2!3}> (select _x_3_1::_Tuple2 0) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update mHs_3_0::menuhandle._MenuHandles [0:select _x_3_1::_Tuple2 1])) (select _x_1_0::_Tuple3 2))) 
StdMenu.getmenuindex_37 !id_0 !index_1::I !_x_2 = case _x_2 (_predefined._Cons mH_1_0 mHs_1_1 -> let _x_2_0 = menuaccess.menuStateHandleGetMenuId mH_1_0 in case (<{id.==_27}> id_0 (select _x_2_0::_Tuple2 0)) (True -> <{_Tuple2!3}> (Data.Maybe.Just index_1) (_predefined._Cons (select _x_2_0::_Tuple2 1) mHs_1_1)) (False -> let _x_4_0 = StdMenu.getmenuindex_37 id_0 (<{StdInt.+_6}> index_1 1) mHs_1_1 in <{_Tuple2!3}> (select _x_4_0::_Tuple2 0) (_predefined._Cons (select _x_2_0::_Tuple2 1) (select _x_4_0::_Tuple2 1))) ) (_ -> <{_Tuple2!3}> Data.Maybe.Nothing _predefined._Nil)
StdMenu.getMenuPos !id_0 !ioState_1 = let _x_1_0 = iostate.ioStGetDevice device.MenuDevice ioState_1 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> <{_Tuple2!3}> Data.Maybe.Nothing (select _x_1_0::_Tuple3 2)) (False -> let mHs_3_0 = devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1), _x_3_1 = StdMenu.getmenuindex_37 id_0 0 (select mHs_3_0::menuhandle._MenuHandles 0) in <{_Tuple2!3}> (select _x_3_1::_Tuple2 0) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update mHs_3_0::menuhandle._MenuHandles [0:select _x_3_1::_Tuple2 1])) (select _x_1_0::_Tuple3 2))) 
StdMenu.setMenuTitle !id_0 !title_1 !ioState_2 = case (<{id.==_27}> id_0 id.windowMenuId) (True -> ioState_2) (False -> menuinternal.setmenutitle id_0 title_1 ioState_2) 
StdMenu.getMenuTitle !id_0 !ioState_1 = StdMenu.accessMenuHandles id_0 menuaccess.menuStateHandleGetTitle ioState_1
StdMenu.validateMenuId !_x_0 !ioState_1 = case _x_0 (Data.Maybe.Nothing -> let _x_2_0 = StdId.openId_7 ioState_1 in <{_Tuple2!3}> (Data.Maybe.Just (select _x_2_0::_Tuple2 0)) (select _x_2_0::_Tuple2 1)) (Data.Maybe.Just id_1_0 -> let _x_2_0 = iostate.ioStGetIdTable ioState_1, idtable_2_1 = select _x_2_0::_Tuple2 0, _x_2_2 = id.memberIdTable id_1_0 idtable_2_1 in case (select _x_2_2::_Tuple2 0) (True -> <{_Tuple2!3}> Data.Maybe.Nothing (iostate.ioStSetIdTable (select _x_2_2::_Tuple2 1) (select _x_2_0::_Tuple2 1))) (False -> <{_Tuple2!3}> (Data.Maybe.Just id_1_0) (iostate.ioStSetIdTable (select _x_2_2::_Tuple2 1) (select _x_2_0::_Tuple2 1))) ) 
StdMenu.getMenuType_17 !_vMenuElements_0 _x_1 = "Menu"
StdMenu.anon_38 !msHs_0 = case msHs_0 (menuhandle._MenuHandles mMenus_1_0 mKeys_1_1 mEnabled_1_2 mNrMenuBound_1_3 mPopUp_1_4 -> _Tuple2 mNrMenuBound_1_3 msHs_0) 
StdMenu.checkZeroMenuBound_39 !ioState_0 = let _x_1_0 = iostate.ioStGetDevice device.MenuDevice ioState_0 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> StdMenu.stdMenuFatalError "openMenu (Menu)" "could not retrieve MenuSystemState from IOSt") (False -> let _x_3_0 = StdMenu.anon_38 (devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1)) in <{_Tuple2!3}> (commondef.zeroBound (select _x_3_0::_Tuple2 0)) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_3_0::_Tuple2 1)) (select _x_1_0::_Tuple3 2))) 
StdMenu.openMenu_18 !_vMenuElements_0 ls_1 !mDef_2 !pState_3 = let pState_1_0 = select menudevice.menuFunctions::devicefunctions._DeviceFunctions 5 pState_3, _x_1_1 = StdPSt.accPIO StdMenu.checkZeroMenuBound_39 pState_1_0 in case (select _x_1_1::_Tuple2 0) (True -> <{_Tuple2!3}> StdIOCommon.ErrorViolateDI (select _x_1_1::_Tuple2 1)) (False -> let _x_3_0 = menudefaccess.menuDefGetMenuId mDef_2, optMenu_3_1 = select _x_3_0::_Tuple2 0, pState_3_2 = select _x_1_1::_Tuple2 1, _x_3_3 = StdPSt.accPIO (StdMenu.validateMenuId optMenu_3_1) pState_3_2, optMenu_3_4 = select _x_3_3::_Tuple2 0 in case (Data.Maybe.isNothing optMenu_3_4) (True -> <{_Tuple2!3}> StdIOCommon.ErrorIdsInUse (select _x_3_3::_Tuple2 1)) (False -> let menu_5_0 = Data.Maybe.fromJust optMenu_3_4 in case (<{id.==_27}> menu_5_0 id.windowMenuId) (True -> <{_Tuple2!3}> StdIOCommon.ErrorIdsInUse (select _x_3_3::_Tuple2 1)) (False -> <{menucreate.openMenu`}> _vMenuElements_0 menu_5_0 ls_1 (select _x_3_0::_Tuple2 1) (select _x_3_3::_Tuple2 1)) ) ) 
StdMenu.getMenuType_19 !_vPopUpMenuElements_0 _x_1 = "PopUpMenu"
StdMenu.handlePopUpMenu_40 !pState_0 = let _x_1_0 = iostate.ioStGetOSDInfo (select pState_0::iostate._PSt 1), ioState_1_1 = select _x_1_0::_Tuple2 1, _x_1_2 = iostate.ioStGetDevice device.MenuDevice ioState_1_1 in case (StdBool.not (select _x_1_2::_Tuple3 0)) (True -> StdMenu.stdMenuFatalError "openMenu (PopUpMenu)" "could not retrieve MenuSystemState from IOSt") (False -> let mDevice_3_0 = select _x_1_2::_Tuple3 1, mHs_3_1 = devicesystemstate.menuSystemStateGetMenuHandles mDevice_3_0, _x_3_2::I = menuaccess.menuHandlesGetMenus mHs_3_1, menus_3_3 = select _x_3_2::_Tuple2 0, _x_3_4 = commondef.hdtl menus_3_3, popUpMenu_3_5::I = select _x_3_4::_Tuple2 0, _x_3_6 = menuaccess.menuStateHandleGetHandle popUpMenu_3_5, mPtr_3_7::I = select _x_3_6::_Tuple2 0, osd_3_8 = select _x_1_0::_Tuple2 0, framePtr_3_9 = <{StdMenu._c;202;47_92}> (osdocumentinterface.getOSDInfoOSInfo osd_3_8), ioState_3_10 = select _x_1_2::_Tuple3 2, _x_3_11 = iostate.getIOToolbox ioState_3_10, tb_3_12 = select _x_3_11::_Tuple2 0, _x_3_13 = osmenu.osTrackPopUpMenu mPtr_3_7 framePtr_3_9 tb_3_12, maybePopUp_3_14 = select _x_3_13::_Tuple2 0 in case (Data.Maybe.isNothing maybePopUp_3_14) (True -> update pState_0::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update (select _x_3_2::_Tuple2 1)::menuhandle._MenuHandles [0:_predefined._Cons (select _x_3_6::_Tuple2 1) (select _x_3_4::_Tuple2 1)])) (iostate.setIOToolbox (select _x_3_13::_Tuple2 1) (select _x_3_11::_Tuple2 1))]) (False -> let popUpMenu_5_0 = select _x_3_6::_Tuple2 1, tb_5_1 = select _x_3_13::_Tuple2 1, _x_5_2::I = menuevent.popUpMenuEvent (Data.Maybe.fromJust maybePopUp_3_14) popUpMenu_5_0 tb_5_1, maybePopUpEvent_5_3 = select _x_5_2::_Tuple3 0 in case (Data.Maybe.isNothing maybePopUpEvent_5_3) (True -> update pState_0::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update (select _x_3_2::_Tuple2 1)::menuhandle._MenuHandles [0:_predefined._Cons (select _x_5_2::_Tuple3 1) (select _x_3_4::_Tuple2 1)])) (iostate.setIOToolbox (select _x_5_2::_Tuple3 2) (select _x_3_11::_Tuple2 1))]) (False -> select (select menudevice.menuFunctions::devicefunctions._DeviceFunctions 4 (Data.Maybe.fromJust maybePopUpEvent_5_3) (update pState_0::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update (select _x_3_2::_Tuple2 1)::menuhandle._MenuHandles [0:_predefined._Cons (select _x_5_2::_Tuple3 1) (select _x_3_4::_Tuple2 1)])) (iostate.setIOToolbox (select _x_5_2::_Tuple3 2) (select _x_3_11::_Tuple2 1))]))::_Tuple2 1) ) ) 
<{StdMenu._c;202;47_92}>::I !_x_0 = case _x_0 (Data.Maybe.Just info_1_0 -> select info_1_0::osdocumentinterface._OSInfo 0) (_ -> StdMenu.stdMenuFatalError "openMenu (PopUpMenu)" "incorrect OSDInfo retrieved")
StdMenu.openMenu_20 !_vPopUpMenuElements_0 ls_1 !mDef_2 !pState_3 = let _x_1_0 = StdPSt.accPIO iostate.ioStGetOSDInfo pState_3, osd_1_1 = select _x_1_0::_Tuple2 0 in case (<{StdIOCommon.==_39}> (osdocumentinterface.getOSDInfoDocumentInterface osd_1_1) StdIOCommon.NDI) (True -> <{_Tuple2!3}> StdIOCommon.ErrorViolateDI (select _x_1_0::_Tuple2 1)) (False -> let maybeOSMenuBar_3_0 = osdocumentinterface.getOSDInfoOSMenuBar osd_1_1 in case (Data.Maybe.isNothing maybeOSMenuBar_3_0) (True -> StdMenu.stdMenuFatalError "openMenu (PopUpMen)" "OSMenuBar could not be retrieved from OSDInfo") (False -> let pState_5_0 = select _x_1_0::_Tuple2 1, pState_5_1 = select menudevice.menuFunctions::devicefunctions._DeviceFunctions 5 pState_5_0, _x_5_2 = iostate.ioStGetDevice device.MenuDevice (select pState_5_1::iostate._PSt 1) in case (StdBool.not (select _x_5_2::_Tuple3 0)) (True -> <{_Tuple2!3}> StdIOCommon.ErrorUnknownObject (update pState_5_1::iostate._PSt [1:select _x_5_2::_Tuple3 2])) (False -> let ioState_7_0 = select _x_5_2::_Tuple3 2, _x_7_1 = iostate.ioStGetIdTable ioState_7_0, ioState_7_2 = select _x_7_1::_Tuple2 1, _x_7_3 = iostate.ioStGetReceiverTable ioState_7_2, ioState_7_4 = select _x_7_3::_Tuple2 1, _x_7_5 = iostate.ioStGetIOId ioState_7_4, ioid_7_6 = select _x_7_5::_Tuple2 0, mDevice_7_7 = select _x_5_2::_Tuple3 1, mHs_7_8 = devicesystemstate.menuSystemStateGetMenuHandles mDevice_7_7, mHs_7_9 = menucreate.closepopupmenu mHs_7_8, rt_7_10 = select _x_7_3::_Tuple2 0, idtable_7_11 = select _x_7_1::_Tuple2 0, osMenuBar_7_12 = Data.Maybe.fromJust maybeOSMenuBar_3_0, ioState_7_13 = select _x_7_5::_Tuple2 1, _x_7_14 = menucreate.createPopUpMenu _vPopUpMenuElements_0 ioid_7_6 ls_1 mDef_2 mHs_7_9 rt_7_10 idtable_7_11 osMenuBar_7_12 (update pState_5_1::iostate._PSt [1:ioState_7_13]) in case (select _x_7_14::_Tuple6 0) (True -> let pState_9_0 = select _x_7_14::_Tuple6 5 in <{_Tuple2!3}> StdIOCommon.NoError (StdMenu.handlePopUpMenu_40 (update pState_9_0::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_7_14::_Tuple6 1)) (iostate.ioStSetIdTable (select _x_7_14::_Tuple6 3) (iostate.ioStSetReceiverTable (select _x_7_14::_Tuple6 2) (iostate.ioStSetOSDInfo (osdocumentinterface.setOSDInfoOSMenuBar (select _x_7_14::_Tuple6 4) osd_1_1) (select pState_9_0::iostate._PSt 1))))]))) (False -> let pState_9_0 = select _x_7_14::_Tuple6 5 in <{_Tuple2!3}> StdIOCommon.ErrorIdsInUse (update pState_9_0::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_7_14::_Tuple6 1)) (iostate.ioStSetIdTable (select _x_7_14::_Tuple6 3) (iostate.ioStSetReceiverTable (select _x_7_14::_Tuple6 2) (iostate.ioStSetOSDInfo (osdocumentinterface.setOSDInfoOSMenuBar (select _x_7_14::_Tuple6 4) osd_1_1) (select pState_9_0::iostate._PSt 1))))])) ) ) ) 
<{StdMenu.TD;Menus;}> _x_0::B = _predefined._Nil


|| Converted Records
:: <{StdMenu.Menus;}> = {!StdMenu.getMenuType, !StdMenu.openMenu}

:: <{StdMenu.gEq_s;}> = {!StdMenu.gEq_s}

:: <{StdMenu.gEq_ss;}> = {!StdMenu.gEq_ss}

:: <{StdMenu.gEq_sss;}> = {!StdMenu.gEq_sss}

:: <{StdMenu.gEq_ssss;}> = {!StdMenu.gEq_ssss}

:: <{StdMenu.gEq_sssss;}> = {!StdMenu.gEq_sssss}

:: <{StdMenu.gEq_ssssss;}> = {!StdMenu.gEq_ssssss}

:: <{StdMenu.gEq_sssssss;}> = {!StdMenu.gEq_sssssss}

:: <{StdMenu.gEq_ssssssss;}> = {!StdMenu.gEq_ssssssss}

:: <{StdMenu.gEq_sssssssss;}> = {!StdMenu.gEq_sssssssss}

:: <{StdMenu.bimap_s;}> = {StdMenu.bimap_s}

:: <{StdMenu.bimap_ss;}> = {StdMenu.bimap_ss}

:: <{StdMenu.bimap_sss;}> = {StdMenu.bimap_sss}

