|| ?module? menuinternal


menuinternal.menuinternalFatalError !function_0 !error_1 = commondef.fatalError function_0 "menuinternal" error_1
menuinternal.isMenuWithThisId_13 !id_0 !msH_1 = let _x_1_0 = menuaccess.menuStateHandleGetMenuId msH_1 in <{_Tuple2!3}> (<{id.==_27}> id_0 (select _x_1_0::_Tuple2 0)) (select _x_1_0::_Tuple2 1)
menuinternal.filterShortcutkeys !osd_0 !_x_1 !keys_2 !tb_3::I = case _x_1 (menuhandle.MenuLSHandle mH_1_0 -> case mH_1_0 (menuhandle._MenuLSHandle mlsState_2_0 mlsH_2_1 -> case mlsH_2_1 (menuhandle._MenuHandle mHandle_3_0 mMenu_3_1 mOSMenuNr_3_2 mTitle_3_3 mSelect_3_4 itemHs_3_5 -> let _x_4_0 = commondef.stateMap (menucreate.disposeShortcutkeys (<{menuinternal._c;135;27_63}> (osdocumentinterface.getOSDInfoOSInfo osd_0))) itemHs_3_5 (_Tuple2 keys_2 tb_3) in <{_Tuple2!3}> (menuhandle.MenuLSHandle (update mH_1_0::menuhandle._MenuLSHandle [1:update mlsH_2_1::menuhandle._MenuHandle [5:select _x_4_0::_Tuple2 0]])) (select _x_4_0::_Tuple2 1)) ) ) 
<{menuinternal._c;135;27_63}>::I !_x_0 = case _x_0 (Data.Maybe.Just info_1_0 -> select info_1_0::osdocumentinterface._OSInfo 0) (_ -> -1)
menuinternal.closeMenuIds !pid_0 !_x_1 !_x_2 = case _x_1 (menuhandle.MenuLSHandle mH_1_0 -> case mH_1_0 (menuhandle._MenuLSHandle mlsState_2_0 mlsH_2_1 -> case mlsH_2_1 (menuhandle._MenuHandle mHandle_3_0 mMenu_3_1 mOSMenuNr_3_2 mTitle_3_3 mSelect_3_4 itemHs_3_5 -> case _x_2 (_Tuple2 rt_4_0 it_4_1 -> let _x_5_0 = commondef.stateMap (menucreate.disposeMenuIds pid_0) itemHs_3_5 (_Tuple2 rt_4_0 it_4_1) in <{_Tuple2!3}> (menuhandle.MenuLSHandle (update mH_1_0::menuhandle._MenuLSHandle [1:update mlsH_2_1::menuhandle._MenuHandle [5:select _x_5_0::_Tuple2 0]])) (select _x_5_0::_Tuple2 1)) ) ) ) 
menuinternal.closeSubMenus !_x_0 !tb_1::I = case _x_0 (menuhandle.MenuLSHandle mH_1_0 -> case mH_1_0 (menuhandle._MenuLSHandle mlsState_2_0 mlsH_2_1 -> case mlsH_2_1 (menuhandle._MenuHandle mParentH_3_0 mMenu_3_1 mOSMenuNr_3_2 mTitle_3_3 mSelect_3_4 itemHs_3_5 -> let _x_4_0 = commondef.stateMap menucreate.disposeSubMenuHandles itemHs_3_5 (_Tuple2 mParentH_3_0 tb_1) in <{_Tuple2!3}> (menuhandle.MenuLSHandle (update mH_1_0::menuhandle._MenuLSHandle [1:update mlsH_2_1::menuhandle._MenuHandle [5:select _x_4_0::_Tuple2 0]])) (select (select _x_4_0::_Tuple2 1)::_Tuple2 1)) ) ) 
menuinternal.closemenu !id_0 !ioState_1 = let _x_1_0 = iostate.ioStGetOSDInfo ioState_1, osd_1_1 = select _x_1_0::_Tuple2 0 in case (<{StdIOCommon.==_39}> (osdocumentinterface.getOSDInfoDocumentInterface osd_1_1) StdIOCommon.NDI) (True -> select _x_1_0::_Tuple2 1) (False -> let maybeOSMenuBar_3_0 = osdocumentinterface.getOSDInfoOSMenuBar osd_1_1 in case (Data.Maybe.isNothing maybeOSMenuBar_3_0) (True -> menuinternal.menuinternalFatalError "closemenu" "could not retrieve OSMenuBar from OSDInfo") (False -> let ioState_5_0 = select _x_1_0::_Tuple2 1, _x_5_1 = iostate.ioStGetDevice device.MenuDevice ioState_5_0 in case (StdBool.not (select _x_5_1::_Tuple3 0)) (True -> select _x_5_1::_Tuple3 2) (False -> let mDevice_7_0 = select _x_5_1::_Tuple3 1, mHs_7_1 = devicesystemstate.menuSystemStateGetMenuHandles mDevice_7_0, _x_7_2 = menuaccess.menuHandlesGetMenus mHs_7_1, menus_7_3 = select _x_7_2::_Tuple2 0, _x_7_4 = commondef.uremove (menuinternal.isMenuWithThisId_13 id_0) StdMisc.undef menus_7_3 in case (StdBool.not (select _x_7_4::_Tuple3 0)) (True -> iostate.ioStSetDevice (devicesystemstate.MenuSystemState (update (select _x_7_2::_Tuple2 1)::menuhandle._MenuHandles [0:select _x_7_4::_Tuple3 2])) (select _x_5_1::_Tuple3 2)) (False -> let ioState_9_0 = select _x_5_1::_Tuple3 2, _x_9_1 = sdisize.getSDIWindowSize ioState_9_0, sdiSize1_9_2 = select _x_9_1::_Tuple3 0, mHs_9_3 = select _x_7_2::_Tuple2 1, _x_9_4 = menuaccess.menuHandlesGetKeys mHs_9_3, mHs_9_5 = select _x_9_4::_Tuple2 1, menus_9_6 = select _x_7_4::_Tuple3 2, mH_9_7 = select _x_7_4::_Tuple3 1, _x_9_8 = menuaccess.menuStateHandleGetHandle mH_9_7, mH_9_9 = select _x_9_8::_Tuple2 1, keys_9_10 = select _x_9_4::_Tuple2 0, ioState_9_11 = select _x_9_1::_Tuple3 2, _x_9_12::I = iostate.getIOToolbox ioState_9_11, tb_9_13::I = select _x_9_12::_Tuple2 0, _x_9_14 = menuinternal.filterShortcutkeys osd_1_1 mH_9_9 keys_9_10 tb_9_13, _x_9_15 = select _x_9_14::_Tuple2 1, keys_9_16::I = select _x_9_15::_Tuple2 0, mHs_9_17 = update mHs_9_5::menuhandle._MenuHandles [0:menus_9_6,1:keys_9_16], menu_9_18::I = select _x_9_8::_Tuple2 0, osMenuBar_9_19 = Data.Maybe.fromJust maybeOSMenuBar_3_0, ioState_9_20 = select _x_9_12::_Tuple2 1, _x_9_21 = iostate.ioStGetReceiverTable ioState_9_20, ioState_9_22 = select _x_9_21::_Tuple2 1, _x_9_23 = iostate.ioStGetIdTable ioState_9_22, ioState_9_24 = select _x_9_23::_Tuple2 1, _x_9_25 = iostate.ioStGetIOId ioState_9_24, ioid_9_26 = select _x_9_25::_Tuple2 0, mH_9_27 = select _x_9_14::_Tuple2 0, rt_9_28 = select _x_9_21::_Tuple2 0, it_9_29 = select _x_9_23::_Tuple2 0, _x_9_30 = id.removeIdFromIdTable id_0 it_9_29, it_9_31 = select _x_9_30::_Tuple2 1, _x_9_32 = menuinternal.closeMenuIds ioid_9_26 mH_9_27 (_Tuple2 rt_9_28 it_9_31), mH_9_33 = select _x_9_32::_Tuple2 0, tb_9_34::I = select _x_9_15::_Tuple2 1, _x_9_35 = menuinternal.closeSubMenus mH_9_33 tb_9_34, tb_9_36 = select _x_9_35::_Tuple2 1, _x_9_37 = osmenu.osMenuRemove menu_9_18 osMenuBar_9_19 tb_9_36, osMenuBar_9_38 = select _x_9_37::_Tuple2 0, tb_9_39::I = select _x_9_37::_Tuple2 1, tb_9_40 = osmenu.osDrawMenuBar osMenuBar_9_38 tb_9_39, osd_9_41 = osdocumentinterface.setOSDInfoOSMenuBar osMenuBar_9_38 osd_1_1, _x_9_42 = select _x_9_32::_Tuple2 1, rt_9_43 = select _x_9_42::_Tuple2 0, it_9_44 = select _x_9_42::_Tuple2 1, ioState_9_45 = select _x_9_25::_Tuple2 1, ioState_9_46 = iostate.ioStSetIdTable it_9_44 ioState_9_45, ioState_9_47 = iostate.ioStSetReceiverTable rt_9_43 ioState_9_46, ioState_9_48 = iostate.ioStSetOSDInfo osd_9_41 ioState_9_47, ioState_9_49 = iostate.setIOToolbox tb_9_40 ioState_9_48, ioState_9_50 = iostate.ioStSetDevice (devicesystemstate.MenuSystemState mHs_9_17) ioState_9_49, _x_9_51 = sdisize.getSDIWindowSize ioState_9_50, sdiSize2_9_52 = select _x_9_51::_Tuple3 0 in case (<{StdIOBasic.==_14}> sdiSize1_9_2 sdiSize2_9_52) (True -> select _x_9_51::_Tuple3 2) (False -> sdisize.resizeSDIWindow (select _x_9_1::_Tuple3 1) sdiSize1_9_2 sdiSize2_9_52 (select _x_9_51::_Tuple3 2)) ) ) ) ) 
menuinternal.accessMenuSystemState !redrawMenus_0::B !f_1 x_2 !ioState_3 = let _x_1_0 = iostate.ioStGetDevice device.MenuDevice ioState_3 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> <{_Tuple2!2}> x_2 (select _x_1_0::_Tuple3 2)) (False -> let ioState_3_0 = select _x_1_0::_Tuple3 2, _x_3_1 = iostate.ioStGetOSDInfo ioState_3_0, osdinfo_3_2 = select _x_3_1::_Tuple2 0, maybeOSMenuBar_3_3 = osdocumentinterface.getOSDInfoOSMenuBar osdinfo_3_2 in case (Data.Maybe.isNothing maybeOSMenuBar_3_3) (True -> menuinternal.menuinternalFatalError "accessMenuSystemState" "could not retrieve OSMenuBar from OSDInfo") (False -> case (StdBool.not redrawMenus_0) (True -> let _x_6_0 = iostate.getIOToolbox (select _x_3_1::_Tuple2 1), _x_6_1 = f_1 (Data.Maybe.fromJust maybeOSMenuBar_3_3) x_2 (devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1)) (select _x_6_0::_Tuple2 0) in <{_Tuple2!2}> (select _x_6_1::_Tuple3 0) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_1::_Tuple3 1)) (iostate.setIOToolbox (select _x_6_1::_Tuple3 2) (select _x_6_0::_Tuple2 1)))) (False -> let osMenuBar_6_0 = Data.Maybe.fromJust maybeOSMenuBar_3_3, _x_6_1 = iostate.getIOToolbox (select _x_3_1::_Tuple2 1), _x_6_2 = f_1 osMenuBar_6_0 x_2 (devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1)) (select _x_6_1::_Tuple2 0) in <{_Tuple2!2}> (select _x_6_2::_Tuple3 0) (iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_2::_Tuple3 1)) (iostate.setIOToolbox (osmenu.osDrawMenuBar osMenuBar_6_0 (select _x_6_2::_Tuple3 2)) (select _x_6_1::_Tuple2 1)))) ) ) 
menuinternal.closemenuelements !m_0 !ids_1 !ioState_2 = let _x_1_0 = iostate.ioStGetIOId ioState_2, _x_1_1 = iostate.ioStGetReceiverTable (select _x_1_0::_Tuple2 1), _x_1_2 = iostate.ioStGetIdTable (select _x_1_1::_Tuple2 1), _x_1_3 = iostate.ioStGetOSDInfo (select _x_1_2::_Tuple2 1), _x_1_4 = menuinternal.accessMenuSystemState True (menuitems.removeMenusItems (select _x_1_3::_Tuple2 0) m_0 ids_1 (select _x_1_0::_Tuple2 0)) (_Tuple2 (select _x_1_1::_Tuple2 0) (select _x_1_2::_Tuple2 0)) (select _x_1_3::_Tuple2 1), _x_1_5 = select _x_1_4::_Tuple2 0 in iostate.ioStSetReceiverTable (select _x_1_5::_Tuple2 0) (iostate.ioStSetIdTable (select _x_1_5::_Tuple2 1) (select _x_1_4::_Tuple2 1))
menuinternal.closemenuindexelements !removeSpecialElements_0::B !fromRadioMenu_1::B !pid_2 !loc_3 !indices_4 !ioState_5 = let _x_1_0 = iostate.ioStGetReceiverTable ioState_5, _x_1_1 = iostate.ioStGetIdTable (select _x_1_0::_Tuple2 1), _x_1_2 = iostate.ioStGetOSDInfo (select _x_1_1::_Tuple2 1), _x_1_3 = menuinternal.accessMenuSystemState True (menuitems.removeMenusIndexItems (select _x_1_2::_Tuple2 0) removeSpecialElements_0 fromRadioMenu_1 loc_3 indices_4 pid_2) (_Tuple2 (select _x_1_0::_Tuple2 0) (select _x_1_1::_Tuple2 0)) (select _x_1_2::_Tuple2 1), _x_1_4 = select _x_1_3::_Tuple2 0 in iostate.ioStSetReceiverTable (select _x_1_4::_Tuple2 0) (iostate.ioStSetIdTable (select _x_1_4::_Tuple2 1) (select _x_1_3::_Tuple2 1))
menuinternal.setSelectMenuHandle_14 !z_0::I !select_1 !osMenuBar_2 !systemAble_3::B !ids_4 !msH_5 !tb_6::I = case msH_5 (menuhandle.MenuLSHandle mlsH_1_0 -> case mlsH_1_0 (menuhandle._MenuLSHandle mlsState_2_0 mH_2_1 -> case mH_2_1 (menuhandle._MenuHandle mHandle_3_0 mMenu_3_1 mOSMenuNr_3_2 mTitle_3_3 mSelect_3_4 m_3_5 -> let _x_4_0 = commondef.removeCheck (<{StdClass.Eq;}> (<{StdOverloaded.==;}> <{id.==_27}>)) mMenu_3_1 ids_4 in case (StdBool.not (select _x_4_0::_Tuple2 0)) (True -> <{_Tuple3!7}> (select _x_4_0::_Tuple2 1) msH_5 tb_6) (False -> case (StdBool.not systemAble_3) (True -> <{_Tuple3!7}> (select _x_4_0::_Tuple2 1) (menuhandle.MenuLSHandle (update mlsH_1_0::menuhandle._MenuLSHandle [1:update mH_2_1::menuhandle._MenuHandle [4:StdIOCommon.enabled select_1]])) tb_6) (False -> case (StdIOCommon.enabled select_1) (True -> <{_Tuple3!7}> (select _x_4_0::_Tuple2 1) (menuhandle.MenuLSHandle (update mlsH_1_0::menuhandle._MenuLSHandle [1:update mH_2_1::menuhandle._MenuHandle [4:StdIOCommon.enabled select_1]])) (osmenu.osEnableMenu z_0 osMenuBar_2 tb_6)) (False -> <{_Tuple3!7}> (select _x_4_0::_Tuple2 1) (menuhandle.MenuLSHandle (update mlsH_1_0::menuhandle._MenuLSHandle [1:update mH_2_1::menuhandle._MenuHandle [4:StdIOCommon.enabled select_1]])) (osmenu.osDisableMenu z_0 osMenuBar_2 tb_6)) ) ) ) ) ) 
menuinternal.setSelectMenuHandles_15 !_x_0::I !_x_1 !_x_2 !_x_3::B !ids_4 !_x_5 !tb_6::I = case _x_5 (_predefined._Nil -> <{_Tuple3!7}> ids_4 _predefined._Nil tb_6) (_predefined._Cons msH_1_0 msHs_1_1 -> case (StdList.isEmpty ids_4) (True -> <{_Tuple3!7}> ids_4 (_predefined._Cons msH_1_0 msHs_1_1) tb_6) (False -> let _x_3_0 = menuinternal.setSelectMenuHandle_14 _x_0 _x_1 _x_2 _x_3 ids_4 msH_1_0 tb_6, _x_3_1 = menuinternal.setSelectMenuHandles_15 (<{StdInt.+_6}> _x_0 1) _x_1 _x_2 _x_3 (select _x_3_0::_Tuple3 0) msHs_1_1 (select _x_3_0::_Tuple3 2) in <{_Tuple3!7}> (select _x_3_1::_Tuple3 0) (_predefined._Cons (select _x_3_0::_Tuple3 1) (select _x_3_1::_Tuple3 1)) (select _x_3_1::_Tuple3 2)) ) 
menuinternal.setSelectMenus !ids_0 !select_1 !osMenuBar_2 !menus_3 !tb_4::I = case menus_3 (menuhandle._MenuHandles mMenus_1_0 mKeys_1_1 mEnabled_1_2 mNrMenuBound_1_3 mPopUp_1_4 -> let _x_2_0 = menuinternal.setSelectMenuHandles_15 0 select_1 osMenuBar_2 mEnabled_1_2 ids_0 mMenus_1_0 tb_4 in <{_Tuple2!3}> (update menus_3::menuhandle._MenuHandles [0:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
menuinternal.changeMenuSystemState !redrawMenus_0::B !f_1 !ioState_2 = let _x_1_0 = iostate.ioStGetDevice device.MenuDevice ioState_2 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> select _x_1_0::_Tuple3 2) (False -> let ioState_3_0 = select _x_1_0::_Tuple3 2, _x_3_1 = iostate.ioStGetOSDInfo ioState_3_0, osdinfo_3_2 = select _x_3_1::_Tuple2 0, maybeOSMenuBar_3_3 = osdocumentinterface.getOSDInfoOSMenuBar osdinfo_3_2 in case (Data.Maybe.isNothing maybeOSMenuBar_3_3) (True -> menuinternal.menuinternalFatalError "changeMenuSystemState" "could not retrieve OSMenuBar from OSDInfo") (False -> case (StdBool.not redrawMenus_0) (True -> let _x_6_0 = iostate.getIOToolbox (select _x_3_1::_Tuple2 1), _x_6_1 = f_1 (Data.Maybe.fromJust maybeOSMenuBar_3_3) (devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1)) (select _x_6_0::_Tuple2 0) in iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_1::_Tuple2 0)) (iostate.setIOToolbox (select _x_6_1::_Tuple2 1) (select _x_6_0::_Tuple2 1))) (False -> let osMenuBar_6_0 = Data.Maybe.fromJust maybeOSMenuBar_3_3, _x_6_1 = iostate.getIOToolbox (select _x_3_1::_Tuple2 1), _x_6_2 = f_1 osMenuBar_6_0 (devicesystemstate.menuSystemStateGetMenuHandles (select _x_1_0::_Tuple3 1)) (select _x_6_1::_Tuple2 0) in iostate.ioStSetDevice (devicesystemstate.MenuSystemState (select _x_6_2::_Tuple2 0)) (iostate.setIOToolbox (osmenu.osDrawMenuBar osMenuBar_6_0 (select _x_6_2::_Tuple2 1)) (select _x_6_1::_Tuple2 1))) ) ) 
menuinternal.enablemenus !ids_0 !ioState_1 = menuinternal.changeMenuSystemState True (menuinternal.setSelectMenus ids_0 StdIOCommon.Able) ioState_1
menuinternal.disablemenus !ids_0 !ioState_1 = menuinternal.changeMenuSystemState True (menuinternal.setSelectMenus ids_0 StdIOCommon.Unable) ioState_1
menuinternal.setOSMenusTitle_16 !id_0 !title_1 !osMenuBar_2 !_x_3 !tb_4::I = case _x_3 (_predefined._Cons msH_1_0 msHs_1_1 -> let _x_2_0 = menuaccess.menuStateHandleGetMenuId msH_1_0 in case (<{id.==_27}> id_0 (select _x_2_0::_Tuple2 0)) (True -> let _x_4_0 = menuaccess.menuStateHandleGetHandle (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (_predefined._Cons (menuaccess.menuStateHandleSetTitle title_1 (select _x_4_0::_Tuple2 1)) msHs_1_1) (osmenu.osChangeMenuTitle osMenuBar_2 (select _x_4_0::_Tuple2 0) title_1 tb_4)) (False -> let _x_4_0 = menuinternal.setOSMenusTitle_16 id_0 title_1 osMenuBar_2 msHs_1_1 tb_4 in <{_Tuple2!3}> (_predefined._Cons (select _x_2_0::_Tuple2 1) (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) (_predefined._Nil -> <{_Tuple2!3}> _predefined._Nil tb_4) 
menuinternal.setOSMenuTitle_17 !id_0 !title_1 !osMenuBar_2 !menus_3 !tb_4::I = case menus_3 (menuhandle._MenuHandles mMenus_1_0 mKeys_1_1 mEnabled_1_2 mNrMenuBound_1_3 mPopUp_1_4 -> let _x_2_0 = menuinternal.setOSMenusTitle_16 id_0 title_1 osMenuBar_2 mMenus_1_0 tb_4 in <{_Tuple2!3}> (update menus_3::menuhandle._MenuHandles [0:select _x_2_0::_Tuple2 0]) (select _x_2_0::_Tuple2 1)) 
menuinternal.setmenutitle !id_0 !title_1 !ioState_2 = menuinternal.changeMenuSystemState True (menuinternal.setOSMenuTitle_17 id_0 title_1) ioState_2


|| Converted Records
:: <{menuinternal.gEq_s;}> = {!menuinternal.gEq_s}

:: <{menuinternal.gEq_ss;}> = {!menuinternal.gEq_ss}

:: <{menuinternal.gEq_sss;}> = {!menuinternal.gEq_sss}

:: <{menuinternal.gEq_ssss;}> = {!menuinternal.gEq_ssss}

:: <{menuinternal.gEq_sssss;}> = {!menuinternal.gEq_sssss}

:: <{menuinternal.gEq_ssssss;}> = {!menuinternal.gEq_ssssss}

:: <{menuinternal.gEq_sssssss;}> = {!menuinternal.gEq_sssssss}

:: <{menuinternal.gEq_ssssssss;}> = {!menuinternal.gEq_ssssssss}

:: <{menuinternal.gEq_sssssssss;}> = {!menuinternal.gEq_sssssssss}

:: <{menuinternal.bimap_s;}> = {menuinternal.bimap_s}

:: <{menuinternal.bimap_ss;}> = {menuinternal.bimap_ss}

:: <{menuinternal.bimap_sss;}> = {menuinternal.bimap_sss}

