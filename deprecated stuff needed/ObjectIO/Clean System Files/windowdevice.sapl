|| ?module? windowdevice


windowdevice.windowdeviceFatalError !function_0 !error_1 = commondef.fatalError function_0 "windowdevice" error_1
windowdevice.receiverSyncIO_34 !msg_0 !rH_1 !ls_ps_2 = let _x_1_0 = receiveraccess.receiverHandleSyncMessage msg_0 rH_1 ls_ps_2 in <{_Tuple3!1}> (update msg_0::receivermessage._SyncMessage [2:select _x_1_0::_Tuple3 0]) (select _x_1_0::_Tuple3 1) (select _x_1_0::_Tuple3 2)
windowdevice.elementControlSyncIO_35 !r2_0 !msg_1 !_x_2 ls_ps_3 = case _x_2 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (windowaccess.identifyMaybeId r2_0 w_2_0)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple4!3}> False msg_1 (windowhandle.WItemHandle itemH_1_0) ls_ps_3) (False -> let _x_5_0 = windowdevice.elementsControlSyncIO_36 r2_0 msg_1 w_2_7 ls_ps_3 in <{_Tuple4!3}> (select _x_5_0::_Tuple4 0) (select _x_5_0::_Tuple4 1) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple4 2])) (select _x_5_0::_Tuple4 3)) ) (False -> case (case (StdBool.not (<{windowhandle.==_8}> w_2_2 (windowhandle.IsOtherControl "Receiver"))) (True -> StdBool.not (<{windowhandle.==_8}> w_2_2 (windowhandle.IsOtherControl "Receiver2"))) (False -> False) ) (True -> <{_Tuple4!3}> True msg_1 (windowhandle.WItemHandle itemH_1_0) ls_ps_3) (False -> let _x_5_0 = windowdevice.receiverSyncIO_34 msg_1 (windowaccess.getWItemReceiverInfo w_2_5) ls_ps_3 in <{_Tuple4!3}> True (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [5:windowhandle.ReceiverInfo (select _x_5_0::_Tuple3 1)])) (select _x_5_0::_Tuple3 2)) ) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsControlSyncIO_36 r2_0 msg_1 itemHs_1_0 ls_ps_3 in <{_Tuple4!3}> (select _x_2_0::_Tuple4 0) (select _x_2_0::_Tuple4 1) (windowhandle.WListLSHandle (select _x_2_0::_Tuple4 2)) (select _x_2_0::_Tuple4 3)) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_3 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlSyncIO_36 r2_0 msg_1 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) pst_3_1), _x_4_1 = select _x_4_0::_Tuple4 3, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple4!3}> (select _x_4_0::_Tuple4 0) (select _x_4_0::_Tuple4 1) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple4 2))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_3 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlSyncIO_36 r2_0 msg_1 itemHs_2_1 (_Tuple2 chLS_2_0 pst_3_1), _x_4_1 = select _x_4_0::_Tuple4 3 in <{_Tuple4!3}> (select _x_4_0::_Tuple4 0) (select _x_4_0::_Tuple4 1) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple4 2))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlSyncIO_36 !r2_0 !msg_1 !_x_2 ls_ps_3 = case _x_2 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlSyncIO_35 r2_0 msg_1 itemH_1_0 ls_ps_3, done_2_1 = select _x_2_0::_Tuple4 0 in case done_2_1 (True -> <{_Tuple4!3}> done_2_1 (select _x_2_0::_Tuple4 1) (_predefined._Cons (select _x_2_0::_Tuple4 2) itemHs_1_1) (select _x_2_0::_Tuple4 3)) (False -> let _x_4_0 = windowdevice.elementsControlSyncIO_36 r2_0 (select _x_2_0::_Tuple4 1) itemHs_1_1 (select _x_2_0::_Tuple4 3) in <{_Tuple4!3}> (select _x_4_0::_Tuple4 0) (select _x_4_0::_Tuple4 1) (_predefined._Cons (select _x_2_0::_Tuple4 2) (select _x_4_0::_Tuple4 2)) (select _x_4_0::_Tuple4 3)) ) (_ -> <{_Tuple4!3}> False msg_1 _predefined._Nil ls_ps_3)
windowdevice.windowControlSyncIO_39 !r2_0 !msg_1 !wH_2 ls_ps_3 = case wH_2 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = windowdevice.elementsControlSyncIO_36 r2_0 msg_1 wh_1_6 ls_ps_3 in <{_Tuple3!1}> (deviceevents.SyncMessage (select _x_2_0::_Tuple4 1)) (update wH_2::windowhandle._WindowHandle [6:select _x_2_0::_Tuple4 2]) (select _x_2_0::_Tuple4 3)) 
windowdevice.receiverASyncIO_31 !rH_0 _x_1 = case rH_0 (receiverhandle._ReceiverHandle r_1_0 rASMQ_1_1 rSelect_1_2 rOneWay_1_3 rFun_1_4 r_1_5 rConnected_1_6 -> case rASMQ_1_1 (_predefined._Cons msg_2_0 msgs_2_1 -> case _x_1 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = rFun_1_4 msg_2_0 (_Tuple2 ls_3_0 pst_3_1) in _Tuple2 (update rH_0::receiverhandle._ReceiverHandle [1:msgs_2_1]) (_Tuple2 (select _x_4_0::_Tuple3 0) (select _x_4_0::_Tuple3 2))) ) ) (_ -> windowdevice.windowdeviceFatalError "receiverASyncIO" "unexpected empty asynchronous message queue")
windowdevice.elementControlASyncIO_32 !r_0 !_x_1 !_x_2 = case _x_1 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case _x_2 (_Tuple2 ls_3_0 pst_3_1 -> case (StdBool.not (windowaccess.identifyMaybeId r_0 w_2_0)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!1}> False (windowhandle.WItemHandle itemH_1_0) (_Tuple2 ls_3_0 pst_3_1)) (False -> let _x_6_0 = windowdevice.elementsControlASyncIO_33 r_0 w_2_7 (_Tuple2 ls_3_0 pst_3_1), _x_6_1 = select _x_6_0::_Tuple3 2 in <{_Tuple3!1}> (select _x_6_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_6_0::_Tuple3 1])) (_Tuple2 (select _x_6_1::_Tuple2 0) (select _x_6_1::_Tuple2 1))) ) (False -> case (case (StdBool.not (<{windowhandle.==_8}> w_2_2 (windowhandle.IsOtherControl "Receiver"))) (True -> StdBool.not (<{windowhandle.==_8}> w_2_2 (windowhandle.IsOtherControl "Receiver2"))) (False -> False) ) (True -> <{_Tuple3!1}> True (windowhandle.WItemHandle itemH_1_0) (_Tuple2 ls_3_0 pst_3_1)) (False -> let _x_6_0 = windowdevice.receiverASyncIO_31 (windowaccess.getWItemReceiverInfo w_2_5) (_Tuple2 ls_3_0 pst_3_1), _x_6_1 = select _x_6_0::_Tuple2 1 in <{_Tuple3!1}> True (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [5:windowhandle.ReceiverInfo (select _x_6_0::_Tuple2 0)])) (_Tuple2 (select _x_6_1::_Tuple2 0) (select _x_6_1::_Tuple2 1))) ) ) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> case _x_2 (_Tuple2 ls_2_0 pst_2_1 -> let _x_3_0 = windowdevice.elementsControlASyncIO_33 r_0 itemHs_1_0 (_Tuple2 ls_2_0 pst_2_1), _x_3_1 = select _x_3_0::_Tuple3 2 in <{_Tuple3!1}> (select _x_3_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_3_0::_Tuple3 1)) (_Tuple2 (select _x_3_1::_Tuple2 0) (select _x_3_1::_Tuple2 1))) ) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case _x_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlASyncIO_33 r_0 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!1}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case _x_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlASyncIO_33 r_0 itemHs_2_1 (_Tuple2 chLS_2_0 pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!1}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlASyncIO_33 !r_0 !_x_1 !_x_2 = case _x_1 (_predefined._Cons itemH_1_0 itemHs_1_1 -> case _x_2 (_Tuple2 ls_2_0 pst_2_1 -> let _x_3_0::B = windowdevice.elementControlASyncIO_32 r_0 itemH_1_0 (_Tuple2 ls_2_0 pst_2_1), done_3_1 = select _x_3_0::_Tuple3 0 in case done_3_1 (True -> let _x_5_0 = select _x_3_0::_Tuple3 2 in <{_Tuple3!1}> done_3_1 (_predefined._Cons (select _x_3_0::_Tuple3 1) itemHs_1_1) (_Tuple2 (select _x_5_0::_Tuple2 0) (select _x_5_0::_Tuple2 1))) (False -> let _x_5_0 = select _x_3_0::_Tuple3 2, _x_5_1 = windowdevice.elementsControlASyncIO_33 r_0 itemHs_1_1 (_Tuple2 (select _x_5_0::_Tuple2 0) (select _x_5_0::_Tuple2 1)), _x_5_2 = select _x_5_1::_Tuple3 2 in <{_Tuple3!1}> (select _x_5_1::_Tuple3 0) (_predefined._Cons (select _x_3_0::_Tuple3 1) (select _x_5_1::_Tuple3 1)) (_Tuple2 (select _x_5_2::_Tuple2 0) (select _x_5_2::_Tuple2 1))) ) ) (_predefined._Nil -> case _x_2 (_Tuple2 ls_2_0 pst_2_1 -> <{_Tuple3!1}> False _predefined._Nil (_Tuple2 ls_2_0 pst_2_1)) ) 
windowdevice.windowControlASyncIO_38 !r_0 !msg_1 !wH_2 !_x_3 = case wH_2 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> case _x_3 (_Tuple2 ls_2_0 pst_2_1 -> let _x_3_0 = windowdevice.elementsControlASyncIO_33 r_0 wh_1_6 (_Tuple2 ls_2_0 pst_2_1), ls_ps1_3_1 = select _x_3_0::_Tuple3 2 in <{_Tuple3!1}> (deviceevents.ASyncMessage msg_1) (update wH_2::windowhandle._WindowHandle [6:select _x_3_0::_Tuple3 1]) (_Tuple2 (select ls_ps1_3_1::_Tuple2 0) (select ls_ps1_3_1::_Tuple2 1))) ) 
windowdevice.elementControlQASyncIO_29 !r_0 !msg_1 !_x_2 = case _x_2 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (windowaccess.identifyMaybeId r_0 w_2_0)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple2!1}> False (windowhandle.WItemHandle itemH_1_0)) (False -> let _x_5_0 = windowdevice.elementsControlQASyncIO_30 r_0 msg_1 w_2_7 in <{_Tuple2!1}> (select _x_5_0::_Tuple2 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple2 1]))) ) (False -> case (case (StdBool.not (<{windowhandle.==_8}> w_2_2 (windowhandle.IsOtherControl "Receiver"))) (True -> StdBool.not (<{windowhandle.==_8}> w_2_2 (windowhandle.IsOtherControl "Receiver2"))) (False -> False) ) (True -> <{_Tuple2!1}> True (windowhandle.WItemHandle itemH_1_0)) (False -> <{_Tuple2!1}> True (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [5:windowhandle.ReceiverInfo (receiveraccess.receiverAddASyncMessage r_0 msg_1 (windowaccess.getWItemReceiverInfo w_2_5))]))) ) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsControlQASyncIO_30 r_0 msg_1 itemHs_1_0 in <{_Tuple2!1}> (select _x_2_0::_Tuple2 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple2 1))) (windowhandle.WExtendLSHandle wExH_1_0 -> case wExH_1_0 (windowhandle._WExtendLSHandle wExtendLS_2_0 itemHs_2_1 -> let _x_3_0 = windowdevice.elementsControlQASyncIO_30 r_0 msg_1 itemHs_2_1 in <{_Tuple2!1}> (select _x_3_0::_Tuple2 0) (windowhandle.WExtendLSHandle (update wExH_1_0::windowhandle._WExtendLSHandle [1:select _x_3_0::_Tuple2 1]))) ) (windowhandle.WChangeLSHandle wChH_1_0 -> case wChH_1_0 (windowhandle._WChangeLSHandle wChangeLS_2_0 itemHs_2_1 -> let _x_3_0 = windowdevice.elementsControlQASyncIO_30 r_0 msg_1 itemHs_2_1 in <{_Tuple2!1}> (select _x_3_0::_Tuple2 0) (windowhandle.WChangeLSHandle (update wChH_1_0::windowhandle._WChangeLSHandle [1:select _x_3_0::_Tuple2 1]))) ) 
windowdevice.elementsControlQASyncIO_30 !r_0 !msg_1 !_x_2 = case _x_2 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlQASyncIO_29 r_0 msg_1 itemH_1_0, done_2_1 = select _x_2_0::_Tuple2 0 in case done_2_1 (True -> <{_Tuple2!1}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple2 1) itemHs_1_1)) (False -> let _x_4_0 = windowdevice.elementsControlQASyncIO_30 r_0 msg_1 itemHs_1_1 in <{_Tuple2!1}> (select _x_4_0::_Tuple2 0) (_predefined._Cons (select _x_2_0::_Tuple2 1) (select _x_4_0::_Tuple2 1))) ) (_predefined._Nil -> <{_Tuple2!1}> False _predefined._Nil) 
windowdevice.windowControlQASyncIO_37 !r_0 !msg_1 !wH_2 !_x_3 = case wH_2 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> case _x_3 (_Tuple2 ls_2_0 pst_2_1 -> <{_Tuple3!1}> (deviceevents.QASyncMessage msg_1) (update wH_2::windowhandle._WindowHandle [6:select (windowdevice.elementsControlQASyncIO_30 r_0 (select msg_1::receivermessage._QASyncMessage 1) wh_1_6)::_Tuple2 1]) (_Tuple2 ls_2_0 pst_2_1)) ) 
windowdevice.windowStateMsgIO !msgEvent_0 !wsH_1 pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = <{windowdevice._c;477;39_129}> msgEvent_0 wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple3 1])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateMsgIO" "unexpected window placeholder")
<{windowdevice._c;477;39_129}> !msgEvent_0 = case msgEvent_0 (deviceevents.QASyncMessage msg_1_0 -> windowdevice.windowControlQASyncIO_37 (select (deviceevents.getMsgEventRecLoc msgEvent_0)::receivertable._RecLoc 3) msg_1_0) (deviceevents.ASyncMessage msg_1_0 -> windowdevice.windowControlASyncIO_38 (select (deviceevents.getMsgEventRecLoc msgEvent_0)::receivertable._RecLoc 3) msg_1_0) (deviceevents.SyncMessage msg_1_0 -> windowdevice.windowControlSyncIO_39 (select (deviceevents.getMsgEventRecLoc msgEvent_0)::receivertable._RecLoc 3) msg_1_0) 
windowdevice.anon_42::I !_x_0 = case _x_0 (windowhandle._ScrollInfo scrollFunction_1_0 scroll_1_1 scroll_1_2 scroll_1_3 -> scroll_1_3) 
windowdevice.calcNewWElementOrigin_43 wPtr_0::I !wMetrics_1 !info_2 !parentPos_3 !_x_4 !tb_5::I = case _x_4 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 compoundSize_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_2::deviceevents._CompoundScrollActionInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple4!15}> False False (windowhandle.WItemHandle itemH_1_0) tb_5) (False -> let _x_5_0 = windowdevice.calcNewCompoundOrigin_45 wPtr_0 wMetrics_1 info_2 (StdIOBasic.movePoint w_2_9 parentPos_3) w_2_7 tb_5 in <{_Tuple4!15}> (select _x_5_0::_Tuple4 0) (select _x_5_0::_Tuple4 1) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple4 2])) (select _x_5_0::_Tuple4 3)) ) (False -> case (StdBool.not (<{windowhandle.==_8}> w_2_2 windowhandle.IsCompoundControl)) (True -> windowdevice.windowdeviceFatalError "windowStateCompoundScrollActionIO" "CompoundScrollAction does not correspond with CompoundControl") (False -> let isHorizontal_5_0::I = <{StdIOCommon.==_35}> (select info_2::deviceevents._CompoundScrollActionInfo 4) StdIOCommon.Horizontal, scroll_5_1::I = Data.Maybe.fromJust (<{windowdevice._if;792;61_133}> isHorizontal_5_0 hScroll_5_7 vScroll_5_8), scrollFun_5_2::I = select scroll_5_1::windowhandle._ScrollInfo 0, compound_5_3 = windowaccess.getWItemCompoundInfo w_2_5, _x_5_4::I = _Tuple4 (select compound_5_3::windowhandle._CompoundInfo 0) (select compound_5_3::windowhandle._CompoundInfo 1) (select compound_5_3::windowhandle._CompoundInfo 2) (select compound_5_3::windowhandle._CompoundInfo 3), origin_5_5::I = select _x_5_4::_Tuple4 1, domainRect_5_6::I = select _x_5_4::_Tuple4 0, hScroll_5_7::I = select _x_5_4::_Tuple4 2, vScroll_5_8::I = select _x_5_4::_Tuple4 3, visScrolls_5_9 = oswindow.osScrollbarsAreVisible wMetrics_1 domainRect_5_6 (commondef.toTuple_72 compoundSize_2_10) (_Tuple2 (Data.Maybe.isJust hScroll_5_7) (Data.Maybe.isJust vScroll_5_8)), _x_5_10 = commondef.rectSize (oswindow.osGetCompoundContentRect wMetrics_1 visScrolls_5_9 (commondef.sizeToRect compoundSize_2_10)), w_5_11::I = select _x_5_10::StdIOBasic._Size 0, h_5_12::I = select _x_5_10::StdIOBasic._Size 1, viewFrame_5_13 = commondef.posSizeToRectangle origin_5_5 (StdIOBasic._Size w_5_11 h_5_12), _x_5_14 = <{windowdevice._if;795;51_132}> isHorizontal_5_0 domainRect_5_6 origin_5_5 w_5_11 h_5_12, <{min`_5_15}> = select _x_5_14::_Tuple4 0, <{max`_5_16}> = select _x_5_14::_Tuple4 2, viewSize_5_17 = select _x_5_14::_Tuple4 3, y_5_18 = <{StdInt.-_7}> <{max`_5_16}> viewSize_5_17, oldThumb_5_19 = select _x_5_14::_Tuple4 1, sliderState_5_20 = StdIOCommon._SliderState <{min`_5_15}> (<{windowdevice._c;51;16_131}> (<{StdInt.<_17}> <{min`_5_15}> y_5_18) y_5_18 <{min`_5_15}>) oldThumb_5_19, <{newThumb`_5_21}> = scrollFun_5_2 viewFrame_5_13 sliderState_5_20 (select info_2::deviceevents._CompoundScrollActionInfo 3), y_5_22 = <{StdInt.-_7}> <{max`_5_16}> viewSize_5_17, newThumb_5_23::B = commondef.setBetween <{newThumb`_5_21}> <{min`_5_15}> (<{windowdevice._c;51;16_130}> (<{StdInt.<_17}> <{min`_5_15}> y_5_22) y_5_22 <{min`_5_15}>) in case (<{StdInt.==_16}> newThumb_5_23 oldThumb_5_19) (True -> <{_Tuple4!15}> True False (windowhandle.WItemHandle itemH_1_0) tb_5) (False -> <{_Tuple4!15}> True True (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [5:windowhandle.CompoundInfo (update compound_5_3::windowhandle._CompoundInfo [1:<{windowdevice._if;802;51_134}> isHorizontal_5_0 origin_5_5 newThumb_5_23]),6:commondef.replaceOrAppend StdControlAttribute.isControlViewSize (StdControlDef.ControlViewSize (StdIOBasic._Size w_5_11 h_5_12)) w_2_6])) (oswindow.osSetCompoundSliderThumb wMetrics_1 wPtr_0 w_2_11 (select info_2::deviceevents._CompoundScrollActionInfo 2) (<{windowdevice._if;790;51_135}> isHorizontal_5_0 wMetrics_1 visScrolls_5_9 w_2_9 parentPos_3 compoundSize_2_10) isHorizontal_5_0 (select (oswindow.toOSscrollbarRange (_Tuple3 <{min`_5_15}> newThumb_5_23 <{max`_5_16}>) viewSize_5_17)::_Tuple4 1) (commondef.toTuple_72 compoundSize_2_10) True tb_5)) ) ) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.calcNewCompoundOrigin_45 wPtr_0 wMetrics_1 info_2 parentPos_3 itemHs_1_0 tb_5 in <{_Tuple4!15}> (select _x_2_0::_Tuple4 0) (select _x_2_0::_Tuple4 1) (windowhandle.WListLSHandle (select _x_2_0::_Tuple4 2)) (select _x_2_0::_Tuple4 3)) (windowhandle.WExtendLSHandle wExH_1_0 -> case wExH_1_0 (windowhandle._WExtendLSHandle wExtendLS_2_0 itemHs_2_1 -> let _x_3_0 = windowdevice.calcNewCompoundOrigin_45 wPtr_0 wMetrics_1 info_2 parentPos_3 itemHs_2_1 tb_5 in <{_Tuple4!15}> (select _x_3_0::_Tuple4 0) (select _x_3_0::_Tuple4 1) (windowhandle.WExtendLSHandle (update wExH_1_0::windowhandle._WExtendLSHandle [1:select _x_3_0::_Tuple4 2])) (select _x_3_0::_Tuple4 3)) ) (windowhandle.WChangeLSHandle wChH_1_0 -> case wChH_1_0 (windowhandle._WChangeLSHandle wChangeLS_2_0 itemHs_2_1 -> let _x_3_0 = windowdevice.calcNewCompoundOrigin_45 wPtr_0 wMetrics_1 info_2 parentPos_3 itemHs_2_1 tb_5 in <{_Tuple4!15}> (select _x_3_0::_Tuple4 0) (select _x_3_0::_Tuple4 1) (windowhandle.WChangeLSHandle (update wChH_1_0::windowhandle._WChangeLSHandle [1:select _x_3_0::_Tuple4 2])) (select _x_3_0::_Tuple4 3)) ) 
windowdevice.calcNewCompoundOrigin_45 wPtr_0::I !wMetrics_1 !info_2 !parentPos_3 !_x_4 !tb_5::I = case _x_4 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.calcNewWElementOrigin_43 wPtr_0 wMetrics_1 info_2 parentPos_3 itemH_1_0 tb_5, done_2_1 = select _x_2_0::_Tuple4 0 in case done_2_1 (True -> <{_Tuple4!15}> done_2_1 (select _x_2_0::_Tuple4 1) (_predefined._Cons (select _x_2_0::_Tuple4 2) itemHs_1_1) (select _x_2_0::_Tuple4 3)) (False -> let _x_4_0 = windowdevice.calcNewCompoundOrigin_45 wPtr_0 wMetrics_1 info_2 parentPos_3 itemHs_1_1 (select _x_2_0::_Tuple4 3) in <{_Tuple4!15}> (select _x_4_0::_Tuple4 0) (select _x_4_0::_Tuple4 1) (_predefined._Cons (select _x_2_0::_Tuple4 2) (select _x_4_0::_Tuple4 2)) (select _x_4_0::_Tuple4 3)) ) (_ -> <{_Tuple4!15}> False False _predefined._Nil tb_5)
<{windowdevice._if;790;51_135}> !isHorizontal_0::B !wMetrics_1 !visScrolls_2 !w_3 !parentPos_4 !compoundSize_5 = case isHorizontal_0 (True -> oswindow.osGetCompoundHScrollRect wMetrics_1 visScrolls_2 (commondef.posSizeToRect (StdIOBasic.movePoint w_3 parentPos_4) compoundSize_5)) (_ -> oswindow.osGetCompoundVScrollRect wMetrics_1 visScrolls_2 (commondef.posSizeToRect (StdIOBasic.movePoint w_3 parentPos_4) compoundSize_5))
<{windowdevice._if;802;51_134}> !isHorizontal_0::B !origin_1 !newThumb_2::I = case isHorizontal_0 (True -> update origin_1::StdIOBasic._Point2 [0:newThumb_2]) (_ -> update origin_1::StdIOBasic._Point2 [1:newThumb_2])
<{windowdevice._if;792;61_133}> !isHorizontal_0::B hScroll_1 vScroll_2 = case isHorizontal_0 (True -> hScroll_1) (_ -> vScroll_2)
<{windowdevice._if;795;51_132}> !isHorizontal_0::B domainRect_1 origin_2 w_3::I h_4::I = case isHorizontal_0 (True -> _Tuple4 (select domainRect_1::ostypes._OSRect 0) (select origin_2::StdIOBasic._Point2 0) (select domainRect_1::ostypes._OSRect 2) w_3) (_ -> _Tuple4 (select domainRect_1::ostypes._OSRect 1) (select origin_2::StdIOBasic._Point2 1) (select domainRect_1::ostypes._OSRect 3) h_4)
<{windowdevice._c;51;16_131}>::I !_x_0::B y_1::I <{min`_2}>::I = case _x_0 (True -> y_1) (_ -> <{min`_2}>)
<{windowdevice._c;51;16_130}>::I !_x_0::B y_1::I <{min`_2}>::I = case _x_0 (True -> y_1) (_ -> <{min`_2}>)
windowdevice.drawWElementLook_40 info_0 !wMetrics_1 !ableContext_2::B !parentPos_3 !clipRect_4 !itemNr_5::I !wPtr_6::I !_x_7 !tb_8::I = case _x_7 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_0::deviceevents._CompoundScrollActionInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!7}> False (windowhandle.WItemHandle itemH_1_0) tb_8) (False -> case (<{windowhandle.==_8}> w_2_2 windowhandle.IsLayoutControl) (True -> let absolutePos_6_0 = StdIOBasic.movePoint w_2_9 parentPos_3, _x_6_1 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 (windowdevice._f136_136 ableContext_2 w_2_4) absolutePos_6_0 (commondef.intersectRects clipRect_4 (commondef.posSizeToRect absolutePos_6_0 w_2_10)) itemNr_5 wPtr_6 w_2_7 tb_8 in <{_Tuple3!7}> (select _x_6_1::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_6_1::_Tuple3 1])) (select _x_6_1::_Tuple3 2)) (False -> let absolutePos_6_0 = StdIOBasic.movePoint w_2_9 parentPos_3, item_6_1 = windowaccess.getWItemCompoundInfo w_2_5, _x_6_2 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 (windowdevice._f137_137 ableContext_2 w_2_4) absolutePos_6_0 (commondef.intersectRects clipRect_4 (oswindow.osGetCompoundContentRect wMetrics_1 (oswindow.osScrollbarsAreVisible wMetrics_1 (select item_6_1::windowhandle._CompoundInfo 0) (commondef.toTuple_72 w_2_10) (_Tuple2 (Data.Maybe.isJust (select item_6_1::windowhandle._CompoundInfo 2)) (Data.Maybe.isJust (select item_6_1::windowhandle._CompoundInfo 3)))) (commondef.posSizeToRect absolutePos_6_0 w_2_10))) itemNr_5 wPtr_6 w_2_7 tb_8 in <{_Tuple3!7}> (select _x_6_2::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_6_2::_Tuple3 1])) (select _x_6_2::_Tuple3 2)) ) ) (False -> case (StdBool.not (<{windowhandle.==_8}> w_2_2 windowhandle.IsCompoundControl)) (True -> windowdevice.windowdeviceFatalError "drawWElementLook (windowStateCompoundScrollActionIO)" "argument control is not a CompoundControl") (False -> let item_5_0 = windowaccess.getWItemCompoundInfo w_2_5, _x_5_1 = controldraw.drawCompoundLook wMetrics_1 (windowdevice._f138_138 ableContext_2 w_2_4) wPtr_6 parentPos_3 (commondef.intersectRects clipRect_4 (oswindow.osGetCompoundContentRect wMetrics_1 (oswindow.osScrollbarsAreVisible wMetrics_1 (select item_5_0::windowhandle._CompoundInfo 0) (commondef.toTuple_72 w_2_10) (_Tuple2 (Data.Maybe.isJust (select item_5_0::windowhandle._CompoundInfo 2)) (Data.Maybe.isJust (select item_5_0::windowhandle._CompoundInfo 3)))) (commondef.posSizeToRect (StdIOBasic.movePoint w_2_9 parentPos_3) w_2_10))) itemH_1_0 tb_8 in <{_Tuple3!7}> True (windowhandle.WItemHandle (select _x_5_1::_Tuple2 0)) (select _x_5_1::_Tuple2 1)) ) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 ableContext_2 parentPos_3 clipRect_4 itemNr_5 wPtr_6 itemHs_1_0 tb_8 in <{_Tuple3!7}> (select _x_2_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple3 1)) (select _x_2_0::_Tuple3 2)) (windowhandle.WExtendLSHandle wExH_1_0 -> case wExH_1_0 (windowhandle._WExtendLSHandle wExtendLS_2_0 itemHs_2_1 -> let _x_3_0 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 ableContext_2 parentPos_3 clipRect_4 itemNr_5 wPtr_6 itemHs_2_1 tb_8 in <{_Tuple3!7}> (select _x_3_0::_Tuple3 0) (windowhandle.WExtendLSHandle (update wExH_1_0::windowhandle._WExtendLSHandle [1:select _x_3_0::_Tuple3 1])) (select _x_3_0::_Tuple3 2)) ) (windowhandle.WChangeLSHandle wChH_1_0 -> case wChH_1_0 (windowhandle._WChangeLSHandle wChangeLS_2_0 itemHs_2_1 -> let _x_3_0 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 ableContext_2 parentPos_3 clipRect_4 itemNr_5 wPtr_6 itemHs_2_1 tb_8 in <{_Tuple3!7}> (select _x_3_0::_Tuple3 0) (windowhandle.WChangeLSHandle (update wChH_1_0::windowhandle._WChangeLSHandle [1:select _x_3_0::_Tuple3 1])) (select _x_3_0::_Tuple3 2)) ) 
<{windowdevice.drawcompoundlook`_41}> info_0 !wMetrics_1 !ableContext_2::B !parentPos_3 !clipRect_4 !itemNr_5::I !wPtr_6::I !_x_7 !tb_8::I = case _x_7 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.drawWElementLook_40 info_0 wMetrics_1 ableContext_2 parentPos_3 clipRect_4 itemNr_5 wPtr_6 itemH_1_0 tb_8, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!7}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 ableContext_2 parentPos_3 clipRect_4 itemNr_5 wPtr_6 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!7}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_predefined._Nil -> <{_Tuple3!7}> False _predefined._Nil tb_8) 
windowdevice._f138_138::B !ableContext_0::B w_1::B = case ableContext_0 (True -> w_1) (_ -> False)
windowdevice._f137_137::B !ableContext_0::B w_1::B = case ableContext_0 (True -> w_1) (_ -> False)
windowdevice._f136_136::B !ableContext_0::B w_1::B = case ableContext_0 (True -> w_1) (_ -> False)
windowdevice.drawcompoundlook_44 info_0 !wMetrics_1 !ableContext_2::B !clipRect_3 !itemNr_4::I !wPtr_5::I !wH_6 !tb_7::I = case wH_6 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = <{windowdevice.drawcompoundlook`_41}> info_0 wMetrics_1 ableContext_2 StdIOBasic.zero_21 clipRect_3 itemNr_4 wPtr_5 wh_1_6 tb_7 in <{_Tuple2!3}> (update wH_6::windowhandle._WindowHandle [6:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
windowdevice.windowStateCompoundScrollActionIO !wMetrics_0 !info_1 !wsH_2 !tb_3::I = case info_1 (deviceevents._CompoundScrollActionInfo csaW_1_0 csa_1_1 csa_1_2 csaSliderMove_1_3 csaDirection_1_4 -> case csaW_1_0 (windowhandle._WIDS w_2_0 wPtr_2_1 wActive_2_2 -> case wsH_2 (windowhandle._WindowStateHandle wsh_3_0 wshHandle_3_1 -> case wshHandle_3_1 (Data.Maybe.Just wlsH_4_0 -> case wlsH_4_0 (windowhandle._WindowLSHandle wlsState_5_0 wH_5_1 -> case wH_5_1 (windowhandle._WindowHandle whMode_6_0 whKind_6_1 whTitle_6_2 wh_6_3 whKeyFocus_6_4 whWindow_6_5 wh_6_6 whShow_6_7 whSelect_6_8 whAtts_6_9 whDefault_6_10 whCancel_6_11 whSize_6_12 whClosing_6_13 -> let _x_7_0 = <{wstate.getWElementHandles`}> wPtr_2_1 wh_6_6 tb_3, wh_7_1::I = select _x_7_0::_Tuple3 1, tb_7_2 = select _x_7_0::_Tuple3 2, _x_7_3 = windowdevice.calcNewCompoundOrigin_45 wPtr_2_1 wMetrics_0 info_1 StdIOBasic.zero_21 wh_7_1 tb_7_2 in case (StdBool.not (select _x_7_3::_Tuple4 0)) (True -> windowdevice.windowdeviceFatalError "windowStateCompoundScrollActionIO" "could not locate CompoundControl") (False -> case (StdBool.not (select _x_7_3::_Tuple4 1)) (True -> <{_Tuple2!3}> (update wsH_2::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_4_0::windowhandle._WindowLSHandle [1:update wH_5_1::windowhandle._WindowHandle [6:select _x_7_3::_Tuple4 2]])]) (select _x_7_3::_Tuple4 3)) (False -> let _x_10_0 = <{windowdevice._if;675;35_139}> (<{windowhandle.==_6}> whKind_6_1 windowhandle.IsWindow) whWindow_6_5 whSize_6_12, domainRect_10_1 = select _x_10_0::_Tuple4 1, wFrame_10_2 = oswindow.osGetWindowContentRect wMetrics_0 (oswindow.osScrollbarsAreVisible wMetrics_0 domainRect_10_1 (commondef.toTuple_72 whSize_6_12) (_Tuple2 (select _x_10_0::_Tuple4 2) (select _x_10_0::_Tuple4 3))) (commondef.sizeToRect whSize_6_12), _x_10_3 = oswindow.osMinWindowSize, _x_10_4 = controllayout.layoutControls wMetrics_0 (windowaccess.getWindowHMargins whKind_6_1 wMetrics_0 whAtts_6_9) (windowaccess.getWindowVMargins whKind_6_1 wMetrics_0 whAtts_6_9) (windowaccess.getWindowItemSpaces whKind_6_1 wMetrics_0 whAtts_6_9) (commondef.rectSize wFrame_10_2) (StdIOBasic._Size (select _x_10_3::_Tuple2 0) (select _x_10_3::_Tuple2 1)) (_predefined._Cons (_Tuple2 (commondef.rectToRectangle domainRect_10_1) (select _x_10_0::_Tuple4 0)) _predefined._Nil) (select _x_7_3::_Tuple4 2) (select _x_7_3::_Tuple4 3), _x_10_5 = windowclipstate.forceValidWindowClipState wMetrics_0 True wPtr_2_1 (update wH_5_1::windowhandle._WindowHandle [6:select _x_10_4::_Tuple3 1]) (select _x_10_4::_Tuple3 2), wH_10_6 = select _x_10_5::_Tuple2 0, _x_10_7 = controlrelayout.relayoutControls wMetrics_0 wPtr_2_1 whDefault_6_10 False whSelect_6_8 whShow_6_7 (_Tuple4 wFrame_10_2 StdIOBasic.zero_21 StdIOBasic.zero_11 (select _x_7_0::_Tuple3 0)) (_Tuple4 wFrame_10_2 StdIOBasic.zero_21 StdIOBasic.zero_11 (select wH_10_6::windowhandle._WindowHandle 6)) (select _x_10_5::_Tuple2 1), _x_10_8 = windowupdate.updatewindowbackgrounds wMetrics_0 (select _x_10_7::_Tuple3 0) (select info_1::deviceevents._CompoundScrollActionInfo 0) (update wH_10_6::windowhandle._WindowHandle [6:select _x_10_7::_Tuple3 1]) (select _x_10_7::_Tuple3 2), _x_10_9 = windowdevice.drawcompoundlook_44 info_1 wMetrics_0 whSelect_6_8 wFrame_10_2 (select info_1::deviceevents._CompoundScrollActionInfo 1) wPtr_2_1 (select _x_10_8::_Tuple2 0) (select _x_10_8::_Tuple2 1) in <{_Tuple2!3}> (update wsH_2::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_4_0::windowhandle._WindowLSHandle [1:select _x_10_9::_Tuple2 0])]) (select _x_10_9::_Tuple2 1)) ) ) ) ) ) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateCompoundScrollActionIO" "unexpected window placeholder")
<{windowdevice._if;675;35_139}> !_x_0::B whWindow_1 whSize_2 = case _x_0 (True -> let window_2_0 = windowaccess.getWindowInfoWindowData whWindow_1 in _Tuple4 (select window_2_0::windowhandle._WindowData 1) (select window_2_0::windowhandle._WindowData 0) (Data.Maybe.isJust (select window_2_0::windowhandle._WindowData 2)) (Data.Maybe.isJust (select window_2_0::windowhandle._WindowData 3))) (_ -> _Tuple4 StdIOBasic.zero_21 (commondef.sizeToRect whSize_2) False False)
windowdevice.itemControlKeyFocusActionIO_46 !activated_0::B !itemH_1 ls_pst_2 = case itemH_1 (windowhandle._WItemHandle w_1_0 w_1_1 w_1_2 w_1_3 w_1_4 w_1_5 w_1_6 w_1_7 w_1_8 w_1_9 w_1_10 w_1_11 w_1_12 -> let _x_2_0 = <{windowdevice._if;869;39_140}> activated_0, reqAtt_2_1 = select _x_2_0::_Tuple2 0, _x_2_2 = commondef.cselect reqAtt_2_1 StdMisc.undef w_1_6 in case (select _x_2_2::_Tuple2 0) (True -> <{_Tuple2!1}> itemH_1 (select _x_2_0::_Tuple2 1 (select _x_2_2::_Tuple2 1) ls_pst_2)) (False -> <{_Tuple2!1}> itemH_1 ls_pst_2) ) 
<{windowdevice._if;869;39_140}> !activated_0::B = case activated_0 (True -> _Tuple2 StdControlAttribute.isControlActivate StdControlAttribute.getControlActivateFun) (_ -> _Tuple2 StdControlAttribute.isControlDeactivate StdControlAttribute.getControlDeactivateFun)
windowdevice.elementControlKeyFocusActionIO_47 !activated_0::B !info_1 !_x_2 ls_ps_3 = case _x_2 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_1::deviceevents._ControlKeyFocusInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!3}> False (windowhandle.WItemHandle itemH_1_0) ls_ps_3) (False -> let _x_5_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 w_2_7 ls_ps_3 in <{_Tuple3!3}> (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple3 1])) (select _x_5_0::_Tuple3 2)) ) (False -> let _x_4_0 = windowdevice.itemControlKeyFocusActionIO_46 activated_0 itemH_1_0 ls_ps_3 in <{_Tuple3!3}> True (windowhandle.WItemHandle (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 itemHs_1_0 ls_ps_3 in <{_Tuple3!3}> (select _x_2_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple3 1)) (select _x_2_0::_Tuple3 2)) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_3 (_Tuple2 ls_3_0 ps_3_1 -> let _x_4_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) ps_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_3 (_Tuple2 ls_3_0 ps_3_1 -> let _x_4_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 itemHs_2_1 (_Tuple2 chLS_2_0 ps_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlKeyFocusActionIO_48 !activated_0::B !info_1 !_x_2 ls_ps_3 = case _x_2 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlKeyFocusActionIO_47 activated_0 info_1 itemH_1_0 ls_ps_3, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!3}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_ -> <{_Tuple3!3}> False _predefined._Nil ls_ps_3)
windowdevice.windowControlKeyFocusActionIO_49 !activated_0::B !info_1 !wH_2 ls_ps_3 = case wH_2 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> case activated_0 (True -> let _x_3_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 wh_1_6 ls_ps_3 in <{_Tuple2!1}> (update wH_2::windowhandle._WindowHandle [4:keyfocus.setNewFocusItem (select info_1::deviceevents._ControlKeyFocusInfo 1) whKeyFocus_1_4,6:select _x_3_0::_Tuple3 1]) (select _x_3_0::_Tuple3 2)) (False -> let _x_3_0 = windowdevice.elementsControlKeyFocusActionIO_48 activated_0 info_1 wh_1_6 ls_ps_3 in <{_Tuple2!1}> (update wH_2::windowhandle._WindowHandle [4:keyfocus.setNoFocusItem whKeyFocus_1_4,6:select _x_3_0::_Tuple3 1]) (select _x_3_0::_Tuple3 2)) ) 
windowdevice.windowStateControlKeyFocusActionIO !activated_0::B !info_1 !wsH_2 !pState_3 = case wsH_2 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowControlKeyFocusActionIO_49 activated_0 info_1 wH_3_1 (_Tuple2 ls_3_0 pState_3), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_2::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateControlKeyFocusActionIO" "unexpected window placeholder")
windowdevice.itemControlKeyboardActionIO_50 !_x_0 !itemH_1 ls_ps_2 = case _x_0 (deviceevents._ControlKeyboardActionInfo ckW_1_0 ck_1_1 ck_1_2 ckKeyboardState_1_3 -> case itemH_1 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> <{_Tuple2!1}> itemH_1 (select (StdControlAttribute.getControlKeyboardAtt (select (commondef.cselect StdControlAttribute.isControlKeyboard StdMisc.undef w_2_6)::_Tuple2 1))::_Tuple3 2 ckKeyboardState_1_3 ls_ps_2)) ) 
windowdevice.elementControlKeyboardActionIO_51 !info_0 !_x_1 ls_ps_2 = case _x_1 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_0::deviceevents._ControlKeyboardActionInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!3}> False (windowhandle.WItemHandle itemH_1_0) ls_ps_2) (False -> let _x_5_0 = windowdevice.elementsControlKeyboardActionIO_52 info_0 w_2_7 ls_ps_2 in <{_Tuple3!3}> (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple3 1])) (select _x_5_0::_Tuple3 2)) ) (False -> let _x_4_0 = windowdevice.itemControlKeyboardActionIO_50 info_0 itemH_1_0 ls_ps_2 in <{_Tuple3!3}> True (windowhandle.WItemHandle (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsControlKeyboardActionIO_52 info_0 itemHs_1_0 ls_ps_2 in <{_Tuple3!3}> (select _x_2_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple3 1)) (select _x_2_0::_Tuple3 2)) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 ps_3_1 -> let _x_4_0 = windowdevice.elementsControlKeyboardActionIO_52 info_0 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) ps_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 ps_3_1 -> let _x_4_0 = windowdevice.elementsControlKeyboardActionIO_52 info_0 itemHs_2_1 (_Tuple2 chLS_2_0 ps_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlKeyboardActionIO_52 !info_0 !_x_1 ls_ps_2 = case _x_1 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlKeyboardActionIO_51 info_0 itemH_1_0 ls_ps_2, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!3}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = windowdevice.elementsControlKeyboardActionIO_52 info_0 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_ -> <{_Tuple3!3}> False _predefined._Nil ls_ps_2)
windowdevice.windowControlKeyboardActionIO_53 !info_0 !wH_1 ls_ps_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = windowdevice.elementsControlKeyboardActionIO_52 info_0 wh_1_6 ls_ps_2 in <{_Tuple2!1}> (update wH_1::windowhandle._WindowHandle [6:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
windowdevice.windowStateControlKeyboardActionIO !info_0 !wsH_1 !pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowControlKeyboardActionIO_53 info_0 wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateControlKeyboardActionIO" "unexpected window placeholder")
windowdevice.itemControlMouseActionIO_54 !_x_0 !itemH_1 ls_ps_2 = case _x_0 (deviceevents._ControlMouseActionInfo cmW_1_0 cm_1_1 cm_1_2 cmMouseState_1_3 -> case itemH_1 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> <{_Tuple2!1}> itemH_1 (select (StdControlAttribute.getControlMouseAtt (select (commondef.cselect StdControlAttribute.isControlMouse StdMisc.undef w_2_6)::_Tuple2 1))::_Tuple3 2 cmMouseState_1_3 ls_ps_2)) ) 
windowdevice.elementControlMouseActionIO_55 !info_0 !_x_1 ls_ps_2 = case _x_1 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_0::deviceevents._ControlMouseActionInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!3}> False (windowhandle.WItemHandle itemH_1_0) ls_ps_2) (False -> let _x_5_0 = windowdevice.elementsControlMouseActionIO_56 info_0 w_2_7 ls_ps_2 in <{_Tuple3!3}> (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple3 1])) (select _x_5_0::_Tuple3 2)) ) (False -> let _x_4_0 = windowdevice.itemControlMouseActionIO_54 info_0 itemH_1_0 ls_ps_2 in <{_Tuple3!3}> True (windowhandle.WItemHandle (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsControlMouseActionIO_56 info_0 itemHs_1_0 ls_ps_2 in <{_Tuple3!3}> (select _x_2_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple3 1)) (select _x_2_0::_Tuple3 2)) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 ps_3_1 -> let _x_4_0 = windowdevice.elementsControlMouseActionIO_56 info_0 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) ps_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 ps_3_1 -> let _x_4_0 = windowdevice.elementsControlMouseActionIO_56 info_0 itemHs_2_1 (_Tuple2 chLS_2_0 ps_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlMouseActionIO_56 !info_0 !_x_1 ls_ps_2 = case _x_1 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlMouseActionIO_55 info_0 itemH_1_0 ls_ps_2, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!3}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = windowdevice.elementsControlMouseActionIO_56 info_0 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_ -> <{_Tuple3!3}> False _predefined._Nil ls_ps_2)
windowdevice.windowControlMouseActionIO_57 !info_0 !wH_1 ls_ps_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = windowdevice.elementsControlMouseActionIO_56 info_0 wh_1_6 ls_ps_2 in <{_Tuple2!1}> (update wH_1::windowhandle._WindowHandle [6:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
windowdevice.windowStateControlMouseActionIO !info_0 !wsH_1 pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowControlMouseActionIO_57 info_0 wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateControlMouseActionIO" "unexpected window placeholder")
windowdevice.anon_58::B !itemPtr_0::I !_x_1 = case _x_1 (windowhandle._RadioItemInfo radio_1_0 radio_1_1 radio_1_2 radio_1_3 -> <{StdInt.==_16}> radio_1_3 itemPtr_0) 
windowdevice.isCheckItem_59 !itemPtr_0::I !check_1 = case check_1 (windowhandle._CheckItemInfo check_1_0 check_1_1 check_1_2 check_1_3 -> case check_1_0 (_Tuple4 title_2_0 width_2_1 mark_2_2 f_2_3 -> case (<{StdInt.==_16}> itemPtr_0 check_1_3) (True -> <{_Tuple2!3}> (_Tuple2 True f_2_3) (update check_1::windowhandle._CheckItemInfo [0:_Tuple4 title_2_0 width_2_1 (<{StdIOCommon.~_16}> mark_2_2) f_2_3])) (False -> <{_Tuple2!3}> (_Tuple2 False StdFunc.id) check_1) ) ) 
windowdevice.anon_60::B !att_0 = case (StdControlAttribute.isControlFunction att_0) (True -> True) (False -> StdControlAttribute.isControlModsFunction att_0) 
windowdevice.itemControlSelectionIO_61 !info_0 !itemH_1 !_x_2 = case itemH_1 (windowhandle._WItemHandle w_1_0 w_1_1 w_1_2 w_1_3 w_1_4 w_1_5 w_1_6 w_1_7 w_1_8 w_1_9 w_1_10 w_1_11 w_1_12 -> case w_1_2 (windowhandle.IsRadioControl -> case _x_2 (_Tuple2 ls_3_0 pst_3_1 -> let radio_4_0 = windowaccess.getWItemRadioInfo w_1_5, _x_4_1 = commondef.selectedAtIndex (windowdevice.anon_58 (select info_0::deviceevents._ControlSelectInfo 2)) (windowdevice.windowdeviceFatalError "windowIO _ (ControlSelection _) _" "RadioControlItem could not be found") (select radio_4_0::windowhandle._RadioInfo 0) in <{_Tuple2!1}> (update itemH_1::windowhandle._WItemHandle [5:windowhandle.RadioInfo (update radio_4_0::windowhandle._RadioInfo [2:select _x_4_1::_Tuple2 0])]) (select (select (select _x_4_1::_Tuple2 1)::windowhandle._RadioItemInfo 0)::_Tuple3 2 (_Tuple2 ls_3_0 pst_3_1))) ) (windowhandle.IsCheckControl -> case _x_2 (_Tuple2 ls_3_0 pst_3_1 -> let check_4_0 = windowaccess.getWItemCheckInfo w_1_5, _x_4_1 = commondef.access (windowdevice.isCheckItem_59 (select info_0::deviceevents._ControlSelectInfo 2)) (windowdevice.windowdeviceFatalError "windowIO _ (ControlSelection _) _" "CheckControlItem could not be found") (select check_4_0::windowhandle._CheckInfo 0) in <{_Tuple2!1}> (update itemH_1::windowhandle._WItemHandle [5:windowhandle.CheckInfo (update check_4_0::windowhandle._CheckInfo [0:select _x_4_1::_Tuple3 2])]) (select _x_4_1::_Tuple3 1 (_Tuple2 ls_3_0 pst_3_1))) ) (windowhandle.IsPopUpControl -> case _x_2 (_Tuple2 ls_3_0 pst_3_1 -> let popUp_4_0::I = windowaccess.getWItemPopUpInfo w_1_5, index_4_1 = select info_0::deviceevents._ControlSelectInfo 3 in <{_Tuple2!1}> (update itemH_1::windowhandle._WItemHandle [5:windowhandle.PopUpInfo (update popUp_4_0::windowhandle._PopUpInfo [1:index_4_1])]) (<{windowdevice._if;1093;39_141}> (<{StdInt.<_17}> index_4_1 0) popUp_4_0 index_4_1 (_Tuple2 ls_3_0 pst_3_1))) ) (_ -> case _x_2 (_Tuple2 ls_2_0 pst_2_1 -> case (case (<{windowhandle.==_8}> w_1_2 windowhandle.IsButtonControl) (True -> True) (False -> <{windowhandle.==_8}> w_1_2 windowhandle.IsCustomButtonControl) ) (True -> let _x_4_0 = commondef.cselect windowdevice.anon_60 StdMisc.undef w_1_6 in case (select _x_4_0::_Tuple2 0) (True -> <{_Tuple2!1}> itemH_1 (<{windowdevice._c;1106;39_142}> (select _x_4_0::_Tuple2 1) info_0 (_Tuple2 ls_2_0 pst_2_1))) (False -> <{_Tuple2!1}> itemH_1 (_Tuple2 ls_2_0 pst_2_1)) ) (False -> <{_Tuple2!1}> itemH_1 (_Tuple2 ls_2_0 pst_2_1)) ) )) 
<{windowdevice._c;1106;39_142}> !_x_0 info_1 = case _x_0 (StdControlDef.ControlFunction f_1_0 -> f_1_0) (StdControlDef.ControlModsFunction f_1_0 -> f_1_0 (select info_1::deviceevents._ControlSelectInfo 4)) (_ -> windowdevice.windowdeviceFatalError "windowStateControlSelectionIO" "argument is not a function attribute")
<{windowdevice._if;1093;39_141}> !_x_0::B popUp_1 index_2::I = case _x_0 (True -> StdFunc.id) (_ -> select (<{StdList.!!}> (select popUp_1::windowhandle._PopUpInfo 0) (<{StdInt.-_7}> index_2 1))::_Tuple2 1)
windowdevice.elementControlSelectionIO_62 !info_0 !_x_1 ls_ps_2 = case _x_1 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_0::deviceevents._ControlSelectInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!3}> False (windowhandle.WItemHandle itemH_1_0) ls_ps_2) (False -> let _x_5_0 = windowdevice.elementsControlSelectionIO_63 info_0 w_2_7 ls_ps_2 in <{_Tuple3!3}> (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple3 1])) (select _x_5_0::_Tuple3 2)) ) (False -> let _x_4_0 = windowdevice.itemControlSelectionIO_61 info_0 itemH_1_0 ls_ps_2 in <{_Tuple3!3}> True (windowhandle.WItemHandle (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> case ls_ps_2 (_Tuple2 ls_2_0 pst_2_1 -> let _x_3_0 = windowdevice.elementsControlSelectionIO_63 info_0 itemHs_1_0 (_Tuple2 ls_2_0 pst_2_1), _x_3_1 = select _x_3_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_3_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_3_0::_Tuple3 1)) (_Tuple2 (select _x_3_1::_Tuple2 0) (select _x_3_1::_Tuple2 1))) ) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlSelectionIO_63 info_0 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlSelectionIO_63 info_0 itemHs_2_1 (_Tuple2 chLS_2_0 pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlSelectionIO_63 !info_0 !_x_1 ls_ps_2 = case _x_1 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlSelectionIO_62 info_0 itemH_1_0 ls_ps_2, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!3}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = windowdevice.elementsControlSelectionIO_63 info_0 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_ -> case ls_ps_2 (_Tuple2 ls_1_0 pst_1_1 -> <{_Tuple3!3}> False _predefined._Nil (_Tuple2 ls_1_0 pst_1_1)) )
windowdevice.windowControlSelectionIO_64 !info_0 !wH_1 ls_ps_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = windowdevice.elementsControlSelectionIO_63 info_0 wh_1_6 ls_ps_2 in <{_Tuple2!1}> (update wH_1::windowhandle._WindowHandle [6:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
windowdevice.windowStateControlSelectionIO !info_0 !wsH_1 pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowControlSelectionIO_64 info_0 wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateControlSelectionIO" "unexpected window placeholder")
windowdevice.itemControlSliderActionIO_65 !info_0 !itemH_1 ls_ps_2 = case itemH_1 (windowhandle._WItemHandle w_1_0 w_1_1 w_1_2 w_1_3 w_1_4 w_1_5 w_1_6 w_1_7 w_1_8 w_1_9 w_1_10 w_1_11 w_1_12 -> case w_1_2 (windowhandle.IsSliderControl -> <{_Tuple2!1}> itemH_1 (select (windowaccess.getWItemSliderInfo w_1_5)::windowhandle._SliderInfo 3 (select info_0::deviceevents._ControlSliderInfo 3) ls_ps_2)) ) (_ -> <{_Tuple2!1}> itemH_1 ls_ps_2)
windowdevice.elementControlSliderActionIO_66 !info_0 !_x_1 ls_ps_2 = case _x_1 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (StdBool.not (<{StdInt.==_16}> (select info_0::deviceevents._ControlSliderInfo 1) w_2_1)) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!3}> False (windowhandle.WItemHandle itemH_1_0) ls_ps_2) (False -> let _x_5_0 = windowdevice.elementsControlSliderActionIO_67 info_0 w_2_7 ls_ps_2 in <{_Tuple3!3}> (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple3 1])) (select _x_5_0::_Tuple3 2)) ) (False -> let _x_4_0 = windowdevice.itemControlSliderActionIO_65 info_0 itemH_1_0 ls_ps_2 in <{_Tuple3!3}> True (windowhandle.WItemHandle (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsControlSliderActionIO_67 info_0 itemHs_1_0 ls_ps_2 in <{_Tuple3!3}> (select _x_2_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple3 1)) (select _x_2_0::_Tuple3 2)) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlSliderActionIO_67 info_0 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsControlSliderActionIO_67 info_0 itemHs_2_1 (_Tuple2 chLS_2_0 pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsControlSliderActionIO_67 !info_0 !_x_1 ls_ps_2 = case _x_1 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementControlSliderActionIO_66 info_0 itemH_1_0 ls_ps_2, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!3}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = windowdevice.elementsControlSliderActionIO_67 info_0 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_ -> <{_Tuple3!3}> False _predefined._Nil ls_ps_2)
windowdevice.windowControlSliderAction_68 !info_0 !wH_1 ls_ps_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = windowdevice.elementsControlSliderActionIO_67 info_0 wh_1_6 ls_ps_2 in <{_Tuple2!1}> (update wH_1::windowhandle._WindowHandle [6:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
windowdevice.windowStateControlSliderActionIO !info_0 !wsH_1 pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowControlSliderAction_68 info_0 wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateControlSliderActionIO" "unexpected window placeholder")
windowdevice.windowActivationIO_69 !wH_0 ls_pst_1 = case wH_0 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = commondef.cselect StdWindowAttribute.isWindowActivate StdMisc.undef whAtts_1_9 in case (select _x_2_0::_Tuple2 0) (True -> <{_Tuple2!1}> wH_0 (StdWindowAttribute.getWindowActivateFun (select _x_2_0::_Tuple2 1) ls_pst_1)) (False -> <{_Tuple2!1}> wH_0 ls_pst_1) ) 
windowdevice.windowStateActivationIO !wsH_0 pState_1 = case wsH_0 (windowhandle._WindowStateHandle wids_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowActivationIO_69 wH_3_1 (_Tuple2 ls_3_0 pState_1), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_0::windowhandle._WindowStateHandle [0:update wids_1_0::windowhandle._WIDS [2:True],1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateActivationIO" "unexpected window placeholder")
windowdevice.windowDeactivationIO_70 !wH_0 ls_pst_1 = case wH_0 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = commondef.cselect StdWindowAttribute.isWindowDeactivate StdMisc.undef whAtts_1_9 in case (select _x_2_0::_Tuple2 0) (True -> <{_Tuple2!1}> wH_0 (StdWindowAttribute.getWindowDeactivateFun (select _x_2_0::_Tuple2 1) ls_pst_1)) (False -> <{_Tuple2!1}> wH_0 ls_pst_1) ) 
windowdevice.windowStateDeactivationIO !wsH_0 pState_1 = case wsH_0 (windowhandle._WindowStateHandle wids_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowDeactivationIO_70 wH_3_1 (_Tuple2 ls_3_0 pState_1), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_0::windowhandle._WindowStateHandle [0:update wids_1_0::windowhandle._WIDS [2:False],1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateDeactivationIO" "unexpected window placeholder")
windowdevice.windowInitialiseIO_71 !wH_0 ls_pst_1 = case wH_0 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = commondef.remove StdWindowAttribute.isWindowInit StdMisc.undef whAtts_1_9 in case (select _x_2_0::_Tuple3 0) (True -> <{_Tuple2!1}> (update wH_0::windowhandle._WindowHandle [9:select _x_2_0::_Tuple3 2]) (StdWindowAttribute.getWindowInitFun (select _x_2_0::_Tuple3 1) ls_pst_1)) (False -> <{_Tuple2!1}> (update wH_0::windowhandle._WindowHandle [9:select _x_2_0::_Tuple3 2]) ls_pst_1) ) 
windowdevice.windowStateInitialiseIO !wsH_0 pState_1 = case wsH_0 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowInitialiseIO_71 wH_3_1 (_Tuple2 ls_3_0 pState_1), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_0::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateInitialiseIO" "unexpected window placeholder")
windowdevice.windowKeyboardActionIO_72 !key_0 !wH_1 ls_ps_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> <{_Tuple2!1}> wH_1 (select (StdWindowAttribute.getWindowKeyboardAtt (select (commondef.cselect StdWindowAttribute.isWindowKeyboard StdMisc.undef whAtts_1_9)::_Tuple2 1))::_Tuple3 2 key_0 ls_ps_2)) 
windowdevice.windowStateWindowKeyboardActionIO !info_0 !wsH_1 pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowKeyboardActionIO_72 (select info_0::deviceevents._WindowKeyboardActionInfo 1) wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateWindowKeyboardActionIO" "unexpected window placeholder")
windowdevice.windowMouseActionIO_73 !mouse_0 !wH_1 ls_pst_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> <{_Tuple2!1}> wH_1 (select (StdWindowAttribute.getWindowMouseAtt (select (commondef.cselect StdWindowAttribute.isWindowMouse StdMisc.undef whAtts_1_9)::_Tuple2 1))::_Tuple3 2 mouse_0 ls_pst_2)) 
windowdevice.windowStateWindowMouseActionIO !info_0 !wsH_1 pState_2 = case wsH_1 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowMouseActionIO_73 (select info_0::deviceevents._WindowMouseActionInfo 1) wH_3_1 (_Tuple2 ls_3_0 pState_2), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_1::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateWindowMouseActionIO" "unexpected window placeholder")
windowdevice.itemButtonActionIO_74 !id_0 !itemH_1 ls_ps_2 = case itemH_1 (windowhandle._WItemHandle w_1_0 w_1_1 w_1_2 w_1_3 w_1_4 w_1_5 w_1_6 w_1_7 w_1_8 w_1_9 w_1_10 w_1_11 w_1_12 -> case (case (StdBool.not (<{windowhandle.==_8}> w_1_2 windowhandle.IsButtonControl)) (True -> StdBool.not (<{windowhandle.==_8}> w_1_2 windowhandle.IsCustomButtonControl)) (False -> False) ) (True -> windowdevice.windowdeviceFatalError "windowButtonActionIO" "Id argument does not refer to (Custom)ButtonControl") (False -> let _x_3_0 = commondef.cselect StdControlAttribute.isControlFunction StdMisc.undef w_1_6 in case (select _x_3_0::_Tuple2 0) (True -> <{_Tuple2!1}> itemH_1 (StdControlAttribute.getControlFun (select _x_3_0::_Tuple2 1) ls_ps_2)) (False -> <{_Tuple2!1}> itemH_1 ls_ps_2) ) ) 
windowdevice.elementButtonActionIO_75 !id_0 !_x_1 ls_ps_2 = case _x_1 (windowhandle.WItemHandle itemH_1_0 -> case itemH_1_0 (windowhandle._WItemHandle w_2_0 w_2_1 w_2_2 w_2_3 w_2_4 w_2_5 w_2_6 w_2_7 w_2_8 w_2_9 w_2_10 w_2_11 w_2_12 -> case (case (Data.Maybe.isNothing w_2_0) (True -> True) (False -> StdBool.not (<{id.==_27}> (Data.Maybe.fromJust w_2_0) id_0)) ) (True -> case (StdBool.not (windowhandle.isRecursiveControl w_2_2)) (True -> <{_Tuple3!3}> False (windowhandle.WItemHandle itemH_1_0) ls_ps_2) (False -> let _x_5_0 = windowdevice.elementsButtonActionIO_76 id_0 w_2_7 ls_ps_2 in <{_Tuple3!3}> (select _x_5_0::_Tuple3 0) (windowhandle.WItemHandle (update itemH_1_0::windowhandle._WItemHandle [7:select _x_5_0::_Tuple3 1])) (select _x_5_0::_Tuple3 2)) ) (False -> let _x_4_0 = windowdevice.itemButtonActionIO_74 id_0 itemH_1_0 ls_ps_2 in <{_Tuple3!3}> True (windowhandle.WItemHandle (select _x_4_0::_Tuple2 0)) (select _x_4_0::_Tuple2 1)) ) ) (windowhandle.WListLSHandle itemHs_1_0 -> let _x_2_0 = windowdevice.elementsButtonActionIO_76 id_0 itemHs_1_0 ls_ps_2 in <{_Tuple3!3}> (select _x_2_0::_Tuple3 0) (windowhandle.WListLSHandle (select _x_2_0::_Tuple3 1)) (select _x_2_0::_Tuple3 2)) (windowhandle.WExtendLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WExtendLSHandle extLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsButtonActionIO_76 id_0 itemHs_2_1 (_Tuple2 (_Tuple2 extLS_2_0 ls_3_0) pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2, _x_4_2 = select _x_4_1::_Tuple2 0 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WExtendLSHandle (windowhandle._WExtendLSHandle (select _x_4_2::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 (select _x_4_2::_Tuple2 1) (select _x_4_1::_Tuple2 1))) ) ) (windowhandle.WChangeLSHandle _x_1_0 -> case _x_1_0 (windowhandle._WChangeLSHandle chLS_2_0 itemHs_2_1 -> case ls_ps_2 (_Tuple2 ls_3_0 pst_3_1 -> let _x_4_0 = windowdevice.elementsButtonActionIO_76 id_0 itemHs_2_1 (_Tuple2 chLS_2_0 pst_3_1), _x_4_1 = select _x_4_0::_Tuple3 2 in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (windowhandle.WChangeLSHandle (windowhandle._WChangeLSHandle (select _x_4_1::_Tuple2 0) (select _x_4_0::_Tuple3 1))) (_Tuple2 ls_3_0 (select _x_4_1::_Tuple2 1))) ) ) 
windowdevice.elementsButtonActionIO_76 !id_0 !_x_1 ls_ps_2 = case _x_1 (_predefined._Cons itemH_1_0 itemHs_1_1 -> let _x_2_0::B = windowdevice.elementButtonActionIO_75 id_0 itemH_1_0 ls_ps_2, done_2_1 = select _x_2_0::_Tuple3 0 in case done_2_1 (True -> <{_Tuple3!3}> done_2_1 (_predefined._Cons (select _x_2_0::_Tuple3 1) itemHs_1_1) (select _x_2_0::_Tuple3 2)) (False -> let _x_4_0 = windowdevice.elementsButtonActionIO_76 id_0 itemHs_1_1 (select _x_2_0::_Tuple3 2) in <{_Tuple3!3}> (select _x_4_0::_Tuple3 0) (_predefined._Cons (select _x_2_0::_Tuple3 1) (select _x_4_0::_Tuple3 1)) (select _x_4_0::_Tuple3 2)) ) (_ -> <{_Tuple3!3}> False _predefined._Nil ls_ps_2)
windowdevice.windowButtonActionIO !button_0 !wH_1 ls_ps_2 = case wH_1 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = windowdevice.elementsButtonActionIO_76 button_0 wh_1_6 ls_ps_2 in <{_Tuple2!1}> (update wH_1::windowhandle._WindowHandle [6:select _x_2_0::_Tuple3 1]) (select _x_2_0::_Tuple3 2)) 
windowdevice.windowStateCANCELIO !wsH_0 pState_1 = case wsH_0 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> case wH_3_1 (windowhandle._WindowHandle whMode_4_0 whKind_4_1 whTitle_4_2 wh_4_3 whKeyFocus_4_4 whWindow_4_5 wh_4_6 whShow_4_7 whSelect_4_8 whAtts_4_9 whDefault_4_10 maybe_4_11 whSize_4_12 whClosing_4_13 -> case (Data.Maybe.isNothing maybe_4_11) (True -> windowdevice.windowdeviceFatalError "windowStateCANCELIO" "no Cancel button administrated") (False -> let _x_6_0 = windowdevice.windowButtonActionIO (Data.Maybe.fromJust maybe_4_11) wH_3_1 (_Tuple2 ls_3_0 pState_1), _x_6_1 = select _x_6_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_0::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_6_1::_Tuple2 0,1:select _x_6_0::_Tuple2 0])]) (select _x_6_1::_Tuple2 1)) ) ) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateCANCELIO" "unexpected window placeholder")
windowdevice.windowStateOKIO !wsH_0 pState_1 = case wsH_0 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> case wH_3_1 (windowhandle._WindowHandle whMode_4_0 whKind_4_1 whTitle_4_2 wh_4_3 whKeyFocus_4_4 whWindow_4_5 wh_4_6 whShow_4_7 whSelect_4_8 whAtts_4_9 maybe_4_10 whCancel_4_11 whSize_4_12 whClosing_4_13 -> case (Data.Maybe.isNothing maybe_4_10) (True -> windowdevice.windowdeviceFatalError "windowStateOKIO" "no Ok button administrated") (False -> let _x_6_0 = windowdevice.windowButtonActionIO (Data.Maybe.fromJust maybe_4_10) wH_3_1 (_Tuple2 ls_3_0 pState_1), _x_6_1 = select _x_6_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_0::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_6_1::_Tuple2 0,1:select _x_6_0::_Tuple2 0])]) (select _x_6_1::_Tuple2 1)) ) ) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateOKIO" "unexpected window placeholder")
windowdevice.windowRequestCloseIO_77 !wH_0 ls_ps_1 = case wH_0 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> let _x_2_0 = commondef.cselect StdWindowAttribute.isWindowClose StdMisc.undef whAtts_1_9 in case (select _x_2_0::_Tuple2 0) (True -> <{_Tuple2!1}> wH_0 (StdWindowAttribute.getWindowCloseFun (select _x_2_0::_Tuple2 1) ls_ps_1)) (False -> <{_Tuple2!1}> wH_0 ls_ps_1) ) 
windowdevice.windowStateRequestCloseIO !wsH_0 pState_1 = case wsH_0 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle ls_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowRequestCloseIO_77 wH_3_1 (_Tuple2 ls_3_0 pState_1), _x_4_1 = select _x_4_0::_Tuple2 1 in <{_Tuple2!1}> (update wsH_0::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [0:select _x_4_1::_Tuple2 0,1:select _x_4_0::_Tuple2 0])]) (select _x_4_1::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateRequestCloseIO" "unexpected window placeholder")
windowdevice.anon_85 r_0 s_1 = _Tuple2 r_0 s_1
windowdevice.anon_78 !wH_0 = case wH_0 (windowhandle._WindowHandle whMode_1_0 whKind_1_1 whTitle_1_2 wh_1_3 whKeyFocus_1_4 whWindow_1_5 wh_1_6 whShow_1_7 whSelect_1_8 whAtts_1_9 whDefault_1_10 whCancel_1_11 whSize_1_12 whClosing_1_13 -> _Tuple2 whWindow_1_5 wH_0) 
windowdevice.scroll_79 !scrollRect_0 !restRect_1 !v_2 !picture_3 = let _x_1_0 = ospicture.pictscroll scrollRect_0 v_2 picture_3 in case (<{commondef.==_65}> (select _x_1_0::_Tuple2 0) commondef.zero_64) (True -> <{_Tuple2!3}> _predefined._Nil (select _x_1_0::_Tuple2 1)) (False -> <{_Tuple2!3}> (_predefined._Cons restRect_1 _predefined._Nil) (select _x_1_0::_Tuple2 1)) 
windowdevice.calcScrollUpdateArea_80 !oldOrigin_0 !newOrigin_1 !areaRect_2 = let v_1_0::I = StdIOBasic.toVector_23 (<{StdIOBasic.-_20}> oldOrigin_0 newOrigin_1), vx_1_1::I = select v_1_0::StdIOBasic._Vector2 0, _x_1_2::I = <{windowdevice._if;1490;43_143}> (<{StdInt.<_17}> vx_1_1 0) newOriginAreaRect_1_3 rright_1_4 vx_1_1 rtop_1_6 rleft_1_7 rbottom_1_5 vy_1_8, newOriginAreaRect_1_3::I = commondef.addVector_67 (StdIOBasic.toVector_23 newOrigin_1) areaRect_2, rright_1_4::I = select newOriginAreaRect_1_3::ostypes._OSRect 2, rbottom_1_5 = select newOriginAreaRect_1_3::ostypes._OSRect 3, rtop_1_6 = select newOriginAreaRect_1_3::ostypes._OSRect 1, rleft_1_7::I = select newOriginAreaRect_1_3::ostypes._OSRect 0, vy_1_8 = select v_1_0::StdIOBasic._Vector2 1 in <{_Tuple2!3}> (select _x_1_2::_Tuple2 0) (windowdevice.scroll_79 (update newOriginAreaRect_1_3::ostypes._OSRect [2:<{StdInt.+_6}> rright_1_4 1,3:<{StdInt.+_6}> rbottom_1_5 1]) (select _x_1_2::_Tuple2 1) v_1_0)
<{windowdevice._if;1490;43_143}> !_x_0::B newOriginAreaRect_1 rright_2::I vx_3::I rtop_4::I rleft_5::I rbottom_6::I vy_7::I = case _x_0 (True -> _Tuple2 (update (commondef.rectToRectangle newOriginAreaRect_1)::StdIOBasic._Rectangle [0:StdIOBasic._Point2 (<{StdInt.+_6}> rright_2 vx_3) rtop_4]) (update newOriginAreaRect_1::ostypes._OSRect [2:<{StdInt.+_6}> rright_2 vx_3])) (_ -> case (<{StdInt.<_17}> 0 vx_3) (True -> _Tuple2 (update (commondef.rectToRectangle newOriginAreaRect_1)::StdIOBasic._Rectangle [1:StdIOBasic._Point2 (<{StdInt.+_6}> rleft_5 vx_3) rbottom_6]) (update newOriginAreaRect_1::ostypes._OSRect [0:<{StdInt.+_6}> rleft_5 vx_3])) (False -> case (<{StdInt.<_17}> vy_7 0) (True -> _Tuple2 (update (commondef.rectToRectangle newOriginAreaRect_1)::StdIOBasic._Rectangle [0:StdIOBasic._Point2 rleft_5 (<{StdInt.+_6}> rbottom_6 vy_7)]) (update newOriginAreaRect_1::ostypes._OSRect [3:<{StdInt.+_6}> rbottom_6 vy_7])) (False -> case (<{StdInt.<_17}> 0 vy_7) (True -> _Tuple2 (update (commondef.rectToRectangle newOriginAreaRect_1)::StdIOBasic._Rectangle [1:StdIOBasic._Point2 rright_2 (<{StdInt.+_6}> rtop_4 vy_7)]) (update newOriginAreaRect_1::ostypes._OSRect [1:<{StdInt.+_6}> rtop_4 vy_7])) (False -> windowdevice.windowdeviceFatalError "calcScrollUpdateArea (scrolling window)" "assumption violation") ) ) )
windowdevice.windowScrollActionIO_81 !wMetrics_0 !info_1 !wH_2 !tb_3::I = case info_1 (deviceevents._WindowScrollActionInfo wsaW_1_0 wsaSliderMove_1_1 wsaDirection_1_2 -> case wsaW_1_0 (windowhandle._WIDS w_2_0 wPtr_2_1 wActive_2_2 -> case wH_2 (windowhandle._WindowHandle whMode_3_0 whKind_3_1 whTitle_3_2 wh_3_3 whKeyFocus_3_4 whWindow_3_5 old_3_6 whShow_3_7 whSelect_3_8 whAtts_3_9 whDefault_3_10 whCancel_3_11 whSize_3_12 whClosing_3_13 -> let isHorizontal_4_0::I = <{StdIOCommon.==_35}> (select info_1::deviceevents._WindowScrollActionInfo 2) StdIOCommon.Horizontal, scroll_4_1::I = Data.Maybe.fromJust (<{windowdevice._if;1465;53_145}> isHorizontal_4_0 window_4_3), scrollFun_4_2 = select scroll_4_1::windowhandle._ScrollInfo 0, window_4_3::I = windowaccess.getWindowInfoWindowData whWindow_3_5, _x_4_4::I = _Tuple5 (select window_4_3::windowhandle._WindowData 1) (select window_4_3::windowhandle._WindowData 0) (Data.Maybe.isJust (select window_4_3::windowhandle._WindowData 2)) (Data.Maybe.isJust (select window_4_3::windowhandle._WindowData 3)) (select window_4_3::windowhandle._WindowData 4), oldOrigin_4_5 = select _x_4_4::_Tuple5 0, domainRect_4_6::I = select _x_4_4::_Tuple5 1, hasHScroll_4_7::I = select _x_4_4::_Tuple5 2, hasVScroll_4_8::I = select _x_4_4::_Tuple5 3, visScrolls_4_9::I = oswindow.osScrollbarsAreVisible wMetrics_0 domainRect_4_6 (commondef.toTuple_72 whSize_3_12) (_Tuple2 hasHScroll_4_7 hasVScroll_4_8), contentRect_4_10 = oswindow.osGetWindowContentRect wMetrics_0 visScrolls_4_9 (commondef.sizeToRect whSize_3_12), contentSize_4_11 = commondef.rectSize contentRect_4_10, oldFrame_4_12 = commondef.posSizeToRectangle oldOrigin_4_5 contentSize_4_11, _x_4_13 = <{windowdevice._if;1459;43_144}> isHorizontal_4_0 domain_4_21 oldOrigin_4_5 <{w`_4_23}> <{h`_4_22}>, <{min`_4_14}> = select _x_4_13::_Tuple4 0, <{max`_4_15}>::B = select _x_4_13::_Tuple4 2, viewSize_4_16::B = select _x_4_13::_Tuple4 3, oldThumb_4_17 = select _x_4_13::_Tuple4 1, sliderState_4_18 = StdIOCommon._SliderState <{min`_4_14}> (<{StdInt.-_7}> <{max`_4_15}> viewSize_4_16) oldThumb_4_17, <{newThumb`_4_19}> = scrollFun_4_2 oldFrame_4_12 sliderState_4_18 (select info_1::deviceevents._WindowScrollActionInfo 1), newThumb_4_20 = commondef.setBetween <{newThumb`_4_19}> <{min`_4_14}> (<{StdInt.-_7}> <{max`_4_15}> viewSize_4_16), domain_4_21 = commondef.rectToRectangle domainRect_4_6, <{h`_4_22}> = select contentSize_4_11::StdIOBasic._Size 1, <{w`_4_23}>::B = select contentSize_4_11::StdIOBasic._Size 0 in case (<{StdInt.==_16}> newThumb_4_20 oldThumb_4_17) (True -> <{_Tuple2!3}> wH_2 tb_3) (False -> let _x_6_0::I = <{windowdevice._if;1436;43_151}> (windowdevice._f150_150 (StdBool.not (select (select _x_4_4::_Tuple5 4)::windowhandle._LookInfo 2)) isHorizontal_4_0 newOrigin_6_1 oldOrigin_4_5 <{w`_4_23}> <{h`_4_22}> _x_6_29) newFrame_6_2 oldOrigin_4_5 newOrigin_6_1 areaRect_6_33, newOrigin_6_1 = <{windowdevice._if;1418;43_149}> isHorizontal_4_0 oldOrigin_4_5 newThumb_4_20, newFrame_6_2 = commondef.posSizeToRectangle newOrigin_6_1 contentSize_4_11, _x_6_3 = oswindow.toOSscrollbarRange (_Tuple3 <{min`_4_14}> newThumb_4_20 <{max`_4_15}>) viewSize_4_16, newOSThumb_6_4 = select _x_6_3::_Tuple4 1, hScroll_6_5 = <{windowdevice._if;1447;43_148}> hasHScroll_4_7 window_4_3, vScroll_6_6 = <{windowdevice._if;1448;43_147}> hasVScroll_4_8 window_4_3, hRect_6_7 = oswindow.osGetWindowHScrollRect wMetrics_0 visScrolls_4_9 (commondef.sizeToRect whSize_3_12), vRect_6_8 = oswindow.osGetWindowVScrollRect wMetrics_0 visScrolls_4_9 (commondef.sizeToRect whSize_3_12), tb_6_9 = oswindow.osSetWindowSliderThumb wMetrics_0 wPtr_2_1 isHorizontal_4_0 newOSThumb_6_4 hScroll_6_5 vScroll_6_6 hRect_6_7 vRect_6_8 (commondef.toTuple_72 whSize_3_12) True tb_3, _x_6_10 = <{wstate.getWElementHandles`}> wPtr_2_1 old_3_6 tb_6_9, hMargins_6_11::I = windowaccess.getWindowHMargins windowhandle.IsWindow wMetrics_0 whAtts_3_9, vMargins_6_12 = windowaccess.getWindowVMargins windowhandle.IsWindow wMetrics_0 whAtts_3_9, spaces_6_13 = windowaccess.getWindowItemSpaces windowhandle.IsWindow wMetrics_0 whAtts_3_9, _x_6_14 = oswindow.osMinWindowSize, defMinW_6_15::I = select _x_6_14::_Tuple2 0, defMinH_6_16 = select _x_6_14::_Tuple2 1, minSize_6_17 = StdIOBasic._Size defMinW_6_15 defMinH_6_16, old_6_18::I = select _x_6_10::_Tuple3 1, tb_6_19::I = select _x_6_10::_Tuple3 2, _x_6_20 = controllayout.layoutControls wMetrics_0 hMargins_6_11 vMargins_6_12 spaces_6_13 contentSize_4_11 minSize_6_17 (_predefined._Cons (_Tuple2 domain_4_21 newOrigin_6_1) _predefined._Nil) old_6_18 tb_6_19, new_6_21 = select _x_6_20::_Tuple3 1, wH_6_22 = update wH_2::windowhandle._WindowHandle [5:windowhandle.WindowInfo (update window_4_3::windowhandle._WindowData [1:newOrigin_6_1]),6:new_6_21], tb_6_23 = select _x_6_20::_Tuple3 2, _x_6_24 = windowclipstate.forceValidWindowClipState wMetrics_0 True wPtr_2_1 wH_6_22 tb_6_23, wH_6_25::I = select _x_6_24::_Tuple2 0, _x_6_26 = windowdevice.anon_78 wH_6_25, wH_6_27 = select _x_6_26::_Tuple2 1, whWindow_6_28 = select _x_6_26::_Tuple2 0, _x_6_29 = <{windowdevice._c;1427;43_146}> whWindow_6_28 tb_6_34, _x_6_30::I = controlrelayout.relayoutControls wMetrics_0 wPtr_2_1 whDefault_3_10 False whSelect_3_8 whShow_3_7 (_Tuple4 contentRect_4_10 StdIOBasic.zero_21 StdIOBasic.zero_11 (select _x_6_10::_Tuple3 0)) (_Tuple4 contentRect_4_10 StdIOBasic.zero_21 StdIOBasic.zero_11 (select wH_6_27::windowhandle._WindowHandle 6)) (select _x_6_29::_Tuple3 2), _x_6_31 = windowupdate.updatewindowbackgrounds wMetrics_0 (select _x_6_30::_Tuple3 0) (select info_1::deviceevents._WindowScrollActionInfo 0) (update wH_6_27::windowhandle._WindowHandle [6:select _x_6_30::_Tuple3 1]) (select _x_6_30::_Tuple3 2), _x_6_32 = <{windowdraw.drawwindowlook`}> wMetrics_0 wPtr_2_1 (select _x_6_0::_Tuple2 1) (StdIOCommon._UpdateState oldFrame_4_12 newFrame_6_2 (_predefined._Cons (select _x_6_0::_Tuple2 0) _predefined._Nil)) (select _x_6_31::_Tuple2 0) (select _x_6_31::_Tuple2 1), areaRect_6_33 = select _x_6_29::_Tuple3 1, tb_6_34 = select _x_6_24::_Tuple2 1 in <{_Tuple2!3}> (select _x_6_32::_Tuple2 0) (oswindow.osValidateWindowRect wPtr_2_1 (commondef.sizeToRect whSize_3_12) (select _x_6_32::_Tuple2 1))) ) ) ) 
<{windowdevice._if;1436;43_151}> !_x_0::B newFrame_1 oldOrigin_2 newOrigin_3 areaRect_4 = case _x_0 (True -> _Tuple2 newFrame_1 (windowdevice.anon_85 _predefined._Nil)) (_ -> windowdevice.calcScrollUpdateArea_80 oldOrigin_2 newOrigin_3 areaRect_4)
windowdevice._f150_150::B !_x_0::B isHorizontal_1::B newOrigin_2 oldOrigin_3 <{w`_4}>::I <{h`_5}>::I _x_6 = case _x_0 (True -> True) (_ -> case (case isHorizontal_1 (True -> StdBool.not (<{StdInt.<_17}> (StdInt.abs_13 (<{StdInt.-_7}> (select newOrigin_2::StdIOBasic._Point2 0) (select oldOrigin_3::StdIOBasic._Point2 0))) <{w`_4}>)) (False -> StdBool.not (<{StdInt.<_17}> (StdInt.abs_13 (<{StdInt.-_7}> (select newOrigin_2::StdIOBasic._Point2 1) (select oldOrigin_3::StdIOBasic._Point2 1))) <{h`_5}>)) ) (True -> True) (False -> StdBool.not (select _x_6::_Tuple3 0)) )
<{windowdevice._if;1418;43_149}> !isHorizontal_0::B !oldOrigin_1 !newThumb_2::I = case isHorizontal_0 (True -> update oldOrigin_1::StdIOBasic._Point2 [0:newThumb_2]) (_ -> update oldOrigin_1::StdIOBasic._Point2 [1:newThumb_2])
<{windowdevice._if;1447;43_148}> !hasHScroll_0::B window_1 = case hasHScroll_0 (True -> Data.Maybe.Just (select (Data.Maybe.fromJust (select window_1::windowhandle._WindowData 2))::windowhandle._ScrollInfo 3)) (_ -> Data.Maybe.Nothing)
<{windowdevice._if;1448;43_147}> !hasVScroll_0::B window_1 = case hasVScroll_0 (True -> Data.Maybe.Just (select (Data.Maybe.fromJust (select window_1::windowhandle._WindowData 3))::windowhandle._ScrollInfo 3)) (_ -> Data.Maybe.Nothing)
<{windowdevice._c;1427;43_146}> !whWindow_0 tb_1::I = case whWindow_0 (windowhandle.WindowInfo _x_1_0 -> case _x_1_0 (windowhandle._WindowData windowDomain_2_0 windowOrigin_2_1 windowHScroll_2_2 windowVScroll_2_3 windowLook_2_4 _x_2_5 -> case _x_2_5 (windowhandle._ClipState clipRgn_3_0 clipOk_3_1 -> osrgn.osgetrgnbox clipRgn_3_0 tb_1) ) ) (_ -> windowdevice.windowdeviceFatalError "windowScrollActionIO" "unexpected whWindowInfo field")
<{windowdevice._if;1465;53_145}> !isHorizontal_0::B !window_1 = case isHorizontal_0 (True -> select window_1::windowhandle._WindowData 2) (_ -> select window_1::windowhandle._WindowData 3)
<{windowdevice._if;1459;43_144}> !isHorizontal_0::B domain_1 oldOrigin_2 <{w`_3}>::I <{h`_4}>::I = case isHorizontal_0 (True -> _Tuple4 (select (select domain_1::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 0) (select oldOrigin_2::StdIOBasic._Point2 0) (select (select domain_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 0) <{w`_3}>) (_ -> _Tuple4 (select (select domain_1::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 1) (select oldOrigin_2::StdIOBasic._Point2 1) (select (select domain_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 1) <{h`_4}>)
windowdevice.windowStateScrollActionIO !wMetrics_0 !info_1 !wsH_2 !tb_3::I = case wsH_2 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle wlsState_3_0 wH_3_1 -> let _x_4_0 = windowdevice.windowScrollActionIO_81 wMetrics_0 info_1 wH_3_1 tb_3 in <{_Tuple2!3}> (update wsH_2::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [1:select _x_4_0::_Tuple2 0])]) (select _x_4_0::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowStateScrollActionIO" "unexpected window placeholder")
windowdevice.newScroll_82 !_x_0 _x_1 = case _x_0 (Data.Maybe.Nothing -> Data.Maybe.Nothing) (Data.Maybe.Just scroll_inf_1_0 -> case scroll_inf_1_0 (windowhandle._ScrollInfo scrollFunction_2_0 scroll_2_1 scroll_2_2 scroll_2_3 -> case _x_1 (ostypes._OSRect rleft_3_0 rtop_3_1 rright_3_2 rbottom_3_3 -> Data.Maybe.Just (update scroll_inf_1_0::windowhandle._ScrollInfo [1:StdIOBasic._Point2 rleft_3_0 rtop_3_1,2:StdIOBasic._Size (<{StdInt.-_7}> rright_3_2 rleft_3_0) (<{StdInt.-_7}> rbottom_3_3 rtop_3_1)])) ) ) 
windowdevice.setwindowslider_84::I whSelect_0::B hScroll_1 vScroll_2 !hasScroll_3::B !wMetrics_4 !wPtr_5::I !isHorizontal_6::B !thumbChanged_7::B !_x_8 !hRect_9 !vRect_10 !maxcoords_11 !tb_12::I = case _x_8 (_Tuple4 osMin_1_0 osThumb_1_1 osMax_1_2 osSize_1_3 -> case (StdBool.not hasScroll_3) (True -> tb_12) (False -> case thumbChanged_7 (True -> let sPtr_4_0::I = <{windowdevice._c;1580;16_152}> isHorizontal_6 hScroll_1 vScroll_2 in oswindow.osSetWindowSliderThumbSize wMetrics_4 wPtr_5 sPtr_4_0 isHorizontal_6 osMin_1_0 osMax_1_2 osSize_1_3 maxcoords_11 (<{windowdevice._if;1575;116_153}> isHorizontal_6 hRect_9 vRect_10) whSelect_0 thumbChanged_7 (oswindow.osSetWindowSliderPosSize wPtr_5 sPtr_4_0 (<{windowdevice._if;1574;63_154}> isHorizontal_6 hRect_9 vRect_10) tb_12)) (False -> let sPtr_4_0::I = <{windowdevice._c;1580;16_155}> isHorizontal_6 hScroll_1 vScroll_2 in oswindow.osSetWindowSliderThumb wMetrics_4 wPtr_5 isHorizontal_6 osThumb_1_1 hScroll_1 vScroll_2 hRect_9 vRect_10 maxcoords_11 True (oswindow.osSetWindowSliderThumbSize wMetrics_4 wPtr_5 sPtr_4_0 isHorizontal_6 osMin_1_0 osMax_1_2 osSize_1_3 maxcoords_11 (<{windowdevice._if;1575;116_156}> isHorizontal_6 hRect_9 vRect_10) whSelect_0 thumbChanged_7 (oswindow.osSetWindowSliderPosSize wPtr_5 sPtr_4_0 (<{windowdevice._if;1574;63_157}> isHorizontal_6 hRect_9 vRect_10) tb_12))) ) ) 
<{windowdevice._if;1574;63_157}> !isHorizontal_0::B hRect_1 vRect_2 = case isHorizontal_0 (True -> hRect_1) (_ -> vRect_2)
<{windowdevice._if;1575;116_156}> !isHorizontal_0::B hRect_1 vRect_2 = case isHorizontal_0 (True -> hRect_1) (_ -> vRect_2)
<{windowdevice._c;1580;16_155}>::I !isHorizontal_0::B hScroll_1 vScroll_2 = case isHorizontal_0 (True -> Data.Maybe.fromJust hScroll_1) (_ -> Data.Maybe.fromJust vScroll_2)
<{windowdevice._if;1574;63_154}> !isHorizontal_0::B hRect_1 vRect_2 = case isHorizontal_0 (True -> hRect_1) (_ -> vRect_2)
<{windowdevice._if;1575;116_153}> !isHorizontal_0::B hRect_1 vRect_2 = case isHorizontal_0 (True -> hRect_1) (_ -> vRect_2)
<{windowdevice._c;1580;16_152}>::I !isHorizontal_0::B hScroll_1 vScroll_2 = case isHorizontal_0 (True -> Data.Maybe.fromJust hScroll_1) (_ -> Data.Maybe.fromJust vScroll_2)
windowdevice.windowStateSizeAction !wMetrics_0 !isActive_1::B !info_2 !wsH_3 !tb_4::I = case info_2 (deviceevents._WindowSizeActionInfo wsW_1_0 wsSize_1_1 wsUpdateAll_1_2 -> case wsW_1_0 (windowhandle._WIDS w_2_0 wPtr_2_1 wActive_2_2 -> case wsH_3 (windowhandle._WindowStateHandle wsh_3_0 wshHandle_3_1 -> case wshHandle_3_1 (Data.Maybe.Just wlsH_4_0 -> case wlsH_4_0 (windowhandle._WindowLSHandle wlsState_5_0 wH_5_1 -> case wH_5_1 (windowhandle._WindowHandle whMode_6_0 whKind_6_1 whTitle_6_2 wh_6_3 whKeyFocus_6_4 whWindow_6_5 wh_6_6 whShow_6_7 whSelect_6_8 whAtts_6_9 whDefault_6_10 whCancel_6_11 whSize_6_12 whClosing_6_13 -> let !winfo_7_0 = update window_7_8::windowhandle._WindowData [1:newOrigin_7_24,2:windowdevice.newScroll_82 (select _x_7_28::_Tuple2 0) newHRect_7_25,3:windowdevice.newScroll_82 (select _x_7_28::_Tuple2 1) newVRect_7_26], !newWindow_7_1 = windowhandle.WindowInfo winfo_7_0, !resizedAtt_7_2 = StdWindowDef.WindowViewSize newContentSize_7_18, !_x_7_3 = commondef.creplace StdWindowAttribute.isWindowViewSize resizedAtt_7_2 (select wH_5_1::windowhandle._WindowHandle 9), !resizedAtts_7_4 = <{windowdevice._if;1536;27_158}> (select _x_7_3::_Tuple2 0) _x_7_3 resizedAtt_7_2, !wH_7_5 = update wH_5_1::windowhandle._WindowHandle [5:newWindow_7_1,9:resizedAtts_7_4,12:wsSize_1_1], !wlsH_7_6 = update wlsH_4_0::windowhandle._WindowLSHandle [1:select _x_7_27::_Tuple2 0], !wsH_7_7 = update wsH_3::windowhandle._WindowStateHandle [1:Data.Maybe.Just wlsH_7_6], window_7_8 = windowaccess.getWindowInfoWindowData (select wH_5_1::windowhandle._WindowHandle 5), _x_7_9 = _Tuple4 (select window_7_8::windowhandle._WindowData 1) (select window_7_8::windowhandle._WindowData 0) (Data.Maybe.isJust (select window_7_8::windowhandle._WindowData 2)) (Data.Maybe.isJust (select window_7_8::windowhandle._WindowData 3)), oldOrigin_7_10 = select _x_7_9::_Tuple4 0, domainRect_7_11 = select _x_7_9::_Tuple4 1, oldSize_7_12 = select wH_5_1::windowhandle._WindowHandle 12, hasHScroll_7_13::I = select _x_7_9::_Tuple4 2, hasVScroll_7_14 = select _x_7_9::_Tuple4 3, <{newSize`_7_15}>::I = commondef.toTuple_72 wsSize_1_1, newVisScrolls_7_16 = oswindow.osScrollbarsAreVisible wMetrics_0 domainRect_7_11 <{newSize`_7_15}> (_Tuple2 hasHScroll_7_13 hasVScroll_7_14), newSizeRect_7_17 = commondef.sizeToRect wsSize_1_1, newContentSize_7_18 = commondef.rectSize (oswindow.osGetWindowContentRect wMetrics_0 newVisScrolls_7_16 newSizeRect_7_17), hScroll_7_19 = <{windowdevice._if;1555;27_162}> hasHScroll_7_13 window_7_8, vScroll_7_20 = <{windowdevice._if;1556;27_161}> hasVScroll_7_14 window_7_8, w_7_21 = select <{newSize`_7_15}>::_Tuple2 0, domainSize_7_22::B = commondef.rectSize domainRect_7_11, h_7_23::B = select <{newSize`_7_15}>::_Tuple2 1, newOrigin_7_24 = StdIOBasic._Point2 (<{windowdevice._if;1518;33_159}> (StdBool.not (<{StdInt.<_17}> w_7_21 (select domainSize_7_22::StdIOBasic._Size 0))) domainRect_7_11 oldOrigin_7_10 w_7_21) (<{windowdevice._if;1519;33_160}> (StdBool.not (<{StdInt.<_17}> h_7_23 (select domainSize_7_22::StdIOBasic._Size 1))) domainRect_7_11 oldOrigin_7_10 h_7_23), newHRect_7_25 = oswindow.osGetWindowHScrollRect wMetrics_0 newVisScrolls_7_16 newSizeRect_7_17, newVRect_7_26 = oswindow.osGetWindowVScrollRect wMetrics_0 newVisScrolls_7_16 newSizeRect_7_17, _x_7_27 = controlresize.resizeControls wMetrics_0 isActive_1 wsUpdateAll_1_2 (select info_2::deviceevents._WindowSizeActionInfo 0) oldOrigin_7_10 (commondef.rectSize (oswindow.osGetWindowContentRect wMetrics_0 (oswindow.osScrollbarsAreVisible wMetrics_0 domainRect_7_11 (commondef.toTuple_72 oldSize_7_12) (_Tuple2 hasHScroll_7_13 hasVScroll_7_14)) (commondef.sizeToRect oldSize_7_12))) newContentSize_7_18 wH_7_5 (windowdevice.setwindowslider_84 whSelect_6_8 hScroll_7_19 vScroll_7_20 hasVScroll_7_14 wMetrics_0 wPtr_2_1 False (<{StdInt.==_16}> (select newOrigin_7_24::StdIOBasic._Point2 1) (select oldOrigin_7_10::StdIOBasic._Point2 1)) (oswindow.toOSscrollbarRange (_Tuple3 (select domainRect_7_11::ostypes._OSRect 1) (select newOrigin_7_24::StdIOBasic._Point2 1) (select domainRect_7_11::ostypes._OSRect 3)) (select newContentSize_7_18::StdIOBasic._Size 1)) newHRect_7_25 newVRect_7_26 <{newSize`_7_15}> (windowdevice.setwindowslider_84 whSelect_6_8 hScroll_7_19 vScroll_7_20 hasHScroll_7_13 wMetrics_0 wPtr_2_1 True (<{StdInt.==_16}> (select newOrigin_7_24::StdIOBasic._Point2 0) (select oldOrigin_7_10::StdIOBasic._Point2 0)) (oswindow.toOSscrollbarRange (_Tuple3 (select domainRect_7_11::ostypes._OSRect 0) (select newOrigin_7_24::StdIOBasic._Point2 0) (select domainRect_7_11::ostypes._OSRect 2)) (select newContentSize_7_18::StdIOBasic._Size 0)) newHRect_7_25 newVRect_7_26 <{newSize`_7_15}> tb_4)), _x_7_28 = _Tuple2 (select window_7_8::windowhandle._WindowData 2) (select window_7_8::windowhandle._WindowData 3) in <{_Tuple2!3}> wsH_7_7 (select _x_7_27::_Tuple2 1)) ) ) ) ) ) (_ -> windowdevice.windowdeviceFatalError "windowIO _ (WindowSizeAction _) _" "unexpected placeholder argument")
<{windowdevice._if;1555;27_162}> !hasHScroll_0::B window_1 = case hasHScroll_0 (True -> Data.Maybe.Just (select (Data.Maybe.fromJust (select window_1::windowhandle._WindowData 2))::windowhandle._ScrollInfo 3)) (_ -> Data.Maybe.Nothing)
<{windowdevice._if;1556;27_161}> !hasVScroll_0::B window_1 = case hasVScroll_0 (True -> Data.Maybe.Just (select (Data.Maybe.fromJust (select window_1::windowhandle._WindowData 3))::windowhandle._ScrollInfo 3)) (_ -> Data.Maybe.Nothing)
<{windowdevice._if;1519;33_160}>::I !_x_0::B !domainRect_1 oldOrigin_2 h_3::I = case _x_0 (True -> select domainRect_1::ostypes._OSRect 1) (_ -> commondef.setBetween (select oldOrigin_2::StdIOBasic._Point2 1) (select domainRect_1::ostypes._OSRect 1) (<{StdInt.-_7}> (select domainRect_1::ostypes._OSRect 3) h_3))
<{windowdevice._if;1518;33_159}>::I !_x_0::B !domainRect_1 oldOrigin_2 w_3::I = case _x_0 (True -> select domainRect_1::ostypes._OSRect 0) (_ -> commondef.setBetween (select oldOrigin_2::StdIOBasic._Point2 0) (select domainRect_1::ostypes._OSRect 0) (<{StdInt.-_7}> (select domainRect_1::ostypes._OSRect 2) w_3))
<{windowdevice._if;1536;27_158}> !_x_0::B _x_1 resizedAtt_2 = case _x_0 (True -> select _x_1::_Tuple2 1) (_ -> _predefined._Cons resizedAtt_2 (select _x_1::_Tuple2 1))
windowdevice.windowStateUpdateIO_27 !wMetrics_0 !info_1 !wsH_2 !tb_3::I = case wsH_2 (windowhandle._WindowStateHandle wsh_1_0 wshHandle_1_1 -> case wshHandle_1_1 (Data.Maybe.Just wlsH_2_0 -> case wlsH_2_0 (windowhandle._WindowLSHandle wlsState_3_0 wH_3_1 -> let _x_4_0 = windowupdate.updatewindow wMetrics_0 info_1 wH_3_1 tb_3 in <{_Tuple2!3}> (update wsH_2::windowhandle._WindowStateHandle [1:Data.Maybe.Just (update wlsH_2_0::windowhandle._WindowLSHandle [1:select _x_4_0::_Tuple2 0])]) (select _x_4_0::_Tuple2 1)) ) ) (_ -> windowdevice.windowdeviceFatalError "windowIO (WindowUpdate _) _" "unexpected placeholder argument")
windowdevice.windowIO_28 !receiverEvent_0 !pState_1 = case receiverEvent_0 (deviceevents.ReceiverEvent msgEvent_1_0 -> let recLoc_2_0 = deviceevents.getMsgEventRecLoc msgEvent_1_0, w_2_1 = select recLoc_2_0::receivertable._RecLoc 2, _x_2_2 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_3 = select _x_2_2::_Tuple3 1, windows_2_4 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_3, _x_2_5 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 w_2_1) windows_2_4 in case (StdBool.not (select _x_2_5::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ReceiverEvent _) _" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateMsgIO msgEvent_1_0 (select _x_2_5::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple3 1) (select _x_2_5::_Tuple3 2))) (select _x_2_2::_Tuple3 2)]) in <{_Tuple2!3}> (deviceevents.ReceiverEvent (select _x_4_0::_Tuple3 0)) (select _x_4_0::_Tuple3 2)) ) (deviceevents.CompoundScrollAction info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._CompoundScrollActionInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (CompoundScrollAction _) _" "window could not be found") (False -> let _x_4_0 = iostate.ioStGetOSWindowMetrics (select _x_2_0::_Tuple3 2), _x_4_1 = iostate.accIOToolbox (windowdevice.windowStateCompoundScrollActionIO (select _x_4_0::_Tuple2 0) info_1_0 (select _x_2_3::_Tuple3 1)) (select _x_4_0::_Tuple2 1) in <{_Tuple2!3}> receiverEvent_0 (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_1::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_4_1::_Tuple2 1)])) ) (deviceevents.ControlGetKeyFocus info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._ControlKeyFocusInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ControlGetKeyFocus _) _" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateControlKeyFocusActionIO True info_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.ControlKeyboardAction info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._ControlKeyboardActionInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ControlKeyboardAction _) _" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateControlKeyboardActionIO info_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.ControlLooseKeyFocus info_1_0 -> let wids_2_0 = select info_1_0::deviceevents._ControlKeyFocusInfo 0, _x_2_1 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_2 = select _x_2_1::_Tuple3 1, windows_2_3 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_2, _x_2_4 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select wids_2_0::windowhandle._WIDS 0)) windows_2_3 in case (StdBool.not (select _x_2_4::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ControlLooseKeyFocus _) _" "window could not be found") (False -> let ioState_4_0 = select _x_2_1::_Tuple3 2, _x_4_1 = iostate.ioStGetInputTrack ioState_4_0, old_4_2 = select _x_4_1::_Tuple2 0, _x_4_3 = <{windowdevice._c;199;43_165}> old_4_2 wids_2_0 info_1_0, lostMouse_4_4 = select _x_4_3::_Tuple3 1, lostKey_4_5 = select _x_4_3::_Tuple3 2, lost_4_6 = <{StdList.++}> lostMouse_4_4 lostKey_4_5 in case (StdList.isEmpty lost_4_6) (True -> let _x_6_0 = windowdevice.windowStateControlKeyFocusActionIO False info_1_0 (select _x_2_4::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_6_0::_Tuple2 0) (select _x_2_4::_Tuple3 2))) (iostate.ioStSetInputTrack (select _x_4_3::_Tuple3 0) (select _x_4_1::_Tuple2 1))]) in <{_Tuple2!3}> receiverEvent_0 (select _x_6_0::_Tuple2 1)) (False -> let _x_6_0 = iostate.accIOToolbox (commondef.strictSeqList (<{StdList.++}> lost_4_6 (_predefined._Cons (osevent.createOSDeactivateControlEvent (select wids_2_0::windowhandle._WIDS 1) (select info_1_0::deviceevents._ControlKeyFocusInfo 2)) _predefined._Nil))) (iostate.ioStSetInputTrack (select _x_4_3::_Tuple3 0) (select _x_4_1::_Tuple2 1)), _x_6_1 = iostate.ioStGetEvents (select _x_6_0::_Tuple2 1) in <{_Tuple2!3}> receiverEvent_0 (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_2_4::_Tuple3 1) (select _x_2_4::_Tuple3 2))) (iostate.ioStSetEvents (osevent.osInsertEvents (select _x_6_0::_Tuple2 0) (select _x_6_1::_Tuple2 0)) (select _x_6_1::_Tuple2 1))])) ) ) (deviceevents.ControlMouseAction info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._ControlMouseActionInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ControlMouseAction _) _" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateControlMouseActionIO info_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.ControlSelection info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._ControlSelectInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ControlSelection _) _" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateControlSelectionIO info_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.ControlSliderAction info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._ControlSliderInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (ControlSliderAction _) _" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateControlSliderActionIO info_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowActivation wids_1_0 -> let wid_2_0 = windowaccess.toWID_71 (select wids_1_0::windowhandle._WIDS 0), _x_2_1 = iostate.ioStGetProcessStack (select pState_1::iostate._PSt 1), ioState_2_2 = select _x_2_1::_Tuple2 1, _x_2_3 = iostate.ioStGetIOId ioState_2_2, io_2_4 = select _x_2_3::_Tuple2 0, processStack_2_5 = select _x_2_1::_Tuple2 0, processStack_2_6 = processstack.selectProcessShowState io_2_4 processStack_2_5, ioState_2_7 = select _x_2_3::_Tuple2 1, ioState_2_8 = iostate.ioStSetProcessStack processStack_2_6 ioState_2_7, _x_2_9 = iostate.ioStGetDevice device.WindowDevice ioState_2_8, wDevice_2_10 = select _x_2_9::_Tuple3 1, windows_2_11 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_10, _x_2_12 = windowaccess.getWindowHandlesWindow wid_2_0 windows_2_11 in case (StdBool.not (select _x_2_12::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowActivation _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateActivationIO (update (select _x_2_12::_Tuple3 1)::windowhandle._WindowStateHandle [0:update wids_1_0::windowhandle._WIDS [2:True]]) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.addWindowHandlesActiveWindow (select _x_4_0::_Tuple2 0) (select (windowaccess.removeWindowHandlesWindow wid_2_0 (select _x_2_12::_Tuple3 2))::_Tuple3 2))) (select _x_2_9::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowDeactivation wids_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select wids_1_0::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowDeactivation _)" "window could not be found") (False -> let ioState_4_0 = select _x_2_0::_Tuple3 2, _x_4_1 = iostate.ioStGetInputTrack ioState_4_0, inputTrack_4_2 = select _x_4_1::_Tuple2 0, _x_4_3 = <{windowdevice._c;299;35_170}> inputTrack_4_2, lostMouse_4_4 = select _x_4_3::_Tuple2 0, lostKey_4_5 = select _x_4_3::_Tuple2 1, lost_4_6 = <{StdList.++}> lostMouse_4_4 lostKey_4_5 in case (StdList.isEmpty lost_4_6) (True -> let _x_6_0 = windowdevice.windowStateDeactivationIO (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_6_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (iostate.ioStSetInputTrack Data.Maybe.Nothing (select _x_4_1::_Tuple2 1))]) in <{_Tuple2!3}> receiverEvent_0 (select _x_6_0::_Tuple2 1)) (False -> let _x_6_0 = iostate.accIOToolbox (commondef.strictSeqList (<{StdList.++}> lost_4_6 (_predefined._Cons (osevent.createOSDeactivateWindowEvent (select wids_1_0::windowhandle._WIDS 1)) _predefined._Nil))) (iostate.ioStSetInputTrack Data.Maybe.Nothing (select _x_4_1::_Tuple2 1)), _x_6_1 = iostate.ioStGetEvents (select _x_6_0::_Tuple2 1) in <{_Tuple2!3}> receiverEvent_0 (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_2_3::_Tuple3 1) (select _x_2_3::_Tuple3 2))) (iostate.ioStSetEvents (osevent.osInsertEvents (select _x_6_0::_Tuple2 0) (select _x_6_1::_Tuple2 0)) (select _x_6_1::_Tuple2 1))])) ) ) (deviceevents.WindowInitialise wids_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select wids_1_0::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowInitialise _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateInitialiseIO (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowKeyboardAction action_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select action_1_0::deviceevents._WindowKeyboardActionInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowKeyboardAction _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateWindowKeyboardActionIO action_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowMouseAction action_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select action_1_0::deviceevents._WindowMouseActionInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowMouseAction _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateWindowMouseActionIO action_1_0 (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowCANCEL wids_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select wids_1_0::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowCANCEL _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateCANCELIO (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowOK wids_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select wids_1_0::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowOK _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateOKIO (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowRequestClose wids_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select wids_1_0::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowRequestClose _)" "window could not be found") (False -> let _x_4_0 = windowdevice.windowStateRequestCloseIO (select _x_2_3::_Tuple3 1) (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_0::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_2_0::_Tuple3 2)]) in <{_Tuple2!3}> receiverEvent_0 (select _x_4_0::_Tuple2 1)) ) (deviceevents.WindowScrollAction info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._WindowScrollActionInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowScrollAction _)" "window could not be found") (False -> let _x_4_0 = iostate.ioStGetOSWindowMetrics (select _x_2_0::_Tuple3 2), _x_4_1 = iostate.accIOToolbox (windowdevice.windowStateScrollActionIO (select _x_4_0::_Tuple2 0) info_1_0 (select _x_2_3::_Tuple3 1)) (select _x_4_0::_Tuple2 1) in <{_Tuple2!3}> receiverEvent_0 (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_1::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_4_1::_Tuple2 1)])) ) (deviceevents.WindowSizeAction info_1_0 -> let w_2_0 = select (select info_1_0::deviceevents._WindowSizeActionInfo 0)::windowhandle._WIDS 0, _x_2_1 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_2 = select _x_2_1::_Tuple3 1, windows_2_3 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_2, _x_2_4 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 w_2_0) windows_2_3 in case (StdBool.not (select _x_2_4::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowSizeAction _)" "window could not be found") (False -> let _x_4_0 = iostate.ioStGetOSWindowMetrics (select _x_2_1::_Tuple3 2), windows_4_1 = select _x_2_4::_Tuple3 2, _x_4_2 = windowaccess.getWindowHandlesActiveWindow windows_4_1, activeW_4_3 = select _x_4_2::_Tuple2 0, _x_4_4 = iostate.getIOToolbox (select _x_4_0::_Tuple2 1), _x_4_5 = windowdevice.windowStateSizeAction (select _x_4_0::_Tuple2 0) (windowdevice._f171_171 (Data.Maybe.isJust activeW_4_3) activeW_4_3 w_2_0) info_1_0 (select _x_2_4::_Tuple3 1) (select _x_4_4::_Tuple2 0) in <{_Tuple2!3}> receiverEvent_0 (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_5::_Tuple2 0) (select _x_4_2::_Tuple2 1))) (iostate.setIOToolbox (select _x_4_5::_Tuple2 1) (select _x_4_4::_Tuple2 1))])) ) (deviceevents.WindowUpdate info_1_0 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice (select pState_1::iostate._PSt 1), wDevice_2_1 = select _x_2_0::_Tuple3 1, windows_2_2 = devicesystemstate.windowSystemStateGetWindowHandles wDevice_2_1, _x_2_3 = windowaccess.getWindowHandlesWindow (windowaccess.toWID_71 (select (select info_1_0::deviceevents._UpdateInfo 0)::windowhandle._WIDS 0)) windows_2_2 in case (StdBool.not (select _x_2_3::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowIO (WindowUpdate _)" "window could not be found") (False -> let _x_4_0 = iostate.ioStGetOSWindowMetrics (select _x_2_0::_Tuple3 2), _x_4_1 = iostate.accIOToolbox (windowdevice.windowStateUpdateIO_27 (select _x_4_0::_Tuple2 0) info_1_0 (select _x_2_3::_Tuple3 1)) (select _x_4_0::_Tuple2 1) in <{_Tuple2!3}> receiverEvent_0 (update pState_1::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowaccess.setWindowHandlesWindow (select _x_4_1::_Tuple2 0) (select _x_2_3::_Tuple3 2))) (select _x_4_1::_Tuple2 1)])) ) (_ -> windowdevice.windowdeviceFatalError "windowIO" "unexpected DeviceEvent")
windowdevice._f171_171::B !_x_0::B activeW_1 w_2 = case _x_0 (True -> <{id.==_27}> (select (Data.Maybe.fromJust activeW_1)::windowhandle._WIDS 0) w_2) (_ -> False)
<{windowdevice._c;299;35_170}> !inputTrack_0 = case inputTrack_0 (Data.Maybe.Nothing -> _Tuple2 _predefined._Nil _predefined._Nil) (Data.Maybe.Just it_1_0 -> case it_1_0 (iostate._InputTrack itWindow_2_0 itControl_2_1 itKind_2_2 -> _Tuple2 (<{windowdevice._if;302;49_167}> (select itKind_2_2::iostate._InputTrackKind 0) itWindow_2_0 itControl_2_1) (<{windowdevice._if;303;49_169}> (select itKind_2_2::iostate._InputTrackKind 1) itWindow_2_0 itControl_2_1)) ) 
<{windowdevice._if;303;49_169}> !_x_0::B itWindow_1::I itControl_2::I = case _x_0 (True -> _predefined._Cons (osevent.createOSLooseKeyEvent itWindow_1 (<{windowdevice._if;303;106_168}> (<{StdInt.==_16}> itControl_2 0) itWindow_1 itControl_2)) _predefined._Nil) (_ -> _predefined._Nil)
<{windowdevice._if;303;106_168}>::I !_x_0::B itWindow_1::I itControl_2::I = case _x_0 (True -> itWindow_1) (_ -> itControl_2)
<{windowdevice._if;302;49_167}> !_x_0::B itWindow_1::I itControl_2::I = case _x_0 (True -> _predefined._Cons (osevent.createOSLooseMouseEvent itWindow_1 (<{windowdevice._if;302;106_166}> (<{StdInt.==_16}> itControl_2 0) itWindow_1 itControl_2)) _predefined._Nil) (_ -> _predefined._Nil)
<{windowdevice._if;302;106_166}>::I !_x_0::B itWindow_1::I itControl_2::I = case _x_0 (True -> itWindow_1) (_ -> itControl_2)
<{windowdevice._c;199;43_165}> !old_0 wids_1 info_2 = case old_0 (Data.Maybe.Just it_1_0 -> case it_1_0 (iostate._InputTrack itWindow_2_0 itControl_2_1 itKind_2_2 -> case (case (<{StdInt.==_16}> itWindow_2_0 (select wids_1::windowhandle._WIDS 1)) (True -> <{StdInt.==_16}> itControl_2_1 (select info_2::deviceevents._ControlKeyFocusInfo 1)) (False -> False) ) (True -> _Tuple3 Data.Maybe.Nothing (<{windowdevice._if;203;65_163}> (select itKind_2_2::iostate._InputTrackKind 0) itWindow_2_0 itControl_2_1) (<{windowdevice._if;204;65_164}> (select itKind_2_2::iostate._InputTrackKind 1) itWindow_2_0 itControl_2_1)) (False -> _Tuple3 old_0 _predefined._Nil _predefined._Nil) ) ) (_ -> _Tuple3 old_0 _predefined._Nil _predefined._Nil)
<{windowdevice._if;204;65_164}> !_x_0::B itWindow_1::I itControl_2::I = case _x_0 (True -> _predefined._Cons (osevent.createOSLooseKeyEvent itWindow_1 itControl_2) _predefined._Nil) (_ -> _predefined._Nil)
<{windowdevice._if;203;65_163}> !_x_0::B itWindow_1::I itControl_2::I = case _x_0 (True -> _predefined._Cons (osevent.createOSLooseMouseEvent itWindow_1 itControl_2) _predefined._Nil) (_ -> _predefined._Nil)
windowdevice.windowIO !deviceEvent_0 !pState_1 = let _x_1_0 = StdPSt.accPIO (iostate.ioStHasDevice device.WindowDevice) pState_1 in case (StdBool.not (select _x_1_0::_Tuple2 0)) (True -> windowdevice.windowdeviceFatalError "windowFunctions.dDoIO" "could not retrieve WindowSystemState from IOSt") (False -> windowdevice.windowIO_28 deviceEvent_0 (select _x_1_0::_Tuple2 1)) 
windowdevice.anon_23 !windows_0 = case windows_0 (windowhandle._WindowHandles whsWindows_1_0 whsCursor_1_1 whsNrWindowBound_1_2 whsModal_1_3 whsFinalModalLS_1_4 -> _Tuple2 whsWindows_1_0 (update windows_0::windowhandle._WindowHandles [0:_predefined._Nil])) 
windowdevice.handleOSEvent_25 !osEvent_0 !pState_1 = scheduler.accContext (scheduler.handleContextOSEvent osEvent_0) pState_1
<{windowdevice.disposeWindowStateHandle`_24}> !wsH_0 !_x_1 = case _x_1 (_Tuple4 osdinfo_1_0 inputTrack_1_1 state_1_2 tb_1_3 -> let _x_2_0 = windowdispose.disposeWindowStateHandle osdinfo_1_0 inputTrack_1_1 windowdevice.handleOSEvent_25 (_Tuple2 wsH_0 state_1_2) tb_1_3, _x_2_1 = select _x_2_0::_Tuple3 0 in <{_Tuple2!3}> (_Tuple4 (select _x_2_1::_Tuple6 0) (select _x_2_1::_Tuple6 1) (select _x_2_1::_Tuple6 2) (select _x_2_1::_Tuple6 3)) (_Tuple4 (select _x_2_1::_Tuple6 4) (select _x_2_1::_Tuple6 5) (select (select _x_2_0::_Tuple3 1)::_Tuple2 1) (select _x_2_0::_Tuple3 2))) 
windowdevice.setFinalLS_26 !finalLSs_0 !ioState_1 = let _x_1_0 = iostate.ioStGetDevice device.WindowDevice ioState_1 in case (StdBool.not (select _x_1_0::_Tuple3 0)) (True -> windowdevice.windowdeviceFatalError "windowFunctions.dClose" "setFinalLS could not retrieve WindowSystemState from IOSt") (False -> let windows_3_0 = devicesystemstate.windowSystemStateGetWindowHandles (select _x_1_0::_Tuple3 1) in iostate.ioStSetDevice (devicesystemstate.WindowSystemState (update windows_3_0::windowhandle._WindowHandles [4:<{StdList.++}> (select windows_3_0::windowhandle._WindowHandles 4) finalLSs_0])) (select _x_1_0::_Tuple3 2)) 
windowdevice.windowClose !pState_0 = case pState_0 (iostate._PSt ls_1_0 ioState_1_1 -> let _x_2_0 = iostate.ioStGetDevice device.WindowDevice ioState_1_1 in case (StdBool.not (select _x_2_0::_Tuple3 0)) (True -> update pState_0::iostate._PSt [1:select _x_2_0::_Tuple3 2]) (False -> let _x_4_0 = windowdevice.anon_23 (devicesystemstate.windowSystemStateGetWindowHandles (select _x_2_0::_Tuple3 1)), _x_4_1 = iostate.ioStGetOSDInfo (select _x_2_0::_Tuple3 2), _x_4_2 = iostate.ioStGetInputTrack (select _x_4_1::_Tuple2 1), _x_4_3 = iostate.getIOToolbox (select _x_4_2::_Tuple2 1), _x_4_4 = commondef.stateMap <{windowdevice.disposeWindowStateHandle`_24}> (select _x_4_0::_Tuple2 0) (_Tuple4 (select _x_4_1::_Tuple2 0) (select _x_4_2::_Tuple2 0) (update pState_0::iostate._PSt [1:iostate.ioStSetDevice (devicesystemstate.WindowSystemState (select _x_4_0::_Tuple2 1)) (select _x_4_3::_Tuple2 1)]) (select _x_4_3::_Tuple2 0)), _x_4_5 = select _x_4_4::_Tuple2 1, pState_4_6 = select _x_4_5::_Tuple4 2, _x_4_7 = commondef.unzip4 (select _x_4_4::_Tuple2 0), freeR_4_8 = StdList.flatten (select _x_4_7::_Tuple4 0), _x_4_9 = iostate.ioStGetIdTable (receiverid.unbindRIds freeR_4_8 (iostate.ioStSetInputTrack (select _x_4_5::_Tuple4 1) (iostate.ioStSetOSDInfo (select _x_4_5::_Tuple4 0) (iostate.setIOToolbox (select _x_4_5::_Tuple4 3) (select pState_4_6::iostate._PSt 1))))) in update pState_4_6::iostate._PSt [1:windowdevice.setFinalLS_26 (StdList.flatten (select _x_4_7::_Tuple4 3)) (iostate.ioStSetIdTable (select (id.removeIdsFromIdTable (<{StdList.++}> freeR_4_8 (StdList.flatten (select _x_4_7::_Tuple4 1))) (select _x_4_9::_Tuple2 0))::_Tuple2 1) (select _x_4_9::_Tuple2 1))]) ) 
windowdevice.windowOpen !pState_0 = case pState_0 (iostate._PSt ls_1_0 ioState_1_1 -> let _x_2_0 = iostate.ioStHasDevice device.WindowDevice ioState_1_1 in case (select _x_2_0::_Tuple2 0) (True -> update pState_0::iostate._PSt [1:select _x_2_0::_Tuple2 1]) (False -> let _x_4_0 = iostate.ioStGetDocumentInterface (select _x_2_0::_Tuple2 1), _x_4_1 = iostate.accIOToolbox osrgn.osnewrgn (select _x_4_0::_Tuple2 1) in update pState_0::iostate._PSt [1:iostate.ioStSetDeviceFunctions windowdevice.windowFunctions (iostate.ioStSetDevice (devicesystemstate.WindowSystemState (windowhandle._WindowHandles _predefined._Nil (windowhandle._CursorInfo True (select _x_4_1::_Tuple2 0) False StdIOCommon.StandardCursor False StdIOCommon.StandardCursor) (<{windowdevice._c;49;59_172}> (select _x_4_0::_Tuple2 0)) False _predefined._Nil)) (select _x_4_1::_Tuple2 1))]) ) 
windowdevice.windowFunctions = devicefunctions._DeviceFunctions device.WindowDevice StdFunc.id StdFunc.id windowevent.windowEvent windowdevice.windowIO windowdevice.windowOpen windowdevice.windowClose
<{windowdevice._c;49;59_172}> !_x_0 = case _x_0 (StdIOCommon.NDI -> commondef.Finite 0) (StdIOCommon.SDI -> commondef.Finite 1) (StdIOCommon.MDI -> commondef.Infinite) 


|| Converted Records
:: <{windowdevice.gEq_s;}> = {!windowdevice.gEq_s}

:: <{windowdevice.gEq_ss;}> = {!windowdevice.gEq_ss}

:: <{windowdevice.gEq_sss;}> = {!windowdevice.gEq_sss}

:: <{windowdevice.gEq_ssss;}> = {!windowdevice.gEq_ssss}

:: <{windowdevice.gEq_sssss;}> = {!windowdevice.gEq_sssss}

:: <{windowdevice.gEq_ssssss;}> = {!windowdevice.gEq_ssssss}

:: <{windowdevice.gEq_sssssss;}> = {!windowdevice.gEq_sssssss}

:: <{windowdevice.gEq_ssssssss;}> = {!windowdevice.gEq_ssssssss}

:: <{windowdevice.gEq_sssssssss;}> = {!windowdevice.gEq_sssssssss}

:: <{windowdevice.bimap_s;}> = {windowdevice.bimap_s}

:: <{windowdevice.bimap_ss;}> = {windowdevice.bimap_ss}

:: <{windowdevice.bimap_sss;}> = {windowdevice.bimap_sss}

