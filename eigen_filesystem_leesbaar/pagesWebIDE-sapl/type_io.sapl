|| ?module? type_io


type_io.write_type_info_of_array !_vArray_0 !_vWriteType_1 !i_2::I !limit_3::I array_4 tcl_file_5 wtis_6 = case (<{StdInt.==_16}> i_2 limit_3) (True -> _Tuple2 tcl_file_5 wtis_6) (False -> let _x_2_0 = select _vWriteType_1::<{type_io.WriteTypeInfo;}> 0 (select _vArray_0::<{_SystemArray.Array;}> 3 array_4 i_2) tcl_file_5 wtis_6 in type_io.write_type_info_of_array _vArray_0 _vWriteType_1 (<{StdInt.+_6}> i_2 StdInt.one_11) limit_3 array_4 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.fold_st_30 op_0 !_x_1 st_2 = case _x_1 (_predefined._Nil -> st_2) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_30 op_0 x_1_1 (op_0 a_1_0 st_2)) 
type_io.normalize_atype_var !td_arg_0 !_x_1 = case td_arg_0 (syntax._ATypeVar atv_attribute_1_0 atv_variable_1_1 -> case atv_variable_1_1 (syntax._TypeVar tv_ident_2_0 tv_info_ptr_2_1 -> case _x_1 (_Tuple2 id_3_0 th_vars_3_1 -> <{_Tuple2!3}> (<{StdInt.+_6}> id_3_0 StdInt.one_11) (Heap.writePtr tv_info_ptr_2_1 (syntax.TVI_Normalized id_3_0) th_vars_3_1)) ) ) 
type_io.write_type_info_loop_12 !_vWriteType_0 !_x_1 tcl_file_2 wtis_3 = case _x_1 (_predefined._Nil -> _Tuple2 tcl_file_2 wtis_3) (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = select _vWriteType_0::<{type_io.WriteTypeInfo;}> 0 x_1_0 tcl_file_2 wtis_3 in type_io.write_type_info_loop_12 _vWriteType_0 xs_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_2 !_vWriteType_0 !l_1 !tcl_file_2 !wtis_3 = type_io.write_type_info_loop_12 _vWriteType_0 l_1 (StdFile.fwritei (StdList.length_47 l_1) tcl_file_2) wtis_3
type_io.get_type_var_nf_number_9::I !_x_0 = case _x_0 (syntax.TVI_Normalized i_1_0 -> i_1_0) 
type_io.write_type_info_16 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._TypeVar tv_ident_1_0 tv_info_ptr_1_1 -> case wtis_2 (type_io._WriteTypeInfoState wtis_n_type_vars_2_0 wtis_common_defs_2_1 wtis_type_defs_2_2 wtis_type_heaps_2_3 wtis_var_heap_2_4 wtis_main_dcl_module_n_2_5 wtis_icl_generic_defs_2_6 -> let _x_3_0 = Heap.readPtr tv_info_ptr_1_1 (select wtis_type_heaps_2_3::syntax._TypeHeaps 0) in <{_Tuple2!3}> (StdFile.fwritei (type_io.get_type_var_nf_number_9 (select _x_3_0::_Tuple2 0)) tcl_file_1) (update wtis_2::type_io._WriteTypeInfoState [3:update wtis_type_heaps_2_3::syntax._TypeHeaps [0:select _x_3_0::_Tuple2 1]])) ) 
type_io.write_type_info_15 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._ATypeVar atv_attribute_1_0 atv_variable_1_1 -> let _x_2_0 = type_io.write_type_info_16 atv_variable_1_1 tcl_file_1 wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_19 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._Ident id_name_1_0 id_info_1_1 -> <{_Tuple2!3}> (StdFile.fwrites id_name_1_0 (StdFile.fwritei (_SystemArray.size_20 id_name_1_0) tcl_file_1)) wtis_2) 
type_io.expand_symbol_type_11 symbol_type_0 !wtis_1 = case wtis_1 (type_io._WriteTypeInfoState wtis_n_type_vars_1_0 wtis_common_defs_1_1 wtis_type_defs_1_2 wtis_type_heaps_1_3 wtis_var_heap_1_4 wtis_main_dcl_module_n_1_5 wtis_icl_generic_defs_1_6 -> let _x_2_0 = expand_types.convertSymbolTypeWithoutCollectingImportedConstructors False wtis_common_defs_1_1 symbol_type_0 wtis_main_dcl_module_n_1_5 wtis_type_defs_1_2 wtis_type_heaps_1_3 wtis_var_heap_1_4 in _Tuple2 (select _x_2_0::_Tuple4 0) (update wtis_1::type_io._WriteTypeInfoState [2:select _x_2_0::_Tuple4 1,3:select _x_2_0::_Tuple4 2,4:select _x_2_0::_Tuple4 3])) 
type_io.write_type_info_22 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax.NotStrict -> <{_Tuple2!3}> (StdFile.fwritec (StdChar.toChar_21 33) tcl_file_1) wtis_2) (syntax.Strict i_1_0 -> <{_Tuple2!3}> (StdFile.fwritei i_1_0 (StdFile.fwritec (StdChar.toChar_21 34) tcl_file_1)) wtis_2) (syntax.StrictList i_1_0 tail_1_1 -> type_io.write_type_info_22 tail_1_1 (StdFile.fwritei i_1_0 (StdFile.fwritec (StdChar.toChar_21 35) tcl_file_1)) wtis_2) 
type_io.fold_st_34 op_0 !_x_1 st_2 = case _x_1 (_predefined._Nil -> st_2) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_34 op_0 x_1_1 (op_0 a_1_0 st_2)) 
type_io.fold_st_33 op_0 !_x_1 st_2 = case _x_1 (_predefined._Nil -> st_2) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_33 op_0 x_1_1 (op_0 a_1_0 st_2)) 
type_io.fold_st_32 op_0 !_x_1 st_2 = case _x_1 (_predefined._Nil -> st_2) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_32 op_0 x_1_1 (op_0 a_1_0 st_2)) 
type_io.normalize_type_var !_x_0 !_x_1 = case _x_0 (syntax._TypeVar tv_ident_1_0 tv_info_ptr_1_1 -> case _x_1 (_Tuple2 id_2_0 th_vars_2_1 -> <{_Tuple2!3}> (<{StdInt.+_6}> id_2_0 StdInt.one_11) (Heap.writePtr tv_info_ptr_1_1 (syntax.TVI_Normalized id_2_0) th_vars_2_1)) ) 
type_io.write_type_info_28 !i_0::I !tcl_file_1 !wtis_2 = <{_Tuple2!3}> (StdFile.fwritei i_0 tcl_file_1) wtis_2
type_io.write_type_info_25 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax.CV type_var_1_0 -> let _x_2_0 = type_io.write_type_info_16 type_var_1_0 (StdFile.fwritec (StdChar.toChar_21 26) tcl_file_1) wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) (syntax.TempCV temp_var_id_1_0 -> let _x_2_0 = type_io.write_type_info_28 temp_var_id_1_0 (StdFile.fwritec (StdChar.toChar_21 27) tcl_file_1) wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) (syntax.TempQCV temp_var_id_1_0 -> let _x_2_0 = type_io.write_type_info_28 temp_var_id_1_0 (StdFile.fwritec (StdChar.toChar_21 28) tcl_file_1) wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) (syntax.TempQCDV temp_var_id_1_0 -> let _x_2_0 = type_io.write_type_info_28 temp_var_id_1_0 (StdFile.fwritec (StdChar.toChar_21 28) tcl_file_1) wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_27 !_vWriteType_0 !_x_1 !tcl_file_2 !wtis_3 = case _x_1 (syntax._Global glob_object_1_0 glob_module_1_1 -> let _x_2_0 = select _vWriteType_0::<{type_io.WriteTypeInfo;}> 0 glob_object_1_0 tcl_file_2 wtis_3, _x_2_1 = type_io.write_type_info_28 glob_module_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1)) 
type_io.write_type_info_75 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._Global glob_object_1_0 glob_module_1_1 -> let _x_2_0 = type_io.write_type_info_28 glob_object_1_0 tcl_file_1 wtis_2, _x_2_1 = type_io.write_type_info_28 glob_module_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1)) 
type_io.write_type_info_26 !tsi_0 !tcl_file_1 !wtis_2 = case tsi_0 (syntax._TypeSymbIdent type_ident_1_0 type_arity_1_1 type_index_1_2 type_prop_1_3 -> case type_index_1_2 (syntax._Global glob_object_2_0 glob_module_2_1 -> let _x_3_0 = type_io.write_type_info_19 type_ident_1_0 (StdFile.fwritec (<{type_io._if;355;24_97}> (<{StdInt.==_16}> glob_module_2_1 1)) tcl_file_1) wtis_2, _x_3_1 = type_io.write_type_info_28 type_arity_1_1 (select _x_3_0::_Tuple2 0) (select _x_3_0::_Tuple2 1), _x_3_2 = type_io.write_type_info_75 (select tsi_0::syntax._TypeSymbIdent 2) (select _x_3_1::_Tuple2 0) (select _x_3_1::_Tuple2 1) in <{_Tuple2!3}> (select _x_3_2::_Tuple2 0) (select _x_3_2::_Tuple2 1)) ) 
<{type_io._if;355;24_97}>::C !_x_0::B = case _x_0 (True -> StdChar.toChar_21 29) (_ -> StdChar.toChar_21 30)
type_io.write_type_info_loop_77 !_x_0 tcl_file_1 wtis_2 = case _x_0 (_predefined._Nil -> _Tuple2 tcl_file_1 wtis_2) (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = type_io.write_type_info_16 x_1_0 tcl_file_1 wtis_2 in type_io.write_type_info_loop_77 xs_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_76 !l_0 !tcl_file_1 !wtis_2 = type_io.write_type_info_loop_77 l_0 (StdFile.fwritei (StdList.length_47 l_0) tcl_file_1) wtis_2
type_io.fold_st_82 !_x_0 !st_1 = case _x_0 (_predefined._Nil -> st_1) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_82 x_1_1 (type_io.normalize_type_var a_1_0 st_1)) 
type_io.fold_st_81 !_x_0 !st_1 = case _x_0 (_predefined._Nil -> st_1) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_81 x_1_1 (type_io.normalize_atype_var a_1_0 st_1)) 
type_io.fold_st_80 !_x_0 !st_1 = case _x_0 (_predefined._Nil -> st_1) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_80 x_1_1 (type_io.normalize_atype_var a_1_0 st_1)) 
type_io.write_type_info_24 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax.TA type_symb_ident_1_0 atypes_1_1 -> let _x_2_0 = type_io.write_type_info_26 type_symb_ident_1_0 (StdFile.fwritec (StdChar.toChar_21 10) tcl_file_1) wtis_2, _x_2_1 = type_io.write_type_info_78 atypes_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1), _x_2_2 = type_io.write_type_info_22 syntax.NotStrict (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_2::_Tuple2 0) (select _x_2_2::_Tuple2 1)) (syntax.TAS type_symb_ident_1_0 atypes_1_1 strictness_1_2 -> let _x_2_0 = type_io.write_type_info_26 type_symb_ident_1_0 (StdFile.fwritec (StdChar.toChar_21 10) tcl_file_1) wtis_2, _x_2_1 = type_io.write_type_info_78 atypes_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1), _x_2_2 = type_io.write_type_info_22 strictness_1_2 (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_2::_Tuple2 0) (select _x_2_2::_Tuple2 1)) (<{syntax.-->}> atype1_1_0 atype2_1_1 -> let _x_2_0 = type_io.write_type_info_23 atype1_1_0 (StdFile.fwritec (StdChar.toChar_21 11) tcl_file_1) wtis_2, _x_2_1 = type_io.write_type_info_23 atype2_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1)) (<{syntax.:@:}> cons_variable_1_0 atypes_1_1 -> let _x_2_0 = type_io.write_type_info_25 cons_variable_1_0 (StdFile.fwritec (StdChar.toChar_21 12) tcl_file_1) wtis_2, _x_2_1 = type_io.write_type_info_78 atypes_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1)) (syntax.TB basic_type_1_0 -> let _x_2_0 = <{type_io._c;258;15_98}> basic_type_1_0 tcl_file_1 wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) (syntax.GTV type_var_1_0 -> let _x_2_0 = type_io.write_type_info_16 type_var_1_0 (StdFile.fwritec (StdChar.toChar_21 14) tcl_file_1) wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) (syntax.TV type_var_1_0 -> let _x_2_0 = type_io.write_type_info_16 type_var_1_0 (StdFile.fwritec (StdChar.toChar_21 15) tcl_file_1) wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) (syntax.TFA uni_vars_1_0 type_1_1 -> case wtis_2 (type_io._WriteTypeInfoState wtis_n_type_vars_2_0 wtis_common_defs_2_1 wtis_type_defs_2_2 wtis_type_heaps_2_3 wtis_var_heap_2_4 wtis_main_dcl_module_n_2_5 wtis_icl_generic_defs_2_6 -> type_io.write_type_info_24 type_1_1 tcl_file_1 (update wtis_2::type_io._WriteTypeInfoState [3:update wtis_type_heaps_2_3::syntax._TypeHeaps [0:select (type_io.fold_st_80 uni_vars_1_0 (_Tuple2 0 (select wtis_type_heaps_2_3::syntax._TypeHeaps 0)))::_Tuple2 1]])) ) (syntax.TFAC uni_vars_1_0 type_1_1 _x_1_2 -> case wtis_2 (type_io._WriteTypeInfoState wtis_n_type_vars_2_0 wtis_common_defs_2_1 wtis_type_defs_2_2 wtis_type_heaps_2_3 wtis_var_heap_2_4 wtis_main_dcl_module_n_2_5 wtis_icl_generic_defs_2_6 -> type_io.write_type_info_24 type_1_1 tcl_file_1 (update wtis_2::type_io._WriteTypeInfoState [3:update wtis_type_heaps_2_3::syntax._TypeHeaps [0:select (type_io.fold_st_81 uni_vars_1_0 (_Tuple2 0 (select wtis_type_heaps_2_3::syntax._TypeHeaps 0)))::_Tuple2 1]])) ) (syntax.TE -> <{_Tuple2!3}> (StdFile.fwritec (StdChar.toChar_21 17) tcl_file_1) wtis_2) (syntax.TGenericFunctionInDictionary _x_1_0 type_kind_1_1 generict_dict_1_2 -> case _x_1_0 (syntax._Global _x_2_0 glob_module_2_1 -> case _x_2_0 (syntax._DefinedSymbol ds_ident_3_0 ds_arity_3_1 ds_index_3_2 -> let _x_4_0 = <{type_io._if;308;15_99}> (<{StdInt.==_16}> glob_module_2_1 (select wtis_2::type_io._WriteTypeInfoState 5)) wtis_2 ds_index_3_2 glob_module_2_1, gen_type_4_1 = select (select _x_4_0::_Tuple2 0)::syntax._GenericDef 3, kind_string_4_2 = genericsupport.kind_to_short_string type_kind_1_1, wtis_4_3 = select _x_4_0::_Tuple2 1, wtis_type_heaps_4_4 = select wtis_4_3::type_io._WriteTypeInfoState 3, _x_4_5 = type_io.fold_st_82 (select gen_type_4_1::syntax._SymbolType 0) (_Tuple2 0 (select wtis_type_heaps_4_4::syntax._TypeHeaps 0)), _x_4_6 = type_io.write_type_info_21 gen_type_4_1 (StdFile.fwrites kind_string_4_2 (StdFile.fwritei (_SystemArray.size_20 kind_string_4_2) (StdFile.fwritec '$' tcl_file_1))) (update wtis_4_3::type_io._WriteTypeInfoState [0:select _x_4_5::_Tuple2 0,3:update wtis_type_heaps_4_4::syntax._TypeHeaps [0:select _x_4_5::_Tuple2 1]]) in <{_Tuple2!3}> (select _x_4_6::_Tuple2 0) (update (select _x_4_6::_Tuple2 1)::type_io._WriteTypeInfoState [0:select wtis_4_3::type_io._WriteTypeInfoState 0])) ) ) 
type_io.write_type_info_23 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._AType at_attribute_1_0 at_type_1_1 -> let _x_2_0 = type_io.write_type_info_24 at_type_1_1 tcl_file_1 wtis_2 in <{_Tuple2!3}> (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_loop_79 !_x_0 tcl_file_1 wtis_2 = case _x_0 (_predefined._Nil -> _Tuple2 tcl_file_1 wtis_2) (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = type_io.write_type_info_23 x_1_0 tcl_file_1 wtis_2 in type_io.write_type_info_loop_79 xs_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_78 !l_0 !tcl_file_1 !wtis_2 = type_io.write_type_info_loop_79 l_0 (StdFile.fwritei (StdList.length_47 l_0) tcl_file_1) wtis_2
type_io.write_type_info_21 !symbol_type_0 !tcl_file_1 !wtis_2 = let !_x_1_0 = type_io.expand_symbol_type_11 symbol_type_0 wtis_2, _x_1_1 = select _x_1_0::_Tuple2 0, _x_1_2 = type_io.write_type_info_76 (select _x_1_1::syntax._SymbolType 0) tcl_file_1 (select _x_1_0::_Tuple2 1), _x_1_3 = type_io.write_type_info_78 (select _x_1_1::syntax._SymbolType 1) (select _x_1_2::_Tuple2 0) (select _x_1_2::_Tuple2 1), _x_1_4 = type_io.write_type_info_22 (select _x_1_1::syntax._SymbolType 2) (select _x_1_3::_Tuple2 0) (select _x_1_3::_Tuple2 1), _x_1_5 = type_io.write_type_info_28 (select _x_1_1::syntax._SymbolType 3) (select _x_1_4::_Tuple2 0) (select _x_1_4::_Tuple2 1), _x_1_6 = type_io.write_type_info_23 (select _x_1_1::syntax._SymbolType 4) (select _x_1_5::_Tuple2 0) (select _x_1_5::_Tuple2 1) in <{_Tuple2!3}> (select _x_1_6::_Tuple2 0) (select _x_1_6::_Tuple2 1)
<{type_io._if;308;15_99}> !_x_0::B !wtis_1 !ds_index_2::I glob_module_3::I = case _x_0 (True -> type_io.select_62 (select wtis_1::type_io._WriteTypeInfoState 6) ds_index_2) (_ -> type_io.select_62 (select (type_io.select_70 (select wtis_1::type_io._WriteTypeInfoState 1) glob_module_3)::syntax._CommonDefs 6) ds_index_2)
<{type_io._c;258;15_98}> !basic_type_0 tcl_file_1 wtis_2 = case basic_type_0 (syntax.BT_Int -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 18) tcl_file_1) wtis_2) (syntax.BT_Char -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 19) tcl_file_1) wtis_2) (syntax.BT_Real -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 20) tcl_file_1) wtis_2) (syntax.BT_Bool -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 21) tcl_file_1) wtis_2) (syntax.BT_Dynamic -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 22) tcl_file_1) wtis_2) (syntax.BT_File -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 23) tcl_file_1) wtis_2) (syntax.BT_World -> _Tuple2 (StdFile.fwritec (StdChar.toChar_21 24) tcl_file_1) wtis_2) (syntax.BT_String type_1_0 -> let _x_2_0 = type_io.write_type_info_24 type_1_0 (StdFile.fwritec (StdChar.toChar_21 25) tcl_file_1) wtis_2 in _Tuple2 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.fold_st_83 !_x_0 !st_1 = case _x_0 (_predefined._Nil -> st_1) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_83 x_1_1 (type_io.normalize_atype_var a_1_0 st_1)) 
type_io.write_type_info_loop_85 !_x_0 tcl_file_1 wtis_2 = case _x_0 (_predefined._Nil -> _Tuple2 tcl_file_1 wtis_2) (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = type_io.write_type_info_15 x_1_0 tcl_file_1 wtis_2 in type_io.write_type_info_loop_85 xs_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_84 !l_0 !tcl_file_1 !wtis_2 = type_io.write_type_info_loop_85 l_0 (StdFile.fwritei (StdList.length_47 l_0) tcl_file_1) wtis_2
type_io.write_type_info_13 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._ConsDef cons_ident_1_0 cons_type_1_1 cons_priority_1_2 cons_number_1_3 cons_type_index_1_4 cons_exi_vars_1_5 cons_type_ptr_1_6 cons_pos_1_7 -> case wtis_2 (type_io._WriteTypeInfoState wtis_n_type_vars_2_0 wtis_common_defs_2_1 wtis_type_defs_2_2 wtis_type_heaps_2_3 wtis_var_heap_2_4 wtis_main_dcl_module_n_2_5 wtis_icl_generic_defs_2_6 -> let _x_3_0 = type_io.write_type_info_19 cons_ident_1_0 tcl_file_1 (update wtis_2::type_io._WriteTypeInfoState [3:update wtis_type_heaps_2_3::syntax._TypeHeaps [0:select (type_io.fold_st_83 cons_exi_vars_1_5 (_Tuple2 wtis_n_type_vars_2_0 (select wtis_type_heaps_2_3::syntax._TypeHeaps 0)))::_Tuple2 1]]), _x_3_1 = type_io.write_type_info_21 cons_type_1_1 (select _x_3_0::_Tuple2 0) (select _x_3_0::_Tuple2 1), _x_3_2 = type_io.write_type_info_28 cons_type_index_1_4 (select _x_3_1::_Tuple2 0) (select _x_3_1::_Tuple2 1), _x_3_3 = type_io.write_type_info_84 cons_exi_vars_1_5 (select _x_3_2::_Tuple2 0) (select _x_3_2::_Tuple2 1) in <{_Tuple2!3}> (select _x_3_3::_Tuple2 0) (select _x_3_3::_Tuple2 1)) ) 
type_io.fold_st_31 op_0 !_x_1 st_2 = case _x_1 (_predefined._Nil -> st_2) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_31 op_0 x_1_1 (op_0 a_1_0 st_2)) 
type_io.write_type_info_3 !_vArray_0 !_vWriteType_1 unboxed_array_2 !tcl_file_3 !wtis_4 = let s_unboxed_array_1_0::I = select _vArray_0::<{_SystemArray.Array;}> 4 unboxed_array_2 in type_io.write_type_info_of_array _vArray_0 _vWriteType_1 0 s_unboxed_array_1_0 unboxed_array_2 (StdFile.fwritei s_unboxed_array_1_0 tcl_file_3) wtis_4
type_io.anon_10::B !_x_0 !_x_1 = case _x_0 (syntax._DefinedSymbol _x_1_0 ds_arity_1_1 ds_index_1_2 -> case _x_1_0 (syntax._Ident id_name1_2_0 id_info_2_1 -> case _x_1 (syntax._DefinedSymbol _x_3_0 ds_arity_3_1 ds_index_3_2 -> case _x_3_0 (syntax._Ident id_name2_4_0 id_info_4_1 -> <{StdString.<_3}> id_name1_2_0 id_name2_4_0) ) ) ) 
type_io.write_type_info_18 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._DefinedSymbol ds_ident_1_0 ds_arity_1_1 ds_index_1_2 -> let _x_2_0 = type_io.write_type_info_19 ds_ident_1_0 tcl_file_1 wtis_2, _x_2_1 = type_io.write_type_info_28 ds_arity_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1), _x_2_2 = type_io.write_type_info_28 ds_index_1_2 (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_2::_Tuple2 0) (select _x_2_2::_Tuple2 1)) 
type_io.write_type_info_20 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._FieldSymbol fs_ident_1_0 fs_var_1_1 fs_index_1_2 -> type_io.write_type_info_19 fs_ident_1_0 tcl_file_1 wtis_2) 
type_io.write_type_info_of_array_89 !_vWriteType_0 !i_1::I !limit_2::I array_3 tcl_file_4 wtis_5 = case (<{StdInt.==_16}> i_1 limit_2) (True -> _Tuple2 tcl_file_4 wtis_5) (False -> let _x_2_0 = select _vWriteType_0::<{type_io.WriteTypeInfo;}> 0 (type_io.select_54 array_3 i_1) tcl_file_4 wtis_5 in type_io.write_type_info_of_array_89 _vWriteType_0 (<{StdInt.+_6}> i_1 StdInt.one_11) limit_2 array_3 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_88 !_vWriteType_0 !unboxed_array_1 !tcl_file_2 !wtis_3 = let s_unboxed_array_1_0::I = type_io.size_55 unboxed_array_1 in type_io.write_type_info_of_array_89 _vWriteType_0 0 s_unboxed_array_1_0 unboxed_array_1 (StdFile.fwritei s_unboxed_array_1_0 tcl_file_2) wtis_3
type_io.write_type_info_loop_87 !_x_0 tcl_file_1 wtis_2 = case _x_0 (_predefined._Nil -> _Tuple2 tcl_file_1 wtis_2) (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = type_io.write_type_info_18 x_1_0 tcl_file_1 wtis_2 in type_io.write_type_info_loop_87 xs_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_86 !l_0 !tcl_file_1 !wtis_2 = type_io.write_type_info_loop_87 l_0 (StdFile.fwritei (StdList.length_47 l_0) tcl_file_1) wtis_2
type_io.write_type_info_of_array_91 !i_0::I !limit_1::I array_2 tcl_file_3 wtis_4 = case (<{StdInt.==_16}> i_0 limit_1) (True -> _Tuple2 tcl_file_3 wtis_4) (False -> let _x_2_0 = type_io.write_type_info_20 (type_io.select_54 array_2 i_0) tcl_file_3 wtis_4 in type_io.write_type_info_of_array_91 (<{StdInt.+_6}> i_0 StdInt.one_11) limit_1 array_2 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_90 !unboxed_array_0 !tcl_file_1 !wtis_2 = let s_unboxed_array_1_0::I = type_io.size_55 unboxed_array_0 in type_io.write_type_info_of_array_91 0 s_unboxed_array_1_0 unboxed_array_0 (StdFile.fwritei s_unboxed_array_1_0 tcl_file_1) wtis_2
type_io.write_type_info_17 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax.AlgType defined_symbols_1_0 -> type_io.write_type_info_86 (StdOrdList.sortBy type_io.anon_10 defined_symbols_1_0) (StdFile.fwritec (StdChar.toChar_21 5) tcl_file_1) wtis_2) (syntax.SynType _x_1_0 -> <{_Tuple2!3}> (StdFile.fwritec (StdChar.toChar_21 6) tcl_file_1) wtis_2) (syntax.RecordType _x_1_0 -> case _x_1_0 (syntax._RecordType rt_constructor_2_0 rt_fields_2_1 rt_is_boxed_record_2_2 -> let !tcl_file_3_0 = StdFile.fwritec (StdChar.toChar_21 7) tcl_file_1, !_x_3_1 = type_io.write_type_info_18 rt_constructor_2_0 tcl_file_3_0 wtis_2 in type_io.write_type_info_90 rt_fields_2_1 (select _x_3_1::_Tuple2 0) (select _x_3_1::_Tuple2 1)) ) (syntax.AbstractType _x_1_0 -> let !tcl_file_2_0 = StdFile.fwritec (StdChar.toChar_21 8) tcl_file_1 in <{_Tuple2!3}> tcl_file_2_0 wtis_2) (syntax.AbstractSynType _x_1_0 _x_1_1 -> let !tcl_file_2_0 = StdFile.fwritec (StdChar.toChar_21 8) tcl_file_1 in <{_Tuple2!3}> tcl_file_2_0 wtis_2) (syntax.ExtensibleAlgType _x_1_0 -> <{_Tuple2!3}> tcl_file_1 wtis_2) (syntax.AlgConses _x_1_0 _x_1_1 -> <{_Tuple2!3}> tcl_file_1 wtis_2) (syntax.NewType _x_1_0 -> let !tcl_file_2_0 = StdFile.fwritec (StdChar.toChar_21 8) tcl_file_1 in <{_Tuple2!3}> tcl_file_2_0 wtis_2) 
type_io.fold_st_92 !_x_0 !st_1 = case _x_0 (_predefined._Nil -> st_1) (_predefined._Cons a_1_0 x_1_1 -> type_io.fold_st_92 x_1_1 (type_io.normalize_atype_var a_1_0 st_1)) 
type_io.write_type_info_14 !_x_0 !tcl_file_1 !wtis_2 = case _x_0 (syntax._TypeDef td_ident_1_0 td_index_1_1 td_arity_1_2 td_args_1_3 td_attrs_1_4 td_rhs_1_5 td_attribute_1_6 td_pos_1_7 td_used_types_1_8 td_fun_index_1_9 -> case wtis_2 (type_io._WriteTypeInfoState wtis_n_type_vars_2_0 wtis_common_defs_2_1 wtis_type_defs_2_2 wtis_type_heaps_2_3 wtis_var_heap_2_4 wtis_main_dcl_module_n_2_5 wtis_icl_generic_defs_2_6 -> case (StdBool.not (<{StdInt.==_16}> td_fun_index_1_9 -1)) (True -> let _x_4_0 = type_io.fold_st_92 td_args_1_3 (_Tuple2 0 (select wtis_type_heaps_2_3::syntax._TypeHeaps 0)), _x_4_1 = type_io.write_type_info_19 td_ident_1_0 tcl_file_1 (update wtis_2::type_io._WriteTypeInfoState [0:select _x_4_0::_Tuple2 0,3:update wtis_type_heaps_2_3::syntax._TypeHeaps [0:select _x_4_0::_Tuple2 1]]), _x_4_2 = type_io.write_type_info_28 td_arity_1_2 (select _x_4_1::_Tuple2 0) (select _x_4_1::_Tuple2 1), _x_4_3 = type_io.write_type_info_84 td_args_1_3 (select _x_4_2::_Tuple2 0) (select _x_4_2::_Tuple2 1) in type_io.write_type_info_17 td_rhs_1_5 (select _x_4_3::_Tuple2 0) (select _x_4_3::_Tuple2 1)) (False -> let _x_4_0 = select td_rhs_1_5::_Tuple1 0, _x_4_1 = type_io.fold_st_92 td_args_1_3 (_Tuple2 0 (select wtis_type_heaps_2_3::syntax._TypeHeaps 0)), _x_4_2 = type_io.write_type_info_19 td_ident_1_0 tcl_file_1 (update wtis_2::type_io._WriteTypeInfoState [0:select _x_4_1::_Tuple2 0,3:update wtis_type_heaps_2_3::syntax._TypeHeaps [0:select _x_4_1::_Tuple2 1]]), _x_4_3 = type_io.write_type_info_28 td_arity_1_2 (select _x_4_2::_Tuple2 0) (select _x_4_2::_Tuple2 1), _x_4_4 = type_io.write_type_info_84 td_args_1_3 (select _x_4_3::_Tuple2 0) (select _x_4_3::_Tuple2 1), _x_4_5 = type_io.write_type_info_18 (select _x_4_0::syntax._RecordType 0) (StdFile.fwritec '%' (select _x_4_4::_Tuple2 0)) (select _x_4_4::_Tuple2 1) in type_io.write_type_info_90 (select _x_4_0::syntax._RecordType 1) (select _x_4_5::_Tuple2 0) (select _x_4_5::_Tuple2 1)) ) ) 
type_io.write_type_info_of_array_93 !_vWriteType_0 !i_1::I !limit_2::I array_3 tcl_file_4 wtis_5 = case (<{StdInt.==_16}> i_1 limit_2) (True -> _Tuple2 tcl_file_4 wtis_5) (False -> let _x_2_0 = select _vWriteType_0::<{type_io.WriteTypeInfo;}> 0 (type_io.select_38 array_3 i_1) tcl_file_4 wtis_5 in type_io.write_type_info_of_array_93 _vWriteType_0 (<{StdInt.+_6}> i_1 StdInt.one_11) limit_2 array_3 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_of_array_94 !_vWriteType_0 !i_1::I !limit_2::I array_3 tcl_file_4 wtis_5 = case (<{StdInt.==_16}> i_1 limit_2) (True -> _Tuple2 tcl_file_4 wtis_5) (False -> let _x_2_0 = select _vWriteType_0::<{type_io.WriteTypeInfo;}> 0 (type_io.select_46 array_3 i_1) tcl_file_4 wtis_5 in type_io.write_type_info_of_array_94 _vWriteType_0 (<{StdInt.+_6}> i_1 StdInt.one_11) limit_2 array_3 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_of_array_95 !i_0::I !limit_1::I array_2 tcl_file_3 wtis_4 = case (<{StdInt.==_16}> i_0 limit_1) (True -> _Tuple2 tcl_file_3 wtis_4) (False -> let _x_2_0 = type_io.write_type_info_14 (type_io.select_38 array_2 i_0) tcl_file_3 wtis_4 in type_io.write_type_info_of_array_95 (<{StdInt.+_6}> i_0 StdInt.one_11) limit_1 array_2 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_of_array_96 !i_0::I !limit_1::I array_2 tcl_file_3 wtis_4 = case (<{StdInt.==_16}> i_0 limit_1) (True -> _Tuple2 tcl_file_3 wtis_4) (False -> let _x_2_0 = type_io.write_type_info_13 (type_io.select_46 array_2 i_0) tcl_file_3 wtis_4 in type_io.write_type_info_of_array_96 (<{StdInt.+_6}> i_0 StdInt.one_11) limit_1 array_2 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_of_types_and_constructors !_x_0 !n_types_with_type_functions_1::I !n_constructors_with_type_functions_2::I !tcl_file_3 !wtis_4 = case _x_0 (syntax._CommonDefs com_type_defs_1_0 com_cons_defs_1_1 com_selector_defs_1_2 com_class_defs_1_3 com_member_defs_1_4 com_instance_defs_1_5 com_generic_defs_1_6 com_gencase_defs_1_7 -> let _x_2_0 = type_io.write_type_info_of_array_95 0 n_types_with_type_functions_1 com_type_defs_1_0 (StdFile.fwritei n_types_with_type_functions_1 tcl_file_3) wtis_4 in type_io.write_type_info_of_array_96 0 n_constructors_with_type_functions_2 com_cons_defs_1_1 (StdFile.fwritei n_constructors_with_type_functions_2 (select _x_2_0::_Tuple2 0)) (select _x_2_0::_Tuple2 1)) 
type_io.write_type_info_1 !c_0::C !tcl_file_1 !wtis_2 = <{_Tuple2!3}> (StdFile.fwritec c_0 tcl_file_1) wtis_2
type_io.write_type_info_29 !_vWriteType_0 !_vWriteType_1 !_x_2 !tcl_file_3 !wtis_4 = case _x_2 (_Tuple2 c1_1_0 c2_1_1 -> let _x_2_0 = select _vWriteType_0::<{type_io.WriteTypeInfo;}> 0 c1_1_0 tcl_file_3 wtis_4, _x_2_1 = select _vWriteType_1::<{type_io.WriteTypeInfo;}> 0 c2_1_1 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1)) 
<{type_io.TD;WriteTypeInfoState}> _x_0::B = _predefined._Nil
<{type_io.TD;WriteTypeInfo;}> _x_0::B = _predefined._Nil


|| Converted Records
:: type_io._WriteTypeInfoState = {!type_io.wtis_n_type_vars::I, !type_io.wtis_common_defs, !type_io.wtis_type_defs, !type_io.wtis_type_heaps, !type_io.wtis_var_heap, !type_io.wtis_main_dcl_module_n::I, !type_io.wtis_icl_generic_defs}

:: <{type_io.WriteTypeInfo;}> = {!type_io.write_type_info}

