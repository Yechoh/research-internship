|| ?module? iTasks.Internal.WebService


iTasks.Internal.WebService.onConnect_33 host_0 r_1 !iworld_2 = case iworld_2 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTIdle host_0 (select clocks_1_2::iTasks.Internal.IWorld._SystemClocks 0))) Data.Maybe.Nothing _predefined._Nil False (update iworld_2::iTasks.Internal.IWorld._IWorld [12:world_1_12])) 
iTasks.Internal.WebService.selectHandler_38 req_0 !_x_1 = case _x_1 (_predefined._Nil -> Data.Maybe.Nothing) (_predefined._Cons h_1_0 hs_1_1 -> case (select h_1_0::iTasks.Internal.WebService._WebService 0 (select req_0::Internet.HTTP._HTTPRequest 1)) (True -> Data.Maybe.Just h_1_0) (False -> iTasks.Internal.WebService.selectHandler_38 req_0 hs_1_1) ) 
<{iTasks.Internal.WebService.get`_86}> !<{_v<_0}> _x_1 !_x_2 = case _x_2 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 _x_1 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_86}> <{_v<_0}> _x_1 l_1_3) (False -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 kx_1_1 _x_1) (True -> <{iTasks.Internal.WebService.get`_86}> <{_v<_0}> _x_1 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
iTasks.Internal.WebService.anon_31::B !h_0 = <{StdString.==_2}> (Text.toLowerCase_17 h_0) "keep-alive"
<{iTasks.Internal.WebService.get`_443}> _x_0 !_x_1 = case _x_1 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (<{StdString.<_3}> _x_0 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_443}> _x_0 l_1_3) (False -> case (<{StdString.<_3}> kx_1_1 _x_0) (True -> <{iTasks.Internal.WebService.get`_443}> _x_0 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
iTasks.Internal.WebService.isKeepAlive_39::B !request_0 = Data.Maybe.maybe (<{StdString.==_2}> (select request_0::Internet.HTTP._HTTPRequest 3) "HTTP/1.1") iTasks.Internal.WebService.anon_31 (<{iTasks.Internal.WebService.get`_443}> "Connection" (select request_0::Internet.HTTP._HTTPRequest 5))
iTasks.Internal.WebService.addDefault_32 !<{_v==_0}> headers_1 hdr_2 val_3 = case (<{iTasks.Internal.WebService._c;252;71_474}> (Data.List.lookup <{_v==_0}> hdr_2 headers_1)) (True -> _predefined._Cons (_Tuple2 hdr_2 val_3) headers_1) (False -> headers_1) 
<{iTasks.Internal.WebService._c;252;71_474}>::B !_x_0 = case _x_0 (Data.Maybe.Nothing -> True) (_ -> False)
iTasks.Internal.WebService.addDefault_444 headers_0 hdr_1 val_2 = case (<{iTasks.Internal.WebService._c;252;71_475}> (Data.List.lookup (<{StdOverloaded.==;}> <{StdString.==_2}>) hdr_1 headers_0)) (True -> _predefined._Cons (_Tuple2 hdr_1 val_2) headers_0) (False -> headers_0) 
<{iTasks.Internal.WebService._c;252;71_475}>::B !_x_0 = case _x_0 (Data.Maybe.Nothing -> True) (_ -> False)
iTasks.Internal.WebService.encodeResponse_40 autoContentLength_0::B !response_1 = case response_1 (Internet.HTTP._HTTPResponse rsp_version_1_0 rsp_code_1_1 rsp_reason_1_2 rsp_headers_1_3 rsp_data_1_4 -> Internet.HTTP.toString_19 (update response_1::Internet.HTTP._HTTPResponse [3:<{iTasks.Internal.WebService._if;247;25_476}> autoContentLength_0 rsp_headers_1_3 rsp_data_1_4])) 
<{iTasks.Internal.WebService._if;247;25_476}> !autoContentLength_0::B rsp_headers_1 rsp_data_2 = case autoContentLength_0 (True -> iTasks.Internal.WebService.addDefault_444 (iTasks.Internal.WebService.addDefault_444 (iTasks.Internal.WebService.addDefault_444 rsp_headers_1 "Server" "iTasks HTTP Server") "Content-Type" "text/html") "Content-Length" (StdString.toString_5 (_SystemArray.size_20 rsp_data_2))) (_ -> iTasks.Internal.WebService.addDefault_444 (iTasks.Internal.WebService.addDefault_444 rsp_headers_1 "Server" "iTasks HTTP Server") "Content-Type" "text/html")
iTasks.Internal.WebService.onData_34 port_0::I requestProcessHandlers_1 data_2 !connState_3 r_4 env_5 = case connState_3 (iTasks.Internal.WebService.NTProcessingRequest request_1_0 localState_1_1 -> <{iTasks.Internal.WebService._c;140;11_477}> (iTasks.Internal.WebService.selectHandler_38 request_1_0 requestProcessHandlers_1) request_1_0 r_4 data_2 localState_1_1 env_5 connState_3) (_ -> case env_5 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> let rstate_2_0 = <{iTasks.Internal.WebService._c;151;20_478}> connState_3 port_0 data_2 in case (select rstate_2_0::iTasks.Internal.WebService._HttpReqState 4) (True -> _Tuple5 (Data.Error.Ok connState_3) Data.Maybe.Nothing (_predefined._Cons "HTTP/1.1 400 Bad Request\r\n\r\n" _predefined._Nil) True env_5) (False -> case (StdBool.not (select rstate_2_0::iTasks.Internal.WebService._HttpReqState 2)) (True -> _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTReadingRequest rstate_2_0)) Data.Maybe.Nothing _predefined._Nil False env_5) (False -> <{iTasks.Internal.WebService._c;170;11_484}> (iTasks.Internal.WebService.selectHandler_38 (select rstate_2_0::iTasks.Internal.WebService._HttpReqState 0) requestProcessHandlers_1) connState_3 env_5 rstate_2_0 r_4 clocks_1_2) ) ) )
<{iTasks.Internal.WebService._c;170;11_484}> !_x_0 connState_1 env_2 rstate_3 r_4 clocks_5 = case _x_0 (Data.Maybe.Nothing -> _Tuple5 (Data.Error.Ok connState_1) Data.Maybe.Nothing (_predefined._Cons "HTTP/1.1 404 Not Found\r\n\r\n" _predefined._Nil) True env_2) (Data.Maybe.Just _x_1_0 -> case _x_1_0 (iTasks.Internal.WebService._WebService urlMatchPred_2_0 completeRequest_2_1 onNewReq_2_2 onData_2_3 onShareChange_2_4 onTick_2_5 onDisconnect_2_6 -> case (case (select rstate_3::iTasks.Internal.WebService._HttpReqState 3) (True -> True) (False -> StdBool.not completeRequest_2_1) ) (True -> let request_4_0 = <{iTasks.Internal.WebService._if;176;35_479}> completeRequest_2_1 rstate_3, _x_4_1 = onNewReq_2_2 request_4_0 r_4 env_2, iworld_4_2 = select _x_4_1::_Tuple4 3, mbW_4_3 = select _x_4_1::_Tuple4 2, response_4_4 = select _x_4_1::_Tuple4 0 in <{iTasks.Internal.WebService._c;184;23_483}> (select _x_4_1::_Tuple4 1) request_4_0 rstate_3 clocks_5 mbW_4_3 response_4_4 iworld_4_2 connState_1) (False -> _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTReadingRequest rstate_3)) Data.Maybe.Nothing _predefined._Nil False env_2) ) ) 
<{iTasks.Internal.WebService._c;184;23_483}> !_x_0 request_1 rstate_2 clocks_3 mbW_4 response_5 iworld_6 connState_7 = case _x_0 (Data.Maybe.Nothing -> let keepalive_2_0::B = iTasks.Internal.WebService.isKeepAlive_39 request_1 in case keepalive_2_0 (True -> _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTIdle (select (select rstate_2::iTasks.Internal.WebService._HttpReqState 0)::Internet.HTTP._HTTPRequest 13) (select clocks_3::iTasks.Internal.IWorld._SystemClocks 0))) mbW_4 (_predefined._Cons (iTasks.Internal.WebService.encodeResponse_40 True (<{iTasks.Internal.WebService._if;182;35_480}> keepalive_2_0 response_5)) _predefined._Nil) False iworld_6) (False -> _Tuple5 (Data.Error.Ok connState_7) mbW_4 (_predefined._Cons (iTasks.Internal.WebService.encodeResponse_40 True (<{iTasks.Internal.WebService._if;182;35_481}> keepalive_2_0 response_5)) _predefined._Nil) True iworld_6) ) (Data.Maybe.Just localState_1_0 -> _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTProcessingRequest request_1 localState_1_0)) mbW_4 (_predefined._Cons (iTasks.Internal.WebService.encodeResponse_40 False (<{iTasks.Internal.WebService._if;182;35_482}> (iTasks.Internal.WebService.isKeepAlive_39 request_1) response_5)) _predefined._Nil) False iworld_6) 
<{iTasks.Internal.WebService._if;182;35_482}> !_x_0::B !response_1 = case _x_0 (True -> update response_1::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Connection" "Keep-Alive") (select response_1::Internet.HTTP._HTTPResponse 3)]) (_ -> response_1)
<{iTasks.Internal.WebService._if;182;35_481}> !keepalive_0::B !response_1 = case keepalive_0 (True -> update response_1::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Connection" "Keep-Alive") (select response_1::Internet.HTTP._HTTPResponse 3)]) (_ -> response_1)
<{iTasks.Internal.WebService._if;182;35_480}> !keepalive_0::B !response_1 = case keepalive_0 (True -> update response_1::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Connection" "Keep-Alive") (select response_1::Internet.HTTP._HTTPResponse 3)]) (_ -> response_1)
<{iTasks.Internal.WebService._if;176;35_479}> !completeRequest_0::B !rstate_1 = case completeRequest_0 (True -> iTasks.Internal.HttpUtil.http_parseArguments (select rstate_1::iTasks.Internal.WebService._HttpReqState 0)) (_ -> select rstate_1::iTasks.Internal.WebService._HttpReqState 0)
<{iTasks.Internal.WebService._c;151;20_478}> !connState_0 port_1::I data_2 = case connState_0 (iTasks.Internal.WebService.NTIdle client_name_1_0 _x_1_1 -> let _x_2_0 = iTasks.Internal.HttpUtil.http_addRequestData (update Internet.HTTP.newHTTPRequest::Internet.HTTP._HTTPRequest [12:port_1,13:client_name_1_0]) False False False data_2 in iTasks.Internal.WebService._HttpReqState (select _x_2_0::_Tuple5 0) (select _x_2_0::_Tuple5 1) (select _x_2_0::_Tuple5 2) (select _x_2_0::_Tuple5 3) (select _x_2_0::_Tuple5 4)) (iTasks.Internal.WebService.NTReadingRequest _x_1_0 -> case _x_1_0 (iTasks.Internal.WebService._HttpReqState request_2_0 method_done_2_1 headers_done_2_2 data_done_2_3 error_2_4 -> let _x_3_0 = iTasks.Internal.HttpUtil.http_addRequestData request_2_0 method_done_2_1 headers_done_2_2 data_done_2_3 (StdString.toString_9 data_2) in iTasks.Internal.WebService._HttpReqState (select _x_3_0::_Tuple5 0) (select _x_3_0::_Tuple5 1) (select _x_3_0::_Tuple5 2) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 4)) ) (_ -> iTasks.Internal.WebService._HttpReqState Internet.HTTP.newHTTPRequest False False False True)
<{iTasks.Internal.WebService._c;140;11_477}> !_x_0 request_1 r_2 data_3 localState_4 env_5 connState_6 = case _x_0 (Data.Maybe.Just _x_1_0 -> case _x_1_0 (iTasks.Internal.WebService._WebService urlMatchPred_2_0 completeRequest_2_1 onNewReq_2_2 onData_2_3 onShareChange_2_4 onTick_2_5 onDisconnect_2_6 -> let _x_3_0::B = onData_2_3 request_1 r_2 data_3 localState_4 env_5, done_3_1 = select _x_3_0::_Tuple5 1 in case (case done_3_1 (True -> iTasks.Internal.WebService.isKeepAlive_39 request_1) (False -> False) ) (True -> let env_5_0 = select _x_3_0::_Tuple5 4 in _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTIdle (select request_1::Internet.HTTP._HTTPRequest 13) (select (select env_5_0::iTasks.Internal.IWorld._IWorld 2)::iTasks.Internal.IWorld._SystemClocks 0))) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 0) False (update env_5_0::iTasks.Internal.IWorld._IWorld [12:select env_5_0::iTasks.Internal.IWorld._IWorld 12])) (False -> let env_5_0 = select _x_3_0::_Tuple5 4 in _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTProcessingRequest request_1 (select _x_3_0::_Tuple5 2))) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 0) done_3_1 (update env_5_0::iTasks.Internal.IWorld._IWorld [12:select env_5_0::iTasks.Internal.IWorld._IWorld 12])) ) ) (Data.Maybe.Nothing -> _Tuple5 (Data.Error.Ok connState_6) Data.Maybe.Nothing (_predefined._Cons "HTTP/1.1 400 Bad Request\r\n\r\n" _predefined._Nil) True env_5) 
iTasks.Internal.WebService.onShareChange_36 requestProcessHandlers_0 !connState_1 r_2 env_3 = case connState_1 (iTasks.Internal.WebService.NTProcessingRequest request_1_0 localState_1_1 -> <{iTasks.Internal.WebService._c;215;11_485}> (iTasks.Internal.WebService.selectHandler_38 request_1_0 requestProcessHandlers_0) request_1_0 r_2 localState_1_1 env_3 connState_1) (_ -> _Tuple5 (Data.Error.Ok connState_1) Data.Maybe.Nothing _predefined._Nil False env_3)
<{iTasks.Internal.WebService._c;215;11_485}> !_x_0 request_1 r_2 localState_3 env_4 connState_5 = case _x_0 (Data.Maybe.Just _x_1_0 -> case _x_1_0 (iTasks.Internal.WebService._WebService urlMatchPred_2_0 completeRequest_2_1 onNewReq_2_2 onData_2_3 onShareChange_2_4 onTick_2_5 onDisconnect_2_6 -> let _x_3_0::B = onShareChange_2_4 request_1 r_2 localState_3 env_4, done_3_1 = select _x_3_0::_Tuple5 1 in case (case done_3_1 (True -> iTasks.Internal.WebService.isKeepAlive_39 request_1) (False -> False) ) (True -> let env_5_0 = select _x_3_0::_Tuple5 4 in _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTIdle (select request_1::Internet.HTTP._HTTPRequest 13) (select (select env_5_0::iTasks.Internal.IWorld._IWorld 2)::iTasks.Internal.IWorld._SystemClocks 0))) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 0) False (update env_5_0::iTasks.Internal.IWorld._IWorld [12:select env_5_0::iTasks.Internal.IWorld._IWorld 12])) (False -> let env_5_0 = select _x_3_0::_Tuple5 4 in _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTProcessingRequest request_1 (select _x_3_0::_Tuple5 2))) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 0) done_3_1 (update env_5_0::iTasks.Internal.IWorld._IWorld [12:select env_5_0::iTasks.Internal.IWorld._IWorld 12])) ) ) (Data.Maybe.Nothing -> _Tuple5 (Data.Error.Ok connState_5) Data.Maybe.Nothing (_predefined._Cons "HTTP/1.1 400 Bad Request\r\n\r\n" _predefined._Nil) True env_4) 
iTasks.Internal.WebService.onTick_35 requestProcessHandlers_0 keepAliveTime_1::I !connState_2 r_3 iworld_4 = case connState_2 (iTasks.Internal.WebService.NTIdle ip_1_0 _x_1_1 -> case _x_1_1 (System.Time.Timestamp t_2_0 -> case iworld_4 (iTasks.Internal.IWorld._IWorld server_3_0 config_3_1 clocks_3_2 current_3_3 random_3_4 sdsNotifyRequests_3_5 memoryShares_3_6 cachedShares_3_7 exposedShares_3_8 jsCompilerState_3_9 ioTasks_3_10 ioStates_3_11 world_3_12 resources_3_13 onClient_3_14 shutdown_3_15 -> case clocks_3_2 (iTasks.Internal.IWorld._SystemClocks _x_4_0 localDate_4_1 localTime_4_2 utcDate_4_3 utcTime_4_4 -> case _x_4_0 (System.Time.Timestamp now_5_0 -> _Tuple5 (Data.Error.Ok connState_2) Data.Maybe.Nothing _predefined._Nil (StdBool.not (<{StdInt.<_17}> now_5_0 (<{StdInt.+_6}> t_2_0 keepAliveTime_1))) iworld_4) ) ) ) ) (iTasks.Internal.WebService.NTProcessingRequest request_1_0 localState_1_1 -> <{iTasks.Internal.WebService._c;202;11_486}> (iTasks.Internal.WebService.selectHandler_38 request_1_0 requestProcessHandlers_0) request_1_0 r_3 localState_1_1 iworld_4 connState_2) (_ -> _Tuple5 (Data.Error.Ok connState_2) Data.Maybe.Nothing _predefined._Nil False iworld_4)
<{iTasks.Internal.WebService._c;202;11_486}> !_x_0 request_1 r_2 localState_3 iworld_4 connState_5 = case _x_0 (Data.Maybe.Just _x_1_0 -> case _x_1_0 (iTasks.Internal.WebService._WebService urlMatchPred_2_0 completeRequest_2_1 onNewReq_2_2 onData_2_3 onShareChange_2_4 onTick_2_5 onDisconnect_2_6 -> let _x_3_0::B = onTick_2_5 request_1 r_2 localState_3 iworld_4, done_3_1 = select _x_3_0::_Tuple5 1 in case (case done_3_1 (True -> iTasks.Internal.WebService.isKeepAlive_39 request_1) (False -> False) ) (True -> let env_5_0 = select _x_3_0::_Tuple5 4 in _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTIdle (select request_1::Internet.HTTP._HTTPRequest 13) (select (select env_5_0::iTasks.Internal.IWorld._IWorld 2)::iTasks.Internal.IWorld._SystemClocks 0))) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 0) False (update env_5_0::iTasks.Internal.IWorld._IWorld [12:select env_5_0::iTasks.Internal.IWorld._IWorld 12])) (False -> let env_5_0 = select _x_3_0::_Tuple5 4 in _Tuple5 (Data.Error.Ok (iTasks.Internal.WebService.NTProcessingRequest request_1 (select _x_3_0::_Tuple5 2))) (select _x_3_0::_Tuple5 3) (select _x_3_0::_Tuple5 0) done_3_1 (update env_5_0::iTasks.Internal.IWorld._IWorld [12:select env_5_0::iTasks.Internal.IWorld._IWorld 12])) ) ) (Data.Maybe.Nothing -> _Tuple5 (Data.Error.Ok connState_5) Data.Maybe.Nothing (_predefined._Cons "HTTP/1.1 400 Bad Request\r\n\r\n" _predefined._Nil) True iworld_4) 
iTasks.Internal.WebService.onDisconnect_37 requestProcessHandlers_0 !connState_1 r_2 env_3 = case connState_1 (iTasks.Internal.WebService.NTProcessingRequest request_1_0 localState_1_1 -> <{iTasks.Internal.WebService._c;230;11_487}> (iTasks.Internal.WebService.selectHandler_38 request_1_0 requestProcessHandlers_0) connState_1 env_3 request_1_0 r_2 localState_1_1) (_ -> _Tuple3 (Data.Error.Ok connState_1) Data.Maybe.Nothing env_3)
<{iTasks.Internal.WebService._c;230;11_487}> !_x_0 connState_1 env_2 request_3 r_4 localState_5 = case _x_0 (Data.Maybe.Nothing -> _Tuple3 (Data.Error.Ok connState_1) Data.Maybe.Nothing env_2) (Data.Maybe.Just _x_1_0 -> case _x_1_0 (iTasks.Internal.WebService._WebService urlMatchPred_2_0 completeRequest_2_1 onNewReq_2_2 onData_2_3 onShareChange_2_4 onTick_2_5 onDisconnect_2_6 -> let _x_3_0 = onDisconnect_2_6 request_3 r_4 localState_5 env_2 in _Tuple3 (Data.Error.Ok connState_1) (select _x_3_0::_Tuple2 0) (select _x_3_0::_Tuple2 1)) ) 
iTasks.Internal.WebService.httpServer !_vTC_0 !_vTC_1 !port_2::I !keepAliveTime_3::I !requestProcessHandlers_4 sds_5 = iTasks.Internal.Task.wrapIWorldConnectionTask (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{iTasks.Internal.WebService.TD;NetTaskState}>)) _vTC_0 _vTC_1 (iTasks.Internal.Task._ConnectionHandlersIWorld iTasks.Internal.WebService.onConnect_33 (iTasks.Internal.WebService.onData_34 port_2 requestProcessHandlers_4) (iTasks.Internal.WebService.onShareChange_36 requestProcessHandlers_4) (iTasks.Internal.WebService.onTick_35 requestProcessHandlers_4 keepAliveTime_3) (iTasks.Internal.WebService.onDisconnect_37 requestProcessHandlers_4)) sds_5
<{iTasks.Internal.WebService.c;257;60_41}> !g_l_0 = <{iTasks.Internal.WebService.g_c1;257;83_489}> g_l_0
<{iTasks.Internal.WebService.g_c1;257;83_489}> !g_l_0 = case g_l_0 (_predefined._Cons g_h_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.g_c2;257;83_488}> g_h_1_0 g_t_1_1) (_ -> _predefined._Nil)
<{iTasks.Internal.WebService.g_c2;257;83_488}> !g_h_0 g_t_1 = case g_h_0 (iTasks.Internal.Engine._PublishedTask url_1_0 task_1_1 -> _predefined._Cons url_1_0 (<{iTasks.Internal.WebService.c;257;60_41}> g_t_1)) (_ -> <{iTasks.Internal.WebService.c;257;60_41}> g_t_1)
iTasks.Internal.WebService.uiUrl_59 !matchUrl_0 = <{StdString.+++_11}> (<{iTasks.Internal.WebService._if;357;23_490}> (Text.endsWith_3 "/" matchUrl_0) matchUrl_0) "gui-wsock"
<{iTasks.Internal.WebService._if;357;23_490}> !_x_0::B !matchUrl_1 = case _x_0 (True -> matchUrl_1) (_ -> <{StdString.+++_11}> matchUrl_1 "/")
<{iTasks.Internal.WebService.c;267;62_42}> reqUrl_0 !g_l_1 = <{iTasks.Internal.WebService.g_c1;267;74_491}> g_l_1 reqUrl_0
<{iTasks.Internal.WebService.g_c1;267;74_491}> !g_l_0 reqUrl_1 = case g_l_0 (_predefined._Cons matchUrl_1_0 g_t_1_1 -> _predefined._Cons (<{StdString.==_2}> reqUrl_1 (iTasks.Internal.WebService.uiUrl_59 matchUrl_1_0)) (<{iTasks.Internal.WebService.c;267;62_42}> reqUrl_1 g_t_1_1)) (_ -> _predefined._Nil)
iTasks.Internal.WebService.matchFun_51::B !matchUrls_0 reqUrl_1 = StdList.or (<{iTasks.Internal.WebService.c;267;62_42}> reqUrl_1 matchUrls_0)
<{iTasks.Internal.WebService.get`_96}> !<{_v<_0}> _x_1 !_x_2 = case _x_2 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 _x_1 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_96}> <{_v<_0}> _x_1 l_1_3) (False -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 kx_1_1 _x_1) (True -> <{iTasks.Internal.WebService.get`_96}> <{_v<_0}> _x_1 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
<{iTasks.Internal.WebService.get`_95}> !<{_v<_0}> _x_1 !_x_2 = case _x_2 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 _x_1 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_95}> <{_v<_0}> _x_1 l_1_3) (False -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 kx_1_1 _x_1) (True -> <{iTasks.Internal.WebService.get`_95}> <{_v<_0}> _x_1 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
<{iTasks.Internal.WebService.get`_94}> !<{_v<_0}> _x_1 !_x_2 = case _x_2 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 _x_1 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_94}> <{_v<_0}> _x_1 l_1_3) (False -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 kx_1_1 _x_1) (True -> <{iTasks.Internal.WebService.get`_94}> <{_v<_0}> _x_1 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
iTasks.Internal.WebService.wsockHandShake key_0 = Text.Encodings.Base64.base64Encode (select (Crypto.Hash.SHA1.sha1StringDigest (<{StdString.+++_11}> key_0 "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"))::_Tuple1 0)
<{iTasks.Internal.WebService.get`_447}> _x_0 !_x_1 = case _x_1 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (<{StdString.<_3}> _x_0 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_447}> _x_0 l_1_3) (False -> case (<{StdString.<_3}> kx_1_1 _x_0) (True -> <{iTasks.Internal.WebService.get`_447}> _x_0 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
<{iTasks.Internal.WebService.get`_446}> _x_0 !_x_1 = case _x_1 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (<{StdString.<_3}> _x_0 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_446}> _x_0 l_1_3) (False -> case (<{StdString.<_3}> kx_1_1 _x_0) (True -> <{iTasks.Internal.WebService.get`_446}> _x_0 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
<{iTasks.Internal.WebService.get`_445}> _x_0 !_x_1 = case _x_1 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (<{StdString.<_3}> _x_0 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_445}> _x_0 l_1_3) (False -> case (<{StdString.<_3}> kx_1_1 _x_0) (True -> <{iTasks.Internal.WebService.get`_445}> _x_0 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
iTasks.Internal.WebService.reqFun_53 taskUrls_0 !req_1 output_2 !iworld_3 = case iworld_3 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> case server_1_0 (iTasks.Internal.IWorld._ServerInfo serverName_2_0 serverURL_2_1 build_2_2 paths_2_3 -> case (iTasks.Internal.WebService._f493_493 (<{iTasks.Internal.WebService._c;275;79_492}> (<{iTasks.Internal.WebService.get`_445}> "Upgrade" (select req_1::Internet.HTTP._HTTPRequest 5))) req_1) (True -> _Tuple4 (update (Internet.HTTP.newHTTPResponse 101 "Switching Protocols")::Internet.HTTP._HTTPResponse [0:"HTTP/1.1",3:_predefined._Cons (_Tuple2 "Upgrade" "websocket") (_predefined._Cons (_Tuple2 "Connection" "Upgrade") (_predefined._Cons (_Tuple2 "Sec-WebSocket-Accept" (iTasks.Internal.WebService.wsockHandShake (Text.trim_19 (Data.Maybe.fromJust (<{iTasks.Internal.WebService.get`_447}> "Sec-WebSocket-Key" (select req_1::Internet.HTTP._HTTPRequest 5)))))) _predefined._Nil)),4:""]) (Data.Maybe.Just (_Tuple3 (select req_1::Internet.HTTP._HTTPRequest 13) (iTasks.Internal.WebService._WebSockState "" True _predefined._Nil) _predefined._Nil)) Data.Maybe.Nothing iworld_3) (False -> _Tuple4 (Internet.HTTP.errorResponse "Requested service format not available for this task") Data.Maybe.Nothing Data.Maybe.Nothing iworld_3) ) ) 
iTasks.Internal.WebService._f493_493::B !_x_0::B req_1 = case _x_0 (True -> Data.Maybe.isJust (<{iTasks.Internal.WebService.get`_446}> "Sec-WebSocket-Key" (select req_1::Internet.HTTP._HTTPRequest 5))) (_ -> False)
<{iTasks.Internal.WebService._c;275;79_492}>::B !_x_0 = case _x_0 (Data.Maybe.Just _x_1_0 -> case _x_1_0 ("websocket" -> True) ) (_ -> False)
<{iTasks.Internal.WebService.reqFun`_52}> taskUrls_0 !req_1 output_2 !iworld_3 = case iworld_3 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> iTasks.Internal.WebService.reqFun_53 taskUrls_0 req_1 output_2 (update iworld_3::iTasks.Internal.IWorld._IWorld [0:update server_1_0::iTasks.Internal.IWorld._ServerInfo [1:<{StdString.+++_11}> "//" (<{StdString.+++_11}> (select req_1::Internet.HTTP._HTTPRequest 11) (<{StdString.+++_11}> ":" (StdString.toString_5 (select req_1::Internet.HTTP._HTTPRequest 12))))]])) 
iTasks.Internal.WebService.foldr_93 op_0 r_1 !_x_2 = case _x_2 (_predefined._Nil -> r_1) (_predefined._Cons a_1_0 x_1_1 -> op_0 a_1_0 (iTasks.Internal.WebService.foldr_93 op_0 r_1 x_1_1)) 
<{iTasks.Internal.WebService.c;100;73_19}> !_vArray_0 data_1 !b_2::I !g_s_3::I i_4::I g_s_5::I = case (StdBool.not (<{StdInt.<_17}> g_s_3 b_2)) (True -> case (StdBool.not (<{StdInt.<_17}> g_s_5 i_4)) (True -> _predefined._Cons (<{StdInt.<<}> (StdChar.fromChar_22 (select _vArray_0::<{_SystemArray.Array;}> 3 data_1 b_2)) (<{StdInt.*_9}> i_4 8)) (<{iTasks.Internal.WebService.c;100;73_19}> _vArray_0 data_1 (<{StdInt.+_6}> b_2 StdInt.one_11) g_s_3 (<{StdInt.+_6}> i_4 StdInt.one_11) g_s_5)) (False -> _predefined._Nil) ) (False -> _predefined._Nil) 
iTasks.Internal.WebService.foldr_448::I !r_0::I !_x_1 = case _x_1 (_predefined._Nil -> r_0) (_predefined._Cons a_1_0 x_1_1 -> <{StdInt.+_6}> a_1_0 (iTasks.Internal.WebService.foldr_448 r_0 x_1_1)) 
iTasks.Internal.WebService.payloadLen_22 !_vArray_0 data_1 = let len_1_0::I = StdInt.bitand (StdChar.fromChar_22 (select _vArray_0::<{_SystemArray.Array;}> 3 data_1 1)) 127 in case (<{StdInt.==_16}> len_1_0 126) (True -> _Tuple2 (<{StdInt.+_6}> (<{StdInt.<<}> (StdChar.fromChar_22 (select _vArray_0::<{_SystemArray.Array;}> 3 data_1 2)) 8) (StdChar.fromChar_22 (select _vArray_0::<{_SystemArray.Array;}> 3 data_1 3))) 2) (False -> case (<{StdInt.==_16}> len_1_0 127) (True -> _Tuple2 (iTasks.Internal.WebService.foldr_448 0 (<{iTasks.Internal.WebService.c;100;73_19}> _vArray_0 data_1 2 9 0 7)) 8) (False -> _Tuple2 len_1_0 0) ) 
iTasks.Internal.WebService.decode_21::C !_vArray_0 mask_1 i_2::I !c_3::C = StdChar.toChar_21 (StdInt.bitxor (StdChar.fromChar_22 (select _vArray_0::<{_SystemArray.Array;}> 3 mask_1 (StdInt.rem_28 i_2 4))) (StdChar.fromChar_22 c_3))
<{iTasks.Internal.WebService.cu;103;64_20}> !_vArray_0 !_vArray_1 !_vArray_2 mask_3 c_a_4 !c_i_5::I !g_s_6::I g_a_7 = case (StdBool.not (<{StdInt.<_17}> g_s_6 c_i_5)) (True -> let !g_a_2_0 = _predefined._dummyForStrictAlias (select _x_2_1::_Tuple2 1), _x_2_1 = select _vArray_0::<{_SystemArray.Array;}> 6 g_a_7 c_i_5 in <{iTasks.Internal.WebService.cu;103;64_20}> _vArray_0 _vArray_1 _vArray_2 mask_3 (select _vArray_2::<{_SystemArray.Array;}> 5 c_a_4 c_i_5 (iTasks.Internal.WebService.decode_21 _vArray_1 mask_3 c_i_5 (select _x_2_1::_Tuple2 0))) (<{StdInt.+_6}> c_i_5 StdInt.one_11) g_s_6 g_a_2_0) (False -> c_a_4) 
iTasks.Internal.WebService.decodePayload_23 !_vArray_0 !_vArray_1 !_vArray_2 mask_3 encoded_4 = let _x_1_0::I = select _vArray_0::<{_SystemArray.Array;}> 7 encoded_4, g_s2_1_1 = <{StdInt.-_7}> (select _x_1_0::_Tuple2 0) 1 in <{iTasks.Internal.WebService.cu;103;64_20}> _vArray_0 _vArray_2 _vArray_1 mask_3 (select _vArray_1::<{_SystemArray.Array;}> 0 (<{StdInt.+_6}> g_s2_1_1 StdInt.one_11)) 0 g_s2_1_1 (select _x_1_0::_Tuple2 1)
<{iTasks.Internal.WebService.c;100;73_450}> data_0 !b_1::I !g_s_2::I i_3::I g_s_4::I = case (StdBool.not (<{StdInt.<_17}> g_s_2 b_1)) (True -> case (StdBool.not (<{StdInt.<_17}> g_s_4 i_3)) (True -> _predefined._Cons (<{StdInt.<<}> (StdChar.fromChar_22 (_SystemArray.select_19 data_0 b_1)) (<{StdInt.*_9}> i_3 8)) (<{iTasks.Internal.WebService.c;100;73_450}> data_0 (<{StdInt.+_6}> b_1 StdInt.one_11) g_s_2 (<{StdInt.+_6}> i_3 StdInt.one_11) g_s_4)) (False -> _predefined._Nil) ) (False -> _predefined._Nil) 
iTasks.Internal.WebService.payloadLen_449 !data_0 = let len_1_0::I = StdInt.bitand (StdChar.fromChar_22 (_SystemArray.select_19 data_0 1)) 127 in case (<{StdInt.==_16}> len_1_0 126) (True -> _Tuple2 (<{StdInt.+_6}> (<{StdInt.<<}> (StdChar.fromChar_22 (_SystemArray.select_19 data_0 2)) 8) (StdChar.fromChar_22 (_SystemArray.select_19 data_0 3))) 2) (False -> case (<{StdInt.==_16}> len_1_0 127) (True -> _Tuple2 (iTasks.Internal.WebService.foldr_448 0 (<{iTasks.Internal.WebService.c;100;73_450}> data_0 2 9 0 7)) 8) (False -> _Tuple2 len_1_0 0) ) 
<{iTasks.Internal.WebService.cu;103;64_452}> !_vArray_0 !_vArray_1 mask_2 c_a_3 !c_i_4::I !g_s_5::I g_a_6 = case (StdBool.not (<{StdInt.<_17}> g_s_5 c_i_4)) (True -> let !g_a_2_0 = _predefined._dummyForStrictAlias (select _x_2_1::_Tuple2 1), _x_2_1 = _SystemArray.uselect_22 g_a_6 c_i_4 in <{iTasks.Internal.WebService.cu;103;64_452}> _vArray_0 _vArray_1 mask_2 (select _vArray_1::<{_SystemArray.Array;}> 5 c_a_3 c_i_4 (iTasks.Internal.WebService.decode_21 _vArray_0 mask_2 c_i_4 (select _x_2_1::_Tuple2 0))) (<{StdInt.+_6}> c_i_4 StdInt.one_11) g_s_5 g_a_2_0) (False -> c_a_3) 
iTasks.Internal.WebService.decodePayload_451 !_vArray_0 !_vArray_1 mask_2 !encoded_3 = let _x_1_0::I = _SystemArray.usize_23 encoded_3, g_s2_1_1 = <{StdInt.-_7}> (select _x_1_0::_Tuple2 0) 1 in <{iTasks.Internal.WebService.cu;103;64_452}> _vArray_1 _vArray_0 mask_2 (select _vArray_0::<{_SystemArray.Array;}> 0 (<{StdInt.+_6}> g_s2_1_1 StdInt.one_11)) 0 g_s2_1_1 (select _x_1_0::_Tuple2 1)
<{iTasks.Internal.WebService.cu;103;64_454}> !_vArray_0 mask_1 !c_a_2 !c_i_3::I !g_s_4::I g_a_5 = case (StdBool.not (<{StdInt.<_17}> g_s_4 c_i_3)) (True -> let !g_a_2_0 = _predefined._dummyForStrictAlias (select _x_2_1::_Tuple2 1), _x_2_1 = _SystemArray.uselect_22 g_a_5 c_i_3 in <{iTasks.Internal.WebService.cu;103;64_454}> _vArray_0 mask_1 (_SystemArray.update_21 c_a_2 c_i_3 (iTasks.Internal.WebService.decode_21 _vArray_0 mask_1 c_i_3 (select _x_2_1::_Tuple2 0))) (<{StdInt.+_6}> c_i_3 StdInt.one_11) g_s_4 g_a_2_0) (False -> c_a_2) 
iTasks.Internal.WebService.decodePayload_453 !_vArray_0 mask_1 !encoded_2 = let _x_1_0::I = _SystemArray.usize_23 encoded_2, g_s2_1_1 = <{StdInt.-_7}> (select _x_1_0::_Tuple2 0) 1 in <{iTasks.Internal.WebService.cu;103;64_454}> _vArray_0 mask_1 (_SystemArray._createArray_16 (<{StdInt.+_6}> g_s2_1_1 StdInt.one_11)) 0 g_s2_1_1 (select _x_1_0::_Tuple2 1)
iTasks.Internal.WebService.decode_457::C !mask_0 !i_1::I !c_2::C = StdChar.toChar_21 (StdInt.bitxor (StdChar.fromChar_22 (_SystemArray.select_19 mask_0 (StdInt.rem_28 i_1 4))) (StdChar.fromChar_22 c_2))
<{iTasks.Internal.WebService.cu;103;64_456}> mask_0 !c_a_1 !c_i_2::I !g_s_3::I g_a_4 = case (StdBool.not (<{StdInt.<_17}> g_s_3 c_i_2)) (True -> let !g_a_2_0 = _predefined._dummyForStrictAlias (select _x_2_1::_Tuple2 1), _x_2_1 = _SystemArray.uselect_22 g_a_4 c_i_2 in <{iTasks.Internal.WebService.cu;103;64_456}> mask_0 (_SystemArray.update_21 c_a_1 c_i_2 (iTasks.Internal.WebService.decode_457 mask_0 c_i_2 (select _x_2_1::_Tuple2 0))) (<{StdInt.+_6}> c_i_2 StdInt.one_11) g_s_3 g_a_2_0) (False -> c_a_1) 
iTasks.Internal.WebService.decodePayload_455 mask_0 !encoded_1 = let _x_1_0::I = _SystemArray.usize_23 encoded_1, g_s2_1_1 = <{StdInt.-_7}> (select _x_1_0::_Tuple2 0) 1 in <{iTasks.Internal.WebService.cu;103;64_456}> mask_0 (_SystemArray._createArray_16 (<{StdInt.+_6}> g_s2_1_1 StdInt.one_11)) 0 g_s2_1_1 (select _x_1_0::_Tuple2 1)
iTasks.Internal.WebService.wsockReadFrame !state_0 !data_1 = case state_0 (iTasks.Internal.WebService._WebSockState cur_frame_1_0 message_text_1_1 message_data_1_2 -> let cur_frame_2_0 = <{StdString.+++_11}> cur_frame_1_0 data_1 in case (<{StdInt.<_17}> (_SystemArray.size_20 cur_frame_2_0) 6) (True -> _Tuple2 (update state_0::iTasks.Internal.WebService._WebSockState [0:cur_frame_2_0]) _predefined._Nil) (False -> let _x_4_0::I = iTasks.Internal.WebService.payloadLen_449 cur_frame_2_0, ext_payload_length_size_4_1::I = select _x_4_0::_Tuple2 1, masked_4_2::B = <{StdInt.<_17}> 0 (StdInt.bitand (StdChar.fromChar_22 (_SystemArray.select_19 cur_frame_2_0 1)) 128), payload_length_4_3::I = select _x_4_0::_Tuple2 0, frame_length_4_4 = <{StdInt.+_6}> (<{StdInt.+_6}> (<{StdInt.+_6}> 2 ext_payload_length_size_4_1) (<{iTasks.Internal.WebService._if;64;52_494}> masked_4_2)) payload_length_4_3 in case (<{StdInt.<_17}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) (True -> _Tuple2 (update state_0::iTasks.Internal.WebService._WebSockState [0:cur_frame_2_0]) _predefined._Nil) (False -> let opcode_6_0::I = StdInt.bitand (StdChar.fromChar_22 (_SystemArray.select_19 cur_frame_2_0 0)) 15 in case (<{StdInt.==_16}> opcode_6_0 8) (True -> _Tuple2 (<{iTasks.Internal.WebService._if;75;15_495}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4) (_predefined._Cons (iTasks.Internal.WebService.WSClose (<{iTasks.Internal.WebService._if;69;17_496}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3)) _predefined._Nil)) (False -> case (<{StdInt.==_16}> opcode_6_0 9) (True -> _Tuple2 (<{iTasks.Internal.WebService._if;75;15_497}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4) (_predefined._Cons (iTasks.Internal.WebService.WSPing (<{iTasks.Internal.WebService._if;69;17_498}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3)) _predefined._Nil)) (False -> case (<{StdInt.==_16}> opcode_6_0 1) (True -> case (<{StdInt.<_17}> 0 (StdInt.bitand (StdChar.fromChar_22 (_SystemArray.select_19 cur_frame_2_0 0)) 128)) (True -> _Tuple2 (update (<{iTasks.Internal.WebService._if;75;15_499}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4)::iTasks.Internal.WebService._WebSockState [2:_predefined._Nil]) (_predefined._Cons (iTasks.Internal.WebService.WSTextMessage (<{iTasks.Internal.WebService._if;69;17_500}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3)) _predefined._Nil)) (False -> _Tuple2 (update (<{iTasks.Internal.WebService._if;75;15_501}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4)::iTasks.Internal.WebService._WebSockState [1:True,2:_predefined._Cons (<{iTasks.Internal.WebService._if;69;17_502}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3) _predefined._Nil]) _predefined._Nil) ) (False -> case (<{StdInt.==_16}> opcode_6_0 2) (True -> case (<{StdInt.<_17}> 0 (StdInt.bitand (StdChar.fromChar_22 (_SystemArray.select_19 cur_frame_2_0 0)) 128)) (True -> _Tuple2 (update (<{iTasks.Internal.WebService._if;75;15_503}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4)::iTasks.Internal.WebService._WebSockState [2:_predefined._Nil]) (_predefined._Cons (iTasks.Internal.WebService.WSBinMessage (<{iTasks.Internal.WebService._if;69;17_504}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3)) _predefined._Nil)) (False -> _Tuple2 (update (<{iTasks.Internal.WebService._if;75;15_505}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4)::iTasks.Internal.WebService._WebSockState [1:False,2:_predefined._Cons (<{iTasks.Internal.WebService._if;69;17_506}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3) _predefined._Nil]) _predefined._Nil) ) (False -> case (<{StdInt.==_16}> opcode_6_0 0) (True -> case (<{StdInt.<_17}> 0 (StdInt.bitand (StdChar.fromChar_22 (_SystemArray.select_19 cur_frame_2_0 0)) 128)) (True -> let state_13_0 = <{iTasks.Internal.WebService._if;75;15_507}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4 in _Tuple2 (update state_13_0::iTasks.Internal.WebService._WebSockState [2:_predefined._Nil]) (_predefined._Cons (<{iTasks.Internal.WebService._if;90;50_508}> (select state_13_0::iTasks.Internal.WebService._WebSockState 1) (Text.concat_1 (StdList.reverse (_predefined._Cons (<{iTasks.Internal.WebService._if;69;17_509}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3) (select state_13_0::iTasks.Internal.WebService._WebSockState 2))))) _predefined._Nil)) (False -> let state_13_0 = <{iTasks.Internal.WebService._if;75;15_510}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4 in _Tuple2 (update state_13_0::iTasks.Internal.WebService._WebSockState [2:_predefined._Cons (<{iTasks.Internal.WebService._if;69;17_511}> masked_4_2 cur_frame_2_0 ext_payload_length_size_4_1 payload_length_4_3) (select state_13_0::iTasks.Internal.WebService._WebSockState 2)]) _predefined._Nil) ) (False -> _Tuple2 (<{iTasks.Internal.WebService._if;75;15_512}> (<{StdInt.==_16}> (_SystemArray.size_20 cur_frame_2_0) frame_length_4_4) state_0 cur_frame_2_0 frame_length_4_4) _predefined._Nil) ) ) ) ) ) ) ) 
<{iTasks.Internal.WebService._if;75;15_512}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_511}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_510}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_509}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;90;50_508}> !_x_0::B = case _x_0 (True -> iTasks.Internal.WebService.WSTextMessage) (_ -> iTasks.Internal.WebService.WSBinMessage)
<{iTasks.Internal.WebService._if;75;15_507}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_506}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_505}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_504}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_503}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_502}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_501}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_500}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_499}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_498}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_497}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;69;17_496}> !masked_0::B !cur_frame_1 !ext_payload_length_size_2::I !payload_length_3::I = case masked_0 (True -> iTasks.Internal.WebService.decodePayload_455 (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) (<{StdInt.+_6}> 5 ext_payload_length_size_2))) (<{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 6 ext_payload_length_size_2) (<{StdInt.-_7}> (<{StdInt.+_6}> (<{StdInt.+_6}> 6 ext_payload_length_size_2) payload_length_3) 1)))) (_ -> <{StdString.%_10}> cur_frame_1 (_Tuple2 (<{StdInt.+_6}> 2 ext_payload_length_size_2) payload_length_3))
<{iTasks.Internal.WebService._if;75;15_495}> !_x_0::B !state_1 cur_frame_2 frame_length_3::I = case _x_0 (True -> update state_1::iTasks.Internal.WebService._WebSockState [0:""]) (_ -> update state_1::iTasks.Internal.WebService._WebSockState [0:<{StdString.%_10}> cur_frame_2 (_Tuple2 frame_length_3 (_SystemArray.size_20 cur_frame_2))])
<{iTasks.Internal.WebService._if;64;52_494}>::I !masked_0::B = case masked_0 (True -> 4) (_ -> 0)
iTasks.Internal.WebService.wsockAddData !state_0 !data_1 = let _x_1_0 = iTasks.Internal.WebService.wsockReadFrame state_0 data_1, evCur_1_1 = select _x_1_0::_Tuple2 1 in case (<{iTasks.Internal.WebService._c;51;16_513}> evCur_1_1) (True -> <{_Tuple2!3}> (select _x_1_0::_Tuple2 0) _predefined._Nil) (False -> let _x_3_0 = iTasks.Internal.WebService.wsockAddData (select _x_1_0::_Tuple2 0) "" in <{_Tuple2!3}> (select _x_3_0::_Tuple2 0) (<{StdList.++}> evCur_1_1 (select _x_3_0::_Tuple2 1))) 
<{iTasks.Internal.WebService._c;51;16_513}>::B !_x_0 = case _x_0 (_predefined._Nil -> True) (_ -> False)
iTasks.Internal.WebService.anon_92 !f_0 g_1 x_2 = f_0 (g_1 x_2)
iTasks.Internal.WebService.fst_91 !tuple_0 = select tuple_0::_Tuple2 0
iTasks.Internal.WebService.frame_30 !_vArray_0 !_vtoChar_1 !<{_v+++_2}> opcode_3::I final_4::B payload_length_5 ext_payload_length_6 payload_7 = select <{_v+++_2}>::<{StdOverloaded.+++;}> 0 (select _vArray_0::<{_SystemArray.Array;}> 5 (select _vArray_0::<{_SystemArray.Array;}> 5 (select _vArray_0::<{_SystemArray.Array;}> 0 2) 1 (select _vtoChar_1::<{StdOverloaded.toChar;}> 0 payload_length_5)) 0 (StdChar.toChar_21 (StdInt.bitor opcode_3 (<{iTasks.Internal.WebService._if;126;34_514}> final_4)))) (select <{_v+++_2}>::<{StdOverloaded.+++;}> 0 ext_payload_length_6 payload_7)
<{iTasks.Internal.WebService._if;126;34_514}>::I !final_0::B = case final_0 (True -> 128) (_ -> 0)
<{iTasks.Internal.WebService.cu;119;66_25}> !_vone_0 !<{_v+_1}> c_l_i_2 !g_l_3 = <{iTasks.Internal.WebService.g_c1;119;71_515}> g_l_3 _vone_0 <{_v+_1}> c_l_i_2
<{iTasks.Internal.WebService.g_c1;119;71_515}> !g_l_0 _vone_1 <{_v+_2}> c_l_i_3 = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;119;66_25}> _vone_1 <{_v+_2}> (select <{_v+_2}>::<{StdOverloaded.+;}> 0 c_l_i_3 (select _vone_1::<{StdOverloaded.one;}> 0)) g_t_1_1) (_ -> c_l_i_3)
<{iTasks.Internal.WebService.cu;119;66_24}> !_vArray_0 num_bytes_1::I c_a_2 c_i_3::I !g_l_4 = <{iTasks.Internal.WebService.g_c1;119;71_516}> g_l_4 _vArray_0 num_bytes_1 c_a_2 c_i_3
<{iTasks.Internal.WebService.g_c1;119;71_516}> !g_l_0 _vArray_1 num_bytes_2::I c_a_3 c_i_4::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;119;66_24}> _vArray_1 num_bytes_2 (select _vArray_1::<{_SystemArray.Array;}> 5 c_a_3 c_i_4 (StdChar.toChar_21 (<{StdInt.>>}> num_bytes_2 (<{StdInt.*_9}> 8 i_1_0)))) (<{StdInt.+_6}> c_i_4 StdInt.one_11) g_t_1_1) (_ -> c_a_3)
<{iTasks.Internal.WebService.cu;122;84_29}> !_vone_0 !<{_v+_1}> c_l_i_2 !g_l_3 = <{iTasks.Internal.WebService.g_c1;122;89_517}> g_l_3 _vone_0 <{_v+_1}> c_l_i_2
<{iTasks.Internal.WebService.g_c1;122;89_517}> !g_l_0 _vone_1 <{_v+_2}> c_l_i_3 = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;122;84_29}> _vone_1 <{_v+_2}> (select <{_v+_2}>::<{StdOverloaded.+;}> 0 c_l_i_3 (select _vone_1::<{StdOverloaded.one;}> 0)) g_t_1_1) (_ -> c_l_i_3)
<{iTasks.Internal.WebService.cu;122;84_28}> !_vArray_0 num_bytes_1::I c_a_2 c_i_3::I !g_l_4 = <{iTasks.Internal.WebService.g_c1;122;89_519}> g_l_4 _vArray_0 num_bytes_1 c_a_2 c_i_3
<{iTasks.Internal.WebService.g_c1;122;89_519}> !g_l_0 _vArray_1 num_bytes_2::I c_a_3 c_i_4::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;122;84_28}> _vArray_1 num_bytes_2 (select _vArray_1::<{_SystemArray.Array;}> 5 c_a_3 c_i_4 (StdChar.toChar_21 (<{iTasks.Internal.WebService._if;122;49_518}> (<{StdInt.<_17}> i_1_0 4) num_bytes_2 i_1_0))) (<{StdInt.+_6}> c_i_4 StdInt.one_11) g_t_1_1) (_ -> c_a_3)
<{iTasks.Internal.WebService._if;122;49_518}>::I !_x_0::B num_bytes_1::I i_2::I = case _x_0 (True -> <{StdInt.>>}> num_bytes_1 (<{StdInt.*_9}> 8 i_2)) (_ -> 0)
<{iTasks.Internal.WebService.cu;121;69_27}> !_vone_0 !<{_v+_1}> c_l_i_2 !g_l_3 = <{iTasks.Internal.WebService.g_c1;121;74_520}> g_l_3 _vone_0 <{_v+_1}> c_l_i_2
<{iTasks.Internal.WebService.g_c1;121;74_520}> !g_l_0 _vone_1 <{_v+_2}> c_l_i_3 = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;121;69_27}> _vone_1 <{_v+_2}> (select <{_v+_2}>::<{StdOverloaded.+;}> 0 c_l_i_3 (select _vone_1::<{StdOverloaded.one;}> 0)) g_t_1_1) (_ -> c_l_i_3)
<{iTasks.Internal.WebService.cu;121;69_26}> !_vArray_0 num_bytes_1::I c_a_2 c_i_3::I !g_l_4 = <{iTasks.Internal.WebService.g_c1;121;74_521}> g_l_4 _vArray_0 num_bytes_1 c_a_2 c_i_3
<{iTasks.Internal.WebService.g_c1;121;74_521}> !g_l_0 _vArray_1 num_bytes_2::I c_a_3 c_i_4::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;121;69_26}> _vArray_1 num_bytes_2 (select _vArray_1::<{_SystemArray.Array;}> 5 c_a_3 c_i_4 (StdChar.toChar_21 (<{StdInt.>>}> num_bytes_2 (<{StdInt.*_9}> 8 i_1_0)))) (<{StdInt.+_6}> c_i_4 StdInt.one_11) g_t_1_1) (_ -> c_a_3)
iTasks.Internal.WebService.frame_458 !_vtoChar_0 !<{_v+++_1}> opcode_2::I final_3::B payload_length_4 ext_payload_length_5 payload_6 = select <{_v+++_1}>::<{StdOverloaded.+++;}> 0 (_SystemArray.update_21 (_SystemArray.update_21 (_SystemArray._createArray_16 2) 1 (select _vtoChar_0::<{StdOverloaded.toChar;}> 0 payload_length_4)) 0 (StdChar.toChar_21 (StdInt.bitor opcode_2 (<{iTasks.Internal.WebService._if;126;34_522}> final_3)))) (select <{_v+++_1}>::<{StdOverloaded.+++;}> 0 ext_payload_length_5 payload_6)
<{iTasks.Internal.WebService._if;126;34_522}>::I !final_0::B = case final_0 (True -> 128) (_ -> 0)
<{iTasks.Internal.WebService.cu;119;66_459}>::I !<{_v+_0}> c_l_i_1::I !g_l_2 = <{iTasks.Internal.WebService.g_c1;119;71_523}> g_l_2 <{_v+_0}> c_l_i_1
<{iTasks.Internal.WebService.g_c1;119;71_523}>::I !g_l_0 <{_v+_1}> c_l_i_2::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;119;66_459}> <{_v+_1}> (select <{_v+_1}>::<{StdOverloaded.+;}> 0 c_l_i_2 StdInt.one_11) g_t_1_1) (_ -> c_l_i_2)
<{iTasks.Internal.WebService.cu;119;66_460}> num_bytes_0::I !c_a_1 c_i_2::I !g_l_3 = <{iTasks.Internal.WebService.g_c1;119;71_524}> g_l_3 num_bytes_0 c_a_1 c_i_2
<{iTasks.Internal.WebService.g_c1;119;71_524}> !g_l_0 num_bytes_1::I !c_a_2 c_i_3::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;119;66_460}> num_bytes_1 (_SystemArray.update_21 c_a_2 c_i_3 (StdChar.toChar_21 (<{StdInt.>>}> num_bytes_1 (<{StdInt.*_9}> 8 i_1_0)))) (<{StdInt.+_6}> c_i_3 StdInt.one_11) g_t_1_1) (_ -> c_a_2)
<{iTasks.Internal.WebService.cu;121;69_461}>::I !<{_v+_0}> c_l_i_1::I !g_l_2 = <{iTasks.Internal.WebService.g_c1;121;74_525}> g_l_2 <{_v+_0}> c_l_i_1
<{iTasks.Internal.WebService.g_c1;121;74_525}>::I !g_l_0 <{_v+_1}> c_l_i_2::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;121;69_461}> <{_v+_1}> (select <{_v+_1}>::<{StdOverloaded.+;}> 0 c_l_i_2 StdInt.one_11) g_t_1_1) (_ -> c_l_i_2)
<{iTasks.Internal.WebService.cu;121;69_462}> num_bytes_0::I !c_a_1 c_i_2::I !g_l_3 = <{iTasks.Internal.WebService.g_c1;121;74_526}> g_l_3 num_bytes_0 c_a_1 c_i_2
<{iTasks.Internal.WebService.g_c1;121;74_526}> !g_l_0 num_bytes_1::I !c_a_2 c_i_3::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;121;69_462}> num_bytes_1 (_SystemArray.update_21 c_a_2 c_i_3 (StdChar.toChar_21 (<{StdInt.>>}> num_bytes_1 (<{StdInt.*_9}> 8 i_1_0)))) (<{StdInt.+_6}> c_i_3 StdInt.one_11) g_t_1_1) (_ -> c_a_2)
iTasks.Internal.WebService.frame_463 !<{_v+++_0}> opcode_1::I final_2::B payload_length_3::I ext_payload_length_4 payload_5 = select <{_v+++_0}>::<{StdOverloaded.+++;}> 0 (_SystemArray.update_21 (_SystemArray.update_21 (_SystemArray._createArray_16 2) 1 (StdChar.toChar_21 payload_length_3)) 0 (StdChar.toChar_21 (StdInt.bitor opcode_1 (<{iTasks.Internal.WebService._if;126;34_527}> final_2)))) (select <{_v+++_0}>::<{StdOverloaded.+++;}> 0 ext_payload_length_4 payload_5)
<{iTasks.Internal.WebService._if;126;34_527}>::I !final_0::B = case final_0 (True -> 128) (_ -> 0)
<{iTasks.Internal.WebService.cu;119;66_464}>::I !c_l_i_0::I !g_l_1 = <{iTasks.Internal.WebService.g_c1;119;71_528}> g_l_1 c_l_i_0
<{iTasks.Internal.WebService.g_c1;119;71_528}>::I !g_l_0 !c_l_i_1::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;119;66_464}> (<{StdInt.+_6}> c_l_i_1 StdInt.one_11) g_t_1_1) (_ -> c_l_i_1)
<{iTasks.Internal.WebService.cu;121;69_465}>::I !c_l_i_0::I !g_l_1 = <{iTasks.Internal.WebService.g_c1;121;74_529}> g_l_1 c_l_i_0
<{iTasks.Internal.WebService.g_c1;121;74_529}>::I !g_l_0 !c_l_i_1::I = case g_l_0 (_predefined._Cons i_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.cu;121;69_465}> (<{StdInt.+_6}> c_l_i_1 StdInt.one_11) g_t_1_1) (_ -> c_l_i_1)
iTasks.Internal.WebService.frame_466 !opcode_0::I !final_1::B !payload_length_2::I !ext_payload_length_3 !payload_4 = <{StdString.+++_11}> (_SystemArray.update_21 (_SystemArray.update_21 (_SystemArray._createArray_16 2) 1 (StdChar.toChar_21 payload_length_2)) 0 (StdChar.toChar_21 (StdInt.bitor opcode_0 (<{iTasks.Internal.WebService._if;126;34_530}> final_1)))) (<{StdString.+++_11}> ext_payload_length_3 payload_4)
<{iTasks.Internal.WebService._if;126;34_530}>::I !final_0::B = case final_0 (True -> 128) (_ -> 0)
iTasks.Internal.WebService.wsockMsgFrame !opcode_0::I !final_1::B !payload_2 = let num_bytes_1_0::I = _SystemArray.size_20 payload_2 in case (<{StdInt.<_17}> num_bytes_1_0 125) (True -> iTasks.Internal.WebService.frame_466 opcode_0 final_1 num_bytes_1_0 "" payload_2) (False -> case (<{StdInt.<_17}> num_bytes_1_0 65536) (True -> iTasks.Internal.WebService.frame_466 opcode_0 final_1 126 (<{iTasks.Internal.WebService.cu;119;66_460}> num_bytes_1_0 (_SystemArray._createArray_16 (<{iTasks.Internal.WebService.cu;119;66_464}> 0 (_predefined._Cons 1 (_predefined._Cons 0 _predefined._Nil)))) 0 (_predefined._Cons 1 (_predefined._Cons 0 _predefined._Nil))) payload_2) (False -> iTasks.Internal.WebService.frame_466 opcode_0 final_1 127 (<{iTasks.Internal.WebService.cu;121;69_462}> num_bytes_1_0 (_SystemArray._createArray_16 (<{iTasks.Internal.WebService.cu;121;69_465}> 0 (_predefined._Cons 7 (_predefined._Cons 6 (_predefined._Cons 5 (_predefined._Cons 4 (_predefined._Cons 3 (_predefined._Cons 2 (_predefined._Cons 1 (_predefined._Cons 0 _predefined._Nil)))))))))) 0 (_predefined._Cons 7 (_predefined._Cons 6 (_predefined._Cons 5 (_predefined._Cons 4 (_predefined._Cons 3 (_predefined._Cons 2 (_predefined._Cons 1 (_predefined._Cons 0 _predefined._Nil))))))))) payload_2) ) 
iTasks.Internal.WebService.wsockControlFrame !opcode_0::I !payload_1 = iTasks.Internal.WebService.wsockMsgFrame opcode_0 True payload_1
iTasks.Internal.WebService.wsockCloseMsg !payload_0 = iTasks.Internal.WebService.wsockControlFrame 8 payload_0
iTasks.Internal.WebService.wsockPongMsg !payload_0 = iTasks.Internal.WebService.wsockControlFrame 10 payload_0
iTasks.Internal.WebService.wsockTextMsg payload_0 = _predefined._Cons (iTasks.Internal.WebService.wsockMsgFrame 1 True payload_0) _predefined._Nil
<{iTasks.Internal.WebService.createTaskInstance`_58}> !req_0 !_x_1 !iworld_2 = case _x_1 (_predefined._Cons _x_1_0 taskUrls_1_1 -> case _x_1_0 (iTasks.Internal.Engine._PublishedTask url_2_0 _x_2_1 -> case _x_2_1 (iTasks.Internal.Engine.WebTaskWrapper _viTask_3_0 task_3_1 -> case (<{StdString.==_2}> (select req_0::Internet.HTTP._HTTPRequest 1) (iTasks.Internal.WebService.uiUrl_59 url_2_0)) (True -> iTasks.Internal.TaskStore.createTaskInstance _viTask_3_0 (task_3_1 req_0) iworld_2) (False -> <{iTasks.Internal.WebService.createTaskInstance`_58}> req_0 taskUrls_1_1 iworld_2) ) ) ) 
iTasks.Internal.WebService.anon_467::B !_x_0::I !g_1 x_2 = <{StdInt.==_16}> _x_0 (g_1 x_2)
iTasks.Internal.WebService.anon_468::B !_x_0::I !x_1 = <{StdInt.==_16}> _x_0 (iTasks.Internal.WebService.fst_91 x_1)
iTasks.Internal.WebService.handleEvent_44 taskUrls_0 req_1 clientname_2 !_x_3 instances_4 iworld_5 = case _x_3 (iTasks.Internal.WebService.WSClose msg_1_0 -> _Tuple4 (_predefined._Cons (iTasks.Internal.WebService.wsockCloseMsg msg_1_0) _predefined._Nil) True instances_4 iworld_5) (iTasks.Internal.WebService.WSPing msg_1_0 -> _Tuple4 (_predefined._Cons (iTasks.Internal.WebService.wsockPongMsg msg_1_0) _predefined._Nil) False instances_4 iworld_5) (iTasks.Internal.WebService.WSTextMessage msg_1_0 -> <{iTasks.Internal.WebService._c;303;15_532}> (Text.JSON.fromString_8 msg_1_0) req_1 taskUrls_0 iworld_5 instances_4 clientname_2) 
<{iTasks.Internal.WebService._c;303;15_532}> !_x_0 req_1 taskUrls_2 iworld_3 instances_4 clientname_5 = case _x_0 (Text.JSON.JSONArray _x_1_0 -> case _x_1_0 (_predefined._Cons _x_2_0 _x_2_1 -> case _x_2_0 (Text.JSON.JSONInt req_3_0 -> case _x_2_1 (_predefined._Cons _x_4_0 _x_4_1 -> case _x_4_0 (Text.JSON.JSONString _x_5_0 -> case _x_5_0 ("new" -> case _x_4_1 (_predefined._Nil -> <{iTasks.Internal.WebService._c;306;23_531}> (<{iTasks.Internal.WebService.createTaskInstance`_58}> req_1 taskUrls_2 iworld_3) req_3_0 instances_4) ) ) ) ) (Text.JSON.JSONString _x_3_0 -> case _x_3_0 ("attach" -> case _x_2_1 (_predefined._Cons _x_5_0 _x_5_1 -> case _x_5_0 (Text.JSON.JSONInt instanceNo_6_0 -> case _x_5_1 (_predefined._Cons _x_7_0 _x_7_1 -> case _x_7_0 (Text.JSON.JSONString instanceKey_8_0 -> case _x_7_1 (_predefined._Nil -> _Tuple4 _predefined._Nil False (_predefined._Cons (_Tuple2 instanceNo_6_0 instanceKey_8_0) instances_4) (select (iTasks.Internal.TaskEval.updateInstanceConnect clientname_5 (_predefined._Cons instanceNo_6_0 _predefined._Nil) (iTasks.Internal.TaskStore.attachViewport instanceNo_6_0 iworld_3))::_Tuple2 1)) ) ) ) ) ) ("detach" -> case _x_2_1 (_predefined._Cons _x_5_0 _x_5_1 -> case _x_5_0 (Text.JSON.JSONInt instanceNo_6_0 -> case _x_5_1 (_predefined._Nil -> _Tuple4 _predefined._Nil False (StdList.filter (iTasks.Internal.WebService.anon_468 instanceNo_6_0) instances_4) (select (iTasks.Internal.TaskEval.updateInstanceDisconnect (_predefined._Cons instanceNo_6_0 _predefined._Nil) (iTasks.Internal.TaskStore.detachViewport instanceNo_6_0 iworld_3))::_Tuple2 1)) ) ) ) ("event" -> case _x_2_1 (_predefined._Cons _x_5_0 _x_5_1 -> case _x_5_0 (Text.JSON.JSONInt instanceNo_6_0 -> case _x_5_1 (_predefined._Cons _x_7_0 _x_7_1 -> case _x_7_0 (Text.JSON.JSONArray _x_8_0 -> case _x_8_0 (_predefined._Cons _x_9_0 _x_9_1 -> case _x_9_0 (Text.JSON.JSONString task_10_0 -> case _x_9_1 (_predefined._Cons _x_11_0 _x_11_1 -> case _x_11_0 (Text.JSON.JSONNull -> case _x_11_1 (_predefined._Cons _x_13_0 _x_13_1 -> case _x_13_0 (Text.JSON.JSONString action_14_0 -> case _x_13_1 (_predefined._Nil -> case _x_7_1 (_predefined._Nil -> _Tuple4 _predefined._Nil False instances_4 (iTasks.Internal.TaskStore.queueEvent instanceNo_6_0 (iTasks.WF.Definition.ActionEvent (iTasks.WF.Definition.fromString_3 task_10_0) action_14_0) iworld_3)) ) ) ) ) (Text.JSON.JSONString name_12_0 -> case _x_11_1 (_predefined._Cons value_13_0 _x_13_1 -> case _x_13_1 (_predefined._Nil -> case _x_7_1 (_predefined._Nil -> _Tuple4 _predefined._Nil False instances_4 (iTasks.Internal.TaskStore.queueEvent instanceNo_6_0 (iTasks.WF.Definition.EditEvent (iTasks.WF.Definition.fromString_3 task_10_0) name_12_0 value_13_0) iworld_3)) ) ) ) ) ) ) ) ) ) ) ) ) ) ) (_ -> _Tuple4 (iTasks.Internal.WebService.wsockTextMsg (Text.JSON.toString_7 (Text.JSON.JSONArray (_predefined._Cons (Text.JSON.JSONString "ERROR") (_predefined._Cons (Text.JSON.JSONString "Unknown event") _predefined._Nil))))) False instances_4 iworld_3)
<{iTasks.Internal.WebService._c;306;23_531}> !_x_0 req_1::I instances_2 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Error _x_2_0 -> case _x_2_0 (_Tuple2 _x_3_0 err_3_1 -> _Tuple4 (iTasks.Internal.WebService.wsockTextMsg (Text.JSON.toString_7 (Text.JSON.JSONArray (_predefined._Cons (Text.JSON.JSONInt req_1) (_predefined._Cons (Text.JSON.JSONString "ERROR") (_predefined._Cons (Text.JSON.JSONString err_3_1) _predefined._Nil)))))) False instances_2 iworld_1_1) ) (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple2 instanceNo_3_0 instanceKey_3_1 -> _Tuple4 (iTasks.Internal.WebService.wsockTextMsg (Text.JSON.toString_7 (Text.JSON.JSONArray (_predefined._Cons (Text.JSON.JSONInt req_1) (_predefined._Cons (Text.JSON.JSONObject (_predefined._Cons (_Tuple2 "instanceNo" (Text.JSON.JSONInt instanceNo_3_0)) (_predefined._Cons (_Tuple2 "instanceKey" (Text.JSON.JSONString instanceKey_3_1)) _predefined._Nil))) _predefined._Nil))))) False instances_2 iworld_1_1) ) ) 
iTasks.Internal.WebService.handleEvents_43 taskUrls_0 req_1 clientname_2 instances_3 output_4 close_5::B !_x_6 iworld_7 = case _x_6 (_predefined._Nil -> _Tuple4 output_4 close_5 instances_3 iworld_7) (_predefined._Cons e_1_0 es_1_1 -> let _x_2_0::B = iTasks.Internal.WebService.handleEvent_44 taskUrls_0 req_1 clientname_2 e_1_0 instances_3 iworld_7, eclose_2_1 = select _x_2_0::_Tuple4 1 in iTasks.Internal.WebService.handleEvents_43 taskUrls_0 req_1 clientname_2 (select _x_2_0::_Tuple4 2) (<{StdList.++}> output_4 (select _x_2_0::_Tuple4 0)) eclose_2_1 (<{iTasks.Internal.WebService._if;296;66_533}> eclose_2_1 es_1_1) (select _x_2_0::_Tuple4 3)) 
<{iTasks.Internal.WebService._if;296;66_533}> !eclose_0::B es_1 = case eclose_0 (True -> _predefined._Nil) (_ -> es_1)
iTasks.Internal.WebService.dataFun_54 taskUrls_0 req_1 output_2 data_3 !_x_4 iworld_5 = case _x_4 (_Tuple3 clientname_1_0 state_1_1 instances_1_2 -> let _x_2_0 = iTasks.Internal.WebService.wsockAddData state_1_1 data_3, _x_2_1 = iTasks.Internal.WebService.handleEvents_43 taskUrls_0 req_1 clientname_1_0 instances_1_2 _predefined._Nil False (select _x_2_0::_Tuple2 1) iworld_5 in _Tuple5 (select _x_2_1::_Tuple4 0) (select _x_2_1::_Tuple4 1) (_Tuple3 clientname_1_0 (select _x_2_0::_Tuple2 0) (select _x_2_1::_Tuple4 2)) Data.Maybe.Nothing (select _x_2_1::_Tuple4 3)) 
iTasks.Internal.WebService.shareChangeFun_55 _x_0 _x_1 connState_2 iworld_3 = _Tuple5 _predefined._Nil False connState_2 Data.Maybe.Nothing iworld_3
iTasks.Internal.WebService.fst_90 !tuple_0 = select tuple_0::_Tuple2 0
iTasks.Internal.WebService.fst_89 !tuple_0 = select tuple_0::_Tuple2 0
iTasks.Internal.WebService.verifyKey_48 !_x_0 !iworld_1 = case _x_0 (_Tuple2 instanceNo_1_0 viewportKey_1_1 -> <{iTasks.Internal.WebService._c;374;53_534}> (iTasks.Internal.SDS.read (iTasks.SDS.Combinators.Common.sdsFocus (<{iTasks.WF.Definition.iTask;}> (<{iTasks.Internal.WebService.gEditor_s;}> iTasks.UI.Editor.Generic.gEditor_Int_7) (<{iTasks.Internal.WebService.gText_s;}> iTasks.Internal.Generic.Visualization.gText_Int_11) (<{iTasks.Internal.WebService.JSONEncode_s;}> Text.JSON.JSONEncode_Int_11) (<{iTasks.Internal.WebService.JSONDecode_s;}> Text.JSON.JSONDecode_Int_35) (<{iTasks.Internal.WebService.gDefault_s;}> iTasks.Internal.Generic.Defaults.gDefault_Int_8) (<{iTasks.Internal.WebService.gEq_s;}> GenEq.gEq_Int_2) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Int))) instanceNo_1_0 iTasks.Internal.TaskStore.taskInstanceProgress) iworld_1) viewportKey_1_1) 
<{iTasks.Internal.WebService._c;374;53_534}> !_x_0 viewportKey_1 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> case _x_2_0 (iTasks.WF.Definition._InstanceProgress value_3_0 attachedTo_3_1 instanceKey_3_2 firstEvent_3_3 lastEvent_3_4 -> _Tuple2 (<{StdString.==_2}> viewportKey_1 instanceKey_3_2) iworld_1_1) ) (_ -> _Tuple2 False iworld_1_1)) 
iTasks.Internal.WebService.filterSt_49 p_0 !_x_1 s_2 = case _x_1 (_predefined._Nil -> _Tuple2 _predefined._Nil s_2) (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = p_0 x_1_0 s_2, s_2_1 = select _x_2_0::_Tuple2 1, _x_2_2 = iTasks.Internal.WebService.filterSt_49 p_0 xs_1_1 s_2_1, xs_2_3 = select _x_2_2::_Tuple2 0 in _Tuple2 (<{iTasks.Internal.WebService._if;382;16_535}> (select _x_2_0::_Tuple2 0) x_1_0 xs_2_3) (select _x_2_2::_Tuple2 1)) 
<{iTasks.Internal.WebService._if;382;16_535}> !_x_0::B x_1 xs_2 = case _x_0 (True -> _predefined._Cons x_1 xs_2) (_ -> xs_2)
iTasks.Internal.WebService.verifyKeys_61 !instances_0 !iworld_1 = iTasks.Internal.WebService.filterSt_49 iTasks.Internal.WebService.verifyKey_48 instances_0 iworld_1
<{iTasks.Internal.WebService.get`_88}> !<{_v<_0}> _x_1 !_x_2 = case _x_2 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 _x_1 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_88}> <{_v<_0}> _x_1 l_1_3) (False -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 kx_1_1 _x_1) (True -> <{iTasks.Internal.WebService.get`_88}> <{_v<_0}> _x_1 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
iTasks.Internal.WebService.toList_47 q_0 = <{iTasks.Internal.WebService._c;367;20_536}> (Data.Queue.dequeue q_0)
<{iTasks.Internal.WebService._c;367;20_536}> !_x_0 = case _x_0 (_Tuple2 _x_1_0 q_1_1 -> case _x_1_0 (Data.Maybe.Nothing -> _predefined._Nil) (Data.Maybe.Just x_2_0 -> _predefined._Cons x_2_0 (iTasks.Internal.WebService.toList_47 q_1_1)) ) 
<{iTasks.Internal.WebService.c;364;35_46}> i_0 !g_l_1 = <{iTasks.Internal.WebService.g_c1;364;40_537}> g_l_1 i_0
<{iTasks.Internal.WebService.g_c1;364;40_537}> !g_l_0 i_1 = case g_l_0 (_predefined._Cons c_1_0 g_t_1_1 -> _predefined._Cons (_Tuple2 i_1 c_1_0) (<{iTasks.Internal.WebService.c;364;35_46}> i_1 g_t_1_1)) (_ -> _predefined._Nil)
<{iTasks.Internal.WebService.get`_469}> _x_0::I !_x_1 = case _x_1 (Data.Map.Tip -> Data.Maybe.Nothing) (Data.Map.Bin _x_1_0 kx_1_1 x_1_2 l_1_3 r_1_4 -> case (<{StdInt.<_17}> _x_0 kx_1_1) (True -> <{iTasks.Internal.WebService.get`_469}> _x_0 l_1_3) (False -> case (<{StdInt.<_17}> kx_1_1 _x_0) (True -> <{iTasks.Internal.WebService.get`_469}> _x_0 r_1_4) (False -> Data.Maybe.Just x_1_2) ) ) 
iTasks.Internal.WebService.dequeueOutput_60 !_x_0 !states_1 = case _x_0 (_predefined._Nil -> <{_Tuple2!3}> _predefined._Nil states_1) (_predefined._Cons i_1_0 is_1_1 -> let _x_2_0 = iTasks.Internal.WebService.dequeueOutput_60 is_1_1 states_1, states_2_1 = select _x_2_0::_Tuple2 1, output_2_2 = select _x_2_0::_Tuple2 0 in <{iTasks.Internal.WebService._c;363;11_538}> (<{iTasks.Internal.WebService.get`_469}> i_1_0 states_2_1) i_1_0 output_2_2 states_2_1) 
<{iTasks.Internal.WebService._c;363;11_538}> !_x_0 i_1::I output_2 !states_3 = case _x_0 (Data.Maybe.Just out_1_0 -> <{_Tuple2!3}> (<{StdList.++}> (<{iTasks.Internal.WebService.c;364;35_46}> i_1 (iTasks.Internal.WebService.toList_47 out_1_0)) output_2) (Data.Map.put (<{StdOverloaded.<;}> <{StdInt.<_17}>) i_1 Data.Queue.newQueue states_3)) (Data.Maybe.Nothing -> <{_Tuple2!3}> output_2 states_3) 
<{iTasks.Internal.WebService.c;347;99_45}> !g_l_0 = <{iTasks.Internal.WebService.g_c1;347;122_540}> g_l_0
<{iTasks.Internal.WebService.g_c1;347;122_540}> !g_l_0 = case g_l_0 (_predefined._Cons g_h_1_0 g_t_1_1 -> <{iTasks.Internal.WebService.g_c2;347;122_539}> g_h_1_0 g_t_1_1) (_ -> _predefined._Nil)
<{iTasks.Internal.WebService.g_c2;347;122_539}> !g_h_0 g_t_1 = case g_h_0 (_Tuple2 instanceNo_1_0 change_1_1 -> _predefined._Cons (iTasks.Internal.WebService.wsockTextMsg (Text.JSON.toString_7 (Text.JSON.JSONObject (_predefined._Cons (_Tuple2 "instance" (Text.JSON.JSONInt instanceNo_1_0)) (_predefined._Cons (_Tuple2 "change" (iTasks.UI.Definition.encodeUIChange change_1_1)) _predefined._Nil))))) (<{iTasks.Internal.WebService.c;347;99_45}> g_t_1)) (_ -> <{iTasks.Internal.WebService.c;347;99_45}> g_t_1)
iTasks.Internal.WebService.onTick_56 req_0 !output_1 !_x_2 !iworld_3 = case _x_2 (_Tuple3 clientname_1_0 state_1_1 instances_1_2 -> let _x_2_0 = iTasks.Internal.WebService.verifyKeys_61 instances_1_2 iworld_3, instances_2_1 = select _x_2_0::_Tuple2 0, _x_2_2 = iTasks.Internal.WebService.dequeueOutput_60 (StdList.map iTasks.Internal.WebService.fst_89 instances_2_1) output_1, changes_2_3 = select _x_2_2::_Tuple2 0, output_2_4 = select _x_2_2::_Tuple2 1, iworld_2_5 = select _x_2_0::_Tuple2 1 in <{iTasks.Internal.WebService._c;342;11_541}> changes_2_3 clientname_1_0 state_1_1 instances_2_1 iworld_2_5 output_2_4) 
<{iTasks.Internal.WebService._c;342;11_541}> !changes_0 clientname_1 state_2 instances_3 iworld_4 output_5 = case changes_0 (_predefined._Nil -> _Tuple5 _predefined._Nil False (_Tuple3 clientname_1 state_2 instances_3) Data.Maybe.Nothing iworld_4) (_ -> _Tuple5 (StdList.flatten (<{iTasks.Internal.WebService.c;347;99_45}> changes_0)) False (_Tuple3 clientname_1 state_2 instances_3) (Data.Maybe.Just output_5) (select (iTasks.Internal.TaskEval.updateInstanceLastIO (StdList.map iTasks.Internal.WebService.fst_90 instances_3) iworld_4)::_Tuple2 1))
iTasks.Internal.WebService.fst_87 !tuple_0 = select tuple_0::_Tuple2 0
iTasks.Internal.WebService.disconnectFun_57 _x_0 _x_1 !_x_2 iworld_3 = case _x_2 (_Tuple3 clientname_1_0 state_1_1 instances_1_2 -> _Tuple2 Data.Maybe.Nothing (select (iTasks.Internal.TaskEval.updateInstanceDisconnect (StdList.map iTasks.Internal.WebService.fst_87 instances_1_2) iworld_3)::_Tuple2 1)) (_ -> _Tuple2 Data.Maybe.Nothing iworld_3)
iTasks.Internal.WebService.taskUIService !taskUrls_0 = iTasks.Internal.WebService._WebService (iTasks.Internal.WebService.matchFun_51 (<{iTasks.Internal.WebService.c;257;60_41}> taskUrls_0)) True (<{iTasks.Internal.WebService.reqFun`_52}> taskUrls_0) (iTasks.Internal.WebService.dataFun_54 taskUrls_0) iTasks.Internal.WebService.shareChangeFun_55 iTasks.Internal.WebService.onTick_56 iTasks.Internal.WebService.disconnectFun_57
iTasks.Internal.WebService.matchFun_64::B !path_0 = <{iTasks.Internal.WebService._c;406;21_542}> (StdList.dropWhile (<{StdString.==_2}> "") (Text.split_13 "/" path_0))
<{iTasks.Internal.WebService._c;406;21_542}>::B !_x_0 = case _x_0 (_predefined._Cons _x_1_0 _x_1_1 -> case _x_1_0 ("upload" -> case _x_1_1 (_predefined._Nil -> True) ) ("download" -> case _x_1_1 (_predefined._Cons _x_3_0 _x_3_1 -> case _x_3_1 (_predefined._Nil -> True) ) ) ) (_ -> False)
iTasks.Internal.WebService.anon_98 k_0 x_1 xs_2 = _predefined._Cons (_Tuple2 k_0 x_1) xs_2
iTasks.Internal.WebService.jsonResponse !_vtoString_0 json_1 = update Internet.HTTP.okResponse::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Content-Type" "text/json") (_predefined._Cons (_Tuple2 "Access-Control-Allow-Origin" "*") _predefined._Nil),4:select _vtoString_0::<{StdOverloaded.toString;}> 0 json_1]
iTasks.Internal.WebService.createDocumentsFromUploads !_x_0 iworld_1 = case _x_0 (_predefined._Nil -> _Tuple2 _predefined._Nil iworld_1) (_predefined._Cons _x_1_0 us_1_1 -> case _x_1_0 (_Tuple2 n_2_0 u_2_1 -> let _x_3_0 = iTasks.Internal.TaskStore.createDocument (select u_2_1::Internet.HTTP._HTTPUpload 1) (select u_2_1::Internet.HTTP._HTTPUpload 2) (select u_2_1::Internet.HTTP._HTTPUpload 3) iworld_1, mbD_3_1 = select _x_3_0::_Tuple2 0 in case (Data.Error.isError mbD_3_1) (True -> iTasks.Internal.WebService.createDocumentsFromUploads us_1_1 (select _x_3_0::_Tuple2 1)) (False -> let _x_5_0 = iTasks.Internal.WebService.createDocumentsFromUploads us_1_1 (select _x_3_0::_Tuple2 1) in _Tuple2 (_predefined._Cons (Data.Error.fromOk mbD_3_1) (select _x_5_0::_Tuple2 0)) (select _x_5_0::_Tuple2 1)) ) ) 
iTasks.Internal.WebService.JSONEncode_s_155 !_vJSONEncode_s_0 !x1_1::B !x2_2 = Text.JSON.JSONEncode__List_17 (select _vJSONEncode_s_0::<{iTasks.Internal.WebService.JSONEncode_s;}> 0) x1_1 x2_2
iTasks.Internal.WebService.jsonResponse_470 json_0 = update Internet.HTTP.okResponse::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Content-Type" "text/json") (_predefined._Cons (_Tuple2 "Access-Control-Allow-Origin" "*") _predefined._Nil),4:Text.JSON.toString_7 json_0]
iTasks.Internal.WebService.JSONEncode_s_471 !x1_0::B !x2_1 = Text.JSON.JSONEncode__List_17 iTasks.Extensions.Document.JSONEncode_Document_5 x1_0 x2_1
iTasks.Internal.WebService.reqFun_65 !req_0 output_1 !iworld_2 = case iworld_2 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> case server_1_0 (iTasks.Internal.IWorld._ServerInfo serverName_2_0 serverURL_2_1 build_2_2 paths_2_3 -> <{iTasks.Internal.WebService._c;412;11_544}> (StdList.dropWhile (<{StdString.==_2}> "") (Text.split_13 "/" (select req_0::Internet.HTTP._HTTPRequest 1))) req_0 iworld_2) ) 
<{iTasks.Internal.WebService._c;412;11_544}> !_x_0 req_1 iworld_2 = case _x_0 (_predefined._Cons _x_1_0 _x_1_1 -> case _x_1_0 ("upload" -> case _x_1_1 (_predefined._Nil -> let uploads_4_0 = Data.Map.foldrWithKey iTasks.Internal.WebService.anon_98 _predefined._Nil (select req_1::Internet.HTTP._HTTPRequest 10) in case (<{StdInt.==_16}> (StdList.length_47 uploads_4_0) 0) (True -> _Tuple4 (iTasks.Internal.WebService.jsonResponse_470 (Text.JSON.JSONArray _predefined._Nil)) Data.Maybe.Nothing Data.Maybe.Nothing iworld_2) (False -> let _x_6_0 = iTasks.Internal.WebService.createDocumentsFromUploads uploads_4_0 iworld_2 in _Tuple4 (iTasks.Internal.WebService.jsonResponse_470 (Text.JSON.toJSON (<{iTasks.Internal.WebService.JSONEncode_s;}> iTasks.Internal.WebService.JSONEncode_s_471) (select _x_6_0::_Tuple2 0))) Data.Maybe.Nothing Data.Maybe.Nothing (select _x_6_0::_Tuple2 1)) ) ) ("download" -> case _x_1_1 (_predefined._Cons downloadParam_3_0 _x_3_1 -> case _x_3_1 (_predefined._Nil -> let _x_5_0 = iTasks.Internal.TaskStore.loadDocumentContent downloadParam_3_0 iworld_2, iworld_5_1 = select _x_5_0::_Tuple2 1, _x_5_2 = iTasks.Internal.TaskStore.loadDocumentMeta downloadParam_3_0 iworld_5_1, iworld_5_3 = select _x_5_2::_Tuple2 1 in <{iTasks.Internal.WebService._c;422;19_543}> (_Tuple2 (select _x_5_0::_Tuple2 0) (select _x_5_2::_Tuple2 0)) iworld_5_3 req_1) ) ) ) (_ -> _Tuple4 (iTasks.Internal.HtmlUtil.notFoundResponse req_1) Data.Maybe.Nothing Data.Maybe.Nothing iworld_2)
<{iTasks.Internal.WebService._c;422;19_543}> !_x_0 iworld_1 req_2 = case _x_0 (_Tuple2 _x_1_0 _x_1_1 -> case _x_1_0 (Data.Maybe.Just content_2_0 -> case _x_1_1 (Data.Maybe.Just _x_3_0 -> case _x_3_0 (iTasks.Extensions.Document._Document document_4_0 contentUrl_4_1 name_4_2 mime_4_3 size_4_4 -> _Tuple4 (update Internet.HTTP.okResponse::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Content-Type" mime_4_3) (_predefined._Cons (_Tuple2 "Content-Length" (StdString.toString_5 size_4_4)) (_predefined._Cons (_Tuple2 "Content-Disposition" (<{StdString.+++_11}> "attachment;filename=\"" (<{StdString.+++_11}> name_4_2 "\""))) _predefined._Nil)),4:content_2_0]) Data.Maybe.Nothing Data.Maybe.Nothing iworld_1) ) ) ) (_ -> _Tuple4 (iTasks.Internal.HtmlUtil.notFoundResponse req_2) Data.Maybe.Nothing Data.Maybe.Nothing iworld_1)
iTasks.Internal.WebService.dataFun_66 _x_0 _x_1 _x_2 s_3 env_4 = _Tuple5 _predefined._Nil True s_3 Data.Maybe.Nothing env_4
iTasks.Internal.WebService.onShareChange_68 _x_0 _x_1 s_2 env_3 = _Tuple5 _predefined._Nil True s_2 Data.Maybe.Nothing env_3
iTasks.Internal.WebService.onTick_67 _x_0 _x_1 s_2 env_3 = _Tuple5 _predefined._Nil True s_2 Data.Maybe.Nothing env_3
iTasks.Internal.WebService.lostFun_69 _x_0 _x_1 s_2 env_3 = _Tuple2 Data.Maybe.Nothing env_3
iTasks.Internal.WebService.documentService = iTasks.Internal.WebService._WebService iTasks.Internal.WebService.matchFun_64 True iTasks.Internal.WebService.reqFun_65 iTasks.Internal.WebService.dataFun_66 iTasks.Internal.WebService.onShareChange_68 iTasks.Internal.WebService.onTick_67 iTasks.Internal.WebService.lostFun_69
iTasks.Internal.WebService.anon_99 !f_0 g_1 x_2 = f_0 (g_1 x_2)
iTasks.Internal.WebService.anon_472 !_x_0 !_x_1 !g_2 x_3 = Text.replaceSubString_10 _x_0 _x_1 (g_2 x_3)
iTasks.Internal.WebService.anon_473 !_x_0 !_x_1 !_x_2 !_x_3 !x_4 = Text.replaceSubString_10 _x_0 _x_1 (Text.replaceSubString_10 _x_2 _x_3 x_4)
iTasks.Internal.WebService.filePath_70 !path_0 = iTasks.Internal.WebService.anon_473 "/" (_SystemArray.update_21 (_SystemArray._createArray_16 1) 0 System.FilePath.pathSeparator) ".." "" path_0
iTasks.Internal.WebService.mimeType_71 !path_0 = Text.Encodings.MIME.extensionToMimeType (System.FilePath.takeExtension path_0)
iTasks.Internal.WebService.handleStaticResourceRequest_77 !taskPaths_0 !req_1 !iworld_2 = case iworld_2 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> case server_1_0 (iTasks.Internal.IWorld._ServerInfo serverName_2_0 serverURL_2_1 build_2_2 _x_2_3 -> case _x_2_3 (iTasks.Internal.IWorld._SystemPaths appDirectory_3_0 dataDirectory_3_1 webDirectory_3_2 saplDirectory_3_3 -> let filename_4_0 = <{iTasks.Internal.WebService._if;471;30_545}> (StdList.isMember (<{StdClass.Eq;}> (<{StdOverloaded.==;}> <{StdString.==_2}>)) (select req_1::Internet.HTTP._HTTPRequest 1) taskPaths_0) webDirectory_3_2 req_1, _x_4_1 = System.File.getFileInfo filename_4_0 world_1_12 in case (<{iTasks.Internal.WebService._c;477;11_546}> (select _x_4_1::_Tuple2 0)) (True -> <{_Tuple2!3}> (iTasks.Internal.HtmlUtil.notFoundResponse req_1) (update iworld_2::iTasks.Internal.IWorld._IWorld [12:select _x_4_1::_Tuple2 1])) (False -> let world_6_0 = select _x_4_1::_Tuple2 1, _x_6_1 = System.File.readFile (<{StdFile.FileSystem;}> StdFile.fclose_30 StdFile.fopen_31 StdFile.sfopen_32 StdFile.stdio_33) filename_4_0 world_6_0, world_6_2 = select _x_6_1::_Tuple2 1 in <{iTasks.Internal.WebService._c;480;11_547}> (select _x_6_1::_Tuple2 0) filename_4_0 iworld_2 world_6_2) ) ) ) 
<{iTasks.Internal.WebService._c;480;11_547}> !_x_0 filename_1 !iworld_2 !world_3 = case _x_0 (Data.Error.Ok content_1_0 -> <{_Tuple2!3}> (update Internet.HTTP.okResponse::Internet.HTTP._HTTPResponse [3:_predefined._Cons (_Tuple2 "Content-Type" (iTasks.Internal.WebService.mimeType_71 filename_1)) (_predefined._Cons (_Tuple2 "Content-Length" (StdString.toString_5 (_SystemArray.size_20 content_1_0))) _predefined._Nil),4:content_1_0]) (update iworld_2::iTasks.Internal.IWorld._IWorld [12:world_3])) (Data.Error.Error e_1_0 -> <{_Tuple2!3}> (Internet.HTTP.errorResponse (<{StdString.+++_11}> (System.File.toString_10 e_1_0) (<{StdString.+++_11}> " (" (<{StdString.+++_11}> filename_1 ")")))) (update iworld_2::iTasks.Internal.IWorld._IWorld [12:world_3])) 
<{iTasks.Internal.WebService._c;477;11_546}>::B !_x_0 = case _x_0 (Data.Error.Ok info_1_0 -> select info_1_0::System.File._FileInfo 0) (_ -> True)
<{iTasks.Internal.WebService._if;471;30_545}> !_x_0::B !webDirectory_1 req_2 = case _x_0 (True -> <{StdString.+++_11}> webDirectory_1 (iTasks.Internal.WebService.filePath_70 "/index.html")) (_ -> <{StdString.+++_11}> webDirectory_1 (iTasks.Internal.WebService.filePath_70 (select req_2::Internet.HTTP._HTTPRequest 1)))
iTasks.Internal.WebService.initFun_72 taskPaths_0 req_1 _x_2 env_3 = let _x_1_0 = iTasks.Internal.WebService.handleStaticResourceRequest_77 taskPaths_0 req_1 env_3 in _Tuple4 (select _x_1_0::_Tuple2 0) Data.Maybe.Nothing Data.Maybe.Nothing (select _x_1_0::_Tuple2 1)
iTasks.Internal.WebService.dataFun_73 _x_0 _x_1 _x_2 s_3 env_4 = _Tuple5 _predefined._Nil True s_3 Data.Maybe.Nothing env_4
iTasks.Internal.WebService.shareChangeFun_74 _x_0 _x_1 s_2 env_3 = _Tuple5 _predefined._Nil True s_2 Data.Maybe.Nothing env_3
iTasks.Internal.WebService.onTick_75 _x_0 _x_1 s_2 env_3 = _Tuple5 _predefined._Nil True s_2 Data.Maybe.Nothing env_3
iTasks.Internal.WebService.lostFun_76 _x_0 _x_1 s_2 env_3 = _Tuple2 Data.Maybe.Nothing env_3
iTasks.Internal.WebService.staticResourceService taskPaths_0 = iTasks.Internal.WebService._WebService (StdFunc.const True) True (iTasks.Internal.WebService.initFun_72 taskPaths_0) iTasks.Internal.WebService.dataFun_73 iTasks.Internal.WebService.shareChangeFun_74 iTasks.Internal.WebService.onTick_75 iTasks.Internal.WebService.lostFun_76
<{iTasks.Internal.WebService.TD;ConnectionState}> _x_0::B = _predefined._Nil
<{iTasks.Internal.WebService.TD;WebSockState}> _x_0::B = _predefined._Nil
<{iTasks.Internal.WebService.TD;WebSockEvent}> _x_0::B = _predefined._Nil
<{iTasks.Internal.WebService.TD;WebService}> _x_0::B = _predefined._Nil
<{iTasks.Internal.WebService.TD;ChangeQueues}> _x_0::B = _predefined._Nil
<{iTasks.Internal.WebService.TD;NetTaskState}> _x_0::B = _predefined._Nil
<{iTasks.Internal.WebService.TD;HttpReqState}> _x_0::B = _predefined._Nil

:: iTasks.Internal.WebService.WebSockEvent = iTasks.Internal.WebService.WSTextMessage a1 | iTasks.Internal.WebService.WSBinMessage a1 | iTasks.Internal.WebService.WSClose a1 | iTasks.Internal.WebService.WSPing a1
:: iTasks.Internal.WebService.NetTaskState = iTasks.Internal.WebService.NTIdle a1 a2 | iTasks.Internal.WebService.NTReadingRequest a1 | iTasks.Internal.WebService.NTProcessingRequest a1 a2

|| Converted Records
:: iTasks.Internal.WebService._WebSockState = {!iTasks.Internal.WebService.cur_frame, !iTasks.Internal.WebService.message_text::B, !iTasks.Internal.WebService.message_data}

:: iTasks.Internal.WebService._WebService = {!iTasks.Internal.WebService.urlMatchPred, !iTasks.Internal.WebService.completeRequest::B, !iTasks.Internal.WebService.onNewReq, !iTasks.Internal.WebService.onData, !iTasks.Internal.WebService.onShareChange, !iTasks.Internal.WebService.onTick, !iTasks.Internal.WebService.onDisconnect}

:: iTasks.Internal.WebService._HttpReqState = {iTasks.Internal.WebService.request, iTasks.Internal.WebService.method_done::B, iTasks.Internal.WebService.headers_done::B, iTasks.Internal.WebService.data_done::B, iTasks.Internal.WebService.error::B}

:: <{iTasks.Internal.WebService.JSONEncode_s;}> = {!iTasks.Internal.WebService.JSONEncode_s}

:: <{iTasks.Internal.WebService.JSONEncode_ss;}> = {!iTasks.Internal.WebService.JSONEncode_ss}

:: <{iTasks.Internal.WebService.JSONEncode_sss;}> = {!iTasks.Internal.WebService.JSONEncode_sss}

:: <{iTasks.Internal.WebService.JSONDecode_s;}> = {!iTasks.Internal.WebService.JSONDecode_s}

:: <{iTasks.Internal.WebService.JSONDecode_ss;}> = {!iTasks.Internal.WebService.JSONDecode_ss}

:: <{iTasks.Internal.WebService.JSONDecode_sss;}> = {!iTasks.Internal.WebService.JSONDecode_sss}

:: <{iTasks.Internal.WebService.gDefault_s;}> = {iTasks.Internal.WebService.gDefault_s}

:: <{iTasks.Internal.WebService.gDefault_ss;}> = {iTasks.Internal.WebService.gDefault_ss}

:: <{iTasks.Internal.WebService.gDefault_sss;}> = {iTasks.Internal.WebService.gDefault_sss}

:: <{iTasks.Internal.WebService.gText_s;}> = {!iTasks.Internal.WebService.gText_s}

:: <{iTasks.Internal.WebService.gText_ss;}> = {!iTasks.Internal.WebService.gText_ss}

:: <{iTasks.Internal.WebService.gText_sss;}> = {!iTasks.Internal.WebService.gText_sss}

:: <{iTasks.Internal.WebService.gEditor_s;}> = {iTasks.Internal.WebService.gEditor_s}

:: <{iTasks.Internal.WebService.gEditor_ss;}> = {iTasks.Internal.WebService.gEditor_ss}

:: <{iTasks.Internal.WebService.gEditor_sss;}> = {iTasks.Internal.WebService.gEditor_sss}

:: <{iTasks.Internal.WebService.gEq_s;}> = {!iTasks.Internal.WebService.gEq_s}

:: <{iTasks.Internal.WebService.gEq_ss;}> = {!iTasks.Internal.WebService.gEq_ss}

:: <{iTasks.Internal.WebService.gEq_sss;}> = {!iTasks.Internal.WebService.gEq_sss}

:: <{iTasks.Internal.WebService.gEq_ssss;}> = {!iTasks.Internal.WebService.gEq_ssss}

:: <{iTasks.Internal.WebService.gEq_sssss;}> = {!iTasks.Internal.WebService.gEq_sssss}

:: <{iTasks.Internal.WebService.gEq_ssssss;}> = {!iTasks.Internal.WebService.gEq_ssssss}

:: <{iTasks.Internal.WebService.gEq_sssssss;}> = {!iTasks.Internal.WebService.gEq_sssssss}

:: <{iTasks.Internal.WebService.gEq_ssssssss;}> = {!iTasks.Internal.WebService.gEq_ssssssss}

:: <{iTasks.Internal.WebService.gEq_sssssssss;}> = {!iTasks.Internal.WebService.gEq_sssssssss}

:: <{iTasks.Internal.WebService.bimap_s;}> = {iTasks.Internal.WebService.bimap_s}

:: <{iTasks.Internal.WebService.bimap_ss;}> = {iTasks.Internal.WebService.bimap_ss}

:: <{iTasks.Internal.WebService.bimap_sss;}> = {iTasks.Internal.WebService.bimap_sss}

:: <{iTasks.Internal.WebService.JSONEncode_ssss;}> = {!iTasks.Internal.WebService.JSONEncode_ssss}

:: <{iTasks.Internal.WebService.JSONEncode_sssss;}> = {!iTasks.Internal.WebService.JSONEncode_sssss}

:: <{iTasks.Internal.WebService.JSONEncode_ssssss;}> = {!iTasks.Internal.WebService.JSONEncode_ssssss}

:: <{iTasks.Internal.WebService.JSONEncode_sssssss;}> = {!iTasks.Internal.WebService.JSONEncode_sssssss}

:: <{iTasks.Internal.WebService.JSONEncode_ssssssss;}> = {!iTasks.Internal.WebService.JSONEncode_ssssssss}

:: <{iTasks.Internal.WebService.JSONEncode_sssssssss;}> = {!iTasks.Internal.WebService.JSONEncode_sssssssss}

:: <{iTasks.Internal.WebService.JSONDecode_ssss;}> = {!iTasks.Internal.WebService.JSONDecode_ssss}

:: <{iTasks.Internal.WebService.JSONDecode_sssss;}> = {!iTasks.Internal.WebService.JSONDecode_sssss}

:: <{iTasks.Internal.WebService.JSONDecode_ssssss;}> = {!iTasks.Internal.WebService.JSONDecode_ssssss}

:: <{iTasks.Internal.WebService.JSONDecode_sssssss;}> = {!iTasks.Internal.WebService.JSONDecode_sssssss}

:: <{iTasks.Internal.WebService.JSONDecode_ssssssss;}> = {!iTasks.Internal.WebService.JSONDecode_ssssssss}

:: <{iTasks.Internal.WebService.JSONDecode_sssssssss;}> = {!iTasks.Internal.WebService.JSONDecode_sssssssss}

:: <{iTasks.Internal.WebService.gText_ssss;}> = {!iTasks.Internal.WebService.gText_ssss}

:: <{iTasks.Internal.WebService.gText_sssss;}> = {!iTasks.Internal.WebService.gText_sssss}

:: <{iTasks.Internal.WebService.gText_ssssss;}> = {!iTasks.Internal.WebService.gText_ssssss}

:: <{iTasks.Internal.WebService.gText_sssssss;}> = {!iTasks.Internal.WebService.gText_sssssss}

:: <{iTasks.Internal.WebService.gText_ssssssss;}> = {!iTasks.Internal.WebService.gText_ssssssss}

:: <{iTasks.Internal.WebService.gText_sssssssss;}> = {!iTasks.Internal.WebService.gText_sssssssss}

:: <{iTasks.Internal.WebService.gDefault_ssss;}> = {iTasks.Internal.WebService.gDefault_ssss}

:: <{iTasks.Internal.WebService.gDefault_sssss;}> = {iTasks.Internal.WebService.gDefault_sssss}

:: <{iTasks.Internal.WebService.gDefault_ssssss;}> = {iTasks.Internal.WebService.gDefault_ssssss}

:: <{iTasks.Internal.WebService.gDefault_sssssss;}> = {iTasks.Internal.WebService.gDefault_sssssss}

:: <{iTasks.Internal.WebService.gDefault_ssssssss;}> = {iTasks.Internal.WebService.gDefault_ssssssss}

:: <{iTasks.Internal.WebService.gDefault_sssssssss;}> = {iTasks.Internal.WebService.gDefault_sssssssss}

:: <{iTasks.Internal.WebService.gEditor_ssss;}> = {iTasks.Internal.WebService.gEditor_ssss}

:: <{iTasks.Internal.WebService.gEditor_sssss;}> = {iTasks.Internal.WebService.gEditor_sssss}

:: <{iTasks.Internal.WebService.gEditor_ssssss;}> = {iTasks.Internal.WebService.gEditor_ssssss}

:: <{iTasks.Internal.WebService.gEditor_sssssss;}> = {iTasks.Internal.WebService.gEditor_sssssss}

