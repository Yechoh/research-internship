|| ?module? iTasks.WF.Tasks.Core


iTasks.WF.Tasks.Core.anon_12 a_0 task_1 iworld_2 = _Tuple2 (Data.Error.Ok a_0) iworld_2
iTasks.WF.Tasks.Core.treturn !_viTask_0 !a_1 = iTasks.Internal.Task.mkInstantTask _viTask_0 (iTasks.WF.Tasks.Core.anon_12 a_1)
iTasks.WF.Tasks.Core.anon_13 !_vTC_0 !_vtoString_1 e_2 task_3 iworld_4 = _Tuple2 (Data.Error.Error (_Tuple2 (_SystemDynamic._DynamicTemp e_2 (_SystemDynamic._normalise (_SystemDynamic._bind_global_type_pattern_var (_SystemDynamic.TypeVar 0) _vTC_0 (_SystemDynamic._initial_unification_environment 1 0)) (_SystemDynamic.TypeVar 0))) (select _vtoString_1::<{StdOverloaded.toString;}> 0 e_2))) iworld_4
iTasks.WF.Tasks.Core.throw !_viTask_0 !_viTask_1 !_vtoString_2 !e_3 = iTasks.Internal.Task.mkInstantTask _viTask_0 (iTasks.WF.Tasks.Core.anon_13 (select _viTask_1::<{iTasks.WF.Definition.iTask;}> 6) _vtoString_2 e_3)
iTasks.WF.Tasks.Core.eval_14 fun_0 task_1 !iworld_2 = case iworld_2 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> _Tuple2 (Data.Error.Ok _predefined._Unit) (update iworld_2::iTasks.Internal.IWorld._IWorld [12:fun_0 world_1_12])) 
iTasks.WF.Tasks.Core.appWorld !fun_0 = iTasks.Internal.Task.mkInstantTask (<{iTasks.WF.Definition.iTask;}> (<{iTasks.WF.Tasks.Core.gEditor_s;}> iTasks.UI.Editor.Generic.gEditor__Unit_13) (<{iTasks.WF.Tasks.Core.gText_s;}> iTasks.Internal.Generic.Visualization.gText__Unit_17) (<{iTasks.WF.Tasks.Core.JSONEncode_s;}> iTasks.WF.Derives.JSONEncode__Unit_0) (<{iTasks.WF.Tasks.Core.JSONDecode_s;}> iTasks.WF.Derives.JSONDecode__Unit_6) (<{iTasks.WF.Tasks.Core.gDefault_s;}> iTasks.Internal.Generic.Defaults.gDefault__Unit_14) (<{iTasks.WF.Tasks.Core.gEq_s;}> iTasks.WF.Derives.gEq__Unit_12) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__Unit))) (iTasks.WF.Tasks.Core.eval_14 fun_0)
iTasks.WF.Tasks.Core.eval_15 fun_0 task_1 !iworld_2 = case iworld_2 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> let _x_2_0 = fun_0 world_1_12 in _Tuple2 (Data.Error.Ok (select _x_2_0::_Tuple2 0)) (update iworld_2::iTasks.Internal.IWorld._IWorld [12:select _x_2_0::_Tuple2 1])) 
iTasks.WF.Tasks.Core.accWorld !_viTask_0 !fun_1 = iTasks.Internal.Task.mkInstantTask _viTask_0 (iTasks.WF.Tasks.Core.eval_15 fun_1)
iTasks.WF.Tasks.Core.eval_16 !_vTC_0 !_vtoString_1 errf_2 !fun_3 task_4 !iworld_5 = case iworld_5 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> case current_1_3 (iTasks.Internal.IWorld._TaskEvalState taskTime_2_0 task_2_1 session_2_2 attachmentChain_2_3 nextTaskNo_2_4 -> let _x_3_0 = fun_3 world_1_12, world_3_1 = select _x_3_0::_Tuple2 1 in <{iTasks.WF.Tasks.Core._c;41;11_366}> (select _x_3_0::_Tuple2 0) errf_2 _vTC_0 _vtoString_1 iworld_5 world_3_1) ) 
<{iTasks.WF.Tasks.Core._c;41;11_366}> !_x_0 errf_1 a_ij_2 _vtoString_3 iworld_4 world_5 = case _x_0 (Data.Error.Error e_1_0 -> let err_2_0 = errf_1 e_1_0 in _Tuple2 (Data.Error.Error (_Tuple2 (_SystemDynamic._DynamicTemp err_2_0 (_SystemDynamic._normalise (_SystemDynamic._bind_global_type_pattern_var (_SystemDynamic.TypeVar 0) a_ij_2 (_SystemDynamic._initial_unification_environment 1 0)) (_SystemDynamic.TypeVar 0))) (select _vtoString_3::<{StdOverloaded.toString;}> 0 err_2_0))) (update iworld_4::iTasks.Internal.IWorld._IWorld [12:world_5])) (Data.Error.Ok v_1_0 -> _Tuple2 (Data.Error.Ok v_1_0) (update iworld_4::iTasks.Internal.IWorld._IWorld [12:world_5])) 
iTasks.WF.Tasks.Core.accWorldError !_viTask_0 !_vTC_1 !_vtoString_2 !fun_3 !errf_4 = iTasks.Internal.Task.mkInstantTask _viTask_0 (iTasks.WF.Tasks.Core.eval_16 _vTC_1 _vtoString_2 errf_4 fun_3)
iTasks.WF.Tasks.Core.toString_7 !_x_0 = case _x_0 (iTasks.WF.Tasks.Core.OSException _x_1_0 -> case _x_1_0 (_Tuple2 _x_2_0 err_2_1 -> <{StdString.+++_11}> "Error performing OS operation: " err_2_1) ) 
iTasks.WF.Tasks.Core.eval_364 !_vTC_0 errf_1 !fun_2 task_3 !iworld_4 = case iworld_4 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> case current_1_3 (iTasks.Internal.IWorld._TaskEvalState taskTime_2_0 task_2_1 session_2_2 attachmentChain_2_3 nextTaskNo_2_4 -> let _x_3_0 = fun_2 world_1_12, world_3_1 = select _x_3_0::_Tuple2 1 in <{iTasks.WF.Tasks.Core._c;41;11_367}> (select _x_3_0::_Tuple2 0) errf_1 _vTC_0 iworld_4 world_3_1) ) 
<{iTasks.WF.Tasks.Core._c;41;11_367}> !_x_0 errf_1 _vTC_2 iworld_3 world_4 = case _x_0 (Data.Error.Error e_1_0 -> let err_2_0 = errf_1 e_1_0 in _Tuple2 (Data.Error.Error (_Tuple2 (_SystemDynamic._DynamicTemp err_2_0 (_SystemDynamic._normalise (_SystemDynamic._bind_global_type_pattern_var (_SystemDynamic.TypeVar 0) _vTC_2 (_SystemDynamic._initial_unification_environment 1 0)) (_SystemDynamic.TypeVar 0))) (iTasks.WF.Tasks.Core.toString_7 err_2_0))) (update iworld_3::iTasks.Internal.IWorld._IWorld [12:world_4])) (Data.Error.Ok v_1_0 -> _Tuple2 (Data.Error.Ok v_1_0) (update iworld_3::iTasks.Internal.IWorld._IWorld [12:world_4])) 
iTasks.WF.Tasks.Core.accWorldError_363 !_viTask_0 !_vTC_1 !fun_2 !errf_3 = iTasks.Internal.Task.mkInstantTask _viTask_0 (iTasks.WF.Tasks.Core.eval_364 _vTC_1 errf_3 fun_2)
iTasks.WF.Tasks.Core.accWorldOSError !_viTask_0 !fun_1 = iTasks.WF.Tasks.Core.accWorldError_363 _viTask_0 (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{iTasks.WF.Tasks.Core.TD;OSException}>)) fun_1 iTasks.WF.Tasks.Core.OSException
iTasks.WF.Tasks.Core.initMask !_vgEditor_s_0 !_vtoString_1 task_2 mode_3 !mbEditor_4 v_5 iworld_6 = <{iTasks.WF.Tasks.Core._c;100;7_368}> (select (Data.Maybe.fromMaybe (select _vgEditor_s_0::<{iTasks.WF.Tasks.Core.gEditor_s;}> 0) mbEditor_4)::iTasks.UI.Editor._Editor 0 _predefined._Nil v_5 (iTasks.UI.Editor._VSt (select _vtoString_1::<{StdOverloaded.toString;}> 0 task_2) mode_3 False -1 iworld_6))
<{iTasks.WF.Tasks.Core._c;100;7_368}> !_x_0 = case _x_0 (_Tuple2 _x_1_0 _x_1_1 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple2 _x_3_0 mask_3_1 -> case _x_1_1 (iTasks.UI.Editor._VSt task_4_0 mode_4_1 optional_4_2 selectedCons_4_3 iworld_4_4 -> _Tuple2 (Data.Error.Ok mask_3_1) iworld_4_4) ) ) (Data.Error.Error e_2_0 -> case _x_1_1 (iTasks.UI.Editor._VSt task_3_0 mode_3_1 optional_3_2 selectedCons_3_3 iworld_3_4 -> _Tuple2 (Data.Error.Error (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) e_2_0)) iworld_3_4) ) ) 
iTasks.WF.Tasks.Core.anon_18 f_0 r_1 = _Tuple2 _predefined._Unit (f_0 r_1)
iTasks.WF.Tasks.Core.matchAndApplyEvent_ !_vgEditor_s_0 !_vtoPrompt_1 !event_2 task_3 mode_4 mbEditor_5 taskTime_6 shared_7 editFun_8 l_9 ov_10 m_11 ts_12 prompt_13 iworld_14 = <{iTasks.WF.Tasks.Core._c;107;7_378}> event_2 _vgEditor_s_0 mbEditor_5 ov_10 task_3 mode_4 iworld_14 l_9 _vtoPrompt_1 prompt_13 taskTime_6 m_11 editFun_8 shared_7 ts_12
<{iTasks.WF.Tasks.Core._c;107;7_378}> !event_0 _vgEditor_s_1 mbEditor_2 ov_3 task_4 mode_5 iworld_6 l_7 _vtoPrompt_8 prompt_9 taskTime_10 m_11 editFun_12 shared_13 ts_14 = case event_0 (iTasks.WF.Definition.ResetEvent -> <{iTasks.WF.Tasks.Core._c;109;15_369}> (select (Data.Maybe.fromMaybe (select _vgEditor_s_1::<{iTasks.WF.Tasks.Core.gEditor_s;}> 0) mbEditor_2)::iTasks.UI.Editor._Editor 0 _predefined._Nil ov_3 (iTasks.UI.Editor._VSt (iTasks.WF.Definition.toString_2 task_4) mode_5 False -1 iworld_6)) l_7 ov_3 _vtoPrompt_8 prompt_9 taskTime_10) (iTasks.WF.Definition.EditEvent eTask_1_0 name_1_1 edit_1_2 -> case (<{iTasks.WF.Definition.==_4}> eTask_1_0 task_4) (True -> <{iTasks.WF.Tasks.Core._c;113;15_377}> (select (Data.Maybe.fromMaybe (select _vgEditor_s_1::<{iTasks.WF.Tasks.Core.gEditor_s;}> 0) mbEditor_2)::iTasks.UI.Editor._Editor 1 _predefined._Nil (_Tuple2 (iTasks.UI.Editor.s2dp name_1_1) edit_1_2) ov_3 m_11 (iTasks.UI.Editor._VSt (iTasks.WF.Definition.toString_2 task_4) mode_5 False -1 iworld_6)) editFun_12 l_7 ov_3 shared_13 taskTime_10) ) (_ -> _Tuple2 (Data.Error.Ok (_Tuple5 l_7 ov_3 iTasks.UI.Definition.NoChange m_11 ts_14)) iworld_6)
<{iTasks.WF.Tasks.Core._c;113;15_377}> !_x_0 editFun_1 l_2 ov_3 shared_4 taskTime_5 = case _x_0 (_Tuple3 _x_1_0 v_1_1 _x_1_2 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple2 change_3_0 m_3_1 -> case _x_1_2 (iTasks.UI.Editor._VSt task_4_0 mode_4_1 optional_4_2 selectedCons_4_3 iworld_4_4 -> let _x_5_0 = editFun_1 v_1_1 l_2 ov_3, v_5_1 = select _x_5_0::_Tuple3 1, l_5_2 = select _x_5_0::_Tuple3 0 in <{iTasks.WF.Tasks.Core._c;117;23_376}> (select _x_5_0::_Tuple3 2) shared_4 iworld_4_4 l_5_2 v_5_1 change_3_0 m_3_1 taskTime_5) ) ) (Data.Error.Error e_2_0 -> case _x_1_2 (iTasks.UI.Editor._VSt task_3_0 mode_3_1 optional_3_2 selectedCons_3_3 iworld_3_4 -> _Tuple2 (Data.Error.Error (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) e_2_0)) iworld_3_4) ) ) 
<{iTasks.WF.Tasks.Core._c;117;23_376}> !_x_0 shared_1 iworld_2 l_3 v_4 change_5 m_6 taskTime_7 = case _x_0 (Data.Maybe.Just f_1_0 -> <{iTasks.WF.Tasks.Core._c;118;34_375}> (iTasks.Internal.SDS.modify (iTasks.WF.Tasks.Core.anon_18 f_1_0) shared_1 iworld_2) l_3 v_4 change_5 m_6 taskTime_7 _x_0 iworld_2) (_ -> <{iTasks.WF.Tasks.Core._c;117;23_371}> _x_0 l_3 v_4 change_5 m_6 taskTime_7 iworld_2)
<{iTasks.WF.Tasks.Core._c;118;34_375}> !_x_0 l_1 v_2 change_3 m_4 taskTime_5 _x_6 iworld_7 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> iTasks.WF.Tasks.Core._f374_374 _x_2_0 l_1 v_2 change_3 m_4 taskTime_5 iworld_1_1 _x_1_0 _x_6 iworld_7) (_ -> iTasks.WF.Tasks.Core._f372_372 _x_1_0 iworld_1_1 _x_6 l_1 v_2 change_3 m_4 taskTime_5 iworld_7)) 
iTasks.WF.Tasks.Core._f374_374 !_x_0 l_1 v_2 change_3 m_4 taskTime_5 iworld_6 _x_7 _x_8 iworld_9 = case _x_0 (_predefined._Unit -> _Tuple2 (Data.Error.Ok (_Tuple5 l_1 v_2 (<{iTasks.WF.Tasks.Core._c;116;32_373}> change_3) m_4 taskTime_5)) iworld_6) (_ -> iTasks.WF.Tasks.Core._f372_372 _x_7 iworld_6 _x_8 l_1 v_2 change_3 m_4 taskTime_5 iworld_9)
<{iTasks.WF.Tasks.Core._c;116;32_373}> !change_0 = case change_0 (iTasks.UI.Definition.NoChange -> iTasks.UI.Definition.NoChange) (_ -> iTasks.UI.Definition.ChangeUI _predefined._Nil (_predefined._Cons (_Tuple2 1 (iTasks.UI.Definition.ChangeChild change_0)) _predefined._Nil))
iTasks.WF.Tasks.Core._f372_372 !_x_0 iworld_1 _x_2 l_3 v_4 change_5 m_6 taskTime_7 iworld_8 = case _x_0 (Data.Error.Error e_1_0 -> _Tuple2 (Data.Error.Error e_1_0) iworld_1) (_ -> <{iTasks.WF.Tasks.Core._c;117;23_371}> _x_2 l_3 v_4 change_5 m_6 taskTime_7 iworld_8)
<{iTasks.WF.Tasks.Core._c;117;23_371}> !_x_0 l_1 v_2 change_3 m_4 taskTime_5 iworld_6 = case _x_0 (Data.Maybe.Nothing -> _Tuple2 (Data.Error.Ok (_Tuple5 l_1 v_2 (<{iTasks.WF.Tasks.Core._c;116;32_370}> change_3) m_4 taskTime_5)) iworld_6) 
<{iTasks.WF.Tasks.Core._c;116;32_370}> !change_0 = case change_0 (iTasks.UI.Definition.NoChange -> iTasks.UI.Definition.NoChange) (_ -> iTasks.UI.Definition.ChangeUI _predefined._Nil (_predefined._Cons (_Tuple2 1 (iTasks.UI.Definition.ChangeChild change_0)) _predefined._Nil))
<{iTasks.WF.Tasks.Core._c;109;15_369}> !_x_0 l_1 ov_2 _vtoPrompt_3 prompt_4 taskTime_5 = case _x_0 (_Tuple2 _x_1_0 _x_1_1 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple2 ui_3_0 m_3_1 -> case _x_1_1 (iTasks.UI.Editor._VSt task_4_0 mode_4_1 optional_4_2 selectedCons_4_3 iworld_4_4 -> _Tuple2 (Data.Error.Ok (_Tuple5 l_1 ov_2 (iTasks.UI.Definition.ReplaceUI (iTasks.UI.Definition.uic iTasks.UI.Definition.UIInteract (_predefined._Cons (select _vtoPrompt_3::<{iTasks.UI.Prompt.toPrompt;}> 0 prompt_4) (_predefined._Cons ui_3_0 _predefined._Nil)))) m_3_1 taskTime_5)) iworld_4_4) ) ) (Data.Error.Error e_2_0 -> case _x_1_1 (iTasks.UI.Editor._VSt task_3_0 mode_3_1 optional_3_2 selectedCons_3_3 iworld_3_4 -> _Tuple2 (Data.Error.Error (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) e_2_0)) iworld_3_4) ) ) 
iTasks.WF.Tasks.Core.anon_19 f_0 r_1 = _Tuple2 _predefined._Unit (f_0 r_1)
iTasks.WF.Tasks.Core.refreshView_ !_vgEditor_s_0 !task_1 mode_2 mbEditor_3 !shared_4 refreshFun_5 l_6 ov_7 m_8 !iworld_9 = <{iTasks.WF.Tasks.Core._c;128;7_387}> (iTasks.Internal.SDS.readRegister task_1 shared_4 iworld_9) refreshFun_5 l_6 ov_7 _vgEditor_s_0 mbEditor_3 m_8 task_1 mode_2 shared_4
<{iTasks.WF.Tasks.Core._c;128;7_387}> !_x_0 refreshFun_1 l_2 ov_3 _vgEditor_s_4 mbEditor_5 m_6 task_7 mode_8 shared_9 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Error e_2_0 -> _Tuple2 (Data.Error.Error e_2_0) iworld_1_1) (Data.Error.Ok r_2_0 -> let _x_3_0 = refreshFun_1 r_2_0 l_2 ov_3, v_3_1 = select _x_3_0::_Tuple3 1, mbf_3_2 = select _x_3_0::_Tuple3 2, l_3_3 = select _x_3_0::_Tuple3 0 in <{iTasks.WF.Tasks.Core._c;134;15_386}> (select (Data.Maybe.fromMaybe (select _vgEditor_s_4::<{iTasks.WF.Tasks.Core.gEditor_s;}> 0) mbEditor_5)::iTasks.UI.Editor._Editor 2 _predefined._Nil v_3_1 ov_3 m_6 (iTasks.UI.Editor._VSt (iTasks.WF.Definition.toString_2 task_7) mode_8 False -1 iworld_1_1)) mbf_3_2 shared_9 l_3_3 v_3_1) ) 
<{iTasks.WF.Tasks.Core._c;134;15_386}> !_x_0 mbf_1 shared_2 l_3 v_4 = case _x_0 (_Tuple3 _x_1_0 _x_1_1 vst_1_2 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple2 change_3_0 m_3_1 -> case vst_1_2 (iTasks.UI.Editor._VSt task_4_0 mode_4_1 optional_4_2 selectedCons_4_3 iworld_4_4 -> <{iTasks.WF.Tasks.Core._c;138;23_385}> mbf_1 shared_2 iworld_4_4 l_3 v_4 change_3_0 m_3_1) ) ) (Data.Error.Error e_2_0 -> case vst_1_2 (iTasks.UI.Editor._VSt task_3_0 mode_3_1 optional_3_2 selectedCons_3_3 iworld_3_4 -> _Tuple2 (Data.Error.Error (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) e_2_0)) iworld_3_4) ) ) 
<{iTasks.WF.Tasks.Core._c;138;23_385}> !mbf_0 shared_1 iworld_2 l_3 v_4 change_5 m_6 = case mbf_0 (Data.Maybe.Just f_1_0 -> <{iTasks.WF.Tasks.Core._c;139;34_384}> (iTasks.Internal.SDS.modify (iTasks.WF.Tasks.Core.anon_19 f_1_0) shared_1 iworld_2) l_3 v_4 change_5 m_6 mbf_0 iworld_2) (_ -> <{iTasks.WF.Tasks.Core._c;138;23_380}> mbf_0 l_3 v_4 change_5 m_6 iworld_2)
<{iTasks.WF.Tasks.Core._c;139;34_384}> !_x_0 l_1 v_2 change_3 m_4 mbf_5 iworld_6 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> iTasks.WF.Tasks.Core._f383_383 _x_2_0 l_1 v_2 change_3 m_4 iworld_1_1 _x_1_0 mbf_5 iworld_6) (_ -> iTasks.WF.Tasks.Core._f381_381 _x_1_0 iworld_1_1 mbf_5 l_1 v_2 change_3 m_4 iworld_6)) 
iTasks.WF.Tasks.Core._f383_383 !_x_0 l_1 v_2 change_3 m_4 iworld_5 _x_6 mbf_7 iworld_8 = case _x_0 (_predefined._Unit -> _Tuple2 (Data.Error.Ok (_Tuple4 l_1 v_2 (<{iTasks.WF.Tasks.Core._c;136;32_382}> change_3) m_4)) iworld_5) (_ -> iTasks.WF.Tasks.Core._f381_381 _x_6 iworld_5 mbf_7 l_1 v_2 change_3 m_4 iworld_8)
<{iTasks.WF.Tasks.Core._c;136;32_382}> !change_0 = case change_0 (iTasks.UI.Definition.NoChange -> iTasks.UI.Definition.NoChange) (_ -> iTasks.UI.Definition.ChangeUI _predefined._Nil (_predefined._Cons (_Tuple2 1 (iTasks.UI.Definition.ChangeChild change_0)) _predefined._Nil))
iTasks.WF.Tasks.Core._f381_381 !_x_0 iworld_1 mbf_2 l_3 v_4 change_5 m_6 iworld_7 = case _x_0 (Data.Error.Error e_1_0 -> _Tuple2 (Data.Error.Error e_1_0) iworld_1) (_ -> <{iTasks.WF.Tasks.Core._c;138;23_380}> mbf_2 l_3 v_4 change_5 m_6 iworld_7)
<{iTasks.WF.Tasks.Core._c;138;23_380}> !mbf_0 l_1 v_2 change_3 m_4 iworld_5 = case mbf_0 (Data.Maybe.Nothing -> _Tuple2 (Data.Error.Ok (_Tuple4 l_1 v_2 (<{iTasks.WF.Tasks.Core._c;136;32_379}> change_3) m_4)) iworld_5) 
<{iTasks.WF.Tasks.Core._c;136;32_379}> !change_0 = case change_0 (iTasks.UI.Definition.NoChange -> iTasks.UI.Definition.NoChange) (_ -> iTasks.UI.Definition.ChangeUI _predefined._Nil (_predefined._Cons (_Tuple2 1 (iTasks.UI.Definition.ChangeChild change_0)) _predefined._Nil))
iTasks.WF.Tasks.Core.initMask_365 !_vgEditor_s_0 task_1 mode_2 !mbEditor_3 v_4 iworld_5 = <{iTasks.WF.Tasks.Core._c;100;7_388}> (select (Data.Maybe.fromMaybe (select _vgEditor_s_0::<{iTasks.WF.Tasks.Core.gEditor_s;}> 0) mbEditor_3)::iTasks.UI.Editor._Editor 0 _predefined._Nil v_4 (iTasks.UI.Editor._VSt (iTasks.WF.Definition.toString_2 task_1) mode_2 False -1 iworld_5))
<{iTasks.WF.Tasks.Core._c;100;7_388}> !_x_0 = case _x_0 (_Tuple2 _x_1_0 _x_1_1 -> case _x_1_0 (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple2 _x_3_0 mask_3_1 -> case _x_1_1 (iTasks.UI.Editor._VSt task_4_0 mode_4_1 optional_4_2 selectedCons_4_3 iworld_4_4 -> _Tuple2 (Data.Error.Ok mask_3_1) iworld_4_4) ) ) (Data.Error.Error e_2_0 -> case _x_1_1 (iTasks.UI.Editor._VSt task_3_0 mode_3_1 optional_3_2 selectedCons_3_3 iworld_3_4 -> _Tuple2 (Data.Error.Error (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) e_2_0)) iworld_3_4) ) ) 
iTasks.WF.Tasks.Core.eval_17 !_vgEditor_s_0 !<{_vJSONDecode*_1}> !<{_vJSONDecode*_2}> !_vtoPrompt_3 !<{_vJSONEncode*_4}> !<{_vJSONEncode*_5}> refreshFun_6 editFun_7 prompt_8 mode_9 mbEditor_10 initFun_11 shared_12 event_13 evalOpts_14 !_x_15 iworld_16 = case _x_15 (iTasks.Internal.TaskState.TCDestroy _x_1_0 -> _Tuple2 iTasks.WF.Definition.DestroyedResult iworld_16) (_ -> case iworld_16 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> case current_1_3 (iTasks.Internal.IWorld._TaskEvalState taskTime_2_0 task_2_1 session_2_2 attachmentChain_2_3 nextTaskNo_2_4 -> let _x_3_0 = <{iTasks.WF.Tasks.Core._c;66;26_392}> _x_15 shared_12 iworld_16 initFun_11 _vgEditor_s_0 mode_9 mbEditor_10 <{_vJSONDecode*_1}> <{_vJSONDecode*_2}>, mbd_3_1 = select _x_3_0::_Tuple2 0 in case (<{iTasks.WF.Tasks.Core._c;80;25_393}> mbd_3_1) (True -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (Data.Error.fromError mbd_3_1)) (select _x_3_0::_Tuple2 1)) (False -> let _x_5_0 = Data.Error.fromOk mbd_3_1, task_5_1 = select _x_5_0::_Tuple5 0 in <{iTasks.WF.Tasks.Core._c;83;11_396}> (iTasks.WF.Tasks.Core.matchAndApplyEvent_ _vgEditor_s_0 _vtoPrompt_3 event_13 task_5_1 mode_9 mbEditor_10 taskTime_2_0 shared_12 editFun_7 (select _x_5_0::_Tuple5 2) (select _x_5_0::_Tuple5 3) (select _x_5_0::_Tuple5 4) (select _x_5_0::_Tuple5 1) prompt_8 (select _x_3_0::_Tuple2 1)) _vgEditor_s_0 task_5_1 mode_9 mbEditor_10 shared_12 refreshFun_6 <{_vJSONEncode*_4}> <{_vJSONEncode*_5}>) ) ) )
<{iTasks.WF.Tasks.Core._c;83;11_396}> !_x_0 _vgEditor_s_1 task_2 mode_3 mbEditor_4 shared_5 refreshFun_6 <{_vJSONEncode*_7}> <{_vJSONEncode*_8}> = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Error e_2_0 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult e_2_0) iworld_1_1) (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple5 l_3_0 v_3_1 ce_3_2 m_3_3 ts_3_4 -> <{iTasks.WF.Tasks.Core._c;87;19_395}> (iTasks.WF.Tasks.Core.refreshView_ _vgEditor_s_1 task_2 mode_3 mbEditor_4 shared_5 refreshFun_6 l_3_0 v_3_1 m_3_3 iworld_1_1) ts_3_4 ce_3_2 task_2 <{_vJSONEncode*_7}> <{_vJSONEncode*_8}>) ) ) 
<{iTasks.WF.Tasks.Core._c;87;19_395}> !_x_0 ts_1::I ce_2 task_3 <{_vJSONEncode*_4}> <{_vJSONEncode*_5}> = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Error e_2_0 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult e_2_0) iworld_1_1) (Data.Error.Ok _x_2_0 -> case _x_2_0 (_Tuple4 l_3_0 v_3_1 cr_3_2 m_3_3 -> _Tuple2 (iTasks.WF.Definition.ValueResult (<{iTasks.WF.Tasks.Core._if;93;39_394}> (StdBool.not (iTasks.UI.Editor.containsInvalidFields m_3_3)) l_3_0 v_3_1) (iTasks.Internal.TaskEval._TaskEvalInfo ts_1 _predefined._Nil True) (iTasks.UI.Definition.mergeUIChanges ce_2 cr_3_2) (iTasks.Internal.TaskState.TCInteract task_3 ts_1 (Text.JSON.toJSON <{_vJSONEncode*_4}> l_3_0) (Text.JSON.toJSON <{_vJSONEncode*_5}> v_3_1) m_3_3)) iworld_1_1) ) ) 
<{iTasks.WF.Tasks.Core._if;93;39_394}> !_x_0::B l_1 v_2 = case _x_0 (True -> iTasks.WF.Definition.Value (_Tuple2 l_1 v_2) False) (_ -> iTasks.WF.Definition.NoValue)
<{iTasks.WF.Tasks.Core._c;80;25_393}>::B !_x_0 = case _x_0 (Data.Error.Error _x_1_0 -> True) (_ -> False)
<{iTasks.WF.Tasks.Core._c;66;26_392}> !_x_0 shared_1 iworld_2 initFun_3 _vgEditor_s_4 mode_5 mbEditor_6 <{_vJSONDecode*_7}> <{_vJSONDecode*_8}> = case _x_0 (iTasks.Internal.TaskState.TCInit task_1_0 ts_1_1 -> <{iTasks.WF.Tasks.Core._c;68;19_390}> (iTasks.Internal.SDS.readRegister task_1_0 shared_1 iworld_2) initFun_3 _vgEditor_s_4 task_1_0 mode_5 mbEditor_6 ts_1_1) (iTasks.Internal.TaskState.TCInteract task_1_0 ts_1_1 encl_1_2 encv_1_3 m_1_4 -> <{iTasks.WF.Tasks.Core._c;77;19_391}> (_Tuple2 (Text.JSON.fromJSON <{_vJSONDecode*_7}> encl_1_2) (Text.JSON.fromJSON <{_vJSONDecode*_8}> encv_1_3)) task_1_0 ts_1_1 m_1_4 iworld_2 encl_1_2 encv_1_3) 
<{iTasks.WF.Tasks.Core._c;77;19_391}> !_x_0 task_1 ts_2::I m_3 iworld_4 encl_5 encv_6 = case _x_0 (_Tuple2 _x_1_0 _x_1_1 -> case _x_1_0 (Data.Maybe.Just l_2_0 -> case _x_1_1 (Data.Maybe.Just v_3_0 -> _Tuple2 (Data.Error.Ok (_Tuple5 task_1 ts_2 l_2_0 v_3_0 m_3)) iworld_4) ) ) (_ -> _Tuple2 (Data.Error.Error (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) (<{StdString.+++_11}> "Failed to decode stored model and view in interact: '" (<{StdString.+++_11}> (Text.JSON.toString_7 encl_5) (<{StdString.+++_11}> "', '" (<{StdString.+++_11}> (Text.JSON.toString_7 encv_6) "'")))))) iworld_4)
<{iTasks.WF.Tasks.Core._c;68;19_390}> !_x_0 initFun_1 _vgEditor_s_2 task_3 mode_4 mbEditor_5 ts_6::I = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Ok r_2_0 -> let _x_3_0 = initFun_1 r_2_0, v_3_1 = select _x_3_0::_Tuple2 1, l_3_2 = select _x_3_0::_Tuple2 0 in <{iTasks.WF.Tasks.Core._c;71;27_389}> (iTasks.WF.Tasks.Core.initMask_365 _vgEditor_s_2 task_3 mode_4 mbEditor_5 v_3_1 iworld_1_1) task_3 ts_6 l_3_2 v_3_1) (Data.Error.Error e_2_0 -> _Tuple2 (Data.Error.Error e_2_0) iworld_1_1) ) 
<{iTasks.WF.Tasks.Core._c;71;27_389}> !_x_0 task_1 ts_2::I l_3 v_4 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (Data.Error.Ok m_2_0 -> _Tuple2 (Data.Error.Ok (_Tuple5 task_1 ts_2 l_3 v_4 m_2_0)) iworld_1_1) (Data.Error.Error e_2_0 -> _Tuple2 (Data.Error.Error e_2_0) iworld_1_1) ) 
iTasks.WF.Tasks.Core.interact !_vtoPrompt_0 !_viTask_1 !_viTask_2 !_viTask_3 !prompt_4 !mode_5 !shared_6 initFun_7 editFun_8 refreshFun_9 mbEditor_10 = iTasks.WF.Definition.Task (iTasks.WF.Tasks.Core.eval_17 (select _viTask_3::<{iTasks.WF.Definition.iTask;}> 0) (select _viTask_1::<{iTasks.WF.Definition.iTask;}> 3) (select _viTask_3::<{iTasks.WF.Definition.iTask;}> 3) _vtoPrompt_0 (select _viTask_1::<{iTasks.WF.Definition.iTask;}> 2) (select _viTask_3::<{iTasks.WF.Definition.iTask;}> 2) refreshFun_9 editFun_8 prompt_4 mode_5 mbEditor_10 initFun_7 shared_6)
<{iTasks.WF.Tasks.Core.TD;OSException}> _x_0::B = _predefined._Nil

:: iTasks.WF.Tasks.Core.OSException = iTasks.WF.Tasks.Core.OSException !a1

|| Converted Records
:: <{iTasks.WF.Tasks.Core.JSONEncode_s;}> = {!iTasks.WF.Tasks.Core.JSONEncode_s}

:: <{iTasks.WF.Tasks.Core.JSONEncode_ss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_ss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_sss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_sss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_s;}> = {!iTasks.WF.Tasks.Core.JSONDecode_s}

:: <{iTasks.WF.Tasks.Core.JSONDecode_ss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_ss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_sss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_sss}

:: <{iTasks.WF.Tasks.Core.gDefault_s;}> = {iTasks.WF.Tasks.Core.gDefault_s}

:: <{iTasks.WF.Tasks.Core.gDefault_ss;}> = {iTasks.WF.Tasks.Core.gDefault_ss}

:: <{iTasks.WF.Tasks.Core.gDefault_sss;}> = {iTasks.WF.Tasks.Core.gDefault_sss}

:: <{iTasks.WF.Tasks.Core.gText_s;}> = {!iTasks.WF.Tasks.Core.gText_s}

:: <{iTasks.WF.Tasks.Core.gText_ss;}> = {!iTasks.WF.Tasks.Core.gText_ss}

:: <{iTasks.WF.Tasks.Core.gText_sss;}> = {!iTasks.WF.Tasks.Core.gText_sss}

:: <{iTasks.WF.Tasks.Core.gEditor_s;}> = {iTasks.WF.Tasks.Core.gEditor_s}

:: <{iTasks.WF.Tasks.Core.gEditor_ss;}> = {iTasks.WF.Tasks.Core.gEditor_ss}

:: <{iTasks.WF.Tasks.Core.gEditor_sss;}> = {iTasks.WF.Tasks.Core.gEditor_sss}

:: <{iTasks.WF.Tasks.Core.gEq_s;}> = {!iTasks.WF.Tasks.Core.gEq_s}

:: <{iTasks.WF.Tasks.Core.gEq_ss;}> = {!iTasks.WF.Tasks.Core.gEq_ss}

:: <{iTasks.WF.Tasks.Core.gEq_sss;}> = {!iTasks.WF.Tasks.Core.gEq_sss}

:: <{iTasks.WF.Tasks.Core.gEq_ssss;}> = {!iTasks.WF.Tasks.Core.gEq_ssss}

:: <{iTasks.WF.Tasks.Core.gEq_sssss;}> = {!iTasks.WF.Tasks.Core.gEq_sssss}

:: <{iTasks.WF.Tasks.Core.gEq_ssssss;}> = {!iTasks.WF.Tasks.Core.gEq_ssssss}

:: <{iTasks.WF.Tasks.Core.gEq_sssssss;}> = {!iTasks.WF.Tasks.Core.gEq_sssssss}

:: <{iTasks.WF.Tasks.Core.gEq_ssssssss;}> = {!iTasks.WF.Tasks.Core.gEq_ssssssss}

:: <{iTasks.WF.Tasks.Core.gEq_sssssssss;}> = {!iTasks.WF.Tasks.Core.gEq_sssssssss}

:: <{iTasks.WF.Tasks.Core.bimap_s;}> = {iTasks.WF.Tasks.Core.bimap_s}

:: <{iTasks.WF.Tasks.Core.bimap_ss;}> = {iTasks.WF.Tasks.Core.bimap_ss}

:: <{iTasks.WF.Tasks.Core.bimap_sss;}> = {iTasks.WF.Tasks.Core.bimap_sss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_ssss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_ssss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_sssss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_sssss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_ssssss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_ssssss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_sssssss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_sssssss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_ssssssss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_ssssssss}

:: <{iTasks.WF.Tasks.Core.JSONEncode_sssssssss;}> = {!iTasks.WF.Tasks.Core.JSONEncode_sssssssss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_ssss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_ssss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_sssss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_sssss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_ssssss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_ssssss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_sssssss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_sssssss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_ssssssss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_ssssssss}

:: <{iTasks.WF.Tasks.Core.JSONDecode_sssssssss;}> = {!iTasks.WF.Tasks.Core.JSONDecode_sssssssss}

:: <{iTasks.WF.Tasks.Core.gText_ssss;}> = {!iTasks.WF.Tasks.Core.gText_ssss}

:: <{iTasks.WF.Tasks.Core.gText_sssss;}> = {!iTasks.WF.Tasks.Core.gText_sssss}

:: <{iTasks.WF.Tasks.Core.gText_ssssss;}> = {!iTasks.WF.Tasks.Core.gText_ssssss}

:: <{iTasks.WF.Tasks.Core.gText_sssssss;}> = {!iTasks.WF.Tasks.Core.gText_sssssss}

:: <{iTasks.WF.Tasks.Core.gText_ssssssss;}> = {!iTasks.WF.Tasks.Core.gText_ssssssss}

:: <{iTasks.WF.Tasks.Core.gText_sssssssss;}> = {!iTasks.WF.Tasks.Core.gText_sssssssss}

:: <{iTasks.WF.Tasks.Core.gDefault_ssss;}> = {iTasks.WF.Tasks.Core.gDefault_ssss}

:: <{iTasks.WF.Tasks.Core.gDefault_sssss;}> = {iTasks.WF.Tasks.Core.gDefault_sssss}

:: <{iTasks.WF.Tasks.Core.gDefault_ssssss;}> = {iTasks.WF.Tasks.Core.gDefault_ssssss}

:: <{iTasks.WF.Tasks.Core.gDefault_sssssss;}> = {iTasks.WF.Tasks.Core.gDefault_sssssss}

:: <{iTasks.WF.Tasks.Core.gDefault_ssssssss;}> = {iTasks.WF.Tasks.Core.gDefault_ssssssss}

:: <{iTasks.WF.Tasks.Core.gDefault_sssssssss;}> = {iTasks.WF.Tasks.Core.gDefault_sssssssss}

:: <{iTasks.WF.Tasks.Core.gEditor_ssss;}> = {iTasks.WF.Tasks.Core.gEditor_ssss}

:: <{iTasks.WF.Tasks.Core.gEditor_sssss;}> = {iTasks.WF.Tasks.Core.gEditor_sssss}

:: <{iTasks.WF.Tasks.Core.gEditor_ssssss;}> = {iTasks.WF.Tasks.Core.gEditor_ssssss}

:: <{iTasks.WF.Tasks.Core.gEditor_sssssss;}> = {iTasks.WF.Tasks.Core.gEditor_sssssss}

