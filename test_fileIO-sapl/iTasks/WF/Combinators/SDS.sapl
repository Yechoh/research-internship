|| ?module? iTasks.WF.Combinators.SDS


iTasks.WF.Combinators.SDS.anon_4 !<{_v<_0}> task_1 shares_2 = _Tuple2 _predefined._Unit (Data.Map.del <{_v<_0}> task_1 shares_2)
iTasks.WF.Combinators.SDS.anon_353 task_0 shares_1 = _Tuple2 _predefined._Unit (Data.Map.del (<{StdOverloaded.<;}> <{iTasks.WF.Definition.<_5}>) task_0 shares_1)
iTasks.WF.Combinators.SDS.eval_5 !<{_vJSONEncode*_0}> !_viTask_1 stask_2 initial_3 event_4 evalOpts_5 !_x_6 iworld_7 = case _x_6 (iTasks.Internal.TaskState.TCInit task_1_0 ts_1_1 -> let _x_2_0 = iTasks.Internal.TaskEval.getNextTaskId iworld_7, iworld_2_1 = select _x_2_0::_Tuple2 1, _x_2_2 = iTasks.Internal.SDS.write (Text.JSON.toJSON <{_vJSONEncode*_0}> initial_3) (iTasks.SDS.Combinators.Common.sdsFocus (<{iTasks.WF.Definition.iTask;}> (<{iTasks.WF.Combinators.SDS.gEditor_s;}> iTasks.WF.Derives.gEditor_TaskId_151) (<{iTasks.WF.Combinators.SDS.gText_s;}> iTasks.WF.Derives.gText_TaskId_152) (<{iTasks.WF.Combinators.SDS.JSONEncode_s;}> iTasks.WF.Derives.JSONEncode_TaskId_153) (<{iTasks.WF.Combinators.SDS.JSONDecode_s;}> iTasks.WF.Derives.JSONDecode_TaskId_154) (<{iTasks.WF.Combinators.SDS.gDefault_s;}> iTasks.WF.Derives.gDefault_TaskId_155) (<{iTasks.WF.Combinators.SDS.gEq_s;}> iTasks.WF.Derives.gEq_TaskId_156) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{iTasks.WF.Definition.TD;TaskId}>))) task_1_0 (iTasks.Internal.TaskStore.localShare (<{iTasks.WF.Definition.iTask;}> (<{iTasks.WF.Combinators.SDS.gEditor_s;}> iTasks.UI.Editor.Generic.gEditor_JSONNode_25) (<{iTasks.WF.Combinators.SDS.gText_s;}> iTasks.Internal.Generic.Visualization.gText_JSONNode_31) (<{iTasks.WF.Combinators.SDS.JSONEncode_s;}> Text.JSON.JSONEncode_JSONNode_28) (<{iTasks.WF.Combinators.SDS.JSONDecode_s;}> Text.JSON.JSONDecode_JSONNode_55) (<{iTasks.WF.Combinators.SDS.gDefault_s;}> iTasks.Internal.Generic.Defaults.gDefault_JSONNode_28) (<{iTasks.WF.Combinators.SDS.gEq_s;}> iTasks.WF.Derives.gEq_JSONNode_18) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{Text.JSON.TD;JSONNode}>))))) iworld_2_1, e_2_3 = select _x_2_2::_Tuple2 0 in case (Data.Error.isError e_2_3) (True -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (Data.Error.fromError e_2_3)) (select _x_2_2::_Tuple2 1)) (False -> iTasks.WF.Combinators.SDS.eval_5 <{_vJSONEncode*_0}> _viTask_1 stask_2 initial_3 event_4 evalOpts_5 (iTasks.Internal.TaskState.TCShared task_1_0 ts_1_1 (iTasks.Internal.TaskState.TCInit (select _x_2_0::_Tuple2 0) ts_1_1)) (select _x_2_2::_Tuple2 1)) ) (iTasks.Internal.TaskState.TCShared task_1_0 ts_1_1 treea_1_2 -> case iworld_7 (iTasks.Internal.IWorld._IWorld server_2_0 config_2_1 clocks_2_2 current_2_3 random_2_4 sdsNotifyRequests_2_5 memoryShares_2_6 cachedShares_2_7 exposedShares_2_8 jsCompilerState_2_9 ioTasks_2_10 ioStates_2_11 world_2_12 resources_2_13 onClient_2_14 shutdown_2_15 -> case current_2_3 (iTasks.Internal.IWorld._TaskEvalState taskTime_3_0 task_3_1 session_3_2 attachmentChain_3_3 nextTaskNo_3_4 -> let evala_4_0 = select (stask_2 (iTasks.SDS.Combinators.Common.sdsFocus (<{iTasks.WF.Definition.iTask;}> (<{iTasks.WF.Combinators.SDS.gEditor_s;}> iTasks.WF.Derives.gEditor_TaskId_151) (<{iTasks.WF.Combinators.SDS.gText_s;}> iTasks.WF.Derives.gText_TaskId_152) (<{iTasks.WF.Combinators.SDS.JSONEncode_s;}> iTasks.WF.Derives.JSONEncode_TaskId_153) (<{iTasks.WF.Combinators.SDS.JSONDecode_s;}> iTasks.WF.Derives.JSONDecode_TaskId_154) (<{iTasks.WF.Combinators.SDS.gDefault_s;}> iTasks.WF.Derives.gDefault_TaskId_155) (<{iTasks.WF.Combinators.SDS.gEq_s;}> iTasks.WF.Derives.gEq_TaskId_156) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{iTasks.WF.Definition.TD;TaskId}>))) task_1_0 (iTasks.Internal.TaskStore.localShare _viTask_1)))::_Tuple1 0, _x_4_1 = evala_4_0 event_4 (iTasks.Internal.TaskEval.extendCallTrace task_1_0 evalOpts_5) treea_1_2 iworld_7, iworld_4_2 = select _x_4_1::_Tuple2 1 in <{iTasks.WF.Combinators.SDS._c;34;11_356}> (select _x_4_1::_Tuple2 0) ts_1_1 task_1_0 iworld_4_2) ) ) (iTasks.Internal.TaskState.TCDestroy _x_1_0 -> case _x_1_0 (iTasks.Internal.TaskState.TCShared task_2_0 ts_2_1 treea_2_2 -> case task_2_0 (iTasks.WF.Definition.TaskId instanceNo_3_0 _x_3_1 -> let evala_4_0 = select (stask_2 (iTasks.SDS.Combinators.Common.sdsFocus (<{iTasks.WF.Definition.iTask;}> (<{iTasks.WF.Combinators.SDS.gEditor_s;}> iTasks.WF.Derives.gEditor_TaskId_151) (<{iTasks.WF.Combinators.SDS.gText_s;}> iTasks.WF.Derives.gText_TaskId_152) (<{iTasks.WF.Combinators.SDS.JSONEncode_s;}> iTasks.WF.Derives.JSONEncode_TaskId_153) (<{iTasks.WF.Combinators.SDS.JSONDecode_s;}> iTasks.WF.Derives.JSONDecode_TaskId_154) (<{iTasks.WF.Combinators.SDS.gDefault_s;}> iTasks.WF.Derives.gDefault_TaskId_155) (<{iTasks.WF.Combinators.SDS.gEq_s;}> iTasks.WF.Derives.gEq_TaskId_156) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{iTasks.WF.Definition.TD;TaskId}>))) task_2_0 (iTasks.Internal.TaskStore.localShare _viTask_1)))::_Tuple1 0, _x_4_1 = evala_4_0 event_4 (iTasks.Internal.TaskEval.extendCallTrace task_2_0 evalOpts_5) (iTasks.Internal.TaskState.TCDestroy treea_2_2) iworld_7, iworld_4_2 = select _x_4_1::_Tuple2 1, _x_4_3 = iTasks.Internal.SDS.modify (iTasks.WF.Combinators.SDS.anon_353 task_2_0) (iTasks.SDS.Combinators.Common.sdsFocus (<{iTasks.WF.Definition.iTask;}> (<{iTasks.WF.Combinators.SDS.gEditor_s;}> iTasks.UI.Editor.Generic.gEditor_Int_7) (<{iTasks.WF.Combinators.SDS.gText_s;}> iTasks.Internal.Generic.Visualization.gText_Int_11) (<{iTasks.WF.Combinators.SDS.JSONEncode_s;}> Text.JSON.JSONEncode_Int_11) (<{iTasks.WF.Combinators.SDS.JSONDecode_s;}> Text.JSON.JSONDecode_Int_35) (<{iTasks.WF.Combinators.SDS.gDefault_s;}> iTasks.Internal.Generic.Defaults.gDefault_Int_8) (<{iTasks.WF.Combinators.SDS.gEq_s;}> GenEq.gEq_Int_2) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Int))) instanceNo_3_0 iTasks.Internal.TaskStore.taskInstanceShares) iworld_4_2, e_4_4 = select _x_4_3::_Tuple2 0 in case (Data.Error.isError e_4_4) (True -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (Data.Error.fromError e_4_4)) (select _x_4_3::_Tuple2 1)) (False -> _Tuple2 (select _x_4_1::_Tuple2 0) (select _x_4_3::_Tuple2 1)) ) ) ) (_ -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) "Corrupt task state in withShared")) iworld_7)
<{iTasks.WF.Combinators.SDS._c;34;11_356}> !_x_0 ts_1::I task_2 iworld_3 = case _x_0 (iTasks.WF.Definition.ValueResult _x_1_0 info_1_1 rep_1_2 ntreea_1_3 -> case _x_1_0 (iTasks.WF.Definition.NoValue -> let y_3_0 = select info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo 0, info_3_1::I = update info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo [0:<{iTasks.WF.Combinators.SDS._c;51;16_354}> (<{StdInt.<_17}> ts_1 y_3_0) y_3_0 ts_1] in _Tuple2 (iTasks.WF.Definition.ValueResult iTasks.WF.Definition.NoValue info_3_1 rep_1_2 (iTasks.Internal.TaskState.TCShared task_2 (select info_3_1::iTasks.Internal.TaskEval._TaskEvalInfo 0) ntreea_1_3)) iworld_3) (iTasks.WF.Definition.Value stable_2_0 val_2_1 -> let y_3_0 = select info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo 0, info_3_1::I = update info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo [0:<{iTasks.WF.Combinators.SDS._c;51;16_355}> (<{StdInt.<_17}> ts_1 y_3_0) y_3_0 ts_1] in _Tuple2 (iTasks.WF.Definition.ValueResult (iTasks.WF.Definition.Value stable_2_0 val_2_1) info_3_1 rep_1_2 (iTasks.Internal.TaskState.TCShared task_2 (select info_3_1::iTasks.Internal.TaskEval._TaskEvalInfo 0) ntreea_1_3)) iworld_3) ) (iTasks.WF.Definition.ExceptionResult e_1_0 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult e_1_0) iworld_3) 
<{iTasks.WF.Combinators.SDS._c;51;16_355}>::I !_x_0::B y_1::I ts_2::I = case _x_0 (True -> y_1) (_ -> ts_2)
<{iTasks.WF.Combinators.SDS._c;51;16_354}>::I !_x_0::B y_1::I ts_2::I = case _x_0 (True -> y_1) (_ -> ts_2)
iTasks.WF.Combinators.SDS.withShared !_viTask_0 !_viTask_1 !initial_2 !stask_3 = iTasks.WF.Definition.Task (iTasks.WF.Combinators.SDS.eval_5 (select _viTask_1::<{iTasks.WF.Definition.iTask;}> 2) _viTask_1 stask_3 initial_2)
iTasks.WF.Combinators.SDS.eval_6 !_vTC_0 !_vTC_1 !<{_vJSONEncode*_2}> !<{_vJSONDecode*_3}> !_viTask_4 !_viTask_5 !_viTask_6 !_vTC_7 !<{_vJSONEncode*_8}> stask_9 shared_10 event_11 evalOpts_12 !_x_13 iworld_14 = case _x_13 (iTasks.Internal.TaskState.TCInit task_1_0 ts_1_1 -> iTasks.WF.Combinators.SDS._f360_360 iworld_14 _vTC_0 _vTC_1 <{_vJSONEncode*_2}> <{_vJSONDecode*_3}> _viTask_4 _viTask_5 _viTask_6 _vTC_7 <{_vJSONEncode*_8}> stask_9 shared_10 event_11 evalOpts_12 task_1_0 ts_1_1 _x_13) (_ -> iTasks.WF.Combinators.SDS._f359_359 _x_13 iworld_14 event_11 evalOpts_12 stask_9 _viTask_5 _viTask_6 _vTC_7 <{_vJSONEncode*_8}>)
iTasks.WF.Combinators.SDS._f360_360 !iworld_0 !_vTC_1 !_vTC_2 !<{_vJSONEncode*_3}> !<{_vJSONDecode*_4}> !_viTask_5 !_viTask_6 !_viTask_7 !_vTC_8 !<{_vJSONEncode*_9}> !stask_10 shared_11 event_12 evalOpts_13 !task_14 !ts_15::I _x_16 = case iworld_0 (iTasks.Internal.IWorld._IWorld server_1_0 config_1_1 clocks_1_2 current_1_3 random_1_4 sdsNotifyRequests_1_5 memoryShares_1_6 cachedShares_1_7 exposedShares_1_8 jsCompilerState_1_9 ioTasks_1_10 ioStates_1_11 world_1_12 resources_1_13 onClient_1_14 shutdown_1_15 -> let _x_2_0 = iTasks.Internal.SDS.newURL iworld_0, url_2_1 = select _x_2_0::_Tuple2 0, _x_2_2 = iTasks.Internal.TaskEval.getNextTaskId (select _x_2_0::_Tuple2 1) in iTasks.WF.Combinators.SDS.eval_6 _vTC_1 _vTC_2 <{_vJSONEncode*_3}> <{_vJSONDecode*_4}> _viTask_5 _viTask_6 _viTask_7 _vTC_8 <{_vJSONEncode*_9}> stask_10 shared_11 event_12 evalOpts_13 (iTasks.Internal.TaskState.TCExposedShared task_14 ts_15 url_2_1 (iTasks.Internal.TaskState.TCInit (select _x_2_2::_Tuple2 0) ts_15)) (update (select _x_2_2::_Tuple2 1)::iTasks.Internal.IWorld._IWorld [8:Data.Map.put (<{StdOverloaded.<;}> <{StdString.<_3}>) url_2_1 (_Tuple2 (_SystemDynamic._DynamicTemp shared_11 (_SystemDynamic._normalise (_SystemDynamic._bind_global_type_pattern_var (_SystemDynamic.TypeVar 0) (select _viTask_5::<{iTasks.WF.Definition.iTask;}> 6) (_SystemDynamic._bind_global_type_pattern_var (_SystemDynamic.TypeVar 1) _vTC_2 (_SystemDynamic._bind_global_type_pattern_var (_SystemDynamic.TypeVar 2) _vTC_1 (_SystemDynamic._initial_unification_environment 3 0)))) (_SystemDynamic.TypeApp (_SystemDynamic.TypeApp (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor <{iTasks.SDS.Definition.TD;SDS}>)) (_SystemDynamic.TypeVar 0)) (_SystemDynamic.TypeVar 1)) (_SystemDynamic.TypeVar 2)))) (iTasks.Internal.SDS.toJSONShared (select _viTask_5::<{iTasks.WF.Definition.iTask;}> 3) <{_vJSONEncode*_3}> <{_vJSONDecode*_4}> _viTask_5 shared_11)) exposedShares_1_8])) (_ -> iTasks.WF.Combinators.SDS._f359_359 _x_16 iworld_0 event_12 evalOpts_13 stask_10 _viTask_6 _viTask_7 _vTC_8 <{_vJSONEncode*_9}>)
iTasks.WF.Combinators.SDS._f359_359 !_x_0 iworld_1 event_2 evalOpts_3 stask_4 _viTask_5 _viTask_6 _vTC_7 <{_vJSONEncode*_8}> = case _x_0 (iTasks.Internal.TaskState.TCExposedShared task_1_0 ts_1_1 url_1_2 treea_1_3 -> case iworld_1 (iTasks.Internal.IWorld._IWorld server_2_0 config_2_1 clocks_2_2 current_2_3 random_2_4 sdsNotifyRequests_2_5 memoryShares_2_6 cachedShares_2_7 exposedShares_2_8 jsCompilerState_2_9 ioTasks_2_10 ioStates_2_11 world_2_12 resources_2_13 onClient_2_14 shutdown_2_15 -> case current_2_3 (iTasks.Internal.IWorld._TaskEvalState taskTime_3_0 task_3_1 session_3_2 attachmentChain_3_3 nextTaskNo_3_4 -> let exposedSDS_4_0 = iTasks.Internal.TaskStore.exposedShare _viTask_5 _viTask_6 (select _viTask_5::<{iTasks.WF.Definition.iTask;}> 6) (select _viTask_6::<{iTasks.WF.Definition.iTask;}> 6) _vTC_7 <{_vJSONEncode*_8}> url_1_2, evala_4_1 = select (stask_4 url_1_2 exposedSDS_4_0)::_Tuple1 0, _x_4_2 = evala_4_1 event_2 (iTasks.Internal.TaskEval.extendCallTrace task_1_0 evalOpts_3) treea_1_3 iworld_1, iworld_4_3 = select _x_4_2::_Tuple2 1 in <{iTasks.WF.Combinators.SDS._c;70;11_358}> (select _x_4_2::_Tuple2 0) ts_1_1 task_1_0 url_1_2 iworld_4_3) ) ) (iTasks.Internal.TaskState.TCDestroy _x_1_0 -> case _x_1_0 (iTasks.Internal.TaskState.TCExposedShared task_2_0 ts_2_1 url_2_2 treea_2_3 -> let _x_3_0 = select (stask_4 url_2_2 (iTasks.Internal.TaskStore.exposedShare _viTask_5 _viTask_6 (select _viTask_5::<{iTasks.WF.Definition.iTask;}> 6) (select _viTask_6::<{iTasks.WF.Definition.iTask;}> 6) _vTC_7 <{_vJSONEncode*_8}> url_2_2))::_Tuple1 0 event_2 (iTasks.Internal.TaskEval.extendCallTrace task_2_0 evalOpts_3) (iTasks.Internal.TaskState.TCDestroy treea_2_3) iworld_1, iworld_3_1 = select _x_3_0::_Tuple2 1 in _Tuple2 (select _x_3_0::_Tuple2 0) (update iworld_3_1::iTasks.Internal.IWorld._IWorld [8:Data.Map.del (<{StdOverloaded.<;}> <{StdString.<_3}>) url_2_2 (select iworld_3_1::iTasks.Internal.IWorld._IWorld 8)])) ) (_ -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) "Corrupt task state in exposeShared")) iworld_1)
<{iTasks.WF.Combinators.SDS._c;70;11_358}> !_x_0 ts_1::I task_2 url_3 iworld_4 = case _x_0 (iTasks.WF.Definition.ValueResult value_1_0 info_1_1 rep_1_2 ntreea_1_3 -> let y_2_0 = select info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo 0, info_2_1::I = update info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo [0:<{iTasks.WF.Combinators.SDS._c;51;16_357}> (<{StdInt.<_17}> ts_1 y_2_0) y_2_0 ts_1] in _Tuple2 (iTasks.WF.Definition.ValueResult value_1_0 info_2_1 rep_1_2 (iTasks.Internal.TaskState.TCExposedShared task_2 (select info_2_1::iTasks.Internal.TaskEval._TaskEvalInfo 0) url_3 ntreea_1_3)) iworld_4) (iTasks.WF.Definition.ExceptionResult e_1_0 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult e_1_0) iworld_4) 
<{iTasks.WF.Combinators.SDS._c;51;16_357}>::I !_x_0::B y_1::I ts_2::I = case _x_0 (True -> y_1) (_ -> ts_2)
iTasks.WF.Combinators.SDS.exposeShared !_viTask_0 !_viTask_1 !_viTask_2 !_viTask_3 !shared_4 !stask_5 = iTasks.WF.Definition.Task (iTasks.WF.Combinators.SDS.eval_6 (select _viTask_2::<{iTasks.WF.Definition.iTask;}> 6) (select _viTask_1::<{iTasks.WF.Definition.iTask;}> 6) (select _viTask_1::<{iTasks.WF.Definition.iTask;}> 2) (select _viTask_2::<{iTasks.WF.Definition.iTask;}> 3) _viTask_3 _viTask_1 _viTask_2 (select _viTask_3::<{iTasks.WF.Definition.iTask;}> 6) (select _viTask_3::<{iTasks.WF.Definition.iTask;}> 2) stask_5 shared_4)
<{iTasks.WF.Combinators.SDS.eval`_7}> !eval_0 event_1 evalOpts_2 state_3 iworld_4 = <{iTasks.WF.Combinators.SDS._c;89;7_362}> (eval_0 event_1 evalOpts_2 state_3 iworld_4)
<{iTasks.WF.Combinators.SDS._c;89;7_362}> !_x_0 = case _x_0 (_Tuple2 _x_1_0 iworld_1_1 -> case _x_1_0 (iTasks.WF.Definition.ValueResult _x_2_0 info_2_1 rep_2_2 tree_2_3 -> case _x_2_0 (iTasks.WF.Definition.Value x_3_0 st_3_1 -> <{iTasks.WF.Combinators.SDS._c;90;61_361}> (iTasks.Internal.TaskState.taskIdFromTaskTree tree_2_3) x_3_0 st_3_1 info_2_1 rep_2_2 tree_2_3 iworld_1_1) (iTasks.WF.Definition.NoValue -> _Tuple2 (iTasks.WF.Definition.ValueResult iTasks.WF.Definition.NoValue info_2_1 rep_2_2 tree_2_3) iworld_1_1) ) (iTasks.WF.Definition.ExceptionResult te_2_0 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult te_2_0) iworld_1_1) (iTasks.WF.Definition.DestroyedResult -> _Tuple2 iTasks.WF.Definition.DestroyedResult iworld_1_1) ) 
<{iTasks.WF.Combinators.SDS._c;90;61_361}> !_x_0 x_1 st_2::B info_3 rep_4 tree_5 iworld_6 = case _x_0 (Data.Error.Ok tid_1_0 -> _Tuple2 (iTasks.WF.Definition.ValueResult (iTasks.WF.Definition.Value (_Tuple2 x_1 tid_1_0) st_2) info_3 rep_4 tree_5) iworld_6) (_ -> _Tuple2 (iTasks.WF.Definition.ValueResult (iTasks.WF.Definition.Value (_Tuple2 x_1 (iTasks.WF.Definition.TaskId 0 0)) st_2) info_3 rep_4 tree_5) iworld_6)
iTasks.WF.Combinators.SDS.withTaskId !_x_0 = case _x_0 (iTasks.WF.Definition.Task eval_1_0 -> iTasks.WF.Definition.Task (<{iTasks.WF.Combinators.SDS.eval`_7}> eval_1_0)) 
iTasks.WF.Combinators.SDS.toString_9 !x_0 = select x_0::_Tuple2 1
iTasks.WF.Combinators.SDS.eval_8 taskfun_0 event_1 evalOpts_2 !_x_3 iworld_4 = case _x_3 (iTasks.Internal.TaskState.TCInit task_1_0 ts_1_1 -> case iworld_4 (iTasks.Internal.IWorld._IWorld server_2_0 config_2_1 clocks_2_2 current_2_3 random_2_4 sdsNotifyRequests_2_5 memoryShares_2_6 cachedShares_2_7 exposedShares_2_8 jsCompilerState_2_9 ioTasks_2_10 ioStates_2_11 world_2_12 resources_2_13 onClient_2_14 shutdown_2_15 -> case server_2_0 (iTasks.Internal.IWorld._ServerInfo serverName_3_0 serverURL_3_1 build_3_2 _x_3_3 -> case _x_3_3 (iTasks.Internal.IWorld._SystemPaths appDirectory_4_0 dataDirectory_4_1 webDirectory_4_2 saplDirectory_4_3 -> let tmpDir_5_0 = <{System.FilePath.</>}> dataDirectory_4_1 (<{System.FilePath.</>}> "tmp" (<{StdString.+++_11}> build_3_2 (<{StdString.+++_11}> "-" (<{StdString.+++_11}> (iTasks.WF.Definition.toString_2 task_1_0) "-tmpdir")))), _x_5_1 = iTasks.Internal.TaskEval.getNextTaskId iworld_4, iworld_5_2 = select _x_5_1::_Tuple2 1, world_5_3 = select iworld_5_2::iTasks.Internal.IWorld._IWorld 12, _x_5_4 = System.Directory.createDirectory tmpDir_5_0 world_5_3, world_5_5 = select _x_5_4::_Tuple2 1, task_5_6 = select _x_5_1::_Tuple2 0 in <{iTasks.WF.Combinators.SDS._c;104;11_363}> (select _x_5_4::_Tuple2 0) taskfun_0 event_1 evalOpts_2 task_1_0 ts_1_1 task_5_6 iworld_5_2 world_5_5) ) ) ) (iTasks.Internal.TaskState.TCShared task_1_0 ts_1_1 treea_1_2 -> case iworld_4 (iTasks.Internal.IWorld._IWorld server_2_0 config_2_1 clocks_2_2 current_2_3 random_2_4 sdsNotifyRequests_2_5 memoryShares_2_6 cachedShares_2_7 exposedShares_2_8 jsCompilerState_2_9 ioTasks_2_10 ioStates_2_11 world_2_12 resources_2_13 onClient_2_14 shutdown_2_15 -> case server_2_0 (iTasks.Internal.IWorld._ServerInfo serverName_3_0 serverURL_3_1 build_3_2 _x_3_3 -> case _x_3_3 (iTasks.Internal.IWorld._SystemPaths appDirectory_4_0 dataDirectory_4_1 webDirectory_4_2 saplDirectory_4_3 -> case current_2_3 (iTasks.Internal.IWorld._TaskEvalState taskTime_5_0 task_5_1 session_5_2 attachmentChain_5_3 nextTaskNo_5_4 -> let _x_6_0 = System.Directory.getCurrentDirectory world_2_12, mbCurdir_6_1 = select _x_6_0::_Tuple2 0 in case (Data.Error.isError mbCurdir_6_1) (True -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__Tuple2)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Int))) (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char)))) (<{StdOverloaded.toString;}> iTasks.WF.Combinators.SDS.toString_9) (Data.Error.fromError mbCurdir_6_1))) (update iworld_4::iTasks.Internal.IWorld._IWorld [12:select _x_6_0::_Tuple2 1])) (False -> let tmpDir_8_0 = <{System.FilePath.</>}> dataDirectory_4_1 (<{System.FilePath.</>}> "tmp" (<{StdString.+++_11}> build_3_2 (<{StdString.+++_11}> "-" (<{StdString.+++_11}> (iTasks.WF.Definition.toString_2 task_1_0) "-tmpdir")))), world_8_1 = select _x_6_0::_Tuple2 1, _x_8_2 = System.Directory.setCurrentDirectory tmpDir_8_0 world_8_1, mbErr_8_3 = select _x_8_2::_Tuple2 0 in case (Data.Error.isError mbErr_8_3) (True -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__Tuple2)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Int))) (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char)))) (<{StdOverloaded.toString;}> iTasks.WF.Combinators.SDS.toString_9) (Data.Error.fromError mbErr_8_3))) (update iworld_4::iTasks.Internal.IWorld._IWorld [12:select _x_8_2::_Tuple2 1])) (False -> case (Data.Error.isError mbErr_8_3) (True -> let iworld_11_0 = select (select (taskfun_0 tmpDir_8_0)::_Tuple1 0 event_1 evalOpts_2 treea_1_2 (update iworld_4::iTasks.Internal.IWorld._IWorld [12:select _x_8_2::_Tuple2 1]))::_Tuple2 1 in _Tuple2 (iTasks.WF.Definition.ExceptionResult (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__Tuple2)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Int))) (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char)))) (<{StdOverloaded.toString;}> iTasks.WF.Combinators.SDS.toString_9) (Data.Error.fromError mbErr_8_3))) (update iworld_11_0::iTasks.Internal.IWorld._IWorld [12:select (System.Directory.setCurrentDirectory (Data.Error.fromOk mbCurdir_6_1) (select iworld_11_0::iTasks.Internal.IWorld._IWorld 12))::_Tuple2 1])) (False -> let evala_11_0 = select (taskfun_0 tmpDir_8_0)::_Tuple1 0, world_11_1 = select _x_8_2::_Tuple2 1, _x_11_2 = evala_11_0 event_1 evalOpts_2 treea_1_2 (update iworld_4::iTasks.Internal.IWorld._IWorld [12:world_11_1]), iworld_11_3 = select _x_11_2::_Tuple2 1 in <{iTasks.WF.Combinators.SDS._c;123;11_366}> (select _x_11_2::_Tuple2 0) event_1 task_1_0 taskTime_5_0 ts_1_1 iworld_11_3 mbCurdir_6_1) ) ) ) ) ) ) ) (iTasks.Internal.TaskState.TCDestroy _x_1_0 -> case _x_1_0 (iTasks.Internal.TaskState.TCShared task_2_0 ts_2_1 treea_2_2 -> case iworld_4 (iTasks.Internal.IWorld._IWorld server_3_0 config_3_1 clocks_3_2 current_3_3 random_3_4 sdsNotifyRequests_3_5 memoryShares_3_6 cachedShares_3_7 exposedShares_3_8 jsCompilerState_3_9 ioTasks_3_10 ioStates_3_11 world_3_12 resources_3_13 onClient_3_14 shutdown_3_15 -> case server_3_0 (iTasks.Internal.IWorld._ServerInfo serverName_4_0 serverURL_4_1 build_4_2 _x_4_3 -> case _x_4_3 (iTasks.Internal.IWorld._SystemPaths appDirectory_5_0 dataDirectory_5_1 webDirectory_5_2 saplDirectory_5_3 -> let _x_6_0 = select (taskfun_0 (<{System.FilePath.</>}> dataDirectory_5_1 (<{System.FilePath.</>}> "tmp" (<{StdString.+++_11}> build_4_2 (<{StdString.+++_11}> "-" (<{StdString.+++_11}> (iTasks.WF.Definition.toString_2 task_2_0) "-tmpdir"))))))::_Tuple1 0 event_1 evalOpts_2 (iTasks.Internal.TaskState.TCDestroy treea_2_2) iworld_4 in _Tuple2 (select _x_6_0::_Tuple2 0) (select _x_6_0::_Tuple2 1)) ) ) ) ) (_ -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (iTasks.WF.Definition.exception (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))) (<{StdOverloaded.toString;}> StdString.toString_9) "Corrupt task state in withShared")) iworld_4)
<{iTasks.WF.Combinators.SDS._c;123;11_366}> !_x_0 event_1 task_2 taskTime_3::I ts_4::I iworld_5 mbCurdir_6 = case _x_0 (iTasks.WF.Definition.ValueResult value_1_0 info_1_1 rep_1_2 ntreea_1_3 -> let ts_2_0 = <{iTasks.WF.Combinators.SDS._c;116;39_365}> event_1 task_2 taskTime_3 ts_4, y_2_1::I = select info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo 0, info_2_2::I = update info_1_1::iTasks.Internal.TaskEval._TaskEvalInfo [0:<{iTasks.WF.Combinators.SDS._c;51;16_364}> (<{StdInt.<_17}> ts_2_0 y_2_1) y_2_1 ts_2_0] in _Tuple2 (iTasks.WF.Definition.ValueResult value_1_0 info_2_2 rep_1_2 (iTasks.Internal.TaskState.TCShared task_2 (select info_2_2::iTasks.Internal.TaskEval._TaskEvalInfo 0) ntreea_1_3)) (update iworld_5::iTasks.Internal.IWorld._IWorld [12:select (System.Directory.setCurrentDirectory (Data.Error.fromOk mbCurdir_6) (select iworld_5::iTasks.Internal.IWorld._IWorld 12))::_Tuple2 1])) (iTasks.WF.Definition.ExceptionResult e_1_0 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult e_1_0) (update iworld_5::iTasks.Internal.IWorld._IWorld [12:select (System.Directory.setCurrentDirectory (Data.Error.fromOk mbCurdir_6) (select iworld_5::iTasks.Internal.IWorld._IWorld 12))::_Tuple2 1])) 
<{iTasks.WF.Combinators.SDS._c;116;39_365}>::I !event_0 task_1 taskTime_2::I ts_3::I = case event_0 (iTasks.WF.Definition.FocusEvent focus_1_0 -> case (<{iTasks.WF.Definition.==_4}> focus_1_0 task_1) (True -> taskTime_2) (False -> ts_3) ) (_ -> ts_3)
<{iTasks.WF.Combinators.SDS._c;51;16_364}>::I !_x_0::B y_1::I ts_2::I = case _x_0 (True -> y_1) (_ -> ts_2)
<{iTasks.WF.Combinators.SDS._c;104;11_363}> !_x_0 taskfun_1 event_2 evalOpts_3 task_4 ts_5::I task_6 iworld_7 world_8 = case _x_0 (Data.Error.Ok _x_1_0 -> iTasks.WF.Combinators.SDS.eval_8 taskfun_1 event_2 evalOpts_3 (iTasks.Internal.TaskState.TCShared task_4 ts_5 (iTasks.Internal.TaskState.TCInit task_6 ts_5)) (update iworld_7::iTasks.Internal.IWorld._IWorld [12:world_8])) (Data.Error.Error e_1_0 -> case e_1_0 (_Tuple2 ecode_2_0 emsg_2_1 -> _Tuple2 (iTasks.WF.Definition.ExceptionResult (_Tuple2 (_SystemDynamic._DynamicTemp e_1_0 (_SystemDynamic.TypeApp (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__Tuple2)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Int))) (_SystemDynamic.TypeApp (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC__UnboxedArray)) (_SystemDynamic.TypeCons (_SystemDynamic._TypeCodeConstructor _SystemDynamic.TC_Char))))) emsg_2_1)) (update iworld_7::iTasks.Internal.IWorld._IWorld [12:world_8])) ) 
iTasks.WF.Combinators.SDS.withTemporaryDirectory !_viTask_0 taskfun_1 = iTasks.WF.Definition.Task (iTasks.WF.Combinators.SDS.eval_8 taskfun_1)


|| Converted Records
:: <{iTasks.WF.Combinators.SDS.JSONEncode_s;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_s}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_ss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_ss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_sss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_sss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_s;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_s}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_ss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_ss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_sss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_sss}

:: <{iTasks.WF.Combinators.SDS.gDefault_s;}> = {iTasks.WF.Combinators.SDS.gDefault_s}

:: <{iTasks.WF.Combinators.SDS.gDefault_ss;}> = {iTasks.WF.Combinators.SDS.gDefault_ss}

:: <{iTasks.WF.Combinators.SDS.gDefault_sss;}> = {iTasks.WF.Combinators.SDS.gDefault_sss}

:: <{iTasks.WF.Combinators.SDS.gText_s;}> = {!iTasks.WF.Combinators.SDS.gText_s}

:: <{iTasks.WF.Combinators.SDS.gText_ss;}> = {!iTasks.WF.Combinators.SDS.gText_ss}

:: <{iTasks.WF.Combinators.SDS.gText_sss;}> = {!iTasks.WF.Combinators.SDS.gText_sss}

:: <{iTasks.WF.Combinators.SDS.gEditor_s;}> = {iTasks.WF.Combinators.SDS.gEditor_s}

:: <{iTasks.WF.Combinators.SDS.gEditor_ss;}> = {iTasks.WF.Combinators.SDS.gEditor_ss}

:: <{iTasks.WF.Combinators.SDS.gEditor_sss;}> = {iTasks.WF.Combinators.SDS.gEditor_sss}

:: <{iTasks.WF.Combinators.SDS.gEq_s;}> = {!iTasks.WF.Combinators.SDS.gEq_s}

:: <{iTasks.WF.Combinators.SDS.gEq_ss;}> = {!iTasks.WF.Combinators.SDS.gEq_ss}

:: <{iTasks.WF.Combinators.SDS.gEq_sss;}> = {!iTasks.WF.Combinators.SDS.gEq_sss}

:: <{iTasks.WF.Combinators.SDS.gEq_ssss;}> = {!iTasks.WF.Combinators.SDS.gEq_ssss}

:: <{iTasks.WF.Combinators.SDS.gEq_sssss;}> = {!iTasks.WF.Combinators.SDS.gEq_sssss}

:: <{iTasks.WF.Combinators.SDS.gEq_ssssss;}> = {!iTasks.WF.Combinators.SDS.gEq_ssssss}

:: <{iTasks.WF.Combinators.SDS.gEq_sssssss;}> = {!iTasks.WF.Combinators.SDS.gEq_sssssss}

:: <{iTasks.WF.Combinators.SDS.gEq_ssssssss;}> = {!iTasks.WF.Combinators.SDS.gEq_ssssssss}

:: <{iTasks.WF.Combinators.SDS.gEq_sssssssss;}> = {!iTasks.WF.Combinators.SDS.gEq_sssssssss}

:: <{iTasks.WF.Combinators.SDS.bimap_s;}> = {iTasks.WF.Combinators.SDS.bimap_s}

:: <{iTasks.WF.Combinators.SDS.bimap_ss;}> = {iTasks.WF.Combinators.SDS.bimap_ss}

:: <{iTasks.WF.Combinators.SDS.bimap_sss;}> = {iTasks.WF.Combinators.SDS.bimap_sss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_ssss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_ssss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_sssss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_sssss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_ssssss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_ssssss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_sssssss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_sssssss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_ssssssss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_ssssssss}

:: <{iTasks.WF.Combinators.SDS.JSONEncode_sssssssss;}> = {!iTasks.WF.Combinators.SDS.JSONEncode_sssssssss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_ssss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_ssss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_sssss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_sssss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_ssssss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_ssssss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_sssssss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_sssssss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_ssssssss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_ssssssss}

:: <{iTasks.WF.Combinators.SDS.JSONDecode_sssssssss;}> = {!iTasks.WF.Combinators.SDS.JSONDecode_sssssssss}

:: <{iTasks.WF.Combinators.SDS.gText_ssss;}> = {!iTasks.WF.Combinators.SDS.gText_ssss}

:: <{iTasks.WF.Combinators.SDS.gText_sssss;}> = {!iTasks.WF.Combinators.SDS.gText_sssss}

:: <{iTasks.WF.Combinators.SDS.gText_ssssss;}> = {!iTasks.WF.Combinators.SDS.gText_ssssss}

:: <{iTasks.WF.Combinators.SDS.gText_sssssss;}> = {!iTasks.WF.Combinators.SDS.gText_sssssss}

:: <{iTasks.WF.Combinators.SDS.gText_ssssssss;}> = {!iTasks.WF.Combinators.SDS.gText_ssssssss}

:: <{iTasks.WF.Combinators.SDS.gText_sssssssss;}> = {!iTasks.WF.Combinators.SDS.gText_sssssssss}

:: <{iTasks.WF.Combinators.SDS.gDefault_ssss;}> = {iTasks.WF.Combinators.SDS.gDefault_ssss}

:: <{iTasks.WF.Combinators.SDS.gDefault_sssss;}> = {iTasks.WF.Combinators.SDS.gDefault_sssss}

:: <{iTasks.WF.Combinators.SDS.gDefault_ssssss;}> = {iTasks.WF.Combinators.SDS.gDefault_ssssss}

:: <{iTasks.WF.Combinators.SDS.gDefault_sssssss;}> = {iTasks.WF.Combinators.SDS.gDefault_sssssss}

:: <{iTasks.WF.Combinators.SDS.gDefault_ssssssss;}> = {iTasks.WF.Combinators.SDS.gDefault_ssssssss}

:: <{iTasks.WF.Combinators.SDS.gDefault_sssssssss;}> = {iTasks.WF.Combinators.SDS.gDefault_sssssssss}

:: <{iTasks.WF.Combinators.SDS.gEditor_ssss;}> = {iTasks.WF.Combinators.SDS.gEditor_ssss}

:: <{iTasks.WF.Combinators.SDS.gEditor_sssss;}> = {iTasks.WF.Combinators.SDS.gEditor_sssss}

:: <{iTasks.WF.Combinators.SDS.gEditor_ssssss;}> = {iTasks.WF.Combinators.SDS.gEditor_ssssss}

:: <{iTasks.WF.Combinators.SDS.gEditor_sssssss;}> = {iTasks.WF.Combinators.SDS.gEditor_sssssss}

