|| ?module? ExtListBox


ExtListBox.openExtListBoxId !_v_0 !env_1 = let _x_1_0 = select _v_0::<{StdId.Ids;}> 0 env_1, _x_1_1 = select _v_0::<{StdId.Ids;}> 2 (select _x_1_0::_Tuple2 1) in <{_Tuple2!3}> (ExtListBox._ExtListBoxId (select _x_1_0::_Tuple2 0) (select _x_1_1::_Tuple2 0)) (select _x_1_1::_Tuple2 1)
ExtListBox.getExtListBoxSelection !_x_0 !pState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> let _x_2_0 = StdReceiver.syncSend2 receiver_1_1 ExtListBox.InGetSelection pState_1, _x_2_1 = select _x_2_0::_Tuple2 0, maybe_out_2_2 = select _x_2_1::_Tuple2 1 in case (Data.Maybe.isNothing maybe_out_2_2) (True -> <{_Tuple2!3}> (_Tuple2 False _predefined._Nil) (select _x_2_0::_Tuple2 1)) (False -> <{_Tuple2!3}> (<{ExtListBox._c;652;35_141}> (Data.Maybe.fromJust maybe_out_2_2)) (select _x_2_0::_Tuple2 1)) ) 
<{ExtListBox._c;652;35_141}> !_x_0 = case _x_0 (ExtListBox.OutGetSelection selection_1_0 -> <{_Tuple2!3}> True selection_1_0) (_ -> <{_Tuple2!3}> False _predefined._Nil)
ExtListBox.setExtListBoxSelection !_x_0 !selection_1 !pState_2 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InSetSelection selection_1) pState_2)::_Tuple2 1) 
ExtListBox.setExtListBoxSelectionAll !_x_0 !pState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 ExtListBox.InSetSelectAll pState_1)::_Tuple2 1) 
ExtListBox.getExtListBoxItems !_x_0 !pState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> let _x_2_0 = StdReceiver.syncSend2 receiver_1_1 ExtListBox.InGetItems pState_1, _x_2_1 = select _x_2_0::_Tuple2 0, maybe_out_2_2 = select _x_2_1::_Tuple2 1 in case (Data.Maybe.isNothing maybe_out_2_2) (True -> <{_Tuple2!3}> (_Tuple2 False _predefined._Nil) (select _x_2_0::_Tuple2 1)) (False -> <{_Tuple2!3}> (<{ExtListBox._c;671;35_142}> (Data.Maybe.fromJust maybe_out_2_2)) (select _x_2_0::_Tuple2 1)) ) 
<{ExtListBox._c;671;35_142}> !_x_0 = case _x_0 (ExtListBox.OutGetItems items_1_0 -> <{_Tuple2!3}> True items_1_0) (_ -> <{_Tuple2!3}> False _predefined._Nil)
ExtListBox.openExtListBoxItems !_x_0 !index_1::I !items_2 !pState_3 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InOpenItems index_1 items_2) pState_3)::_Tuple2 1) 
ExtListBox.execExtListBoxItem !_x_0 !index_1::I !pState_2 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InExecItem index_1) pState_2)::_Tuple2 1) 
ExtListBox.appendExtListBoxItems !_x_0 !items_1 !pState_2 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InAppendItems items_1) pState_2)::_Tuple2 1) 
ExtListBox.closeExtListBoxItems !_x_0 !items_1 !pState_2 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InCloseItems items_1) pState_2)::_Tuple2 1) 
ExtListBox.closeAllExtListBoxItems !_x_0 !pState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 ExtListBox.InCloseAllItems pState_1)::_Tuple2 1) 
ExtListBox.setExtListBoxPen !_x_0 !pen_1 !ps_2 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> select (StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InSetPen pen_1) ps_2)::_Tuple2 1) 
ExtListBox.getExtListBoxPen !_x_0 !ps_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> let _x_2_0 = StdReceiver.syncSend2 receiver_1_1 ExtListBox.InGetPen ps_1, _x_2_1 = select _x_2_0::_Tuple2 0, maybe_out_2_2 = select _x_2_1::_Tuple2 1 in case (Data.Maybe.isNothing maybe_out_2_2) (True -> _Tuple2 Data.Maybe.Nothing (select _x_2_0::_Tuple2 1)) (False -> _Tuple2 (<{ExtListBox._c;718;35_143}> (Data.Maybe.fromJust maybe_out_2_2)) (select _x_2_0::_Tuple2 1)) ) 
<{ExtListBox._c;718;35_143}> !_x_0 = case _x_0 (ExtListBox.OutGetPen pen_1_0 -> Data.Maybe.Just pen_1_0) (_ -> Data.Maybe.Nothing)
ExtListBox.showExtListBoxControl !_x_0 !ioState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> StdControl.showControls (_predefined._Cons control_1_0 _predefined._Nil) ioState_1) 
ExtListBox.hideExtListBoxControl !_x_0 !ioState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> StdControl.hideControls (_predefined._Cons control_1_0 _predefined._Nil) ioState_1) 
ExtListBox.enableExtListBoxControl !_x_0 !ioState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> StdControl.enableControls (_predefined._Cons control_1_0 _predefined._Nil) ioState_1) 
ExtListBox.disableExtListBoxControl !_x_0 !ioState_1 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> StdControl.disableControls (_predefined._Cons control_1_0 _predefined._Nil) ioState_1) 
ExtListBox.dec_71 !<{_v-_0}> !_vone_1 !x_2 = select <{_v-_0}>::<{StdOverloaded.-;}> 0 x_2 (select _vone_1::<{StdOverloaded.one;}> 0)
ExtListBox.inc_70 !<{_v+_0}> !_vone_1 !x_2 = select <{_v+_0}>::<{StdOverloaded.+;}> 0 x_2 (select _vone_1::<{StdOverloaded.one;}> 0)
ExtListBox.normalise_58 !<{_v<_0}> !<{_v+_1}> !<{_v-_2}> num_3 min_4 max_5 incr_6 = case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 num_3 min_4) (True -> ExtListBox.normalise_58 <{_v<_0}> <{_v+_1}> <{_v-_2}> (select <{_v+_1}>::<{StdOverloaded.+;}> 0 num_3 incr_6) min_4 max_5 incr_6) (False -> case (select <{_v<_0}>::<{StdOverloaded.<;}> 0 max_5 num_3) (True -> ExtListBox.normalise_58 <{_v<_0}> <{_v+_1}> <{_v-_2}> (select <{_v-_2}>::<{StdOverloaded.-;}> 0 num_3 incr_6) min_4 max_5 incr_6) (False -> num_3) ) 
ExtListBox.inc_115::I !_vone_0 !x_1::I = <{StdInt.+_6}> x_1 (select _vone_0::<{StdOverloaded.one;}> 0)
ExtListBox.dec_116::I !_vone_0 !x_1::I = <{StdInt.-_7}> x_1 (select _vone_0::<{StdOverloaded.one;}> 0)
ExtListBox.normalise_117::I !<{_v+_0}> !<{_v-_1}> !num_2::I !min_3::I !max_4::I incr_5::I = case (<{StdInt.<_17}> num_2 min_3) (True -> ExtListBox.normalise_117 <{_v+_0}> <{_v-_1}> (select <{_v+_0}>::<{StdOverloaded.+;}> 0 num_2 incr_5) min_3 max_4 incr_5) (False -> case (<{StdInt.<_17}> max_4 num_2) (True -> ExtListBox.normalise_117 <{_v+_0}> <{_v-_1}> (select <{_v-_1}>::<{StdOverloaded.-;}> 0 num_2 incr_5) min_3 max_4 incr_5) (False -> num_2) ) 
ExtListBox.inc_118::I !x_0::I = <{StdInt.+_6}> x_0 StdInt.one_11
ExtListBox.dec_119::I !x_0::I = <{StdInt.-_7}> x_0 StdInt.one_11
ExtListBox.normalise_120::I !<{_v-_0}> !num_1::I !min_2::I !max_3::I incr_4::I = case (<{StdInt.<_17}> num_1 min_2) (True -> ExtListBox.normalise_120 <{_v-_0}> (<{StdInt.+_6}> num_1 incr_4) min_2 max_3 incr_4) (False -> case (<{StdInt.<_17}> max_3 num_1) (True -> ExtListBox.normalise_120 <{_v-_0}> (select <{_v-_0}>::<{StdOverloaded.-;}> 0 num_1 incr_4) min_2 max_3 incr_4) (False -> num_1) ) 
ExtListBox.normalise_121::I !num_0::I !min_1::I !max_2::I incr_3::I = case (<{StdInt.<_17}> num_0 min_1) (True -> ExtListBox.normalise_121 (<{StdInt.+_6}> num_0 incr_3) min_1 max_2 incr_3) (False -> case (<{StdInt.<_17}> max_2 num_0) (True -> ExtListBox.normalise_121 (<{StdInt.-_7}> num_0 incr_3) min_1 max_2 incr_3) (False -> num_0) ) 
ExtListBox.exec_next !next_0::B !lb_1 !ps_2 = let _x_1_0 = ExtListBox.getExtListBoxSelection lb_1 ps_2, _x_1_1 = select _x_1_0::_Tuple2 0 in case (StdBool.not (select _x_1_1::_Tuple2 0)) (True -> select _x_1_0::_Tuple2 1) (False -> let ps_3_0 = select _x_1_0::_Tuple2 1, _x_3_1 = ExtListBox.getExtListBoxItems lb_1 ps_3_0, _x_3_2 = select _x_3_1::_Tuple2 0 in case (StdBool.not (select _x_3_2::_Tuple2 0)) (True -> select _x_3_1::_Tuple2 1) (False -> let lst_5_0::I = select _x_3_2::_Tuple2 1, num_5_1 = StdList.length_47 lst_5_0 in case (<{StdInt.==_16}> num_5_1 0) (True -> select _x_3_1::_Tuple2 1) (False -> let sel_7_0::I = select _x_1_1::_Tuple2 1, idx_7_1 = ExtListBox.normalise_121 (<{ExtListBox._if;731;28_145}> (StdList.isEmpty sel_7_0) next_0 sel_7_0) 1 num_5_1 num_5_1 in ExtListBox.setExtListBoxSelection lb_1 (_predefined._Cons idx_7_1 _predefined._Nil) (ExtListBox.execExtListBoxItem lb_1 idx_7_1 (select _x_3_1::_Tuple2 1))) ) ) 
<{ExtListBox._if;731;28_145}>::I !_x_0::B next_1::B sel_2 = case _x_0 (True -> 1) (_ -> <{ExtListBox._if;730;27_144}> next_1 (select (StdList.hd sel_2)::_Tuple2 1))
<{ExtListBox._if;730;27_144}> !next_0::B = case next_0 (True -> ExtListBox.inc_118) (_ -> ExtListBox.dec_119)
ExtListBox.twiddle !idx1_0::I !idx2_1::I !items_2 = let <{idx1`_1_0}>::I = <{StdInt.-_7}> idx1_0 StdInt.one_11, <{idx2`_1_1}>::I = <{StdInt.-_7}> idx2_1 StdInt.one_11 in StdList.updateAt <{idx1`_1_0}> (<{StdList.!!}> items_2 <{idx2`_1_1}>) (StdList.updateAt <{idx2`_1_1}> (<{StdList.!!}> items_2 <{idx1`_1_0}>) items_2)
ExtListBox.upSelItem !lb_0 !_x_1 = case lb_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> case _x_1 (_Tuple2 ls_2_0 ps_2_1 -> let _x_3_0 = ExtListBox.getExtListBoxSelection lb_0 ps_2_1, _x_3_1 = select _x_3_0::_Tuple2 0, sel_3_2 = select _x_3_1::_Tuple2 1 in case (case (StdBool.not (select _x_3_1::_Tuple2 0)) (True -> True) (False -> StdBool.not (<{StdInt.==_16}> (StdList.length_47 sel_3_2) 1)) ) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_3_0::_Tuple2 1))) (False -> let _x_5_0::I = StdList.hd sel_3_2, sel_5_1 = select _x_5_0::_Tuple2 1 in case (<{StdInt.==_16}> sel_5_1 1) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_3_0::_Tuple2 1))) (False -> let ps_7_0 = select _x_3_0::_Tuple2 1, _x_7_1 = StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InTwiddleItems sel_5_1 (<{StdInt.-_7}> sel_5_1 StdInt.one_11)) ps_7_0 in case (Data.Maybe.isNothing (select (select _x_7_1::_Tuple2 0)::_Tuple2 1)) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_7_1::_Tuple2 1))) (False -> _Tuple2 True (_Tuple2 (ExtListBox.twiddle sel_5_1 (<{StdInt.-_7}> sel_5_1 StdInt.one_11) ls_2_0) (ExtListBox.setExtListBoxSelection lb_0 (_predefined._Cons (<{StdInt.-_7}> sel_5_1 StdInt.one_11) _predefined._Nil) (select _x_7_1::_Tuple2 1)))) ) ) ) ) 
ExtListBox.dnSelItem !lb_0 !_x_1 = case lb_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> case _x_1 (_Tuple2 ls_2_0 ps_2_1 -> let _x_3_0 = ExtListBox.getExtListBoxSelection lb_0 ps_2_1, _x_3_1 = select _x_3_0::_Tuple2 0, sel_3_2 = select _x_3_1::_Tuple2 1 in case (case (StdBool.not (select _x_3_1::_Tuple2 0)) (True -> True) (False -> StdBool.not (<{StdInt.==_16}> (StdList.length_47 sel_3_2) 1)) ) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_3_0::_Tuple2 1))) (False -> let ps_5_0 = select _x_3_0::_Tuple2 1, _x_5_1 = ExtListBox.getExtListBoxItems lb_0 ps_5_0, _x_5_2 = select _x_5_1::_Tuple2 0 in case (StdBool.not (select _x_5_2::_Tuple2 0)) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_5_1::_Tuple2 1))) (False -> let _x_7_0::I = StdList.hd sel_3_2, sel_7_1 = select _x_7_0::_Tuple2 1 in case (<{StdInt.==_16}> sel_7_1 (StdList.length_47 (select _x_5_2::_Tuple2 1))) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_5_1::_Tuple2 1))) (False -> let ps_9_0 = select _x_5_1::_Tuple2 1, _x_9_1 = StdReceiver.syncSend2 receiver_1_1 (ExtListBox.InTwiddleItems sel_7_1 (<{StdInt.+_6}> sel_7_1 StdInt.one_11)) ps_9_0 in case (Data.Maybe.isNothing (select (select _x_9_1::_Tuple2 0)::_Tuple2 1)) (True -> _Tuple2 False (_Tuple2 ls_2_0 (select _x_9_1::_Tuple2 1))) (False -> _Tuple2 True (_Tuple2 (ExtListBox.twiddle sel_7_1 (<{StdInt.+_6}> sel_7_1 StdInt.one_11) ls_2_0) (ExtListBox.setExtListBoxSelection lb_0 (_predefined._Cons (<{StdInt.+_6}> sel_7_1 StdInt.one_11) _predefined._Nil) (select _x_9_1::_Tuple2 1)))) ) ) ) ) ) 
ExtListBox.mouseFilter::B !_x_0 = case _x_0 (StdIOCommon.MouseDown _x_1_0 _x_1_1 _x_1_2 -> True) (_ -> False)
ExtListBox.calc_45 tMargin_0::I bMargin_1::I lMargin_2::I rMargin_3::I items_4 pen_5 pic_6 = let _x_1_0 = StdPicture.getPenFontMetrics (StdPicture.setPenAttributes pen_5 pic_6), _x_1_1 = StdPicture.getPenFontStringWidths items_4 (select _x_1_0::_Tuple2 1), metrics_1_2 = select _x_1_0::_Tuple2 0 in _Tuple2 (StdIOBasic._Rectangle StdIOBasic.zero_21 (StdIOBasic._Point2 (<{StdInt.+_6}> (<{StdInt.+_6}> (StdOrdList.maxList_15 (_predefined._Cons 0 (select _x_1_1::_Tuple2 0))) lMargin_2) rMargin_3) (<{StdInt.+_6}> (<{StdInt.+_6}> (<{StdInt.*_9}> (StdList.length_47 items_4) (<{StdInt.+_6}> (<{StdInt.+_6}> (select metrics_1_2::StdPictureDef._FontMetrics 2) (select metrics_1_2::StdPictureDef._FontMetrics 0)) (select metrics_1_2::StdPictureDef._FontMetrics 1))) tMargin_0) bMargin_1))) (select _x_1_1::_Tuple2 1)
ExtListBox.calcControlDomain !listboxState_0 ps_1 = case listboxState_0 (ExtListBox._ExtListBoxState items_1_0 funs_1_1 shiftfuns_1_2 selection_1_3 listbox_1_4 lineHeight_1_5 initHeight_1_6 lMargin_1_7 tMargin_1_8 rMargin_1_9 bMargin_1_10 pen_1_11 newselfun_1_12 -> let _x_2_0 = StdPSt.accPIO (StdPSt.accScreenPicture_13 (ExtListBox.calc_45 tMargin_1_8 bMargin_1_10 lMargin_1_7 rMargin_1_9 items_1_0 pen_1_11)) ps_1 in _Tuple3 listboxState_0 (select _x_2_0::_Tuple2 0) (select _x_2_0::_Tuple2 1)) 
ExtListBox.diff_46::B !_x_0 _x_1 = case _x_0 (StdPictureDef.PenSize _x_1_0 -> case _x_1 (StdPictureDef.PenSize _x_2_0 -> False) ) (StdPictureDef.PenPos _x_1_0 -> case _x_1 (StdPictureDef.PenPos _x_2_0 -> False) ) (StdPictureDef.PenColour _x_1_0 -> case _x_1 (StdPictureDef.PenColour _x_2_0 -> False) ) (StdPictureDef.PenBack _x_1_0 -> case _x_1 (StdPictureDef.PenBack _x_2_0 -> False) ) (StdPictureDef.PenFont _x_1_0 -> case _x_1 (StdPictureDef.PenFont _x_2_0 -> False) ) (_ -> True)
ExtListBox.removeDupAtt !_x_0 = case _x_0 (_predefined._Cons x_1_0 xs_1_1 -> _predefined._Cons x_1_0 (ExtListBox.removeDupAtt (StdList.filter (ExtListBox.diff_46 x_1_0) xs_1_1))) (_ -> _predefined._Nil)
ExtListBox.drawline_48 !_vDrawables_0 lineHeight_1::I lMargin_2::I line_3 y_4::I = _Tuple2 (select _vDrawables_0::<{StdPicture.Drawables;}> 1 (StdIOBasic._Point2 lMargin_2 y_4) line_3) (<{StdInt.+_6}> y_4 lineHeight_1)
ExtListBox.smap f_0 !_x_1 s_2 = case _x_1 (_predefined._Cons x_1_0 xs_1_1 -> let _x_2_0 = f_0 x_1_0 s_2, _x_2_1 = ExtListBox.smap f_0 xs_1_1 (select _x_2_0::_Tuple2 1) in _Tuple2 (_predefined._Cons (select _x_2_0::_Tuple2 0) (select _x_2_1::_Tuple2 0)) (select _x_2_1::_Tuple2 1)) (_ -> _Tuple2 _predefined._Nil s_2)
ExtListBox.drawsel_47 !tMargin_0::I !lineHeight_1::I !x2_2::I !x1_3::I !i_4::I = StdPicture.hilite_55 (StdIOBasic._Rectangle (StdIOBasic._Point2 x1_3 (<{StdInt.+_6}> tMargin_0 (<{StdInt.*_9}> (<{StdInt.-_7}> i_4 1) lineHeight_1))) (StdIOBasic._Point2 x2_2 (<{StdInt.-_7}> (<{StdInt.+_6}> tMargin_0 (<{StdInt.*_9}> i_4 lineHeight_1)) 1)))
ExtListBox.customlook_49 !_vDrawables_0 lMargin_1::I lineHeight_2::I !selection_3 items_4 initHeight_5::I tMargin_6::I pen_7 _x_8 !_x_9 pict_10 = case _x_9 (StdIOCommon._UpdateState oldFrame_1_0 newFrame_1_1 updArea_1_2 -> let _x_2_0 = _Tuple2 (select (select newFrame_1_1::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 0) (select (select newFrame_1_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 0) in StdFunc.seq (StdList.map (ExtListBox.drawsel_47 tMargin_6 lineHeight_2 (select _x_2_0::_Tuple2 1) (select _x_2_0::_Tuple2 0)) selection_3) (StdFunc.seq (select (ExtListBox.smap (ExtListBox.drawline_48 _vDrawables_0 lineHeight_2 lMargin_1) items_4 (<{StdInt.+_6}> initHeight_5 tMargin_6))::_Tuple2 0) (StdPicture.unfill_103 newFrame_1_1 (StdPicture.setPenAttributes pen_7 pict_10)))) 
ExtListBox.drawline_123 lineHeight_0::I lMargin_1::I line_2 y_3::I = _Tuple2 (StdPicture.drawAt_62 (StdIOBasic._Point2 lMargin_1 y_3) line_2) (<{StdInt.+_6}> y_3 lineHeight_0)
ExtListBox.customlook_122 lMargin_0::I lineHeight_1::I !selection_2 items_3 initHeight_4::I tMargin_5::I pen_6 _x_7 !_x_8 pict_9 = case _x_8 (StdIOCommon._UpdateState oldFrame_1_0 newFrame_1_1 updArea_1_2 -> let _x_2_0 = _Tuple2 (select (select newFrame_1_1::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 0) (select (select newFrame_1_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 0) in StdFunc.seq (StdList.map (ExtListBox.drawsel_47 tMargin_5 lineHeight_1 (select _x_2_0::_Tuple2 1) (select _x_2_0::_Tuple2 0)) selection_2) (StdFunc.seq (select (ExtListBox.smap (ExtListBox.drawline_123 lineHeight_1 lMargin_0) items_3 (<{StdInt.+_6}> initHeight_4 tMargin_5))::_Tuple2 0) (StdPicture.unfill_103 newFrame_1_1 (StdPicture.setPenAttributes pen_6 pict_9)))) 
ExtListBox.customlook !ls_0 = case ls_0 (ExtListBox._ExtListBoxState items_1_0 funs_1_1 shiftfuns_1_2 selection_1_3 listbox_1_4 lineHeight_1_5 initHeight_1_6 lMargin_1_7 tMargin_1_8 rMargin_1_9 bMargin_1_10 pen_1_11 newselfun_1_12 -> _Tuple2 (ExtListBox.customlook_122 lMargin_1_7 lineHeight_1_5 selection_1_3 items_1_0 initHeight_1_6 tMargin_1_8 pen_1_11) ls_0) 
ExtListBox.drawsel_51 !x2_0::I !tMargin_1::I !lineHeight_2::I !x1_3::I !i_4::I = StdPicture.hilite_55 (StdIOBasic._Rectangle (StdIOBasic._Point2 x1_3 (<{StdInt.+_6}> tMargin_1 (<{StdInt.*_9}> (<{StdInt.-_7}> i_4 1) lineHeight_2))) (StdIOBasic._Point2 x2_0 (<{StdInt.-_7}> (<{StdInt.+_6}> tMargin_1 (<{StdInt.*_9}> i_4 lineHeight_2)) 1)))
ExtListBox.update_50 x2_0::I tMargin_1::I lineHeight_2::I x1_3::I !selection_4 oldsel_5 pict_6 = StdFunc.seq (StdList.map (ExtListBox.drawsel_51 x2_0 tMargin_1 lineHeight_2 x1_3) selection_4) (StdFunc.seq (StdList.map (ExtListBox.drawsel_51 x2_0 tMargin_1 lineHeight_2 x1_3) oldsel_5) pict_6)
ExtListBox.updatelook !ls_0 oldsel_1 !_x_2 = case ls_0 (ExtListBox._ExtListBoxState items_1_0 funs_1_1 shiftfuns_1_2 selection_1_3 listbox_1_4 lineHeight_1_5 initHeight_1_6 lMargin_1_7 tMargin_1_8 rMargin_1_9 bMargin_1_10 pen_1_11 newselfun_1_12 -> case _x_2 (_Tuple2 x1_2_0 x2_2_1 -> _Tuple2 (ExtListBox.update_50 x2_2_1 tMargin_1_8 lineHeight_1_5 x1_2_0 selection_1_3 oldsel_1) ls_0) ) 
ExtListBox.sameSelection_52::B !_vOrd_0 !<{_v==_1}> !n_2 !o_3 = <{StdList.==_45}> <{_v==_1}> (StdOrdList.sort _vOrd_0 n_2) (StdOrdList.sort _vOrd_0 o_3)
ExtListBox.applySelfun !ls_0 ps_1 = case ls_0 (ExtListBox._ExtListBoxState items_1_0 funs_1_1 shiftfuns_1_2 selection_1_3 listbox_1_4 lineHeight_1_5 initHeight_1_6 lMargin_1_7 tMargin_1_8 rMargin_1_9 bMargin_1_10 pen_1_11 newselfun_1_12 -> let !ps_2_0 = newselfun_1_12 selection_1_3 ps_1 in _Tuple2 ls_0 ps_2_0) 
ExtListBox.setListBoxLook !listbox_0 !redraw_1::B newlook_2 !io_3 = case listbox_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> StdControl.setControlLook control_1_0 redraw_1 newlook_2 io_3) 
ExtListBox.scrolltoselection !_x_0 lineHeight_1::I tMargin_2::I bMargin_3::I !selection_4 !ps_5 = case _x_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> case (StdBool.not (<{StdInt.==_16}> (StdList.length_47 selection_4) 1)) (True -> ps_5) (False -> let _x_3_0 = StdPSt.accPIO (StdControl.getParentWindow control_1_0) ps_5, wdef_3_1 = select _x_3_0::_Tuple2 0 in case (Data.Maybe.isNothing wdef_3_1) (True -> select _x_3_0::_Tuple2 1) (False -> let wdef_5_0 = Data.Maybe.fromJust wdef_3_1, _x_5_1 = StdControl.getControlViewFrame control_1_0 wdef_5_0 in case (StdBool.not (select _x_5_1::_Tuple2 0)) (True -> select _x_3_0::_Tuple2 1) (False -> let frame_7_0 = select _x_5_1::_Tuple2 1 in case (Data.Maybe.isNothing frame_7_0) (True -> select _x_3_0::_Tuple2 1) (False -> let selitem_9_0::I = StdList.hd selection_4, top_9_1 = <{StdInt.*_9}> (<{StdInt.-_7}> selitem_9_0 1) lineHeight_1, frame_9_2::I = Data.Maybe.fromJust frame_7_0, delta_9_3::I = <{StdInt.-_7}> top_9_1 (select (select frame_9_2::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 1) in case (<{StdInt.<_17}> delta_9_3 0) (True -> StdPSt.appPIO (StdControl.moveControlViewFrame control_1_0 (StdIOBasic._Vector2 0 delta_9_3)) (select _x_3_0::_Tuple2 1)) (False -> let bot_11_0::I = <{StdInt.+_6}> (<{StdInt.+_6}> (<{StdInt.*_9}> selitem_9_0 lineHeight_1) tMargin_2) bMargin_3, delta_11_1::I = <{StdInt.-_7}> bot_11_0 (select (select frame_9_2::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 1) in case (<{StdInt.<_17}> 0 delta_11_1) (True -> StdPSt.appPIO (StdControl.moveControlViewFrame control_1_0 (StdIOBasic._Vector2 0 delta_11_1)) (select _x_3_0::_Tuple2 1)) (False -> select _x_3_0::_Tuple2 1) ) ) ) ) ) ) 
ExtListBox.sameSelection_124::B !<{_v==_0}> !n_1 !o_2 = <{StdList.==_45}> <{_v==_0}> (StdOrdList.sort_9 n_1) (StdOrdList.sort_9 o_2)
ExtListBox.sameSelection_125::B !n_0 !o_1 = <{StdList.==_85}> (StdOrdList.sort_9 n_0) (StdOrdList.sort_9 o_1)
ExtListBox.updateListBoxLook !custom_0 !newSelection_1 !_x_2 = case custom_0 (ExtListBox._ExtListBoxId control_1_0 receiver_1_1 -> case _x_2 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 lbState_3_0 ls_3_1 -> case lbState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> case (ExtListBox.sameSelection_125 newSelection_1 selection_4_3) (True -> _Tuple2 (_Tuple2 lbState_3_0 ls_3_1) ps_2_1) (False -> let lbState_6_0 = update lbState_3_0::ExtListBox._ExtListBoxState [3:newSelection_1], _x_6_1 = ExtListBox.applySelfun lbState_6_0 ps_2_1, ps_6_2 = select _x_6_1::_Tuple2 1, _x_6_3 = StdPSt.accPIO (StdControl.getParentWindow control_1_0) ps_6_2, wdef_6_4 = select _x_6_3::_Tuple2 0 in case (Data.Maybe.isNothing wdef_6_4) (True -> _Tuple2 (_Tuple2 (select _x_6_1::_Tuple2 0) ls_3_1) (select _x_6_3::_Tuple2 1)) (False -> let _x_8_0 = StdControl.getControlViewFrame control_1_0 (Data.Maybe.fromJust wdef_6_4), frame_8_1 = select _x_8_0::_Tuple2 1 in case (Data.Maybe.isNothing frame_8_1) (True -> _Tuple2 (_Tuple2 (select _x_6_1::_Tuple2 0) ls_3_1) (select _x_6_3::_Tuple2 1)) (False -> let !ps_10_0 = StdPSt.appPIO (StdControl.appControlPicture control_1_0 (select _x_10_5::_Tuple2 0)) (select _x_6_3::_Tuple2 1), !ps_10_1 = StdPSt.appPIO (ExtListBox.setListBoxLook custom_0 False (_Tuple2 True (select _x_10_6::_Tuple2 0))) ps_10_0, !ps_10_2 = ExtListBox.scrolltoselection custom_0 lineHeight_4_5 tMargin_4_8 bMargin_4_10 newSelection_1 ps_10_1, frame_10_3 = Data.Maybe.fromJust frame_8_1, _x_10_4 = _Tuple2 (select (select frame_10_3::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 0) (select (select frame_10_3::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 0), _x_10_5 = ExtListBox.updatelook (select _x_6_1::_Tuple2 0) selection_4_3 (_Tuple2 (select _x_10_4::_Tuple2 0) (select _x_10_4::_Tuple2 1)), _x_10_6 = ExtListBox.customlook (select _x_10_5::_Tuple2 1) in _Tuple2 (_Tuple2 (select _x_10_6::_Tuple2 1) ls_3_1) ps_10_2) ) ) ) ) ) ) 
ExtListBox.keyboard_54 oKeyboard_0 nKeyboard_1 !nFilter_2 keyState_3 ks_4 = case (nFilter_2 keyState_3) (True -> nKeyboard_1 keyState_3 ks_4) (False -> oKeyboard_0 keyState_3 ks_4) 
ExtListBox.filter_53::B !nFilter_0 oFilter_1 keyState_2 = case (nFilter_0 keyState_2) (True -> True) (False -> oFilter_1 keyState_2) 
ExtListBox.joinKeyboards !_x_0 !_x_1 = case _x_0 (StdControlDef.ControlKeyboard oFilter_1_0 oState_1_1 oKeyboard_1_2 -> case _x_1 (StdControlDef.ControlKeyboard nFilter_2_0 nState_2_1 nKeyboard_2_2 -> StdControlDef.ControlKeyboard (ExtListBox.filter_53 nFilter_2_0 oFilter_1_0) StdIOCommon.Able (ExtListBox.keyboard_54 oKeyboard_1_2 nKeyboard_2_2 nFilter_2_0)) ) 
ExtListBox.hasSelection_55::B !selection_0 = case (StdList.isEmpty selection_0) (True -> False) (False -> True) 
ExtListBox.keyboard !_x_0 !_x_1 = case _x_0 (StdIOCommon.SpecialKey key_1_0 _x_1_1 _x_1_2 -> case _x_1_1 (StdIOCommon.KeyDown repeat_2_0 -> case _x_1_2 (StdIOCommon._Modifiers shiftDown_3_0 optionDown_3_1 commandDown_3_2 controlDown_3_3 altDown_3_4 -> case _x_1 (_Tuple2 _x_4_0 ps_4_1 -> case _x_4_0 (_Tuple2 lbState_5_0 ls_5_1 -> case lbState_5_0 (ExtListBox._ExtListBoxState items_6_0 funs_6_1 shiftfuns_6_2 selection_6_3 listbox_6_4 lineHeight_6_5 initHeight_6_6 lMargin_6_7 tMargin_6_8 rMargin_6_9 bMargin_6_10 pen_6_11 newselfun_6_12 -> case (case (<{oskey.==_32}> key_1_0 oskey.enterKey) (True -> True) (False -> <{oskey.==_32}> key_1_0 oskey.returnKey) ) (True -> case (StdBool.not (ExtListBox.hasSelection_55 selection_6_3)) (True -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1) (False -> case shiftDown_3_0 (True -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (<{StdList.!!}> shiftfuns_6_2 (<{StdInt.-_7}> (StdList.hd selection_6_3) 1) ps_4_1)) (False -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (<{StdList.!!}> funs_6_1 (<{StdInt.-_7}> (StdList.hd selection_6_3) 1) ps_4_1)) ) ) (False -> case (<{oskey.==_32}> key_1_0 oskey.escapeKey) (True -> ExtListBox.updateListBoxLook listbox_6_4 _predefined._Nil (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) (False -> case (<{oskey.==_32}> key_1_0 oskey.upKey) (True -> case shiftDown_3_0 (True -> case (ExtListBox.hasSelection_55 selection_6_3) (True -> let new_12_0::I = <{ExtListBox._if;467;27_146}> (ExtListBox.hasSelection_55 selection_6_3) lastSelection_12_1, lastSelection_12_1::I = StdList.hd selection_6_3 in ExtListBox.updateListBoxLook listbox_6_4 (StdList.removeDup_63 (_predefined._Cons new_12_0 (<{StdList.++}> (<{ExtListBox._if;470;35_147}> (<{StdInt.<_17}> lastSelection_12_1 new_12_0) lastSelection_12_1 new_12_0) selection_6_3))) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) (False -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (<{ExtListBox._if;467;27_148}> (ExtListBox.hasSelection_55 selection_6_3) selection_6_3) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) ) (False -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (<{ExtListBox._if;467;27_149}> (ExtListBox.hasSelection_55 selection_6_3) selection_6_3) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) ) (False -> case (<{oskey.==_32}> key_1_0 oskey.downKey) (True -> case shiftDown_3_0 (True -> case (ExtListBox.hasSelection_55 selection_6_3) (True -> let new_13_0::I = <{ExtListBox._if;484;27_150}> (ExtListBox.hasSelection_55 selection_6_3) lastSelection_13_1 nr_13_2, lastSelection_13_1::I = StdList.hd selection_6_3, nr_13_2::I = StdList.length_47 items_6_0 in ExtListBox.updateListBoxLook listbox_6_4 (StdList.removeDup_63 (_predefined._Cons new_13_0 (<{StdList.++}> (<{ExtListBox._if;487;35_151}> (<{StdInt.<_17}> lastSelection_13_1 new_13_0) lastSelection_13_1 new_13_0) selection_6_3))) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) (False -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (<{ExtListBox._if;484;27_152}> (ExtListBox.hasSelection_55 selection_6_3) selection_6_3 items_6_0) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) ) (False -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (<{ExtListBox._if;484;27_153}> (ExtListBox.hasSelection_55 selection_6_3) selection_6_3 items_6_0) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) ) (False -> case (<{oskey.==_32}> key_1_0 oskey.beginKey) (True -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons 1 _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) (False -> case (<{oskey.==_32}> key_1_0 oskey.endKey) (True -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (StdList.length_47 items_6_0) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) ps_4_1)) (False -> let custom_13_0 = select listbox_6_4::ExtListBox._ExtListBoxId 0, _x_13_1 = StdPSt.accPIO (StdControl.getParentWindow custom_13_0) ps_4_1, wstate_13_2 = select _x_13_1::_Tuple2 0 in case (Data.Maybe.isNothing wstate_13_2) (True -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (select _x_13_1::_Tuple2 1)) (False -> let wstate_15_0 = Data.Maybe.fromJust wstate_13_2, _x_15_1 = StdControl.getControlViewFrame custom_13_0 wstate_15_0 in case (StdBool.not (select _x_15_1::_Tuple2 0)) (True -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (select _x_13_1::_Tuple2 1)) (False -> let frame_17_0 = select _x_15_1::_Tuple2 1 in case (Data.Maybe.isNothing frame_17_0) (True -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (select _x_13_1::_Tuple2 1)) (False -> case (<{oskey.==_32}> key_1_0 oskey.pgUpKey) (True -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (<{ExtListBox._if;527;27_155}> (ExtListBox.hasSelection_55 selection_6_3) selection_6_3 frame_17_0 lineHeight_6_5 tMargin_6_8) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (select _x_13_1::_Tuple2 1))) (False -> case (<{oskey.==_32}> key_1_0 oskey.pgDownKey) (True -> ExtListBox.updateListBoxLook listbox_6_4 (_predefined._Cons (<{ExtListBox._if;540;27_157}> (ExtListBox.hasSelection_55 selection_6_3) frame_17_0 selection_6_3 lineHeight_6_5 tMargin_6_8 items_6_0) _predefined._Nil) (_Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (select _x_13_1::_Tuple2 1))) (False -> _Tuple2 (_Tuple2 lbState_5_0 ls_5_1) (select _x_13_1::_Tuple2 1)) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) (_ -> _x_1)
<{ExtListBox._if;540;27_157}>::I !_x_0::B frame_1 selection_2 lineHeight_3::I tMargin_4::I !items_5 = case _x_0 (True -> let lastSelection_2_0 = StdList.hd selection_2, frame_2_1::I = Data.Maybe.fromJust frame_1 in case (StdBool.not (<{StdInt.<_17}> (<{StdInt.+_6}> (<{StdInt.*_9}> (<{StdInt.+_6}> lastSelection_2_0 StdInt.one_11) lineHeight_3) tMargin_4) (select (select frame_2_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 1))) (True -> let nr_4_0::I = StdList.length_47 items_5, x_4_1::I = 1, y_4_2::I = <{StdInt.-_7}> (<{StdInt./_10}> (<{StdInt.-_7}> (select (select frame_2_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 1) (select (select frame_2_1::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 1)) lineHeight_3) StdInt.one_11, linesOnPage_4_3::I = <{ExtListBox._c;51;16_156}> (<{StdInt.<_17}> x_4_1 y_4_2) y_4_2 x_4_1, y_4_4::I = <{StdInt.+_6}> lastSelection_2_0 linesOnPage_4_3 in case (<{StdInt.<_17}> nr_4_0 y_4_4) (True -> nr_4_0) (False -> y_4_4) ) (False -> let nr_4_0::I = StdList.length_47 items_5, y_4_1::I = <{StdInt./_10}> (select (select frame_2_1::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 1) lineHeight_3 in case (<{StdInt.<_17}> nr_4_0 y_4_1) (True -> nr_4_0) (False -> y_4_1) ) ) (_ -> StdList.length_47 items_5)
<{ExtListBox._c;51;16_156}>::I !_x_0::B y_1::I x_2::I = case _x_0 (True -> y_1) (_ -> x_2)
<{ExtListBox._if;527;27_155}>::I !_x_0::B selection_1 frame_2 lineHeight_3::I tMargin_4::I = case _x_0 (True -> let frame_2_0::I = Data.Maybe.fromJust frame_2, lastSelection_2_1 = StdList.hd selection_1 in case (StdBool.not (<{StdInt.<_17}> (select (select frame_2_0::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 1) (<{StdInt.+_6}> (<{StdInt.*_9}> (<{StdInt.-_7}> lastSelection_2_1 2) lineHeight_3) tMargin_4))) (True -> let x_4_0::I = 1, x_4_1::I = 1, y_4_2::I = <{StdInt.-_7}> (<{StdInt./_10}> (<{StdInt.-_7}> (select (select frame_2_0::StdIOBasic._Rectangle 1)::StdIOBasic._Point2 1) (select (select frame_2_0::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 1)) lineHeight_3) StdInt.one_11, linesOnPage_4_3::I = <{ExtListBox._c;51;16_154}> (<{StdInt.<_17}> x_4_1 y_4_2) y_4_2 x_4_1, y_4_4::I = <{StdInt.-_7}> lastSelection_2_1 linesOnPage_4_3 in case (<{StdInt.<_17}> x_4_0 y_4_4) (True -> y_4_4) (False -> x_4_0) ) (False -> <{StdInt.+_6}> 1 (<{StdInt./_10}> (<{StdInt.-_7}> (select (select frame_2_0::StdIOBasic._Rectangle 0)::StdIOBasic._Point2 1) tMargin_4) lineHeight_3)) ) (_ -> 1)
<{ExtListBox._c;51;16_154}>::I !_x_0::B y_1::I x_2::I = case _x_0 (True -> y_1) (_ -> x_2)
<{ExtListBox._if;484;27_153}>::I !_x_0::B selection_1 !items_2 = case _x_0 (True -> let nr_2_0::I = StdList.length_47 items_2, lastSelection_2_1::I = StdList.hd selection_1, y_2_2::I = <{StdInt.+_6}> lastSelection_2_1 1 in case (<{StdInt.<_17}> nr_2_0 y_2_2) (True -> nr_2_0) (False -> y_2_2) ) (_ -> StdList.length_47 items_2)
<{ExtListBox._if;484;27_152}>::I !_x_0::B selection_1 !items_2 = case _x_0 (True -> let nr_2_0::I = StdList.length_47 items_2, lastSelection_2_1::I = StdList.hd selection_1, y_2_2::I = <{StdInt.+_6}> lastSelection_2_1 1 in case (<{StdInt.<_17}> nr_2_0 y_2_2) (True -> nr_2_0) (False -> y_2_2) ) (_ -> StdList.length_47 items_2)
<{ExtListBox._if;487;35_151}> !_x_0::B !lastSelection_1::I !new_2::I = case _x_0 (True -> _SystemEnum._from_to_6 lastSelection_1 new_2) (_ -> _SystemEnum._from_to_6 new_2 lastSelection_1)
<{ExtListBox._if;484;27_150}>::I !_x_0::B lastSelection_1::I !nr_2::I = case _x_0 (True -> let y_2_0::I = <{StdInt.+_6}> lastSelection_1 1 in case (<{StdInt.<_17}> nr_2 y_2_0) (True -> nr_2) (False -> y_2_0) ) (_ -> nr_2)
<{ExtListBox._if;467;27_149}>::I !_x_0::B selection_1 = case _x_0 (True -> let x_2_0::I = 1, lastSelection_2_1::I = StdList.hd selection_1, y_2_2::I = <{StdInt.-_7}> lastSelection_2_1 1 in case (<{StdInt.<_17}> x_2_0 y_2_2) (True -> y_2_2) (False -> x_2_0) ) (_ -> 1)
<{ExtListBox._if;467;27_148}>::I !_x_0::B selection_1 = case _x_0 (True -> let x_2_0::I = 1, lastSelection_2_1::I = StdList.hd selection_1, y_2_2::I = <{StdInt.-_7}> lastSelection_2_1 1 in case (<{StdInt.<_17}> x_2_0 y_2_2) (True -> y_2_2) (False -> x_2_0) ) (_ -> 1)
<{ExtListBox._if;470;35_147}> !_x_0::B !lastSelection_1::I !new_2::I = case _x_0 (True -> _SystemEnum._from_to_6 lastSelection_1 new_2) (_ -> _SystemEnum._from_to_6 new_2 lastSelection_1)
<{ExtListBox._if;467;27_146}>::I !_x_0::B lastSelection_1::I = case _x_0 (True -> let x_2_0::I = 1, y_2_1::I = <{StdInt.-_7}> lastSelection_1 1 in case (<{StdInt.<_17}> x_2_0 y_2_1) (True -> y_2_1) (False -> x_2_0) ) (_ -> 1)
ExtListBox.keyFilter::B !_x_0 = case _x_0 (StdIOCommon.SpecialKey _x_1_0 _x_1_1 _x_1_2 -> case _x_1_1 (StdIOCommon.KeyDown _x_2_0 -> True) ) (_ -> False)
ExtListBox.elbKeyboard = StdControlDef.ControlKeyboard ExtListBox.keyFilter StdIOCommon.Able ExtListBox.keyboard
ExtListBox.listSelection_56 !_vEnum_0 !prev_1 !new_2 = case (select (select _vEnum_0::<{StdClass.Enum;}> 0)::<{StdOverloaded.<;}> 0 prev_1 new_2) (True -> _SystemEnum._from_to _vEnum_0 prev_1 new_2) (False -> _SystemEnum._from_to _vEnum_0 new_2 prev_1) 
ExtListBox.newSelection_57 !_vEnum_0 !_vEq_1 controlDown_2::B selection_3 !shiftDown_4::B prev_5 new_6 hasSelection_7::B = case shiftDown_4 (True -> case hasSelection_7 (True -> StdList.removeDup _vEq_1 (_predefined._Cons new_6 (<{StdList.++}> (ExtListBox.listSelection_56 _vEnum_0 prev_5 new_6) selection_3))) (False -> _predefined._Cons new_6 _predefined._Nil) ) (False -> case controlDown_2 (True -> case (StdList.isMember _vEq_1 new_6 selection_3) (True -> StdList.removeMembers _vEq_1 selection_3 (_predefined._Cons new_6 _predefined._Nil)) (False -> _predefined._Cons new_6 selection_3) ) (False -> _predefined._Cons new_6 _predefined._Nil) ) 
ExtListBox.isBetween::B !_vOrd_0 low_1 up_2 x_3 = case (StdBool.not (select (select _vOrd_0::<{StdClass.Ord;}> 0)::<{StdOverloaded.<;}> 0 x_3 low_1)) (True -> StdBool.not (select (select _vOrd_0::<{StdClass.Ord;}> 0)::<{StdOverloaded.<;}> 0 up_2 x_3)) (False -> False) 
ExtListBox.listSelection_128 !prev_0::I !new_1::I = case (<{StdInt.<_17}> prev_0 new_1) (True -> _SystemEnum._from_to_6 prev_0 new_1) (False -> _SystemEnum._from_to_6 new_1 prev_0) 
ExtListBox.newSelection_127 !_vEq_0 controlDown_1::B selection_2 !shiftDown_3::B prev_4::I new_5::I hasSelection_6::B = case shiftDown_3 (True -> case hasSelection_6 (True -> StdList.removeDup _vEq_0 (_predefined._Cons new_5 (<{StdList.++}> (ExtListBox.listSelection_128 prev_4 new_5) selection_2))) (False -> _predefined._Cons new_5 _predefined._Nil) ) (False -> case controlDown_1 (True -> case (StdList.isMember _vEq_0 new_5 selection_2) (True -> StdList.removeMembers _vEq_0 selection_2 (_predefined._Cons new_5 _predefined._Nil)) (False -> _predefined._Cons new_5 selection_2) ) (False -> _predefined._Cons new_5 _predefined._Nil) ) 
ExtListBox.isBetween_126::B !low_0::I up_1::I !x_2::I = case (StdBool.not (<{StdInt.<_17}> x_2 low_0)) (True -> StdBool.not (<{StdInt.<_17}> up_1 x_2)) (False -> False) 
ExtListBox.newSelection_129 controlDown_0::B selection_1 !shiftDown_2::B prev_3::I new_4::I hasSelection_5::B = case shiftDown_2 (True -> case hasSelection_5 (True -> StdList.removeDup_63 (_predefined._Cons new_4 (<{StdList.++}> (ExtListBox.listSelection_128 prev_3 new_4) selection_1))) (False -> _predefined._Cons new_4 _predefined._Nil) ) (False -> case controlDown_0 (True -> case (StdList.isMember_51 new_4 selection_1) (True -> StdList.removeMembers_60 selection_1 (_predefined._Cons new_4 _predefined._Nil)) (False -> _predefined._Cons new_4 selection_1) ) (False -> _predefined._Cons new_4 _predefined._Nil) ) 
ExtListBox.mouseFunction !_x_0 !_x_1 = case _x_0 (StdIOCommon.MouseDown pos_1_0 _x_1_1 _x_1_2 -> case _x_1_1 (StdIOCommon._Modifiers shiftDown_2_0 optionDown_2_1 commandDown_2_2 controlDown_2_3 altDown_2_4 -> case _x_1_2 (1 -> case _x_1 (_Tuple2 _x_4_0 ps_4_1 -> case _x_4_0 (_Tuple2 listboxState_5_0 ls_5_1 -> case listboxState_5_0 (ExtListBox._ExtListBoxState items_6_0 funs_6_1 shiftfuns_6_2 selection_6_3 listbox_6_4 lineHeight_6_5 initHeight_6_6 lMargin_6_7 tMargin_6_8 rMargin_6_9 bMargin_6_10 pen_6_11 newselfun_6_12 -> let _x_7_0 = ExtListBox.applySelfun (update listboxState_5_0::ExtListBox._ExtListBoxState [3:StdList.filter (ExtListBox.isBetween_126 1 (StdList.length_47 items_6_0)) (ExtListBox.newSelection_129 controlDown_2_3 selection_6_3 shiftDown_2_0 (select selection_6_3::_Tuple2 0) (<{StdInt.+_6}> (<{StdInt./_10}> (<{StdInt.-_7}> (select pos_1_0::StdIOBasic._Point2 1) tMargin_6_8) lineHeight_6_5) 1) (StdBool.not (StdList.isEmpty selection_6_3)))]) ps_4_1, _x_7_1 = ExtListBox.customlook (select _x_7_0::_Tuple2 0) in _Tuple2 (_Tuple2 (select _x_7_1::_Tuple2 1) ls_5_1) (StdPSt.appPIO (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select (select listboxState_5_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_7_1::_Tuple2 0))) _predefined._Nil)) (select _x_7_0::_Tuple2 1))) ) ) ) (_ -> case _x_1 (_Tuple2 _x_3_0 ps_3_1 -> case _x_3_0 (_Tuple2 listboxState_4_0 ls_4_1 -> case listboxState_4_0 (ExtListBox._ExtListBoxState items_5_0 funs_5_1 shiftfuns_5_2 selection_5_3 listbox_5_4 lineHeight_5_5 initHeight_5_6 lMargin_5_7 tMargin_5_8 rMargin_5_9 bMargin_5_10 pen_5_11 newselfun_5_12 -> let new_6_0::I = <{StdInt.+_6}> (<{StdInt./_10}> (<{StdInt.-_7}> (select pos_1_0::StdIOBasic._Point2 1) tMargin_5_8) lineHeight_5_5) 1 in case (case (<{StdInt.<_17}> new_6_0 1) (True -> True) (False -> <{StdInt.<_17}> (StdList.length_47 funs_5_1) new_6_0) ) (True -> let _x_8_0 = ExtListBox.applySelfun (update listboxState_4_0::ExtListBox._ExtListBoxState [3:StdList.filter (ExtListBox.isBetween_126 1 (StdList.length_47 items_5_0)) (_predefined._Cons new_6_0 _predefined._Nil)]) ps_3_1, _x_8_1 = ExtListBox.customlook (select _x_8_0::_Tuple2 0) in _Tuple2 (_Tuple2 (select _x_8_1::_Tuple2 1) ls_4_1) (StdPSt.appPIO (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select (select listboxState_4_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_8_1::_Tuple2 0))) _predefined._Nil)) (select _x_8_0::_Tuple2 1))) (False -> case shiftDown_2_0 (True -> let _x_9_0 = ExtListBox.applySelfun (update listboxState_4_0::ExtListBox._ExtListBoxState [3:StdList.filter (ExtListBox.isBetween_126 1 (StdList.length_47 items_5_0)) (_predefined._Cons new_6_0 _predefined._Nil)]) ps_3_1, _x_9_1 = ExtListBox.customlook (select _x_9_0::_Tuple2 0) in _Tuple2 (_Tuple2 (select _x_9_1::_Tuple2 1) ls_4_1) (<{StdList.!!}> shiftfuns_5_2 (<{StdInt.-_7}> new_6_0 1) (StdPSt.appPIO (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select (select listboxState_4_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_9_1::_Tuple2 0))) _predefined._Nil)) (select _x_9_0::_Tuple2 1)))) (False -> let _x_9_0 = ExtListBox.applySelfun (update listboxState_4_0::ExtListBox._ExtListBoxState [3:StdList.filter (ExtListBox.isBetween_126 1 (StdList.length_47 items_5_0)) (_predefined._Cons new_6_0 _predefined._Nil)]) ps_3_1, _x_9_1 = ExtListBox.customlook (select _x_9_0::_Tuple2 0) in _Tuple2 (_Tuple2 (select _x_9_1::_Tuple2 1) ls_4_1) (<{StdList.!!}> funs_5_1 (<{StdInt.-_7}> new_6_0 1) (StdPSt.appPIO (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select (select listboxState_4_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_9_1::_Tuple2 0))) _predefined._Nil)) (select _x_9_0::_Tuple2 1)))) ) ) ) ) )) ) (_ -> _x_1)
ExtListBox.setBetween !_vOrd_0 low_1 up_2 x_3 = case (select (select _vOrd_0::<{StdClass.Ord;}> 0)::<{StdOverloaded.<;}> 0 x_3 low_1) (True -> low_1) (False -> case (select (select _vOrd_0::<{StdClass.Ord;}> 0)::<{StdOverloaded.<;}> 0 x_3 up_2) (True -> x_3) (False -> up_2) ) 
ExtListBox.liheights_64 pen_0 pic_1 = let _x_1_0 = StdPicture.getPenFontMetrics (StdPicture.setPenAttributes pen_0 pic_1), metrics_1_1 = select _x_1_0::_Tuple2 0 in _Tuple2 (_Tuple2 (<{StdInt.+_6}> (<{StdInt.+_6}> (select metrics_1_1::StdPictureDef._FontMetrics 2) (select metrics_1_1::StdPictureDef._FontMetrics 0)) (select metrics_1_1::StdPictureDef._FontMetrics 1)) (<{StdInt.+_6}> (select metrics_1_1::StdPictureDef._FontMetrics 0) (select metrics_1_1::StdPictureDef._FontMetrics 2))) (select _x_1_0::_Tuple2 1)
ExtListBox.anon_59 items_0 index_1::I = _Tuple2 (<{StdList.!!}> items_0 (<{StdInt.-_7}> index_1 1)) index_1
ExtListBox.anon_60::B !<{_v<_0}> okBehind_1 index_2 = StdBool.not (select <{_v<_0}>::<{StdOverloaded.<;}> 0 okBehind_1 index_2)
<{ExtListBox.c;281;63_61}> !_vEq_0 !_vone_1 !<{_v+_2}> close_3 !g_l_4 i_5 = <{ExtListBox.g_c1;281;54_158}> g_l_4 _vEq_0 i_5 close_3 _vone_1 <{_v+_2}>
<{ExtListBox.g_c1;281;54_158}> !g_l_0 _vEq_1 i_2 close_3 _vone_4 <{_v+_5}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember _vEq_1 i_2 close_3)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;281;63_61}> _vEq_1 _vone_4 <{_v+_5}> close_3 g_t_1_1 (select <{_v+_5}>::<{StdOverloaded.+;}> 0 i_2 (select _vone_4::<{StdOverloaded.one;}> 0)))) (False -> <{ExtListBox.c;281;63_61}> _vEq_1 _vone_4 <{_v+_5}> close_3 g_t_1_1 (select <{_v+_5}>::<{StdOverloaded.+;}> 0 i_2 (select _vone_4::<{StdOverloaded.one;}> 0))) ) (_ -> _predefined._Nil)
<{ExtListBox.c;282;62_62}> !_vEq_0 !_vone_1 !<{_v+_2}> close_3 !g_l_4 i_5 = <{ExtListBox.g_c1;282;54_159}> g_l_4 _vEq_0 i_5 close_3 _vone_1 <{_v+_2}>
<{ExtListBox.g_c1;282;54_159}> !g_l_0 _vEq_1 i_2 close_3 _vone_4 <{_v+_5}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember _vEq_1 i_2 close_3)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;282;62_62}> _vEq_1 _vone_4 <{_v+_5}> close_3 g_t_1_1 (select <{_v+_5}>::<{StdOverloaded.+;}> 0 i_2 (select _vone_4::<{StdOverloaded.one;}> 0)))) (False -> <{ExtListBox.c;282;62_62}> _vEq_1 _vone_4 <{_v+_5}> close_3 g_t_1_1 (select <{_v+_5}>::<{StdOverloaded.+;}> 0 i_2 (select _vone_4::<{StdOverloaded.one;}> 0))) ) (_ -> _predefined._Nil)
<{ExtListBox.c;283;67_63}> !_vEq_0 !_vone_1 !<{_v+_2}> close_3 !g_l_4 i_5 = <{ExtListBox.g_c1;283;54_160}> g_l_4 _vEq_0 i_5 close_3 _vone_1 <{_v+_2}>
<{ExtListBox.g_c1;283;54_160}> !g_l_0 _vEq_1 i_2 close_3 _vone_4 <{_v+_5}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember _vEq_1 i_2 close_3)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;283;67_63}> _vEq_1 _vone_4 <{_v+_5}> close_3 g_t_1_1 (select <{_v+_5}>::<{StdOverloaded.+;}> 0 i_2 (select _vone_4::<{StdOverloaded.one;}> 0)))) (False -> <{ExtListBox.c;283;67_63}> _vEq_1 _vone_4 <{_v+_5}> close_3 g_t_1_1 (select <{_v+_5}>::<{StdOverloaded.+;}> 0 i_2 (select _vone_4::<{StdOverloaded.one;}> 0))) ) (_ -> _predefined._Nil)
<{ExtListBox.c;283;67_134}> !_vone_0 !<{_v+_1}> close_2 !g_l_3 i_4::I = <{ExtListBox.g_c1;283;54_161}> g_l_3 i_4 close_2 _vone_0 <{_v+_1}>
<{ExtListBox.g_c1;283;54_161}> !g_l_0 i_1::I close_2 _vone_3 <{_v+_4}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;283;67_134}> _vone_3 <{_v+_4}> close_2 g_t_1_1 (select <{_v+_4}>::<{StdOverloaded.+;}> 0 i_1 (select _vone_3::<{StdOverloaded.one;}> 0)))) (False -> <{ExtListBox.c;283;67_134}> _vone_3 <{_v+_4}> close_2 g_t_1_1 (select <{_v+_4}>::<{StdOverloaded.+;}> 0 i_1 (select _vone_3::<{StdOverloaded.one;}> 0))) ) (_ -> _predefined._Nil)
<{ExtListBox.c;282;62_133}> !_vone_0 !<{_v+_1}> close_2 !g_l_3 i_4::I = <{ExtListBox.g_c1;282;54_162}> g_l_3 i_4 close_2 _vone_0 <{_v+_1}>
<{ExtListBox.g_c1;282;54_162}> !g_l_0 i_1::I close_2 _vone_3 <{_v+_4}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;282;62_133}> _vone_3 <{_v+_4}> close_2 g_t_1_1 (select <{_v+_4}>::<{StdOverloaded.+;}> 0 i_1 (select _vone_3::<{StdOverloaded.one;}> 0)))) (False -> <{ExtListBox.c;282;62_133}> _vone_3 <{_v+_4}> close_2 g_t_1_1 (select <{_v+_4}>::<{StdOverloaded.+;}> 0 i_1 (select _vone_3::<{StdOverloaded.one;}> 0))) ) (_ -> _predefined._Nil)
<{ExtListBox.c;281;63_132}> !_vone_0 !<{_v+_1}> close_2 !g_l_3 i_4::I = <{ExtListBox.g_c1;281;54_163}> g_l_3 i_4 close_2 _vone_0 <{_v+_1}>
<{ExtListBox.g_c1;281;54_163}> !g_l_0 i_1::I close_2 _vone_3 <{_v+_4}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;281;63_132}> _vone_3 <{_v+_4}> close_2 g_t_1_1 (select <{_v+_4}>::<{StdOverloaded.+;}> 0 i_1 (select _vone_3::<{StdOverloaded.one;}> 0)))) (False -> <{ExtListBox.c;281;63_132}> _vone_3 <{_v+_4}> close_2 g_t_1_1 (select <{_v+_4}>::<{StdOverloaded.+;}> 0 i_1 (select _vone_3::<{StdOverloaded.one;}> 0))) ) (_ -> _predefined._Nil)
ExtListBox.setBetween_131::I !low_0::I up_1::I !x_2::I = case (<{StdInt.<_17}> x_2 low_0) (True -> low_0) (False -> case (<{StdInt.<_17}> x_2 up_1) (True -> x_2) (False -> up_1) ) 
ExtListBox.anon_130::B !okBehind_0::I !index_1::I = StdBool.not (<{StdInt.<_17}> okBehind_0 index_1)
<{ExtListBox.c;283;67_137}> !<{_v+_0}> close_1 !g_l_2 i_3::I = <{ExtListBox.g_c1;283;54_164}> g_l_2 i_3 close_1 <{_v+_0}>
<{ExtListBox.g_c1;283;54_164}> !g_l_0 i_1::I close_2 <{_v+_3}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;283;67_137}> <{_v+_3}> close_2 g_t_1_1 (select <{_v+_3}>::<{StdOverloaded.+;}> 0 i_1 StdInt.one_11))) (False -> <{ExtListBox.c;283;67_137}> <{_v+_3}> close_2 g_t_1_1 (select <{_v+_3}>::<{StdOverloaded.+;}> 0 i_1 StdInt.one_11)) ) (_ -> _predefined._Nil)
<{ExtListBox.c;282;62_136}> !<{_v+_0}> close_1 !g_l_2 i_3::I = <{ExtListBox.g_c1;282;54_165}> g_l_2 i_3 close_1 <{_v+_0}>
<{ExtListBox.g_c1;282;54_165}> !g_l_0 i_1::I close_2 <{_v+_3}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;282;62_136}> <{_v+_3}> close_2 g_t_1_1 (select <{_v+_3}>::<{StdOverloaded.+;}> 0 i_1 StdInt.one_11))) (False -> <{ExtListBox.c;282;62_136}> <{_v+_3}> close_2 g_t_1_1 (select <{_v+_3}>::<{StdOverloaded.+;}> 0 i_1 StdInt.one_11)) ) (_ -> _predefined._Nil)
<{ExtListBox.c;281;63_135}> !<{_v+_0}> close_1 !g_l_2 i_3::I = <{ExtListBox.g_c1;281;54_166}> g_l_2 i_3 close_1 <{_v+_0}>
<{ExtListBox.g_c1;281;54_166}> !g_l_0 i_1::I close_2 <{_v+_3}> = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;281;63_135}> <{_v+_3}> close_2 g_t_1_1 (select <{_v+_3}>::<{StdOverloaded.+;}> 0 i_1 StdInt.one_11))) (False -> <{ExtListBox.c;281;63_135}> <{_v+_3}> close_2 g_t_1_1 (select <{_v+_3}>::<{StdOverloaded.+;}> 0 i_1 StdInt.one_11)) ) (_ -> _predefined._Nil)
<{ExtListBox.c;283;67_140}> close_0 !g_l_1 i_2::I = <{ExtListBox.g_c1;283;54_167}> g_l_1 i_2 close_0
<{ExtListBox.g_c1;283;54_167}> !g_l_0 i_1::I close_2 = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;283;67_140}> close_2 g_t_1_1 (<{StdInt.+_6}> i_1 StdInt.one_11))) (False -> <{ExtListBox.c;283;67_140}> close_2 g_t_1_1 (<{StdInt.+_6}> i_1 StdInt.one_11)) ) (_ -> _predefined._Nil)
<{ExtListBox.c;282;62_139}> close_0 !g_l_1 i_2::I = <{ExtListBox.g_c1;282;54_168}> g_l_1 i_2 close_0
<{ExtListBox.g_c1;282;54_168}> !g_l_0 i_1::I close_2 = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;282;62_139}> close_2 g_t_1_1 (<{StdInt.+_6}> i_1 StdInt.one_11))) (False -> <{ExtListBox.c;282;62_139}> close_2 g_t_1_1 (<{StdInt.+_6}> i_1 StdInt.one_11)) ) (_ -> _predefined._Nil)
<{ExtListBox.c;281;63_138}> close_0 !g_l_1 i_2::I = <{ExtListBox.g_c1;281;54_169}> g_l_1 i_2 close_0
<{ExtListBox.g_c1;281;54_169}> !g_l_0 i_1::I close_2 = case g_l_0 (_predefined._Cons item_1_0 g_t_1_1 -> case (StdBool.not (StdList.isMember_51 i_1 close_2)) (True -> _predefined._Cons item_1_0 (<{ExtListBox.c;281;63_138}> close_2 g_t_1_1 (<{StdInt.+_6}> i_1 StdInt.one_11))) (False -> <{ExtListBox.c;281;63_138}> close_2 g_t_1_1 (<{StdInt.+_6}> i_1 StdInt.one_11)) ) (_ -> _predefined._Nil)
ExtListBox.receiver_68 !_x_0 !_x_1 = case _x_0 (ExtListBox.InGetSelection -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> _Tuple2 (ExtListBox.OutGetSelection (StdList.map (ExtListBox.anon_59 items_4_0) selection_4_3)) (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) ) ) ) (ExtListBox.InSetSelection newSelection_1_0 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let _x_5_0 = ExtListBox.applySelfun (update listboxState_3_0::ExtListBox._ExtListBoxState [3:newSelection_1_0]) ps_2_1, _x_5_1 = ExtListBox.customlook (select _x_5_0::_Tuple2 0) in _Tuple2 ExtListBox.OutSetSelection (_Tuple2 (_Tuple2 (select _x_5_1::_Tuple2 1) ls_3_1) (StdPSt.appPIO (ExtListBox.setListBoxLook listbox_4_4 True (_Tuple2 True (select _x_5_1::_Tuple2 0))) (ExtListBox.scrolltoselection listbox_4_4 lineHeight_4_5 tMargin_4_8 bMargin_4_10 newSelection_1_0 (select _x_5_0::_Tuple2 1))))) ) ) ) (ExtListBox.InSetSelectAll -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let newSelection_5_0 = _SystemEnum._from_to_6 1 (StdList.length_47 items_4_0), _x_5_1 = ExtListBox.applySelfun (update listboxState_3_0::ExtListBox._ExtListBoxState [3:newSelection_5_0]) ps_2_1, _x_5_2 = ExtListBox.customlook (select _x_5_1::_Tuple2 0) in _Tuple2 ExtListBox.OutSetSelection (_Tuple2 (_Tuple2 (select _x_5_2::_Tuple2 1) ls_3_1) (StdPSt.appPIO (ExtListBox.setListBoxLook listbox_4_4 True (_Tuple2 True (select _x_5_2::_Tuple2 0))) (ExtListBox.scrolltoselection listbox_4_4 lineHeight_4_5 tMargin_4_8 bMargin_4_10 newSelection_5_0 (select _x_5_1::_Tuple2 1))))) ) ) ) (ExtListBox.InGetItems -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> _Tuple2 (ExtListBox.OutGetItems items_4_0) (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) ) ) ) (ExtListBox.InExecItem index_1_0 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> case (<{StdInt.<_17}> (StdList.length_47 funs_4_1) index_1_0) (True -> _Tuple2 ExtListBox.OutExecItem (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) (False -> _Tuple2 ExtListBox.OutExecItem (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) (<{StdList.!!}> funs_4_1 (<{StdInt.-_7}> index_1_0 1) ps_2_1))) ) ) ) ) (ExtListBox.InOpenItems behind_1_0 new_1_1 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let nrNew_5_0::I = StdList.length_47 new_1_1 in case (<{StdInt.==_16}> nrNew_5_0 0) (True -> _Tuple2 ExtListBox.OutOpenItems (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) (False -> let okBehind_7_0 = ExtListBox.setBetween_131 0 (<{StdInt.+_6}> (StdList.length_47 items_4_0) StdInt.one_11) behind_1_0, _x_7_1 = StdList.span (ExtListBox.anon_130 okBehind_7_0) (StdOrdList.sort_9 selection_4_3), _x_7_2 = ExtListBox.calcControlDomain (update listboxState_3_0::ExtListBox._ExtListBoxState [0:<{ExtListBox._if;227;39_170}> (<{StdInt.==_16}> okBehind_7_0 0) okNew_7_7 items_4_0 okBehind_7_0,1:<{ExtListBox._if;230;39_171}> (<{StdInt.==_16}> okBehind_7_0 0) <{okNewFuns`_7_8}> funs_4_1 okBehind_7_0,2:<{ExtListBox._if;233;43_172}> (<{StdInt.==_16}> okBehind_7_0 0) <{okNewShiftFuns`_7_9}> shiftfuns_4_2 okBehind_7_0,3:<{StdList.++}> (select _x_7_1::_Tuple2 0) (StdList.map (<{StdInt.+_6}> nrNew_5_0) (select _x_7_1::_Tuple2 1))]) ps_2_1, _x_7_3 = ExtListBox.customlook (select _x_7_2::_Tuple3 0), custom_7_4 = select (select listboxState_3_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0, okNew_7_5 = <{StdList.%_48}> new_1_1 (_Tuple2 0 (<{StdInt.-_7}> nrNew_5_0 1)), _x_7_6 = commondef.unzip3 okNew_7_5, okNew_7_7 = select _x_7_6::_Tuple3 0, <{okNewFuns`_7_8}> = select _x_7_6::_Tuple3 1, <{okNewShiftFuns`_7_9}>::I = select _x_7_6::_Tuple3 2 in _Tuple2 ExtListBox.OutOpenItems (_Tuple2 (_Tuple2 (select _x_7_3::_Tuple2 1) ls_3_1) (StdPSt.appPIO (StdFunc.seq (_predefined._Cons (StdControl.setControlViewDomain custom_7_4 (select _x_7_2::_Tuple3 1)) (_predefined._Cons (StdControl.setControlLooks (_predefined._Cons (_Tuple3 custom_7_4 True (_Tuple2 True (select _x_7_3::_Tuple2 0))) _predefined._Nil)) _predefined._Nil))) (select _x_7_2::_Tuple3 2)))) ) ) ) ) (ExtListBox.InAppendItems new_1_0 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let nrNew_5_0::I = StdList.length_47 new_1_0 in case (<{StdInt.==_16}> nrNew_5_0 0) (True -> _Tuple2 ExtListBox.OutOpenItems (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) (False -> let _x_7_0 = commondef.unzip3 (<{StdList.%_48}> new_1_0 (_Tuple2 0 (<{StdInt.-_7}> nrNew_5_0 1))), _x_7_1 = ExtListBox.calcControlDomain (update listboxState_3_0::ExtListBox._ExtListBoxState [0:<{StdList.++}> items_4_0 (select _x_7_0::_Tuple3 0),1:<{StdList.++}> funs_4_1 (select _x_7_0::_Tuple3 1),2:<{StdList.++}> shiftfuns_4_2 (select _x_7_0::_Tuple3 2),3:selection_4_3]) ps_2_1, _x_7_2 = ExtListBox.customlook (select _x_7_1::_Tuple3 0), custom_7_3 = select (select listboxState_3_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0 in _Tuple2 ExtListBox.OutAppendItems (_Tuple2 (_Tuple2 (select _x_7_2::_Tuple2 1) ls_3_1) (StdPSt.appPIO (StdFunc.seq (_predefined._Cons (StdControl.setControlLooks (_predefined._Cons (_Tuple3 custom_7_3 False (_Tuple2 True (select _x_7_2::_Tuple2 0))) _predefined._Nil)) (_predefined._Cons (StdControl.setControlViewDomain custom_7_3 (select _x_7_1::_Tuple3 1)) _predefined._Nil))) (select _x_7_1::_Tuple3 2)))) ) ) ) ) (ExtListBox.InCloseItems close_1_0 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> case (<{StdInt.==_16}> (StdList.length_47 close_1_0) 0) (True -> _Tuple2 ExtListBox.OutCloseItems (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) (False -> let _x_6_0 = ExtListBox.calcControlDomain (update listboxState_3_0::ExtListBox._ExtListBoxState [0:<{ExtListBox.c;281;63_138}> close_1_0 items_4_0 1,1:<{ExtListBox.c;282;62_139}> close_1_0 funs_4_1 1,2:<{ExtListBox.c;283;67_140}> close_1_0 shiftfuns_4_2 1,3:StdList.removeMembers_60 selection_4_3 close_1_0]) ps_2_1, _x_6_1 = ExtListBox.customlook (select _x_6_0::_Tuple3 0), custom_6_2 = select (select listboxState_3_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0 in _Tuple2 ExtListBox.OutCloseItems (_Tuple2 (_Tuple2 (select _x_6_1::_Tuple2 1) ls_3_1) (StdPSt.appPIO (StdFunc.seq (_predefined._Cons (StdControl.setControlViewDomain custom_6_2 (select _x_6_0::_Tuple3 1)) (_predefined._Cons (StdControl.setControlLooks (_predefined._Cons (_Tuple3 custom_6_2 True (_Tuple2 True (select _x_6_1::_Tuple2 0))) _predefined._Nil)) _predefined._Nil))) (select _x_6_0::_Tuple3 2)))) ) ) ) ) (ExtListBox.InCloseAllItems -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let _x_5_0 = ExtListBox.calcControlDomain (update listboxState_3_0::ExtListBox._ExtListBoxState [0:_predefined._Nil,1:_predefined._Nil,2:_predefined._Nil,3:_predefined._Nil]) ps_2_1, _x_5_1 = ExtListBox.customlook (select _x_5_0::_Tuple3 0) in _Tuple2 ExtListBox.OutCloseAllItems (_Tuple2 (_Tuple2 (select _x_5_1::_Tuple2 1) ls_3_1) (StdPSt.appPIO (StdFunc.seq (_predefined._Cons (StdControl.setControlViewDomain (select listbox_4_4::ExtListBox._ExtListBoxId 0) (select _x_5_0::_Tuple3 1)) (_predefined._Cons (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select listbox_4_4::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_5_1::_Tuple2 0))) _predefined._Nil)) _predefined._Nil))) (select _x_5_0::_Tuple3 2)))) ) ) ) (ExtListBox.InSetPen newpen_1_0 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let pen_5_0 = ExtListBox.removeDupAtt (<{StdList.++}> newpen_1_0 pen_4_11), _x_5_1 = ioutil.accScreenPicture_21 (ExtListBox.liheights_64 pen_5_0) ps_2_1, _x_5_2::I = select _x_5_1::_Tuple2 0, lineHeight_5_3 = select _x_5_2::_Tuple2 0, _x_5_4 = ExtListBox.calcControlDomain (update listboxState_3_0::ExtListBox._ExtListBoxState [5:lineHeight_5_3,6:select _x_5_2::_Tuple2 1,11:pen_5_0]) (select _x_5_1::_Tuple2 1), _x_5_5 = ExtListBox.customlook (select _x_5_4::_Tuple3 0) in _Tuple2 ExtListBox.OutSetPen (_Tuple2 (_Tuple2 (select _x_5_5::_Tuple2 1) ls_3_1) (StdPSt.appPIO (StdFunc.seq (_predefined._Cons (StdControl.setControlViewDomain (select listbox_4_4::ExtListBox._ExtListBoxId 0) (select _x_5_4::_Tuple3 1)) (_predefined._Cons (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select listbox_4_4::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_5_5::_Tuple2 0))) _predefined._Nil)) (_predefined._Cons (StdControl.setControlScrollFunction (select listbox_4_4::ExtListBox._ExtListBoxId 0) StdIOCommon.Vertical (ioutil.altScrollFunction StdIOCommon.Vertical lineHeight_5_3)) _predefined._Nil)))) (select _x_5_4::_Tuple3 2)))) ) ) ) (ExtListBox.InGetPen -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> _Tuple2 (ExtListBox.OutGetPen pen_4_11) (_Tuple2 (_Tuple2 listboxState_3_0 ls_3_1) ps_2_1)) ) ) ) (ExtListBox.InTwiddleItems idx1_1_0 idx2_1_1 -> case _x_1 (_Tuple2 _x_2_0 ps_2_1 -> case _x_2_0 (_Tuple2 listboxState_3_0 ls_3_1 -> case listboxState_3_0 (ExtListBox._ExtListBoxState items_4_0 funs_4_1 shiftfuns_4_2 selection_4_3 listbox_4_4 lineHeight_4_5 initHeight_4_6 lMargin_4_7 tMargin_4_8 rMargin_4_9 bMargin_4_10 pen_4_11 newselfun_4_12 -> let _x_5_0 = ExtListBox.customlook (update listboxState_3_0::ExtListBox._ExtListBoxState [0:ExtListBox.twiddle idx1_1_0 idx2_1_1 items_4_0]) in _Tuple2 ExtListBox.OutTwiddleItems (_Tuple2 (_Tuple2 (select _x_5_0::_Tuple2 1) ls_3_1) (StdPSt.appPIO (StdControl.setControlLooks (_predefined._Cons (_Tuple3 (select (select listboxState_3_0::ExtListBox._ExtListBoxState 4)::ExtListBox._ExtListBoxId 0) True (_Tuple2 True (select _x_5_0::_Tuple2 0))) _predefined._Nil)) ps_2_1))) ) ) ) 
<{ExtListBox._if;233;43_172}> !_x_0::B <{okNewShiftFuns`_1}> shiftfuns_2 okBehind_3::I = case _x_0 (True -> <{StdList.++}> <{okNewShiftFuns`_1}> shiftfuns_2) (_ -> let _x_1_0 = StdList.splitAt (<{StdInt.-_7}> okBehind_3 1) shiftfuns_2 in <{StdList.++}> (select _x_1_0::_Tuple2 0) (<{StdList.++}> <{okNewShiftFuns`_1}> (select _x_1_0::_Tuple2 1)))
<{ExtListBox._if;230;39_171}> !_x_0::B <{okNewFuns`_1}> funs_2 okBehind_3::I = case _x_0 (True -> <{StdList.++}> <{okNewFuns`_1}> funs_2) (_ -> let _x_1_0 = StdList.splitAt (<{StdInt.-_7}> okBehind_3 1) funs_2 in <{StdList.++}> (select _x_1_0::_Tuple2 0) (<{StdList.++}> <{okNewFuns`_1}> (select _x_1_0::_Tuple2 1)))
<{ExtListBox._if;227;39_170}> !_x_0::B okNew_1 items_2 okBehind_3::I = case _x_0 (True -> <{StdList.++}> okNew_1 items_2) (_ -> let _x_1_0 = StdList.splitAt (<{StdInt.-_7}> okBehind_3 1) items_2 in <{StdList.++}> (select _x_1_0::_Tuple2 0) (<{StdList.++}> okNew_1 (select _x_1_0::_Tuple2 1)))
ExtListBox.imp_65 listbox_0 lineHeight_1::I listboxState_2 domain_3 listboxAtts_4 = let _x_1_0 = ExtListBox.customlook listboxState_2 in StdIOBasic._AddLS (select _x_1_0::_Tuple2 1) (<{StdIOBasic.:+:}> (StdControlDef.CompoundControl StdIOBasic.NilLS (<{StdList.++}> listboxAtts_4 (_predefined._Cons (StdControlDef.ControlId (select listbox_0::ExtListBox._ExtListBoxId 0)) (_predefined._Cons (StdControlDef.ControlItemSpace 0 0) (_predefined._Cons (StdControlDef.ControlHScroll (ioutil.altScrollFunction StdIOCommon.Horizontal 10)) (_predefined._Cons (StdControlDef.ControlVScroll (ioutil.altScrollFunction StdIOCommon.Vertical lineHeight_1)) (_predefined._Cons (StdControlDef.ControlViewDomain domain_3) (_predefined._Cons (StdControlDef.ControlLook True (select _x_1_0::_Tuple2 0)) (_predefined._Cons (StdControlDef.ControlMouse ExtListBox.mouseFilter StdIOCommon.Able ExtListBox.mouseFunction) (_predefined._Cons ExtListBox.elbKeyboard _predefined._Nil)))))))))) (StdReceiverDef.Receiver2 (select listbox_0::ExtListBox._ExtListBoxId 1) ExtListBox.receiver_68 _predefined._Nil))
ExtListBox.isListBoxControlAttribute_66::B !_x_0 = case _x_0 (StdControlDef.ControlFunction _x_1_0 -> True) (StdControlDef.ControlHide -> True) (StdControlDef.ControlPos _x_1_0 -> True) (StdControlDef.ControlPen _x_1_0 -> True) (StdControlDef.ControlSelectState _x_1_0 -> True) (StdControlDef.ControlViewSize _x_1_0 -> True) (StdControlDef.ControlOuterSize _x_1_0 -> True) (StdControlDef.ControlResize _x_1_0 -> True) (StdControlDef.ControlMouse _x_1_0 _x_1_1 _x_1_2 -> True) (StdControlDef.ControlKeyboard _x_1_0 _x_1_1 _x_1_2 -> True) (_ -> False)
ExtListBox.toLBCA_67 !_x_0 = case _x_0 (StdControlDef.ControlFunction f_1_0 -> StdControlDef.ControlFunction f_1_0) (StdControlDef.ControlHide -> StdControlDef.ControlHide) (StdControlDef.ControlPos p_1_0 -> StdControlDef.ControlPos p_1_0) (StdControlDef.ControlPen p_1_0 -> StdControlDef.ControlPen p_1_0) (StdControlDef.ControlSelectState p_1_0 -> StdControlDef.ControlSelectState p_1_0) (StdControlDef.ControlViewSize p_1_0 -> StdControlDef.ControlViewSize p_1_0) (StdControlDef.ControlOuterSize p_1_0 -> StdControlDef.ControlOuterSize p_1_0) (StdControlDef.ControlResize p_1_0 -> StdControlDef.ControlResize p_1_0) (StdControlDef.ControlMouse a_1_0 b_1_1 f_1_2 -> StdControlDef.ControlMouse a_1_0 b_1_1 f_1_2) (StdControlDef.ControlKeyboard a_1_0 b_1_1 f_1_2 -> ExtListBox.joinKeyboards ExtListBox.elbKeyboard (StdControlDef.ControlKeyboard a_1_0 b_1_1 f_1_2)) (_ -> StdMisc.abort "ExtListBox.icl: unsupported control attribute handed to toLBCA")
ExtListBox.controlToHandles_20 !_x_0 !ps_1 = case _x_0 (ExtListBox.ExtListBoxControl contents_1_0 selection_1_1 newselfun_1_2 listbox_1_3 attrs_1_4 -> let Controls_2_0 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_14 (<{StdControlClass.Controls;}> StdControlClass.controlToHandles_6 StdControlClass.getControlType_7)) (StdControlClass.getControlType_15 (<{StdControlClass.Controls;}> StdControlClass.controlToHandles_6 StdControlClass.getControlType_7)), Controls_2_1 = <{StdControlClass.Controls;}> StdControlReceiver.controlToHandles_2 StdControlReceiver.getControlType_3, penAtts_2_2 = StdList.flatten (StdList.map StdControlAttribute.getControlPenAtt (StdList.filter StdControlAttribute.isControlPen attrs_1_4)), _x_2_3 = ioutil.accScreenPicture_21 (ExtListBox.liheights_64 penAtts_2_2) ps_1, _x_2_4::I = select _x_2_3::_Tuple2 0, lineHeight_2_5 = select _x_2_4::_Tuple2 0, _x_2_6 = commondef.unzip3 contents_1_0, _x_2_7 = <{ExtListBox._c;130;29_174}> (StdList.map StdControlAttribute.getControlHMarginAtt (StdList.filter StdControlAttribute.isControlHMargin attrs_1_4)), _x_2_8 = <{ExtListBox._c;133;29_173}> (StdList.map StdControlAttribute.getControlVMarginAtt (StdList.filter StdControlAttribute.isControlVMargin attrs_1_4)), _x_2_9 = ExtListBox.calcControlDomain (ExtListBox._ExtListBoxState (select _x_2_6::_Tuple3 0) (select _x_2_6::_Tuple3 1) (select _x_2_6::_Tuple3 2) selection_1_1 listbox_1_3 lineHeight_2_5 (select _x_2_4::_Tuple2 1) (select _x_2_7::_Tuple2 0) (select _x_2_8::_Tuple2 0) (select _x_2_7::_Tuple2 1) (select _x_2_8::_Tuple2 1) penAtts_2_2 newselfun_1_2) (select _x_2_3::_Tuple2 1) in StdControlClass.controlToHandles_0 (<{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_0 Controls_2_1) (StdControlClass.getControlType_9 Controls_2_0 Controls_2_1)) (ExtListBox.imp_65 listbox_1_3 lineHeight_2_5 (select _x_2_9::_Tuple3 0) (select _x_2_9::_Tuple3 1) (StdList.map ExtListBox.toLBCA_67 (StdList.filter ExtListBox.isListBoxControlAttribute_66 attrs_1_4))) (select _x_2_9::_Tuple3 2)) 
<{ExtListBox._c;130;29_174}> !_x_0 = case _x_0 (_predefined._Nil -> _Tuple2 0 0) (_predefined._Cons _x_1_0 _x_1_1 -> case _x_1_0 (_Tuple2 l_2_0 r_2_1 -> _Tuple2 l_2_0 r_2_1) ) 
<{ExtListBox._c;133;29_173}> !_x_0 = case _x_0 (_predefined._Nil -> _Tuple2 0 0) (_predefined._Cons _x_1_0 _x_1_1 -> case _x_1_0 (_Tuple2 l_2_0 r_2_1 -> _Tuple2 l_2_0 r_2_1) ) 
ExtListBox.getControlType_21 _x_0 = "ExtListBoxControl"
<{ExtListBox.TD;ExtListBoxId}> _x_0::B = _predefined._Nil
<{ExtListBox.TD;MessageIn}> _x_0::B = _predefined._Nil
<{ExtListBox.TD;MessageOut}> _x_0::B = _predefined._Nil
<{ExtListBox.TD;ExtListBoxItem}> _x_0::B = _predefined._Nil
<{ExtListBox.TD;ExtListBoxControl}> _x_0::B = _predefined._Nil
<{ExtListBox.TD;ExtListBoxState}> _x_0::B = _predefined._Nil

:: ExtListBox.MessageIn = ExtListBox.InGetSelection | ExtListBox.InSetSelection a1 | ExtListBox.InSetSelectAll | ExtListBox.InGetItems | ExtListBox.InOpenItems a1 a2 | ExtListBox.InAppendItems a1 | ExtListBox.InCloseItems a1 | ExtListBox.InCloseAllItems | ExtListBox.InExecItem a1 | ExtListBox.InSetPen a1 | ExtListBox.InGetPen | ExtListBox.InTwiddleItems a1 a2
:: ExtListBox.MessageOut = ExtListBox.OutGetSelection a1 | ExtListBox.OutSetSelection | ExtListBox.OutGetItems a1 | ExtListBox.OutOpenItems | ExtListBox.OutAppendItems | ExtListBox.OutCloseItems | ExtListBox.OutCloseAllItems | ExtListBox.OutExecItem | ExtListBox.OutSetPen | ExtListBox.OutGetPen a1 | ExtListBox.OutTwiddleItems
:: ExtListBox.ExtListBoxControl = ExtListBox.ExtListBoxControl a1 a2 a3 a4 a5

|| Converted Records
:: ExtListBox._ExtListBoxId = {!ExtListBox.controlId, !ExtListBox.receiverId}

:: ExtListBox._ExtListBoxState = {!ExtListBox.items, !ExtListBox.funs, !ExtListBox.shiftfuns, !ExtListBox.selection, !ExtListBox.listboxId, !ExtListBox.lineHeight::I, !ExtListBox.initHeight::I, !ExtListBox.lMargin::I, !ExtListBox.tMargin::I, !ExtListBox.rMargin::I, !ExtListBox.bMargin::I, !ExtListBox.pen, !ExtListBox.newselfun}

:: <{ExtListBox.gEq_s;}> = {!ExtListBox.gEq_s}

:: <{ExtListBox.gEq_ss;}> = {!ExtListBox.gEq_ss}

:: <{ExtListBox.gEq_sss;}> = {!ExtListBox.gEq_sss}

:: <{ExtListBox.gEq_ssss;}> = {!ExtListBox.gEq_ssss}

:: <{ExtListBox.gEq_sssss;}> = {!ExtListBox.gEq_sssss}

:: <{ExtListBox.gEq_ssssss;}> = {!ExtListBox.gEq_ssssss}

:: <{ExtListBox.gEq_sssssss;}> = {!ExtListBox.gEq_sssssss}

:: <{ExtListBox.gEq_ssssssss;}> = {!ExtListBox.gEq_ssssssss}

:: <{ExtListBox.gEq_sssssssss;}> = {!ExtListBox.gEq_sssssssss}

:: <{ExtListBox.bimap_s;}> = {ExtListBox.bimap_s}

:: <{ExtListBox.bimap_ss;}> = {ExtListBox.bimap_ss}

:: <{ExtListBox.bimap_sss;}> = {ExtListBox.bimap_sss}

