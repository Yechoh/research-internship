|| ?module? search


search.initFindBoxInfo !_v_0 !_vaccScreenPicture_1 !prefs_2 !pstate_3 = let _x_1_0 = select _v_0::<{StdId.Ids;}> 0 pstate_3, _x_1_1 = select _v_0::<{StdId.Ids;}> 0 (select _x_1_0::_Tuple2 1), _x_1_2 = select _v_0::<{StdId.Ids;}> 0 (select _x_1_1::_Tuple2 1), _x_1_3 = select _v_0::<{StdId.Ids;}> 0 (select _x_1_2::_Tuple2 1), _x_1_4 = select _v_0::<{StdId.Ids;}> 0 (select _x_1_3::_Tuple2 1), _x_1_5 = select _v_0::<{StdId.Ids;}> 0 (select _x_1_4::_Tuple2 1), _x_1_6 = select _v_0::<{StdId.Ids;}> 0 (select _x_1_5::_Tuple2 1), _x_1_7 = select _v_0::<{StdId.Ids;}> 4 (select _x_1_6::_Tuple2 1), _x_1_8 = ExtListBox.openExtListBoxId _v_0 (select _x_1_7::_Tuple2 1), _x_1_9 = select _vaccScreenPicture_1::<{StdPSt.accScreenPicture;}> 0 (ioutil.safeOpenFixedFont (StdPictureDef._FontDef (select (select prefs_2::PmPrefs._Prefs 6)::PmPrefs._SrcPrefs 2) _predefined._Nil (select (select prefs_2::PmPrefs._Prefs 6)::PmPrefs._SrcPrefs 3))) (select _x_1_8::_Tuple2 1) in _Tuple2 (fbi._FindBoxInfo (select _x_1_0::_Tuple2 0) (select _x_1_1::_Tuple2 0) (select _x_1_2::_Tuple2 0) (select _x_1_3::_Tuple2 0) (select _x_1_4::_Tuple2 0) (select _x_1_5::_Tuple2 0) PmParse.Implementation fbi.SearchImports False _predefined._Nil True False (select _x_1_6::_Tuple2 0) (select _x_1_8::_Tuple2 0) (select (select prefs_2::PmPrefs._Prefs 6)::PmPrefs._SrcPrefs 0) (select _x_1_9::_Tuple2 0) (select (select prefs_2::PmPrefs._Prefs 6)::PmPrefs._SrcPrefs 4) (select (select prefs_2::PmPrefs._Prefs 6)::PmPrefs._SrcPrefs 5) (select (select prefs_2::PmPrefs._Prefs 6)::PmPrefs._SrcPrefs 1) "" (select _x_1_7::_Tuple2 0)) (select _x_1_9::_Tuple2 1)
search.savefun !_x_0 = case _x_0 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (fbi._FindBoxInfo dlog_2_0 intr_2_1 msg_2_2 find_2_3 close_2_4 string_2_5 kind_2_6 type_2_7 is_searching_2_8 cleanid_2_9 verb_2_10 export__2_11 wind_2_12 windlb_2_13 src_offset_2_14 src_font_2_15 src_forg_2_16 src_back_2_17 src_size_2_18 pathname_2_19 recv_2_20 -> let _x_3_0 = StdPSt.accPIO (StdControl.getWindow dlog_2_0) ps_1_1, wdef_3_1 = select _x_3_0::_Tuple2 0 in case (Data.Maybe.isNothing wdef_3_1) (True -> _Tuple2 ls_1_0 (select _x_3_0::_Tuple2 1)) (False -> let wdef_5_0 = Data.Maybe.fromJust wdef_3_1, _x_5_1 = StdControl.getControlTexts (_predefined._Cons string_2_5 _predefined._Nil) wdef_5_0, _x_5_2 = select _x_5_1::_Tuple2 0 in case (StdBool.not (select _x_5_2::_Tuple2 0)) (True -> _Tuple2 ls_1_0 (select _x_3_0::_Tuple2 1)) (False -> let ss_7_0 = select _x_5_2::_Tuple2 1 in case (Data.Maybe.isNothing ss_7_0) (True -> _Tuple2 ls_1_0 (select _x_3_0::_Tuple2 1)) (False -> let ls_9_0 = update ls_1_0::fbi._FindBoxInfo [9:StdList.removeDup (<{StdClass.Eq;}> (<{StdOverloaded.==;}> <{StdString.==_2}>)) (_predefined._Cons (Data.Maybe.fromJust ss_7_0) cleanid_2_9)] in _Tuple2 ls_9_0 (IdeState.setFBI ls_9_0 (select _x_3_0::_Tuple2 1))) ) ) ) ) 
search.closefun !_x_0 = case _x_0 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (fbi._FindBoxInfo dlog_2_0 intr_2_1 msg_2_2 find_2_3 close_2_4 string_2_5 kind_2_6 type_2_7 is_searching_2_8 cleanid_2_9 verb_2_10 export__2_11 wind_2_12 windlb_2_13 src_offset_2_14 src_font_2_15 src_forg_2_16 src_back_2_17 src_size_2_18 pathname_2_19 recv_2_20 -> let _x_3_0 = search.savefun (_Tuple2 ls_1_0 ps_1_1) in _Tuple2 (select _x_3_0::_Tuple2 0) (StdWindow.closeWindow dlog_2_0 (select _x_3_0::_Tuple2 1))) ) 
search.recvfun _x_0 !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (fbi._FindBoxInfo dlog_2_0 intr_2_1 msg_2_2 find_2_3 close_2_4 string_2_5 kind_2_6 type_2_7 is_searching_2_8 cleanid_2_9 verb_2_10 export__2_11 wind_2_12 windlb_2_13 src_offset_2_14 src_font_2_15 src_forg_2_16 src_back_2_17 src_size_2_18 pathname_2_19 recv_2_20 -> case is_searching_2_8 (True -> _Tuple2 (update ls_1_0::fbi._FindBoxInfo [8:False]) (StdPSt.appPIO (StdControl.setControlText find_2_3 "Find") ps_1_1)) (False -> _Tuple2 (update ls_1_0::fbi._FindBoxInfo [8:True]) (StdPSt.appPIO (StdControl.setControlText find_2_3 "Stop") ps_1_1)) ) ) 
search.sw_close !wind_0 !ps_1 = let _x_1_0 = IdeState.getMenuIds ps_1 in StdWindow.closeWindow wind_0 (StdPSt.appPIO (StdMenuElement.disableMenuElements (_predefined._Cons (<{StdList.!!}> (select (select (select _x_1_0::_Tuple2 0)::IdeState._MenuIds 15)::IdeState._SearchMenuIds 3) 0) _predefined._Nil)) (select _x_1_0::_Tuple2 1))
search.wind_deac !ps_0 = let _x_1_0 = IdeState.getFBI ps_0, inf_1_1 = select _x_1_0::_Tuple2 0, wind_1_2 = select inf_1_1::fbi._FindBoxInfo 12, ps_1_3 = select _x_1_0::_Tuple2 1, _x_1_4 = StdPSt.accPIO (StdWindow.getWindowPos wind_1_2) ps_1_3, pos_1_5 = select _x_1_4::_Tuple2 0 in case (Data.Maybe.isNothing pos_1_5) (True -> select _x_1_4::_Tuple2 1) (False -> let _x_3_0 = StdPSt.accPIO (StdWindow.getWindowViewSize wind_1_2) (select _x_1_4::_Tuple2 1), _x_3_1 = IdeState.getMenuIds (IdeState.setFBI (update inf_1_1::fbi._FindBoxInfo [14:Data.Maybe.fromJust pos_1_5,18:select _x_3_0::_Tuple2 0]) (select _x_3_0::_Tuple2 1)), ps_3_2 = select _x_3_1::_Tuple2 1, _x_3_3 = select _x_3_1::_Tuple2 0, search_3_4 = select _x_3_3::IdeState._MenuIds 15 in update ps_3_2::iostate._PSt [1:StdMenuElement.enableMenuElements (select search_3_4::IdeState._SearchMenuIds 2) (StdMenuElement.enableMenuElements (select search_3_4::IdeState._SearchMenuIds 1) (StdMenuElement.enableMenuElements (_predefined._Cons (select _x_3_3::IdeState._MenuIds 10) (_predefined._Cons (select _x_3_3::IdeState._MenuIds 11) (_predefined._Cons (select _x_3_3::IdeState._MenuIds 12) (_predefined._Cons (select _x_3_3::IdeState._MenuIds 13) (select _x_3_3::IdeState._MenuIds 14))))) (select ps_3_2::iostate._PSt 1)))]) 
search.sw_safe_close !ps_0 = let _x_1_0 = IdeState.getFBI ps_0, ps_1_1 = select _x_1_0::_Tuple2 1, _x_1_2 = StdPSt.accPIO StdWindow.getActiveWindow ps_1_1, win_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing win_1_3) (True -> search.sw_close (select (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo 12) (select _x_1_2::_Tuple2 1)) (False -> let _x_3_0 = select _x_1_0::_Tuple2 0, wind_3_1 = select _x_3_0::fbi._FindBoxInfo 12 in case (<{id.==_27}> (Data.Maybe.fromJust win_1_3) wind_3_1) (True -> search.sw_close wind_3_1 (search.wind_deac (select _x_1_2::_Tuple2 1))) (False -> search.sw_close wind_3_1 (select _x_1_2::_Tuple2 1)) ) 
search.get_paths_51 pstate_0 = let _x_1_0 = IdeState.getCurrentPaths pstate_0, _x_1_1 = IdeState.getFromProject PmProject.PR_GetPaths (select _x_1_0::_Tuple2 1) in _Tuple2 (UtilStrictLists.AppendLists (select _x_1_1::_Tuple2 0) (select _x_1_0::_Tuple2 0)) (select _x_1_1::_Tuple2 1)
search.ResetButtonString !pst_0 = let _x_1_0 = IdeState.getFBI pst_0 in select (StdReceiver.asyncSend (select (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo 20) True (select _x_1_0::_Tuple2 1))::_Tuple2 1
search.ChangeMsgString !verbose_0::B !message_1 !pstate_2 = case verbose_0 (True -> let _x_2_0 = IdeState.getFBI pstate_2 in StdPSt.appPIO (StdControl.setControlTexts (_predefined._Cons (_Tuple2 (select (select _x_2_0::_Tuple2 0)::fbi._FindBoxInfo 2) message_1) _predefined._Nil)) (select _x_2_0::_Tuple2 1)) (False -> pstate_2) 
search.add_suffix !is_dcl_file_0::B !modname_1 = case is_dcl_file_0 (True -> PmPath.MakeDefPathname modname_1) (False -> PmPath.MakeImpPathname modname_1) 
search.doall_68 modname_0 !_x_1 !ps_2 = case _x_1 (_predefined._Nil -> <{_Tuple2!3}> Data.Maybe.Nothing ps_2) (_predefined._Cons win_1_0 res_1_1 -> let _x_2_0 = EdClient.message (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) win_1_0 EdClient.msgGetPathName ps_2, mr_2_1 = select _x_2_0::_Tuple2 0 in case (Data.Maybe.isNothing mr_2_1) (True -> search.doall_68 modname_0 res_1_1 (select _x_2_0::_Tuple2 1)) (False -> case (<{StdString.==_2}> modname_0 (Data.Maybe.fromJust mr_2_1)) (True -> <{_Tuple2!3}> (Data.Maybe.Just win_1_0) (select _x_2_0::_Tuple2 1)) (False -> search.doall_68 modname_0 res_1_1 (select _x_2_0::_Tuple2 1)) ) ) 
search.IsOpen modname_0 !ps_1 = let _x_1_0 = StdPSt.accPIO StdWindow.getWindowsStack ps_1 in search.doall_68 modname_0 (select _x_1_0::_Tuple2 0) (select _x_1_0::_Tuple2 1)
<{search.cu;499;33_60}> !_vone_0 !<{_v+_1}> c_l_i_2 !g_l_3 = <{search.g_c1;499;38_160}> g_l_3 _vone_0 <{_v+_1}> c_l_i_2
<{search.g_c1;499;38_160}> !g_l_0 _vone_1 <{_v+_2}> c_l_i_3 = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;499;33_60}> _vone_1 <{_v+_2}> (select <{_v+_2}>::<{StdOverloaded.+;}> 0 c_l_i_3 (select _vone_1::<{StdOverloaded.one;}> 0)) g_t_1_1) (_ -> c_l_i_3)
<{search.cu;499;33_59}> !_vArray_0 c_a_1 c_i_2::I !g_l_3 = <{search.g_c1;499;38_161}> g_l_3 _vArray_0 c_a_1 c_i_2
<{search.g_c1;499;38_161}> !g_l_0 _vArray_1 c_a_2 c_i_3::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;499;33_59}> _vArray_1 (select _vArray_1::<{_SystemArray.Array;}> 5 c_a_2 c_i_3 t_1_0) (<{StdInt.+_6}> c_i_3 StdInt.one_11) g_t_1_1) (_ -> c_a_2)
<{search.cu;499;33_146}>::I !<{_v+_0}> c_l_i_1::I !g_l_2 = <{search.g_c1;499;38_162}> g_l_2 <{_v+_0}> c_l_i_1
<{search.g_c1;499;38_162}>::I !g_l_0 <{_v+_1}> c_l_i_2::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;499;33_146}> <{_v+_1}> (select <{_v+_1}>::<{StdOverloaded.+;}> 0 c_l_i_2 StdInt.one_11) g_t_1_1) (_ -> c_l_i_2)
<{search.cu;499;33_147}> !c_a_0 c_i_1::I !g_l_2 = <{search.g_c1;499;38_163}> g_l_2 c_a_0 c_i_1
<{search.g_c1;499;38_163}> !g_l_0 !c_a_1 c_i_2::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;499;33_147}> (_SystemArray.update_77 c_a_1 c_i_2 t_1_0) (<{StdInt.+_6}> c_i_2 StdInt.one_11) g_t_1_1) (_ -> c_a_1)
<{search.cu;499;33_148}>::I !c_l_i_0::I !g_l_1 = <{search.g_c1;499;38_164}> g_l_1 c_l_i_0
<{search.g_c1;499;38_164}>::I !g_l_0 !c_l_i_1::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;499;33_148}> (<{StdInt.+_6}> c_l_i_1 StdInt.one_11) g_t_1_1) (_ -> c_l_i_1)
search.search_identifiers_in_file_63 !path_0 !imp_1::B !rest_2 !cleanid_3 !pstate_4 = let _x_1_0 = search.IsOpen path_0 pstate_4, win_1_1 = select _x_1_0::_Tuple2 0 in case (Data.Maybe.isJust win_1_1) (True -> let pstate_3_0 = select _x_1_0::_Tuple2 1, _x_3_1 = EdClient.message (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) (Data.Maybe.fromJust win_1_1) EdClient.msgGetText pstate_3_0, pstate_3_2 = select _x_3_1::_Tuple2 1 in <{search._c;493;15_165}> (select _x_3_1::_Tuple2 0) imp_1 rest_2 cleanid_3 path_0 pstate_3_2) (False -> StdPStClass.accFiles_8 (PmParse.FindIdentifiersInFile imp_1 rest_2 cleanid_3 path_0) (select _x_1_0::_Tuple2 1)) 
<{search._c;493;15_165}> !_x_0 !imp_1::B !rest_2 !cleanid_3 path_4 !pstate_5 = case _x_0 (Data.Maybe.Nothing -> StdPStClass.accFiles_8 (PmParse.FindIdentifiersInFile imp_1 rest_2 cleanid_3 path_4) pstate_5) (Data.Maybe.Just text_1_0 -> let text_2_0 = StrictList.slToList (EdLineText.textToStrings text_1_0) in StdPStClass.accFiles_8 (PmParse.FindIdentifiersInText imp_1 rest_2 cleanid_3 (<{search.cu;499;33_147}> (_SystemArray._createArray_72 (<{search.cu;499;33_148}> 0 text_2_0)) 0 text_2_0)) pstate_5) 
search.is_3_char_file_ext_64::B !_x_0 = case _x_0 (".icl" -> True) (".dcl" -> True) (".lhs" -> True) (_ -> False)
search.is_2_char_file_ext_65::B !_x_0 = case _x_0 (".hs" -> True) (_ -> False)
search.n_chars_of_file_ext_66::I !s_0 = let n_1_0::I = _SystemArray.size_20 s_0 in case (case (<{StdInt.<_17}> 3 n_1_0) (True -> search.is_3_char_file_ext_64 (<{StdString.%_10}> s_0 (_Tuple2 (<{StdInt.-_7}> n_1_0 4) (<{StdInt.-_7}> n_1_0 1)))) (False -> False) ) (True -> 4) (False -> case (case (<{StdInt.<_17}> 2 n_1_0) (True -> search.is_2_char_file_ext_65 (<{StdString.%_10}> s_0 (_Tuple2 (<{StdInt.-_7}> n_1_0 3) (<{StdInt.-_7}> n_1_0 1)))) (False -> False) ) (True -> 3) (False -> 0) ) 
search.split_string_67 !i_0::I !s_1 = let n_1_0::I = _SystemArray.size_20 s_1, i_1_1::I = <{StdInt.-_7}> n_1_0 i_0 in <{_Tuple2!3}> (<{StdString.%_10}> s_1 (_Tuple2 0 (<{StdInt.-_7}> i_1_1 1))) (<{StdString.%_10}> s_1 (_Tuple2 i_1_1 (<{StdInt.-_7}> n_1_0 1)))
search.search_disk !module_name_0 !paths_1 !files_2 = let n_1_0::I = search.n_chars_of_file_ext_66 module_name_0 in case (<{StdInt.==_16}> n_1_0 0) (True -> PmDirCache.SearchDisk module_name_0 paths_1 files_2) (False -> let _x_3_0 = search.split_string_67 n_1_0 module_name_0 in PmDirCache.FindHModule (select _x_3_0::_Tuple2 0) (select _x_3_0::_Tuple2 1) paths_1 files_2) 
search.SearchIdentifiersInFile_62 !imp_0::B !rest_1 !cleanid_2 !modname_3 !paths_4 !pstate_5 = case (StdPathname.IsFullPathname modname_3) (True -> let _x_2_0 = search.search_identifiers_in_file_63 modname_3 imp_0 rest_1 cleanid_2 pstate_5, _x_2_1 = select _x_2_0::_Tuple2 0 in <{_Tuple4!13}> (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1) modname_3 (select _x_2_0::_Tuple2 1)) (False -> let _x_2_0 = StdPStClass.accFiles_8 (search.search_disk modname_3 paths_4) pstate_5, _x_2_1 = select _x_2_0::_Tuple2 0 in case (select _x_2_1::_Tuple2 0) (True -> let _x_4_0 = search.search_identifiers_in_file_63 (select _x_2_1::_Tuple2 1) imp_0 rest_1 cleanid_2 (select _x_2_0::_Tuple2 1), _x_4_1 = select _x_4_0::_Tuple2 0 in <{_Tuple4!13}> (select _x_4_1::_Tuple2 0) (select _x_4_1::_Tuple2 1) modname_3 (select _x_4_0::_Tuple2 1)) (False -> <{_Tuple4!13}> rest_1 PmParse.PosNil modname_3 (select _x_2_0::_Tuple2 1)) ) 
search.make_implementation_file_name_73 !mod_0 = let file_name_1_0 = StdPathname.RemovePath mod_0 in case (PmPath.IsImpPathname file_name_1_0) (True -> file_name_1_0) (False -> PmPath.MakeImpPathname file_name_1_0) 
search.MakeFoundPosMsg_69 !_vtoString_0 !_x_1 mod_2 linenr_3 id_4 = case _x_1 (PmParse.Definition -> let path_2_0 = PmPath.MakeDefPathname (StdPathname.RemovePath mod_2) in _Tuple3 (<{StdString.+++_11}> "Definition found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) (PmParse.Implementation -> let path_2_0 = search.make_implementation_file_name_73 mod_2 in _Tuple3 (<{StdString.+++_11}> "Implementation found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) (PmParse.Identifier -> let path_2_0 = StdPathname.RemovePath mod_2 in _Tuple3 (<{StdString.+++_11}> "Identifier found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) 
search.MakeFoundInsMsg_70 !_vtoString_0 !_x_1 mod_2 linenr_3 id_4 = case _x_1 (PmParse.Definition -> let path_2_0 = PmPath.MakeDefPathname (StdPathname.RemovePath mod_2) in _Tuple3 (<{StdString.+++_11}> "Instance Definition found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) (PmParse.Implementation -> let path_2_0 = search.make_implementation_file_name_73 mod_2 in _Tuple3 (<{StdString.+++_11}> "Instance Implementation found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) (PmParse.Identifier -> let path_2_0 = StdPathname.RemovePath mod_2 in _Tuple3 (<{StdString.+++_11}> "Identifier found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) 
search.MakeFoundClsMsg_71 !_vtoString_0 !_x_1 mod_2 linenr_3 id_4 = case _x_1 (PmParse.Definition -> let path_2_0 = PmPath.MakeDefPathname (StdPathname.RemovePath mod_2) in _Tuple3 (<{StdString.+++_11}> "Class Definition found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) (PmParse.Implementation -> let path_2_0 = search.make_implementation_file_name_73 mod_2 in _Tuple3 (<{StdString.+++_11}> "Class Implementation found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) (PmParse.Identifier -> let path_2_0 = StdPathname.RemovePath mod_2 in _Tuple3 (<{StdString.+++_11}> "Identifier found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (select _vtoString_0::<{StdOverloaded.toString;}> 0 linenr_3) (<{StdString.+++_11}> "]: " id_4))))) path_2_0 linenr_3) 
search.MakeFoundClsMsg_151 !_x_0 mod_1 linenr_2::I id_3 = case _x_0 (PmParse.Definition -> let path_2_0 = PmPath.MakeDefPathname (StdPathname.RemovePath mod_1) in _Tuple3 (<{StdString.+++_11}> "Class Definition found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) (PmParse.Implementation -> let path_2_0 = search.make_implementation_file_name_73 mod_1 in _Tuple3 (<{StdString.+++_11}> "Class Implementation found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) (PmParse.Identifier -> let path_2_0 = StdPathname.RemovePath mod_1 in _Tuple3 (<{StdString.+++_11}> "Identifier found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) 
search.MakeFoundInsMsg_150 !_x_0 mod_1 linenr_2::I id_3 = case _x_0 (PmParse.Definition -> let path_2_0 = PmPath.MakeDefPathname (StdPathname.RemovePath mod_1) in _Tuple3 (<{StdString.+++_11}> "Instance Definition found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) (PmParse.Implementation -> let path_2_0 = search.make_implementation_file_name_73 mod_1 in _Tuple3 (<{StdString.+++_11}> "Instance Implementation found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) (PmParse.Identifier -> let path_2_0 = StdPathname.RemovePath mod_1 in _Tuple3 (<{StdString.+++_11}> "Identifier found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) 
search.MakeFoundPosMsg_149 !_x_0 mod_1 linenr_2::I id_3 = case _x_0 (PmParse.Definition -> let path_2_0 = PmPath.MakeDefPathname (StdPathname.RemovePath mod_1) in _Tuple3 (<{StdString.+++_11}> "Definition found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) (PmParse.Implementation -> let path_2_0 = search.make_implementation_file_name_73 mod_1 in _Tuple3 (<{StdString.+++_11}> "Implementation found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) (PmParse.Identifier -> let path_2_0 = StdPathname.RemovePath mod_1 in _Tuple3 (<{StdString.+++_11}> "Identifier found in [" (<{StdString.+++_11}> path_2_0 (<{StdString.+++_11}> "," (<{StdString.+++_11}> (StdString.toString_5 linenr_2) (<{StdString.+++_11}> "]: " id_3))))) path_2_0 linenr_2) 
search.WriteFoundPositionsInSearchWindow_72 info_0 search_kind_1 modname_2 !_x_3 id_4 = case _x_3 (PmParse.PosNil -> <{_predefined._!Nil!}>) (PmParse.Pos line_n_1_0 _x_1_1 positions_1_2 -> <{_predefined._!Cons!}> (search.MakeFoundPosMsg_149 search_kind_1 modname_2 (<{StdInt.+_6}> line_n_1_0 StdInt.one_11) id_4) (search.WriteFoundPositionsInSearchWindow_72 info_0 search_kind_1 modname_2 positions_1_2 id_4)) (PmParse.Ins line_n_1_0 _x_1_1 positions_1_2 -> <{_predefined._!Cons!}> (search.MakeFoundInsMsg_150 search_kind_1 modname_2 (<{StdInt.+_6}> line_n_1_0 StdInt.one_11) id_4) (search.WriteFoundPositionsInSearchWindow_72 info_0 search_kind_1 modname_2 positions_1_2 id_4)) (PmParse.Cls line_n_1_0 _x_1_1 positions_1_2 -> <{_predefined._!Cons!}> (search.MakeFoundClsMsg_151 search_kind_1 modname_2 (<{StdInt.+_6}> line_n_1_0 StdInt.one_11) id_4) (search.WriteFoundPositionsInSearchWindow_72 info_0 search_kind_1 modname_2 positions_1_2 id_4)) 
search.win_resize_77 !oc_0 !ow_1 !nw_2 = StdIOBasic._Size (<{StdInt.-_7}> (<{StdInt.+_6}> (select oc_0::StdIOBasic._Size 0) (select nw_2::StdIOBasic._Size 0)) (select ow_1::StdIOBasic._Size 0)) (<{StdInt.-_7}> (<{StdInt.+_6}> (select oc_0::StdIOBasic._Size 1) (select nw_2::StdIOBasic._Size 1)) (select ow_1::StdIOBasic._Size 1))
search.anon_76 _x_0 !ps_1 = ps_1
search.anon_102 !f_0 g_1 x_2 = f_0 (g_1 x_2)
search.wind_act c_0 !ps_1 = let _x_1_0 = IdeState.getMenuIds ps_1, ps_1_1 = select _x_1_0::_Tuple2 1, _x_1_2 = select _x_1_0::_Tuple2 0, search_1_3 = select _x_1_2::IdeState._MenuIds 15 in update ps_1_1::iostate._PSt [1:StdMenuElement.disableMenuElements (select search_1_3::IdeState._SearchMenuIds 2) (StdMenuElement.disableMenuElements (select search_1_3::IdeState._SearchMenuIds 1) (StdMenuElement.disableMenuElements (_predefined._Cons (select _x_1_2::IdeState._MenuIds 10) (_predefined._Cons (select _x_1_2::IdeState._MenuIds 11) (_predefined._Cons (select _x_1_2::IdeState._MenuIds 12) (_predefined._Cons (select _x_1_2::IdeState._MenuIds 13) (select _x_1_2::IdeState._MenuIds 14))))) (select ps_1_1::iostate._PSt 1)))]
search.sw_init !ps_0 = let _x_1_0 = IdeState.getMenuIds ps_0 in StdPSt.appPIO (StdMenuElement.enableMenuElements (_predefined._Cons (<{StdList.!!}> (select (select (select _x_1_0::_Tuple2 0)::IdeState._MenuIds 15)::IdeState._SearchMenuIds 3) 0) _predefined._Nil)) (select _x_1_0::_Tuple2 1)
search.anon_152 !wind_0 !g_1 x_2 = search.sw_close wind_0 (g_1 x_2)
search.anon_153 !wind_0 !x_1 = search.sw_close wind_0 (search.wind_deac x_1)
search.searchwin_78 wind_0 windlb_1 src_offset_2 elb_3 win_size_4 = StdWindowDef.Window "Search Results" elb_3 (_predefined._Cons (StdWindowDef.WindowId wind_0) (_predefined._Cons (StdWindowDef.WindowClose (StdIOBasic.noLS (search.anon_153 wind_0))) (_predefined._Cons (StdWindowDef.WindowInit (StdIOBasic.noLS search.sw_init)) (_predefined._Cons (StdWindowDef.WindowDeactivate (StdIOBasic.noLS search.wind_deac)) (_predefined._Cons (StdWindowDef.WindowInitActive (select windlb_1::ExtListBox._ExtListBoxId 0)) (_predefined._Cons (StdWindowDef.WindowActivate (StdIOBasic.noLS (search.wind_act (select windlb_1::ExtListBox._ExtListBoxId 0)))) (_predefined._Cons (StdWindowDef.WindowViewSize win_size_4) (_predefined._Cons (StdWindowDef.WindowPos (_Tuple2 StdIOCommon.Fix (StdIOCommon.OffsetVector src_offset_2))) _predefined._Nil))))))))
search.wind_open !info_0 menu_elem_id_1 !ps_2 = case info_0 (fbi._FindBoxInfo dlog_1_0 intr_1_1 msg_1_2 find_1_3 close_1_4 string_1_5 kind_1_6 type_1_7 is_searching_1_8 cleanid_1_9 verb_1_10 export__1_11 wind_1_12 windlb_1_13 src_offset_1_14 src_font_1_15 src_forg_1_16 src_back_1_17 src_size_1_18 pathname_1_19 recv_1_20 -> let elb_2_0 = ExtListBox.ExtListBoxControl _predefined._Nil _predefined._Nil search.anon_76 windlb_1_13 (_predefined._Cons (StdControlDef.ControlViewSize src_size_1_18) (_predefined._Cons (StdControlDef.ControlResize search.win_resize_77) (_predefined._Cons (StdControlDef.ControlPen (_predefined._Cons (StdPictureDef.PenColour src_forg_1_16) (_predefined._Cons (StdPictureDef.PenBack src_back_1_17) (_predefined._Cons (StdPictureDef.PenFont src_font_1_15) _predefined._Nil)))) _predefined._Nil))), _x_2_1 = StdControl.controlSize (<{StdControlClass.Controls;}> ExtListBox.controlToHandles_20 ExtListBox.getControlType_21) elb_2_0 True Data.Maybe.Nothing Data.Maybe.Nothing Data.Maybe.Nothing ps_2 in select (StdWindow.openWindow_55 (<{StdControlClass.Controls;}> ExtListBox.controlToHandles_20 ExtListBox.getControlType_21) StdMisc.undef (search.searchwin_78 wind_1_12 windlb_1_13 src_offset_1_14 elb_2_0 (select _x_2_1::_Tuple2 0)) (select _x_2_1::_Tuple2 1))::_Tuple2 1) 
search.fifi_75 !path_0 lnr_1::I !ps_2 = case (StdBool.not (<{StdString.==_2}> path_0 "")) (True -> IDE.OpenModule path_0 (EdSelection.lineSelection lnr_1) ps_2) (False -> ps_2) 
<{search.c;629;74_74}> !g_l_0 = <{search.g_c1;629;92_167}> g_l_0
<{search.g_c1;629;92_167}> !g_l_0 = case g_l_0 (_predefined._Cons g_h_1_0 g_t_1_1 -> <{search.g_c2;629;92_166}> g_h_1_0 g_t_1_1) (_ -> _predefined._Nil)
<{search.g_c2;629;92_166}> !g_h_0 g_t_1 = case g_h_0 (_Tuple3 msg_1_0 path_1_1 lnr_1_2 -> _predefined._Cons (_Tuple3 msg_1_0 (search.fifi_75 path_1_1 lnr_1_2) StdFunc.id) (<{search.c;629;74_74}> g_t_1)) (_ -> <{search.c;629;74_74}> g_t_1)
search.updateSearchWindow !info_0 !text_1 !ps_2 = case info_0 (fbi._FindBoxInfo dlog_1_0 intr_1_1 msg_1_2 find_1_3 close_1_4 string_1_5 kind_1_6 type_1_7 is_searching_1_8 cleanid_1_9 verb_1_10 export__1_11 wind_1_12 windlb_1_13 src_offset_1_14 src_font_1_15 src_forg_1_16 src_back_1_17 src_size_1_18 pathname_1_19 recv_1_20 -> let _x_2_0 = IdeState.getMenuIds ps_2 in ExtListBox.appendExtListBoxItems windlb_1_13 (<{search.c;629;74_74}> (UtilStrictLists.StrictListToList text_1)) (search.wind_open info_0 (<{StdList.!!}> (select (select (select _x_2_0::_Tuple2 0)::IdeState._MenuIds 15)::IdeState._SearchMenuIds 3) 0) (select _x_2_0::_Tuple2 1))) 
search.WriteFoundPositionsInSearchWindow !info_0 search_kind_1 modname_2 !list_3 id_4 !pstate_5 = search.updateSearchWindow info_0 (search.WriteFoundPositionsInSearchWindow_72 info_0 search_kind_1 modname_2 list_3 id_4) pstate_5
search.write_found_positions_61 info_0 search_kind_1 !found_in_file_2::B <{modname`_3}> found_positions_4 cleanid_5 !pstate_6 = case found_in_file_2 (True -> search.WriteFoundPositionsInSearchWindow info_0 search_kind_1 <{modname`_3}> found_positions_4 cleanid_5 pstate_6) (False -> pstate_6) 
search.SearchIdentifiersInFiles !d_0 !i_1 !is_dcl_file_2::B !info_3 !done_4 !modnames_5 !paths_6 !_x_7::B !ps_8 = case _x_7 (True -> search.ResetButtonString (UtilInterrupt.StopIntr (_Tuple2 d_0 i_1) ps_8)) (False -> case modnames_5 (<{_predefined._!Nil!}> -> let ps_3_0 = UtilInterrupt.StopIntr (_Tuple2 d_0 i_1) ps_8, ps_3_1 = search.ResetButtonString ps_3_0, _x_3_2 = ExtListBox.getExtListBoxItems (select info_3::fbi._FindBoxInfo 13) ps_3_1, _x_3_3 = select _x_3_2::_Tuple2 0, itms_3_4 = select _x_3_3::_Tuple2 1 in case (<{StdInt.==_16}> (StdList.length_47 itms_3_4) 0) (True -> search.ChangeMsgString True "Not Found" (select _x_3_2::_Tuple2 1)) (False -> case (<{StdInt.==_16}> (StdList.length_47 itms_3_4) 1) (True -> ExtListBox.execExtListBoxItem (select info_3::fbi._FindBoxInfo 13) 1 (StdWindow.closeWindow d_0 (select _x_3_2::_Tuple2 1))) (False -> StdWindow.closeWindow d_0 (select _x_3_2::_Tuple2 1)) ) ) (<{_predefined._!Cons!}> _x_2_0 rest_2_1 -> case _x_2_0 ("" -> search.SearchIdentifiersInFiles d_0 i_1 is_dcl_file_2 info_3 done_4 rest_2_1 paths_6 _x_7 ps_8) (_ -> case info_3 (fbi._FindBoxInfo dlog_3_0 intr_3_1 msg_3_2 find_3_3 close_3_4 string_3_5 search_kind_3_6 imp_3_7 is_searching_3_8 cleanid_3_9 verbose_3_10 export__3_11 wind_3_12 windlb_3_13 src_offset_3_14 src_font_3_15 src_forg_3_16 src_back_3_17 src_size_3_18 pathname_3_19 recv_3_20 -> case (StdList.isEmpty cleanid_3_9) (True -> ps_8) (False -> case (case (StdBool.not is_dcl_file_2) (True -> UtilStrictLists.StringOccurs _x_2_0 done_4) (False -> False) ) (True -> search.SearchIdentifiersInFiles d_0 i_1 False info_3 done_4 rest_2_1 paths_6 _x_7 ps_8) (False -> case (StdBool.not is_dcl_file_2) (True -> let cleanid_7_0 = StdList.hd cleanid_3_9, <{modname`_7_1}> = search.add_suffix is_dcl_file_2 _x_2_0, _x_7_2 = search.SearchIdentifiersInFile_62 True rest_2_1 cleanid_7_0 <{modname`_7_1}> paths_6 (search.ChangeMsgString verbose_3_10 (<{StdString.+++_11}> "Searching '" (<{StdString.+++_11}> (StdPathname.RemovePath <{modname`_7_1}>) "'")) ps_8), found_positions_7_3 = select _x_7_2::_Tuple4 1 in UtilInterrupt.ContIntr (_Tuple2 d_0 i_1) (search.SearchIdentifiersInFiles d_0 i_1 True info_3 done_4 (<{_predefined._!Cons!}> _x_2_0 (select _x_7_2::_Tuple4 0)) paths_6) (search.write_found_positions_61 info_3 search_kind_3_6 (<{search._c;463;43_168}> found_positions_7_3) (select _x_7_2::_Tuple4 2) found_positions_7_3 cleanid_7_0 (select _x_7_2::_Tuple4 3))) (False -> let cleanid_7_0 = StdList.hd cleanid_3_9, <{modname`_7_1}> = search.add_suffix is_dcl_file_2 _x_2_0, _x_7_2 = search.SearchIdentifiersInFile_62 True rest_2_1 cleanid_7_0 <{modname`_7_1}> paths_6 (search.ChangeMsgString verbose_3_10 (<{StdString.+++_11}> "Searching '" (<{StdString.+++_11}> (StdPathname.RemovePath <{modname`_7_1}>) "'")) ps_8), found_positions_7_3 = select _x_7_2::_Tuple4 1 in UtilInterrupt.ContIntr (_Tuple2 d_0 i_1) (search.SearchIdentifiersInFiles d_0 i_1 False info_3 (<{_predefined._!Cons!}> _x_2_0 done_4) (select _x_7_2::_Tuple4 0) paths_6) (search.write_found_positions_61 info_3 search_kind_3_6 (<{search._c;463;43_169}> found_positions_7_3) (select _x_7_2::_Tuple4 2) found_positions_7_3 cleanid_7_0 (select _x_7_2::_Tuple4 3))) ) ) ) )) ) 
<{search._c;463;43_169}>::B !found_positions_0 = case found_positions_0 (PmParse.PosNil -> False) (_ -> True)
<{search._c;463;43_168}>::B !found_positions_0 = case found_positions_0 (PmParse.PosNil -> False) (_ -> True)
<{search.cu;427;37_54}> !_vone_0 !<{_v+_1}> c_l_i_2 !g_l_3 = <{search.g_c1;427;42_170}> g_l_3 _vone_0 <{_v+_1}> c_l_i_2
<{search.g_c1;427;42_170}> !g_l_0 _vone_1 <{_v+_2}> c_l_i_3 = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;427;37_54}> _vone_1 <{_v+_2}> (select <{_v+_2}>::<{StdOverloaded.+;}> 0 c_l_i_3 (select _vone_1::<{StdOverloaded.one;}> 0)) g_t_1_1) (_ -> c_l_i_3)
<{search.cu;427;37_53}> !_vArray_0 c_a_1 c_i_2::I !g_l_3 = <{search.g_c1;427;42_171}> g_l_3 _vArray_0 c_a_1 c_i_2
<{search.g_c1;427;42_171}> !g_l_0 _vArray_1 c_a_2 c_i_3::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;427;37_53}> _vArray_1 (select _vArray_1::<{_SystemArray.Array;}> 5 c_a_2 c_i_3 t_1_0) (<{StdInt.+_6}> c_i_3 StdInt.one_11) g_t_1_1) (_ -> c_a_2)
<{search.cu;427;37_154}>::I !<{_v+_0}> c_l_i_1::I !g_l_2 = <{search.g_c1;427;42_172}> g_l_2 <{_v+_0}> c_l_i_1
<{search.g_c1;427;42_172}>::I !g_l_0 <{_v+_1}> c_l_i_2::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;427;37_154}> <{_v+_1}> (select <{_v+_1}>::<{StdOverloaded.+;}> 0 c_l_i_2 StdInt.one_11) g_t_1_1) (_ -> c_l_i_2)
<{search.cu;427;37_155}> !c_a_0 c_i_1::I !g_l_2 = <{search.g_c1;427;42_173}> g_l_2 c_a_0 c_i_1
<{search.g_c1;427;42_173}> !g_l_0 !c_a_1 c_i_2::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;427;37_155}> (_SystemArray.update_77 c_a_1 c_i_2 t_1_0) (<{StdInt.+_6}> c_i_2 StdInt.one_11) g_t_1_1) (_ -> c_a_1)
<{search.cu;427;37_156}>::I !c_l_i_0::I !g_l_1 = <{search.g_c1;427;42_174}> g_l_1 c_l_i_0
<{search.g_c1;427;42_174}>::I !g_l_0 !c_l_i_1::I = case g_l_0 (_predefined._Cons t_1_0 g_t_1_1 -> <{search.cu;427;37_156}> (<{StdInt.+_6}> c_l_i_1 StdInt.one_11) g_t_1_1) (_ -> c_l_i_1)
search.seach_definition_in_file_57 path_0 !imp_1::B !rest_2 !cleanid_3 !ps_4 = let _x_1_0 = search.IsOpen path_0 ps_4, win_1_1 = select _x_1_0::_Tuple2 0 in case (Data.Maybe.isJust win_1_1) (True -> let ps_3_0 = select _x_1_0::_Tuple2 1, _x_3_1 = EdClient.message (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) (Data.Maybe.fromJust win_1_1) EdClient.msgGetText ps_3_0, ps_3_2 = select _x_3_1::_Tuple2 1 in <{search._c;421;19_175}> (select _x_3_1::_Tuple2 0) imp_1 rest_2 cleanid_3 path_0 ps_3_2) (False -> StdPStClass.accFiles_8 (PmParse.FindDefinitionInFile imp_1 rest_2 cleanid_3 path_0) (select _x_1_0::_Tuple2 1)) 
<{search._c;421;19_175}> !_x_0 !imp_1::B !rest_2 !cleanid_3 path_4 !ps_5 = case _x_0 (Data.Maybe.Nothing -> StdPStClass.accFiles_8 (PmParse.FindDefinitionInFile imp_1 rest_2 cleanid_3 path_4) ps_5) (Data.Maybe.Just text_1_0 -> let text_2_0 = StrictList.slToList (EdLineText.textToStrings text_1_0) in StdPStClass.accFiles_8 (PmParse.FindDefinitionInText imp_1 rest_2 cleanid_3 (<{search.cu;427;37_155}> (_SystemArray._createArray_72 (<{search.cu;427;37_156}> 0 text_2_0)) 0 text_2_0)) ps_5) 
search.SearchDefinitionInFile_56 imp_0::B rest_1 cleanid_2 !modname_3 paths_4 ps_5 = case (StdPathname.IsFullPathname modname_3) (True -> let _x_2_0 = search.seach_definition_in_file_57 modname_3 imp_0 rest_1 cleanid_2 ps_5, _x_2_1 = select _x_2_0::_Tuple2 0 in _Tuple4 (select _x_2_1::_Tuple2 0) (select _x_2_1::_Tuple2 1) modname_3 (select _x_2_0::_Tuple2 1)) (False -> let _x_2_0 = StdPStClass.accFiles_8 (search.search_disk modname_3 paths_4) ps_5, _x_2_1 = select _x_2_0::_Tuple2 0 in case (select _x_2_1::_Tuple2 0) (True -> let _x_4_0 = search.seach_definition_in_file_57 (select _x_2_1::_Tuple2 1) imp_0 rest_1 cleanid_2 (select _x_2_0::_Tuple2 1), _x_4_1 = select _x_4_0::_Tuple2 0 in _Tuple4 (select _x_4_1::_Tuple2 0) (select _x_4_1::_Tuple2 1) modname_3 (select _x_4_0::_Tuple2 1)) (False -> _Tuple4 rest_1 PmParse.PosNil modname_3 (select _x_2_0::_Tuple2 1)) ) 
<{search.done`_55}> modname_0 !done_1 !is_dcl_file_2::B = case is_dcl_file_2 (True -> <{_predefined._!Cons!}> modname_0 done_1) (False -> done_1) 
search.SearchDefinitionInFiles_58 paths_0 i_1 d_2 imports_3::B first_4::B found_5::B is_dcl_file_6::B info_7 done_8 !modnames_9 !_x_10::B !ps_11 = case _x_10 (True -> search.ResetButtonString (UtilInterrupt.StopIntr (_Tuple2 d_2 i_1) ps_11)) (False -> case found_5 (False -> case modnames_9 (<{_predefined._!Nil!}> -> search.ChangeMsgString True "Not Found" (search.ResetButtonString (UtilInterrupt.StopIntr (_Tuple2 d_2 i_1) ps_11))) ) (True -> case modnames_9 (<{_predefined._!Nil!}> -> let ps_4_0 = UtilInterrupt.StopIntr (_Tuple2 d_2 i_1) ps_11, ps_4_1 = StdWindow.closeWindow d_2 ps_4_0, _x_4_2 = ExtListBox.getExtListBoxItems (select info_7::fbi._FindBoxInfo 13) ps_4_1 in case (<{StdInt.==_16}> (StdList.length_47 (select (select _x_4_2::_Tuple2 0)::_Tuple2 1)) 1) (True -> ExtListBox.execExtListBoxItem (select info_7::fbi._FindBoxInfo 13) 1 (select _x_4_2::_Tuple2 1)) (False -> select _x_4_2::_Tuple2 1) ) ) (_ -> case modnames_9 (<{_predefined._!Cons!}> _x_2_0 rest_2_1 -> case _x_2_0 ("" -> search.SearchDefinitionInFiles_58 paths_0 i_1 d_2 imports_3 False found_5 is_dcl_file_6 info_7 done_8 rest_2_1 _x_10 ps_11) (_ -> case info_7 (fbi._FindBoxInfo dlog_3_0 intr_3_1 msg_3_2 find_3_3 close_3_4 string_3_5 search_kind_3_6 type_3_7 is_searching_3_8 cleanid_3_9 verbose_3_10 export__3_11 wind_3_12 windlb_3_13 src_offset_3_14 src_font_3_15 src_forg_3_16 src_back_3_17 src_size_3_18 pathname_3_19 recv_3_20 -> case (StdList.isEmpty cleanid_3_9) (True -> ps_11) (False -> case (case is_dcl_file_6 (True -> UtilStrictLists.StringOccurs _x_2_0 done_8) (False -> False) ) (True -> search.SearchDefinitionInFiles_58 paths_0 i_1 d_2 imports_3 False found_5 is_dcl_file_6 info_7 done_8 rest_2_1 _x_10 ps_11) (False -> let cleanid_6_0::B = StdList.hd cleanid_3_9, <{modname`_6_1}>::B = search.add_suffix is_dcl_file_6 _x_2_0, ps_6_2::B = search.ChangeMsgString verbose_3_10 (<{StdString.+++_11}> "Searching '" (<{StdString.+++_11}> (StdPathname.RemovePath <{modname`_6_1}>) "'")) ps_11, _x_6_3 = search.SearchDefinitionInFile_56 imports_3 rest_2_1 cleanid_6_0 <{modname`_6_1}> paths_0 ps_6_2, found_positions_6_4 = select _x_6_3::_Tuple4 1, found_in_file_6_5 = <{search._c;381;47_178}> found_positions_6_4, found_here_6_6 = search._f177_177 found_in_file_6_5 find_definition_6_7 is_dcl_file_6, find_definition_6_7 = <{search._c;386;47_176}> search_kind_3_6 in case found_here_6_6 (True -> let search_icl_file_next_8_0 = search._f179_179 found_in_file_6_5 is_dcl_file_6 find_definition_6_7, impsa_8_1::B = select _x_6_3::_Tuple4 0 in UtilInterrupt.ContIntr (_Tuple2 d_2 i_1) (search.SearchDefinitionInFiles_58 paths_0 i_1 d_2 imports_3 (search._f180_180 first_4 is_dcl_file_6) (search._f181_181 found_5 found_here_6_6) (StdBool.not search_icl_file_next_8_0) info_7 (<{search.done`_55}> _x_2_0 done_8 is_dcl_file_6) (<{search._if;390;47_182}> search_icl_file_next_8_0 _x_2_0 impsa_8_1 is_dcl_file_6)) (search.WriteFoundPositionsInSearchWindow info_7 search_kind_3_6 (select _x_6_3::_Tuple4 2) found_positions_6_4 cleanid_6_0 (select _x_6_3::_Tuple4 3))) (False -> let search_icl_file_next_8_0 = search._f183_183 found_in_file_6_5 is_dcl_file_6 find_definition_6_7, impsa_8_1::B = select _x_6_3::_Tuple4 0 in UtilInterrupt.ContIntr (_Tuple2 d_2 i_1) (search.SearchDefinitionInFiles_58 paths_0 i_1 d_2 imports_3 (search._f184_184 first_4 is_dcl_file_6) (search._f185_185 found_5 found_here_6_6) (StdBool.not search_icl_file_next_8_0) info_7 (<{search.done`_55}> _x_2_0 done_8 is_dcl_file_6) (<{search._if;390;47_186}> search_icl_file_next_8_0 _x_2_0 impsa_8_1 is_dcl_file_6)) (select _x_6_3::_Tuple4 3)) ) ) ) )) )) 
<{search._if;390;47_186}> !search_icl_file_next_0::B _x_1 !impsa_2 is_dcl_file_3::B = case search_icl_file_next_0 (True -> <{_predefined._!Cons!}> _x_1 impsa_2) (_ -> case is_dcl_file_3 (True -> impsa_2) (False -> <{_predefined._!Cons!}> _x_1 impsa_2) )
search._f185_185::B !found_0::B found_here_1::B = case found_0 (True -> True) (_ -> found_here_1)
search._f184_184::B !first_0::B is_dcl_file_1::B = case first_0 (True -> StdBool.not is_dcl_file_1) (_ -> False)
search._f183_183::B !found_in_file_0::B is_dcl_file_1::B find_definition_2::B = case found_in_file_0 (True -> case is_dcl_file_1 (True -> StdBool.not find_definition_2) (False -> False) ) (_ -> False)
<{search._if;390;47_182}> !search_icl_file_next_0::B _x_1 !impsa_2 is_dcl_file_3::B = case search_icl_file_next_0 (True -> <{_predefined._!Cons!}> _x_1 impsa_2) (_ -> case is_dcl_file_3 (True -> impsa_2) (False -> <{_predefined._!Cons!}> _x_1 impsa_2) )
search._f181_181::B !found_0::B found_here_1::B = case found_0 (True -> True) (_ -> found_here_1)
search._f180_180::B !first_0::B is_dcl_file_1::B = case first_0 (True -> StdBool.not is_dcl_file_1) (_ -> False)
search._f179_179::B !found_in_file_0::B is_dcl_file_1::B find_definition_2::B = case found_in_file_0 (True -> case is_dcl_file_1 (True -> StdBool.not find_definition_2) (False -> False) ) (_ -> False)
<{search._c;381;47_178}>::B !found_positions_0 = case found_positions_0 (PmParse.Pos _x_1_0 _x_1_1 _x_1_2 -> True) (PmParse.Cls _x_1_0 _x_1_1 _x_1_2 -> True) (PmParse.Ins _x_1_0 _x_1_1 _x_1_2 -> True) (_ -> False)
search._f177_177::B !found_in_file_0::B find_definition_1::B is_dcl_file_2::B = case found_in_file_0 (True -> <{StdBool.==_3}> find_definition_1 is_dcl_file_2) (_ -> False)
<{search._c;386;47_176}>::B !search_kind_0 = case search_kind_0 (PmParse.Definition -> True) (_ -> False)
search.SearchDefinitionInFiles !d_0 !i_1 !is_dcl_file_2::B !info_3 !done_4 !modnames_5 !paths_6 !intr_7::B !ps_8 = case info_3 (fbi._FindBoxInfo dlog_1_0 intr_1_1 msg_1_2 find_1_3 close_1_4 string_1_5 kind_1_6 type_1_7 is_searching_1_8 cleanid_1_9 verb_1_10 export__1_11 wind_1_12 windlb_1_13 src_offset_1_14 src_font_1_15 src_forg_1_16 src_back_1_17 src_size_1_18 pathname_1_19 recv_1_20 -> search.SearchDefinitionInFiles_58 paths_6 i_1 d_0 (search._f187_187 (<{fbi.==_0}> type_1_7 fbi.SearchImports) type_1_7) True False is_dcl_file_2 info_3 done_4 modnames_5 intr_7 ps_8) 
search._f187_187::B !_x_0::B type_1 = case _x_0 (True -> True) (_ -> <{fbi.==_0}> type_1 fbi.SearchProject)
search.search_52 !info_0 !d_1 !i_2 !pathname_3 !modpaths_4 !_x_5 !paths_6 !intr_7::B !pstate_8 = case _x_5 (PmParse.Identifier -> search.SearchIdentifiersInFiles d_1 i_2 (PmPath.IsDefPathname pathname_3) info_0 <{_predefined._!Nil!}> modpaths_4 paths_6 intr_7 pstate_8) (_ -> search.SearchDefinitionInFiles d_1 i_2 (PmPath.IsDefPathname pathname_3) info_0 <{_predefined._!Nil!}> modpaths_4 paths_6 intr_7 pstate_8)
search.getinfo_49 !_x_0 = case _x_0 (Directory._DirEntry fileName_1_0 fi_1_1 -> case fi_1_1 (Directory._FileInfo dummyname_2_0 pd_file_2_1 -> case dummyname_2_0 (Directory._PI_FileInfo fileSize_3_0 lastModified_3_1 isDirectory_3_2 isReadOnly_3_3 -> _Tuple2 isDirectory_3_2 fileName_1_0) ) ) 
search.anon_45::B !_x_0 = case _x_0 (_Tuple2 b_1_0 n_1_1 -> StdBool.not b_1_0) 
search.anon_46 !_x_0 = case _x_0 (_Tuple2 _x_1_0 n_1_1 -> n_1_1) 
search.is_interesting_50::B !string_0 = let s_1_0::I = _SystemArray.size_20 string_0 in case (case (StdBool.not (<{StdInt.<_17}> s_1_0 4)) (True -> let suffix_4_3_0 = <{StdString.%_10}> string_0 (_Tuple2 (<{StdInt.-_7}> s_1_0 4) (<{StdInt.-_7}> s_1_0 1)) in case (<{StdString.==_2}> suffix_4_3_0 ".icl") (True -> True) (False -> <{StdString.==_2}> suffix_4_3_0 ".dcl") ) (False -> False) ) (True -> True) (False -> case (StdBool.not (<{StdInt.<_17}> s_1_0 3)) (True -> <{StdString.==_2}> (<{StdString.%_10}> string_0 (_Tuple2 (<{StdInt.-_7}> s_1_0 3) (<{StdInt.-_7}> s_1_0 1))) ".hs") (False -> False) ) 
search.anon_47 !path_0 !n_1 = StdPathname.MakeFullPathname path_0 n_1
search.findmods_48 !_vFileSystem_0 !_x_1 files_2 = case _x_1 (<{_predefined._!Nil!}> -> _Tuple2 _predefined._Nil files_2) (<{_predefined._!Cons!}> path_1_0 paths_1_1 -> let _x_2_0 = Directory.pd_StringToPath _vFileSystem_0 path_1_0 files_2, _x_2_1 = select _x_2_0::_Tuple2 0 in case (StdBool.not (select _x_2_1::_Tuple2 0)) (True -> search.findmods_48 _vFileSystem_0 paths_1_1 (select _x_2_0::_Tuple2 1)) (False -> let <{path`_4_0}> = select _x_2_1::_Tuple2 1, files_4_1 = select _x_2_0::_Tuple2 1, _x_4_2 = Directory.getDirectoryContents _vFileSystem_0 <{path`_4_0}> files_4_1, _x_4_3 = select _x_4_2::_Tuple2 0 in case (StdBool.not (<{Directory.==_13}> (select _x_4_3::_Tuple2 0) Directory.NoDirError)) (True -> search.findmods_48 _vFileSystem_0 paths_1_1 (select _x_4_2::_Tuple2 1)) (False -> let _x_6_0 = search.findmods_48 _vFileSystem_0 paths_1_1 (select _x_4_2::_Tuple2 1) in _Tuple2 (<{StdList.++}> (StdList.map (search.anon_47 path_1_0) (StdList.filter search.is_interesting_50 (StdList.map search.anon_46 (StdList.filter search.anon_45 (StdList.map search.getinfo_49 (select _x_4_3::_Tuple2 1)))))) (select _x_6_0::_Tuple2 0)) (select _x_6_0::_Tuple2 1)) ) ) 
search.findmods_157 !_x_0 files_1 = case _x_0 (<{_predefined._!Nil!}> -> _Tuple2 _predefined._Nil files_1) (<{_predefined._!Cons!}> path_1_0 paths_1_1 -> let _x_2_0 = Directory.pd_StringToPath (<{StdFile.FileSystem;}> StdFile.fclose_26 StdFile.fopen_27 StdFile.sfopen_28 StdFile.stdio_29) path_1_0 files_1, _x_2_1 = select _x_2_0::_Tuple2 0 in case (StdBool.not (select _x_2_1::_Tuple2 0)) (True -> search.findmods_157 paths_1_1 (select _x_2_0::_Tuple2 1)) (False -> let <{path`_4_0}> = select _x_2_1::_Tuple2 1, files_4_1 = select _x_2_0::_Tuple2 1, _x_4_2 = Directory.getDirectoryContents (<{StdFile.FileSystem;}> StdFile.fclose_26 StdFile.fopen_27 StdFile.sfopen_28 StdFile.stdio_29) <{path`_4_0}> files_4_1, _x_4_3 = select _x_4_2::_Tuple2 0 in case (StdBool.not (<{Directory.==_13}> (select _x_4_3::_Tuple2 0) Directory.NoDirError)) (True -> search.findmods_157 paths_1_1 (select _x_4_2::_Tuple2 1)) (False -> let _x_6_0 = search.findmods_157 paths_1_1 (select _x_4_2::_Tuple2 1) in _Tuple2 (<{StdList.++}> (StdList.map (search.anon_47 path_1_0) (StdList.filter search.is_interesting_50 (StdList.map search.anon_46 (StdList.filter search.anon_45 (StdList.map search.getinfo_49 (select _x_4_3::_Tuple2 1)))))) (select _x_6_0::_Tuple2 0)) (select _x_6_0::_Tuple2 1)) ) ) 
search.getModulesInPaths !ps_0 = let _x_1_0 = IdeState.getCurrentPaths ps_0, _x_1_1 = IdeState.getFromProject PmProject.PR_GetPaths (select _x_1_0::_Tuple2 1) in StdPStClass.accFiles_8 (search.findmods_157 (UtilStrictLists.Concat (select _x_1_1::_Tuple2 0) (select _x_1_0::_Tuple2 0))) (select _x_1_1::_Tuple2 1)
search.sr_find_worker !_x_0 = case _x_0 (_Tuple2 info_1_0 pstate_1_1 -> case info_1_0 (fbi._FindBoxInfo f_2_0 t_2_1 msg_2_2 find_2_3 close_2_4 string_2_5 kind_2_6 type_2_7 is_searching_2_8 cleanid_2_9 verb_2_10 export__2_11 wind_2_12 windlb_2_13 src_offset_2_14 src_font_2_15 src_forg_2_16 src_back_2_17 src_size_2_18 pathname_2_19 recv_2_20 -> <{search._c;311;7_188}> type_2_7 pstate_1_1 info_1_0 f_2_0 t_2_1 pathname_2_19 kind_2_6) ) 
<{search._c;311;7_188}> !type_0 !pstate_1 !info_2 !f_3 !t_4 pathname_5 kind_6 = case type_0 (fbi.SearchPaths -> let _x_2_0 = search.getModulesInPaths (search.sw_safe_close pstate_1), _x_2_1 = search.get_paths_51 (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> info_2 (UtilInterrupt.StartIntr (_Tuple2 f_3 t_4) (search.search_52 info_2 f_3 t_4 pathname_5 (<{_predefined._!Cons!}> pathname_5 (UtilStrictLists.ListToStrictList (select _x_2_0::_Tuple2 0))) kind_6 (select _x_2_1::_Tuple2 0)) (select _x_2_1::_Tuple2 1))) (fbi.SearchProject -> let _x_2_0 = IdeState.getProject (search.sw_safe_close pstate_1), _x_2_1 = select (PmProject.PR_GetRootModuleDirAndName (select _x_2_0::_Tuple2 0))::_Tuple2 0, mdn_name_2_2 = select _x_2_1::PmTypes._ModuleDirAndName 1, _x_2_3 = search.get_paths_51 (select _x_2_0::_Tuple2 1) in <{_Tuple2!3}> info_2 (UtilInterrupt.StartIntr (_Tuple2 f_3 t_4) (search.search_52 info_2 f_3 t_4 (<{StdString.+++_11}> (select _x_2_1::PmTypes._ModuleDirAndName 0) mdn_name_2_2) (<{_predefined._!Cons!}> mdn_name_2_2 <{_predefined._!Nil!}>) kind_6 (select _x_2_3::_Tuple2 0)) (select _x_2_3::_Tuple2 1))) (fbi.SearchImports -> let _x_2_0 = search.get_paths_51 (search.sw_safe_close pstate_1), paths_2_1 = select _x_2_0::_Tuple2 0, _x_2_2 = PmPath.determine_dir_and_filename pathname_5 paths_2_1 in <{_Tuple2!3}> info_2 (UtilInterrupt.StartIntr (_Tuple2 f_3 t_4) (search.search_52 info_2 f_3 t_4 (select _x_2_2::_Tuple2 1) (<{_predefined._!Cons!}> (select (select _x_2_2::_Tuple2 0)::PmTypes._ModuleDirAndName 1) <{_predefined._!Nil!}>) kind_6 paths_2_1) (select _x_2_0::_Tuple2 1))) 
search.findfun !_x_0 = case _x_0 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (fbi._FindBoxInfo dlog_2_0 intr_2_1 msg_2_2 find_2_3 close_2_4 string_2_5 kind_2_6 type_2_7 is_searching_2_8 cleanid_2_9 verb_2_10 export__2_11 wind_2_12 windlb_2_13 src_offset_2_14 src_font_2_15 src_forg_2_16 src_back_2_17 src_size_2_18 pathname_2_19 recv_2_20 -> case is_searching_2_8 (True -> let _x_4_0 = search.savefun (_Tuple2 ls_1_0 ps_1_1) in _Tuple2 (update (select _x_4_0::_Tuple2 0)::fbi._FindBoxInfo [8:False]) (StdPSt.appPIO (StdControl.setControlText find_2_3 "Find") (UtilInterrupt.StopIntr (_Tuple2 dlog_2_0 intr_2_1) (select _x_4_0::_Tuple2 1)))) (False -> let _x_4_0 = search.savefun (_Tuple2 ls_1_0 ps_1_1), _x_4_1 = search.sr_find_worker (_Tuple2 (update (select _x_4_0::_Tuple2 0)::fbi._FindBoxInfo [8:True]) (StdPSt.appPIO (StdControl.setControlText find_2_3 "Stop") (select _x_4_0::_Tuple2 1))) in _Tuple2 (select _x_4_1::_Tuple2 0) (select _x_4_1::_Tuple2 1)) ) ) 
search.anon_43 !l_0 = update l_0::fbi._FindBoxInfo [11:StdBool.not (select l_0::fbi._FindBoxInfo 11)]
search.anon_42 !l_0 = update l_0::fbi._FindBoxInfo [10:StdBool.not (select l_0::fbi._FindBoxInfo 10)]
search.anon_41 !l_0 = update l_0::fbi._FindBoxInfo [7:fbi.SearchProject]
search.anon_40 !l_0 = update l_0::fbi._FindBoxInfo [7:fbi.SearchPaths]
search.anon_39 !l_0 = update l_0::fbi._FindBoxInfo [7:fbi.SearchImports]
search.anon_38 !l_0 = update l_0::fbi._FindBoxInfo [6:PmParse.Identifier]
search.anon_37 !l_0 = update l_0::fbi._FindBoxInfo [6:PmParse.Implementation]
search.anon_36 !l_0 = update l_0::fbi._FindBoxInfo [6:PmParse.Definition]
search.stringKey_44 !string_0 !dlog_1 !ps_2 = case ps_2 (iostate._PSt ls_1_0 io_1_1 -> let _x_2_0 = StdControl.getWindow dlog_1 io_1_1 in update ps_2::iostate._PSt [1:StdControl.selectPopUpControlItem string_0 0 (StdControl.openPopUpControlItems string_0 0 (_predefined._Cons (_Tuple2 (Data.Maybe.fromJust (select (StdList.hd (StdControl.getControlTexts (_predefined._Cons string_0 _predefined._Nil) (Data.Maybe.fromJust (select _x_2_0::_Tuple2 0))))::_Tuple2 1)) StdFunc.id) _predefined._Nil) (select _x_2_0::_Tuple2 1))]) 
search.anon_35 string_0 dlog_1 _x_2 = search.stringKey_44 string_0 dlog_1
<{search.c;169;35_34}> !g_l_0 = <{search.g_c1;169;41_189}> g_l_0
<{search.g_c1;169;41_189}> !g_l_0 = case g_l_0 (_predefined._Cons ci_1_0 g_t_1_1 -> _predefined._Cons (_Tuple2 ci_1_0 StdFunc.id) (<{search.c;169;35_34}> g_t_1_1)) (_ -> _predefined._Nil)
search.fi_dialog !info_0 !pstate_1 = case info_0 (fbi._FindBoxInfo dlog_1_0 intr_1_1 msg_1_2 find_1_3 close_1_4 string_1_5 kind_1_6 type_1_7 is_searching_1_8 cleanid_1_9 verb_1_10 export__1_11 wind_1_12 windlb_1_13 src_offset_1_14 src_font_1_15 src_forg_1_16 src_back_1_17 src_size_1_18 pathname_1_19 recv_1_20 -> let Controls_2_0 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_30 StdControlClass.getControlType_31, Controls_2_1 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_30 StdControlClass.getControlType_31, Controls_2_2 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_24 StdControlClass.getControlType_25, Controls_2_3 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_26 StdControlClass.getControlType_27, Controls_2_4 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_26 StdControlClass.getControlType_27, Controls_2_5 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_12 StdControlClass.getControlType_13, Controls_2_6 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_2_7 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_2_8 = <{StdControlClass.Controls;}> StdControlReceiver.controlToHandles_0 StdControlReceiver.getControlType_1, Controls_2_9 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_7 Controls_2_8) (StdControlClass.getControlType_9 Controls_2_7 Controls_2_8), Controls_2_10 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_6 Controls_2_9) (StdControlClass.getControlType_9 Controls_2_6 Controls_2_9), Controls_2_11 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_5 Controls_2_10) (StdControlClass.getControlType_9 Controls_2_5 Controls_2_10), Controls_2_12 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_4 Controls_2_11) (StdControlClass.getControlType_9 Controls_2_4 Controls_2_11), Controls_2_13 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_3 Controls_2_12) (StdControlClass.getControlType_9 Controls_2_3 Controls_2_12), Controls_2_14 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_2 Controls_2_13) (StdControlClass.getControlType_9 Controls_2_2 Controls_2_13), Controls_2_15 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_1 Controls_2_14) (StdControlClass.getControlType_9 Controls_2_1 Controls_2_14) in select (StdWindow.openModalDialog_58 (<{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_2_0 Controls_2_15) (StdControlClass.getControlType_9 Controls_2_0 Controls_2_15)) info_0 (StdWindowDef.Dialog "Find..." (<{StdIOBasic.:+:}> (StdControlDef.TextControl "" (_predefined._Cons (StdControlDef.ControlId msg_1_2) (_predefined._Cons (StdControlDef.ControlWidth (StdControlDef.PixelWidth 300)) _predefined._Nil))) (<{StdIOBasic.:+:}> (StdControlDef.TextControl "Find:" (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) _predefined._Nil)) (<{StdIOBasic.:+:}> (StdControlDef.PopUpControl (<{search.c;169;35_34}> cleanid_1_9) 0 (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlId string_1_5) (_predefined._Cons (StdControlDef.ControlKeyboard ioutil.filterReturnKeys StdIOCommon.Able (StdIOBasic.noLS1 (search.anon_35 string_1_5 dlog_1_0))) (_predefined._Cons (StdControlDef.ControlDeactivate (StdIOBasic.noLS (search.stringKey_44 string_1_5 dlog_1_0))) (_predefined._Cons (StdControlDef.ControlWidth (StdControlDef.PixelWidth 300)) _predefined._Nil)))))) (<{StdIOBasic.:+:}> (StdControlDef.RadioControl (_predefined._Cons (_Tuple3 "Find Definition" Data.Maybe.Nothing (ioutil.noPS search.anon_36)) (_predefined._Cons (_Tuple3 "Find Implementation" Data.Maybe.Nothing (ioutil.noPS search.anon_37)) (_predefined._Cons (_Tuple3 "Find Identifiers" Data.Maybe.Nothing (ioutil.noPS search.anon_38)) _predefined._Nil))) (StdControlDef.Columns 1) (<{search._c;181;19_190}> kind_1_6) (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) _predefined._Nil)) (<{StdIOBasic.:+:}> (StdControlDef.RadioControl (_predefined._Cons (_Tuple3 "Search in Imported Files" Data.Maybe.Nothing (ioutil.noPS search.anon_39)) (_predefined._Cons (_Tuple3 "Search in Paths" Data.Maybe.Nothing (ioutil.noPS search.anon_40)) (_predefined._Cons (_Tuple3 "Search in Project" Data.Maybe.Nothing (ioutil.noPS search.anon_41)) _predefined._Nil))) (StdControlDef.Columns 1) (<{search._c;193;19_191}> type_1_7) _predefined._Nil) (<{StdIOBasic.:+:}> (StdControlDef.CheckControl (_predefined._Cons (_Tuple4 "Be Verbose" Data.Maybe.Nothing (ioutil.toMark verb_1_10) (ioutil.noPS search.anon_42)) (_predefined._Cons (_Tuple4 "Exported Identifiers Only" Data.Maybe.Nothing (ioutil.toMark export__1_11) (ioutil.noPS search.anon_43)) _predefined._Nil)) (StdControlDef.Columns 1) (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) _predefined._Nil)) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Close" (_predefined._Cons (StdControlDef.ControlFunction search.closefun) (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlId close_1_4) _predefined._Nil)))) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Find" (_predefined._Cons (StdControlDef.ControlId find_1_3) (_predefined._Cons (StdControlDef.ControlFunction search.findfun) _predefined._Nil))) (StdReceiverDef.Receiver recv_1_20 search.recvfun _predefined._Nil))))))))) (_predefined._Cons (StdWindowDef.WindowId dlog_1_0) (_predefined._Cons (StdWindowDef.WindowOk find_1_3) (_predefined._Cons (StdWindowDef.WindowCancel close_1_4) (_predefined._Cons (StdWindowDef.WindowClose search.closefun) _predefined._Nil))))) (StdWindow.closeWindow dlog_1_0 pstate_1))::_Tuple2 1) 
<{search._c;193;19_191}>::I !type_0 = case type_0 (fbi.SearchImports -> 1) (fbi.SearchPaths -> 2) (fbi.SearchProject -> 3) 
<{search._c;181;19_190}>::I !kind_0 = case kind_0 (PmParse.Definition -> 1) (PmParse.Implementation -> 2) (PmParse.Identifier -> 3) 
search.closefun_33 dlog_0 !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> _Tuple2 ls_1_0 (StdWindow.closeWindow dlog_0 ps_1_1)) 
search.fi_messagebox !info_0 !pstate_1 = case info_0 (fbi._FindBoxInfo dlog_1_0 intr_1_1 msg_1_2 find_1_3 close_1_4 string_1_5 kind_1_6 type_1_7 is_searching_1_8 cleanid_1_9 verb_1_10 export__1_11 wind_1_12 windlb_1_13 src_offset_1_14 src_font_1_15 src_forg_1_16 src_back_1_17 src_size_1_18 pathname_1_19 recv_1_20 -> case (StdList.isEmpty cleanid_1_9) (True -> pstate_1) (False -> let Controls_3_0 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_30 StdControlClass.getControlType_31, Controls_3_1 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_30 StdControlClass.getControlType_31, Controls_3_2 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_20 StdControlClass.getControlType_21, Controls_3_3 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_3_4 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_3_2 Controls_3_3) (StdControlClass.getControlType_9 Controls_3_2 Controls_3_3), Controls_3_5 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_3_1 Controls_3_4) (StdControlClass.getControlType_9 Controls_3_1 Controls_3_4) in select (StdWindow.openModalDialog_58 (<{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_3_0 Controls_3_5) (StdControlClass.getControlType_9 Controls_3_0 Controls_3_5)) info_0 (StdWindowDef.Dialog (<{search._c;122;19_192}> kind_1_6) (<{StdIOBasic.:+:}> (StdControlDef.TextControl "" (_predefined._Cons (StdControlDef.ControlId msg_1_2) (_predefined._Cons (StdControlDef.ControlWidth (StdControlDef.PixelWidth 300)) _predefined._Nil))) (<{StdIOBasic.:+:}> (StdControlDef.TextControl "Find:" (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) _predefined._Nil)) (<{StdIOBasic.:+:}> (StdControlDef.EditControl (StdList.hd cleanid_1_9) (StdControlDef.PixelWidth 300) 1 (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlId string_1_5) (_predefined._Cons (StdControlDef.ControlActivate (StdIOBasic.noLS (StdPSt.appPIO (StdControl.setEditControlSelection string_1_5 1 0)))) _predefined._Nil)))) (StdControlDef.ButtonControl "Close" (_predefined._Cons (StdControlDef.ControlFunction (search.closefun_33 dlog_1_0)) (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlId close_1_4) _predefined._Nil))))))) (_predefined._Cons (StdWindowDef.WindowId dlog_1_0) (_predefined._Cons (StdWindowDef.WindowCancel close_1_4) (_predefined._Cons (StdWindowDef.WindowOk close_1_4) (_predefined._Cons (StdWindowDef.WindowClose (search.closefun_33 dlog_1_0)) (_predefined._Cons (StdWindowDef.WindowInit search.sr_find_worker) _predefined._Nil)))))) (StdWindow.closeWindow dlog_1_0 pstate_1))::_Tuple2 1) ) 
<{search._c;122;19_192}> !kind_0 = case kind_0 (PmParse.Definition -> "Find Definition") (PmParse.Implementation -> "Find Implementation") (PmParse.Identifier -> "Find Identifier") 
search.sr_find_idi !always_dialog_0::B !pstate_1 = let _x_1_0 = IdeState.getFBI pstate_1, pstate_1_1 = select _x_1_0::_Tuple2 1, _x_1_2 = EdClient.sendToActiveWindow (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) EdClient.msgGetPathName pstate_1_1, maybepath_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybepath_1_3) (True -> let fbi_3_0 = update (update (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo [6:PmParse.Identifier,7:fbi.SearchProject])::fbi._FindBoxInfo [19:""] in search.fi_dialog fbi_3_0 (IdeState.setFBI fbi_3_0 (select _x_1_2::_Tuple2 1))) (False -> let pstate_3_0 = select _x_1_2::_Tuple2 1, _x_3_1 = EdClient.sendToActiveWindow (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) EdClient.msgGetSelection pstate_3_0, maybesel_3_2 = select _x_3_1::_Tuple2 0 in case (case (Data.Maybe.isNothing maybesel_3_2) (True -> True) (False -> case always_dialog_0 (True -> True) (False -> case (<{StdString.==_2}> (select (Data.Maybe.fromJust maybesel_3_2)::_Tuple2 0) "") (True -> True) (False -> StdBool.not (PmParse.CleanModId (select (Data.Maybe.fromJust maybesel_3_2)::_Tuple2 0))) ) ) ) (True -> let fbi_5_0 = update (update (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo [6:PmParse.Identifier,7:fbi.SearchProject])::fbi._FindBoxInfo [19:Data.Maybe.fromJust maybepath_1_3] in search.fi_dialog fbi_5_0 (IdeState.setFBI fbi_5_0 (select _x_3_1::_Tuple2 1))) (False -> let fbi_5_0 = update (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo [6:PmParse.Identifier,7:fbi.SearchProject], fbi_5_1 = update fbi_5_0::fbi._FindBoxInfo [9:StdList.removeDup (<{StdClass.Eq;}> (<{StdOverloaded.==;}> <{StdString.==_2}>)) (_predefined._Cons (select (Data.Maybe.fromJust maybesel_3_2)::_Tuple2 0) (select fbi_5_0::fbi._FindBoxInfo 9)),19:Data.Maybe.fromJust maybepath_1_3] in search.fi_messagebox fbi_5_1 (IdeState.setFBI fbi_5_1 (select _x_3_1::_Tuple2 1))) ) 
search.sr_find_def_imp_sel !always_dialog_0::B !selection_1 !pathname_2 !info_3 !pstate_4 = case info_3 (fbi._FindBoxInfo dlog_1_0 intr_1_1 msg_1_2 find_1_3 close_1_4 string_1_5 kind_1_6 type_1_7 is_searching_1_8 cleanid_1_9 verb_1_10 export__1_11 wind_1_12 windlb_1_13 src_offset_1_14 src_font_1_15 src_forg_1_16 src_back_1_17 src_size_1_18 pathname_1_19 recv_1_20 -> case (case (<{StdInt.==_16}> (_SystemArray.size_20 selection_1) 0) (True -> True) (False -> case (StdBool.not (PmParse.CleanModId selection_1)) (True -> True) (False -> always_dialog_0) ) ) (True -> let info_3_0 = update info_3::fbi._FindBoxInfo [9:StdList.removeDup (<{StdClass.Eq;}> (<{StdOverloaded.==;}> <{StdString.==_2}>)) (_predefined._Cons selection_1 cleanid_1_9),19:pathname_2] in search.fi_dialog info_3_0 (IdeState.setFBI info_3_0 pstate_4)) (False -> let info_3_0 = update info_3::fbi._FindBoxInfo [9:StdList.removeDup (<{StdClass.Eq;}> (<{StdOverloaded.==;}> <{StdString.==_2}>)) (_predefined._Cons selection_1 cleanid_1_9),19:pathname_2] in search.fi_messagebox info_3_0 (IdeState.setFBI info_3_0 pstate_4)) ) 
<{search.c;100;60_32}> !_vArray_0 !g_i_1::I !g_s_2::I g_a_3 = case (StdBool.not (<{StdInt.<_17}> g_s_2 g_i_1)) (True -> let !g_a_2_0 = _predefined._dummyForStrictAlias (select _x_2_1::_Tuple2 1), _x_2_1::C = select _vArray_0::<{_SystemArray.Array;}> 6 g_a_3 g_i_1, c_2_2 = select _x_2_1::_Tuple2 0 in _predefined._Cons (search._f193_193 (<{StdChar.==_18}> c_2_2 '\r') c_2_2) (<{search.c;100;60_32}> _vArray_0 (<{StdInt.+_6}> g_i_1 StdInt.one_11) g_s_2 g_a_2_0)) (False -> _predefined._Nil) 
search._f193_193::B !_x_0::B c_1::C = case _x_0 (True -> True) (_ -> <{StdChar.==_18}> c_1 '\n')
<{search.c;100;60_158}> !g_i_0::I !g_s_1::I g_a_2 = case (StdBool.not (<{StdInt.<_17}> g_s_1 g_i_0)) (True -> let !g_a_2_0 = _predefined._dummyForStrictAlias (select _x_2_1::_Tuple2 1), _x_2_1::C = _SystemArray.uselect_22 g_a_2 g_i_0, c_2_2 = select _x_2_1::_Tuple2 0 in _predefined._Cons (search._f194_194 (<{StdChar.==_18}> c_2_2 '\r') c_2_2) (<{search.c;100;60_158}> (<{StdInt.+_6}> g_i_0 StdInt.one_11) g_s_1 g_a_2_0)) (False -> _predefined._Nil) 
search._f194_194::B !_x_0::B c_1::C = case _x_0 (True -> True) (_ -> <{StdChar.==_18}> c_1 '\n')
search.sr_find_def_imp !always_dialog_0::B !info_1 !pstate_2 = let _x_1_0 = EdClient.sendToActiveWindow (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) EdClient.msgGetSelection pstate_2, pstate_1_1 = select _x_1_0::_Tuple2 1, _x_1_2 = EdClient.sendToActiveWindow (<{EdState.Editor;}> IdeState.getEditorState_66 IdeState.setEditorState_67) EdClient.msgGetPathName pstate_1_1, maybepath_1_3 = select _x_1_2::_Tuple2 0 in case (Data.Maybe.isNothing maybepath_1_3) (True -> search.sr_find_def_imp_sel always_dialog_0 "" "" (update info_1::fbi._FindBoxInfo [7:fbi.SearchProject]) (select _x_1_2::_Tuple2 1)) (False -> let maybesel_3_0 = select _x_1_0::_Tuple2 0 in case (Data.Maybe.isNothing maybesel_3_0) (True -> search.sr_find_def_imp_sel always_dialog_0 "" "" info_1 (select _x_1_2::_Tuple2 1)) (False -> let _x_5_0 = Data.Maybe.fromJust maybesel_3_0, selection_5_1 = select _x_5_0::_Tuple2 0, _x_5_2 = _SystemArray.usize_23 selection_5_1 in search.sr_find_def_imp_sel always_dialog_0 (<{search._c;101;31_195}> (StdList.or (<{search.c;100;60_158}> 0 (<{StdInt.-_7}> (select _x_5_2::_Tuple2 0) 1) (select _x_5_2::_Tuple2 1))) selection_5_1) (Data.Maybe.fromJust maybepath_1_3) info_1 (select _x_1_2::_Tuple2 1)) ) 
<{search._c;101;31_195}> !_x_0::B selection_1 = case _x_0 (True -> "") (False -> selection_1) 
search.sr_find_def !always_dialog_0::B !pstate_1 = let _x_1_0 = IdeState.getFBI pstate_1 in search.sr_find_def_imp always_dialog_0 (update (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo [6:PmParse.Definition,7:fbi.SearchImports]) (select _x_1_0::_Tuple2 1)
search.sr_find_imp !always_dialog_0::B !pstate_1 = let _x_1_0 = IdeState.getFBI pstate_1 in search.sr_find_def_imp always_dialog_0 (update (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo [6:PmParse.Implementation,7:fbi.SearchImports]) (select _x_1_0::_Tuple2 1)
search.sw_maybe_close !win_0 !ps_1 = let _x_1_0 = IdeState.getFBI ps_1, _x_1_1 = select _x_1_0::_Tuple2 0, wind_1_2 = select _x_1_1::fbi._FindBoxInfo 12 in case (<{id.==_27}> win_0 wind_1_2) (True -> _Tuple2 True (search.sw_close wind_1_2 (search.wind_deac (select _x_1_0::_Tuple2 1)))) (False -> _Tuple2 False (select _x_1_0::_Tuple2 1)) 
search.wind_next !next_0::B !ps_1 = let _x_1_0 = IdeState.getFBI ps_1 in ExtListBox.exec_next next_0 (select (select _x_1_0::_Tuple2 0)::fbi._FindBoxInfo 13) (select _x_1_0::_Tuple2 1)
search.lsfun_95 !f_0 !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> f_0 (_Tuple2 ls_1_0 ps_1_1)) 
search.cont_83 !_vtoString_0 !col_1 !ps_2 = case (Data.Maybe.isNothing col_1) (True -> ps_2) (False -> StdClipboard.setClipboard (_predefined._Cons (StdClipboard.toClipboard_4 (select _vtoString_0::<{StdOverloaded.toString;}> 0 (Data.Maybe.fromJust col_1))) _predefined._Nil) ps_2) 
search.cont_159 !col_0 !ps_1 = case (Data.Maybe.isNothing col_0) (True -> ps_1) (False -> StdClipboard.setClipboard (_predefined._Cons (StdClipboard.toClipboard_4 (colourclip.toString_0 (Data.Maybe.fromJust col_0))) _predefined._Nil) ps_1) 
search.copyFun_90 rgbid_0 !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> _Tuple2 ls_1_0 (colorpickcontrol.getColourBoxColour rgbid_0 search.cont_159 ps_1_1)) 
search.toStringC_89 !c_0 = colourclip.toString_0 c_0
search.setBoxCol_92 fcid_0 bcid_1 !_x_2 = case _x_2 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> let _x_3_0 = <{search._c;870;23_196}> cur_2_4 fcid_0 fc_2_2 bcid_1 bc_2_3 in _Tuple2 ls_1_0 (StdPSt.appPIO (<{colorpickcontrol.SetColourBox`}> (select _x_3_0::_Tuple2 0) (StdPicture.toRGBColour (select _x_3_0::_Tuple2 1))) ps_1_1)) ) 
<{search._c;870;23_196}> !cur_0 fcid_1 fc_2 bcid_3 bc_4 = case cur_0 (search.TXT -> _Tuple2 fcid_1 fc_2) (search.BCK -> _Tuple2 bcid_3 bc_4) 
search.pasteFun_91 rgb_0 fcid_1 bcid_2 !_x_3 = case _x_3 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> let _x_3_0 = StdClipboard.getClipboard ps_1_1, its_3_1 = select _x_3_0::_Tuple2 0 in case (StdList.isEmpty its_3_1) (True -> _Tuple2 ls_1_0 (select _x_3_0::_Tuple2 1)) (False -> let its_5_0 = StdList.map StdClipboard.fromClipboard_3 its_3_1, its_5_1 = StdList.filter Data.Maybe.isJust its_5_0 in case (StdList.isEmpty its_5_1) (True -> _Tuple2 ls_1_0 (select _x_3_0::_Tuple2 1)) (False -> let it_7_0 = Data.Maybe.fromJust (StdList.hd its_5_1) in case (StdBool.not (<{StdString.==_2}> it_7_0 (search.toStringC_89 (colourclip.fromString_1 it_7_0)))) (True -> _Tuple2 ls_1_0 (select _x_3_0::_Tuple2 1)) (False -> let _x_9_0 = search.setBoxCol_92 fcid_1 bcid_2 (_Tuple2 (<{search._c;863;23_197}> cur_2_4 ls_1_0 col_9_1) (select _x_3_0::_Tuple2 1)), col_9_1 = colourclip.fromString_1 it_7_0 in _Tuple2 (select _x_9_0::_Tuple2 0) (<{colorpickcontrol.setColourBoxColour`}> rgb_0 col_9_1 (select _x_9_0::_Tuple2 1))) ) ) ) ) 
<{search._c;863;23_197}> !cur_0 !ls_1 !col_2 = case cur_0 (search.TXT -> update ls_1::search._SWO [2:col_2]) (search.BCK -> update ls_1::search._SWO [3:col_2]) 
search.apply_96 !_x_0 = case _x_0 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> let _x_3_0 = IdeState.getFBI ps_1_1, fbi_3_1 = select _x_3_0::_Tuple2 0, _x_3_2 = ioutil.accScreenPicture_21 (ioutil.safeOpenFixedFont (StdPictureDef._FontDef fn_2_0 _predefined._Nil fs_2_1)) (select _x_3_0::_Tuple2 1), fnt_3_3 = select _x_3_2::_Tuple2 0 in _Tuple2 ls_1_0 (IdeState.setFBI (update fbi_3_1::fbi._FindBoxInfo [15:fnt_3_3,16:fc_2_2,17:bc_2_3]) (ExtListBox.setExtListBoxPen (select fbi_3_1::fbi._FindBoxInfo 13) (_predefined._Cons (StdPictureDef.PenColour fc_2_2) (_predefined._Cons (StdPictureDef.PenBack bc_2_3) (_predefined._Cons (StdPictureDef.PenFont fnt_3_3) _predefined._Nil))) (select _x_3_2::_Tuple2 1)))) ) 
search.cont2_82 !col_0 !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> search.apply_96 (_Tuple2 (<{search._c;833;23_198}> cur_2_4 ls_1_0 col_0) ps_1_1)) ) 
<{search._c;833;23_198}> !cur_0 !ls_1 !col_2 = case cur_0 (search.TXT -> update ls_1::search._SWO [2:col_2]) (search.BCK -> update ls_1::search._SWO [3:col_2]) 
search.cont_81 lsid_0 !col_1 !ps_2 = case (Data.Maybe.isNothing col_1) (True -> ps_2) (False -> select (StdReceiver.asyncSend lsid_0 (search.cont2_82 (Data.Maybe.fromJust col_1)) ps_2)::_Tuple2 1) 
search.applyFun_88 rgbid_0 lsid_1 !_x_2 = case _x_2 (_Tuple2 ls_1_0 ps_1_1 -> _Tuple2 ls_1_0 (colorpickcontrol.getColourBoxColour rgbid_0 (search.cont_81 lsid_1) ps_1_1)) 
search.cancelFun_87 inistate_0 dialog_1 !_x_2 = case _x_2 (_Tuple2 ls_1_0 ps_1_1 -> let _x_2_0 = search.apply_96 (_Tuple2 inistate_0 ps_1_1) in _Tuple2 (select _x_2_0::_Tuple2 0) (StdWindow.closeWindow dialog_1 (select _x_2_0::_Tuple2 1))) 
search.cont2_80 dialog_0 col_1 !_x_2 = case _x_2 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> let _x_3_0 = search.apply_96 (_Tuple2 (<{search._c;813;23_199}> cur_2_4 ls_1_0 col_1) ps_1_1) in _Tuple2 (select _x_3_0::_Tuple2 0) (StdWindow.closeWindow dialog_0 (select _x_3_0::_Tuple2 1))) ) 
<{search._c;813;23_199}> !cur_0 !ls_1 !col_2 = case cur_0 (search.TXT -> update ls_1::search._SWO [2:col_2]) (search.BCK -> update ls_1::search._SWO [3:col_2]) 
search.cont_79 dialog_0 lsid_1 !col_2 !ps_3 = case (Data.Maybe.isNothing col_2) (True -> ps_3) (False -> select (StdReceiver.asyncSend lsid_1 (search.cont2_80 dialog_0 (Data.Maybe.fromJust col_2)) ps_3)::_Tuple2 1) 
search.okFun_86 rgbid_0 lsid_1 dialog_2 !_x_3 = case _x_3 (_Tuple2 ls_1_0 ps_1_1 -> _Tuple2 ls_1_0 (colorpickcontrol.getColourBoxColour rgbid_0 (search.cont_79 dialog_2 lsid_1) ps_1_1)) 
search.mfilter_93::B !_x_0 = case _x_0 (StdIOCommon.MouseDown _x_1_0 _x_1_1 _x_1_2 -> True) (_ -> False)
search.cont2_85 act_0 col_1 !_x_2 = case _x_2 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> _Tuple2 (<{search._c;916;23_200}> cur_2_4 ls_1_0 col_1 act_0) ps_1_1) ) 
<{search._c;916;23_200}> !cur_0 !ls_1 !col_2 !act_3 = case cur_0 (search.TXT -> update ls_1::search._SWO [2:col_2,4:act_3]) (search.BCK -> update ls_1::search._SWO [3:col_2,4:act_3]) 
search.cont_84 lsid_0 rgbid_1 bcid_2 bc_3 fcid_4 fc_5 cur_6 act_7 !col_8 !ps_9 = case (Data.Maybe.isNothing col_8) (True -> ps_9) (False -> let col_2_0 = Data.Maybe.fromJust col_8 in select (StdReceiver.asyncSend lsid_0 (search.cont2_85 act_7 col_2_0) (<{colorpickcontrol.setColourBoxColour`}> rgbid_1 (<{search._c;908;22_201}> act_7 fc_5 bc_3) (colorpickcontrol.setColourBoxId rgbid_1 (<{search._c;905;21_202}> act_7 fcid_4 bcid_2) (StdPSt.appPIO (<{search._c;895;31_205}> act_7 bcid_2 cur_6 col_2_0 bc_3) (StdPSt.appPIO (<{search._c;885;31_208}> act_7 fcid_4 cur_6 col_2_0 fc_5) ps_9)))))::_Tuple2 1) 
<{search._c;885;31_208}> !act_0 fcid_1 cur_2 col_3 fc_4 = case act_0 (search.TXT -> <{colorpickcontrol.SetColourBox`}> fcid_1 (<{search._c;886;60_206}> cur_2 col_3 fc_4)) (_ -> colorpickcontrol.SetColourBox fcid_1 (<{search._c;890;59_207}> cur_2 col_3 fc_4))
<{search._c;890;59_207}> !cur_0 col_1 fc_2 = case cur_0 (search.TXT -> StdPicture.toRGBColour col_1) (_ -> StdPicture.toRGBColour fc_2)
<{search._c;886;60_206}> !cur_0 col_1 fc_2 = case cur_0 (search.TXT -> StdPicture.toRGBColour col_1) (_ -> StdPicture.toRGBColour fc_2)
<{search._c;895;31_205}> !act_0 bcid_1 cur_2 col_3 bc_4 = case act_0 (search.BCK -> <{colorpickcontrol.SetColourBox`}> bcid_1 (<{search._c;896;60_203}> cur_2 col_3 bc_4)) (_ -> colorpickcontrol.SetColourBox bcid_1 (<{search._c;900;59_204}> cur_2 col_3 bc_4))
<{search._c;900;59_204}> !cur_0 col_1 bc_2 = case cur_0 (search.BCK -> StdPicture.toRGBColour col_1) (_ -> StdPicture.toRGBColour bc_2)
<{search._c;896;60_203}> !cur_0 col_1 bc_2 = case cur_0 (search.BCK -> StdPicture.toRGBColour col_1) (_ -> StdPicture.toRGBColour bc_2)
<{search._c;905;21_202}> !act_0 fcid_1 bcid_2 = case act_0 (search.TXT -> fcid_1) (search.BCK -> bcid_2) 
<{search._c;908;22_201}> !act_0 fc_1 bc_2 = case act_0 (search.TXT -> fc_1) (search.BCK -> bc_2) 
<{search.==_99}>::B !_x_0 !_x_1 = case _x_0 (search.TXT -> case _x_1 (search.TXT -> True) ) (search.BCK -> case _x_1 (search.BCK -> True) ) (_ -> False)
search.mfun_94 rgbid_0 lsid_1 fcid_2 bcid_3 !act_4 _x_5 !_x_6 = case _x_6 (_Tuple2 ls_1_0 ps_1_1 -> case ls_1_0 (search._SWO fn_2_0 fs_2_1 fc_2_2 bc_2_3 cur_2_4 -> case (<{search.==_99}> act_4 cur_2_4) (True -> _Tuple2 ls_1_0 ps_1_1) (False -> _Tuple2 ls_1_0 (colorpickcontrol.getColourBoxColour rgbid_0 (search.cont_84 lsid_1 rgbid_0 bcid_3 bc_2_3 fcid_2 fc_2_2 cur_2_4 act_4) ps_1_1)) ) ) 
search.sizefun_98 size_0::I !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> _Tuple2 (update ls_1_0::search._SWO [1:size_0]) ps_1_1) 
search.fontfun_97 name_0 !_x_1 = case _x_1 (_Tuple2 ls_1_0 ps_1_1 -> _Tuple2 (update ls_1_0::search._SWO [0:name_0]) ps_1_1) 
search.src_options !ps_0 = let Controls_1_0 = <{StdControlClass.Controls;}> morecontrols.controlToHandles_0 morecontrols.getControlType_1, Controls_1_1 = <{StdControlClass.Controls;}> colorpickcontrol.controlToHandles_9 colorpickcontrol.getControlType_10, Controls_1_2 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_0 Controls_1_1) (StdControlClass.getControlType_9 Controls_1_0 Controls_1_1), Controls_1_3 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_22 Controls_1_2) (StdControlClass.getControlType_23 Controls_1_2), Controls_1_4 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_30 StdControlClass.getControlType_31, Controls_1_5 = <{StdControlClass.Controls;}> colorpickcontrol.controlToHandles_13 colorpickcontrol.getControlType_14, Controls_1_6 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_30 StdControlClass.getControlType_31, Controls_1_7 = <{StdControlClass.Controls;}> colorpickcontrol.controlToHandles_13 colorpickcontrol.getControlType_14, Controls_1_8 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_6 Controls_1_7) (StdControlClass.getControlType_9 Controls_1_6 Controls_1_7), Controls_1_9 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_5 Controls_1_8) (StdControlClass.getControlType_9 Controls_1_5 Controls_1_8), Controls_1_10 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_4 Controls_1_9) (StdControlClass.getControlType_9 Controls_1_4 Controls_1_9), Controls_1_11::I = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_22 Controls_1_10) (StdControlClass.getControlType_23 Controls_1_10), Controls_1_12 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_1_13 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_1_14 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_1_15 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_1_16 = <{StdControlClass.Controls;}> StdControlClass.controlToHandles_10 StdControlClass.getControlType_11, Controls_1_17 = <{StdControlClass.Controls;}> StdControlReceiver.controlToHandles_0 StdControlReceiver.getControlType_1, Controls_1_18 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_16 Controls_1_17) (StdControlClass.getControlType_9 Controls_1_16 Controls_1_17), Controls_1_19 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_15 Controls_1_18) (StdControlClass.getControlType_9 Controls_1_15 Controls_1_18), Controls_1_20 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_14 Controls_1_19) (StdControlClass.getControlType_9 Controls_1_14 Controls_1_19), Controls_1_21 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_13 Controls_1_20) (StdControlClass.getControlType_9 Controls_1_13 Controls_1_20), Controls_1_22 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_12 Controls_1_21) (StdControlClass.getControlType_9 Controls_1_12 Controls_1_21), Controls_1_23 = <{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_11 Controls_1_22) (StdControlClass.getControlType_9 Controls_1_11 Controls_1_22), _x_1_24 = StdId.openId_13 ps_0, _x_1_25 = StdId.openId_13 (select _x_1_24::_Tuple2 1), _x_1_26 = StdId.openId_13 (select _x_1_25::_Tuple2 1), _x_1_27 = colorpickcontrol.openRGBId (<{StdId.Ids;}> StdId.openId_13 StdId.openIds_14 StdId.openR2Id_15 StdId.openR2Ids_16 StdId.openRId_17 StdId.openRIds_18) (select _x_1_26::_Tuple2 1), _x_1_28 = StdId.openId_13 (select _x_1_27::_Tuple2 1), _x_1_29 = StdId.openId_13 (select _x_1_28::_Tuple2 1), _x_1_30 = StdId.openRId_17 (select _x_1_29::_Tuple2 1), _x_1_31 = StdPSt.accPIO (StdPSt.accScreenPicture_13 StdPicture.getFontNames) (select _x_1_30::_Tuple2 1), _x_1_32 = IdeState.getFBI (select _x_1_31::_Tuple2 1), fbi_1_33 = select _x_1_32::_Tuple2 0, fdef_1_34 = StdPicture.getFontDef (select fbi_1_33::fbi._FindBoxInfo 15), inifn_1_35 = select fdef_1_34::StdPictureDef._FontDef 0, inifs_1_36 = select fdef_1_34::StdPictureDef._FontDef 2, inifc_1_37 = select fbi_1_33::fbi._FindBoxInfo 16, inibc_1_38 = select fbi_1_33::fbi._FindBoxInfo 17, inistate_1_39 = search._SWO inifn_1_35 inifs_1_36 inifc_1_37 inibc_1_38 search.TXT, left_1_40 = StdControlDef.ControlPos (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32), rgbid_1_41 = select _x_1_27::_Tuple2 0, fcid_1_42 = select _x_1_28::_Tuple2 0, lsid_1_43 = select _x_1_30::_Tuple2 0, bcid_1_44 = select _x_1_29::_Tuple2 0, ok_1_45 = select _x_1_25::_Tuple2 0, dialog_1_46 = select _x_1_24::_Tuple2 0, cancel_1_47 = select _x_1_26::_Tuple2 0 in select (StdWindow.openModalDialog_58 (<{StdControlClass.Controls;}> (StdControlClass.controlToHandles_8 Controls_1_3 Controls_1_23) (StdControlClass.getControlType_9 Controls_1_3 Controls_1_23)) inistate_1_39 (StdWindowDef.Dialog "Search Window..." (<{StdIOBasic.:+:}> (StdControlDef.LayoutControl (<{StdIOBasic.:+:}> (morecontrols.FontNameSizeControl inifn_1_35 inifs_1_36 (select _x_1_31::_Tuple2 0) (_predefined._Cons 7 (_predefined._Cons 8 (_predefined._Cons 9 (_predefined._Cons 10 (_predefined._Cons 11 (_predefined._Cons 12 _predefined._Nil)))))) search.fontfun_97 search.sizefun_98 (_predefined._Cons left_1_40 _predefined._Nil)) (<{colorpickcontrol.RGBColourPickControl`}> rgbid_1_41 inifc_1_37 fcid_1_42 (Data.Maybe.Just (_Tuple2 StdIOCommon.Left StdIOCommon.zero_32)))) _predefined._Nil) (<{StdIOBasic.:+:}> (StdControlDef.LayoutControl (<{StdIOBasic.:+:}> (StdControlDef.TextControl "Text:" (_predefined._Cons left_1_40 (_predefined._Cons (StdControlDef.ControlWidth (StdControlDef.ContentWidth "Background: ")) _predefined._Nil))) (<{StdIOBasic.:+:}> (<{colorpickcontrol.ColourBoxControl`}> (StdPicture.toRGBColour inifc_1_37) fcid_1_42 (_Tuple2 search.mfilter_93 (search.mfun_94 rgbid_1_41 lsid_1_43 fcid_1_42 bcid_1_44 search.TXT)) Data.Maybe.Nothing) (<{StdIOBasic.:+:}> (StdControlDef.TextControl "Background:" (_predefined._Cons left_1_40 (_predefined._Cons (StdControlDef.ControlWidth (StdControlDef.ContentWidth "Background: ")) _predefined._Nil))) (<{colorpickcontrol.ColourBoxControl`}> (StdPicture.toRGBColour inibc_1_38) bcid_1_44 (_Tuple2 search.mfilter_93 (search.mfun_94 rgbid_1_41 lsid_1_43 fcid_1_42 bcid_1_44 search.BCK)) Data.Maybe.Nothing)))) _predefined._Nil) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Ok" (_predefined._Cons (StdControlDef.ControlId ok_1_45) (_predefined._Cons (StdControlDef.ControlFunction (search.okFun_86 rgbid_1_41 lsid_1_43 dialog_1_46)) (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.Right StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlWidth (StdControlDef.ContentWidth "Cancel")) _predefined._Nil))))) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Cancel" (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.LeftOfPrev StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlFunction (search.cancelFun_87 inistate_1_39 dialog_1_46)) (_predefined._Cons (StdControlDef.ControlId cancel_1_47) _predefined._Nil)))) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Apply" (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.LeftOfPrev StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlFunction (search.applyFun_88 rgbid_1_41 lsid_1_43)) _predefined._Nil))) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Paste" (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.LeftOfPrev StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlFunction (search.pasteFun_91 rgbid_1_41 fcid_1_42 bcid_1_44)) _predefined._Nil))) (<{StdIOBasic.:+:}> (StdControlDef.ButtonControl "Copy" (_predefined._Cons (StdControlDef.ControlPos (_Tuple2 StdIOCommon.LeftOfPrev StdIOCommon.zero_32)) (_predefined._Cons (StdControlDef.ControlFunction (search.copyFun_90 rgbid_1_41)) _predefined._Nil))) (StdReceiverDef.Receiver lsid_1_43 search.lsfun_95 _predefined._Nil)))))))) (_predefined._Cons (StdWindowDef.WindowId dialog_1_46) (_predefined._Cons (StdWindowDef.WindowOk ok_1_45) (_predefined._Cons (StdWindowDef.WindowCancel cancel_1_47) (_predefined._Cons (StdWindowDef.WindowClose (search.cancelFun_87 inistate_1_39 dialog_1_46)) (_predefined._Cons (StdWindowDef.WindowInit (search.setBoxCol_92 fcid_1_42 bcid_1_44)) _predefined._Nil)))))) (select _x_1_32::_Tuple2 1))::_Tuple2 1
<{search.TD;SWO}> _x_0::B = _predefined._Nil
<{search.TD;SWO_LS}> _x_0::B = _predefined._Nil

:: search.SWO_LS = search.TXT | search.BCK

|| Converted Records
:: search._SWO = {!search.fn, !search.fs::I, !search.fc, !search.bc, !search.cur}

:: <{search.gEq_s;}> = {!search.gEq_s}

:: <{search.gEq_ss;}> = {!search.gEq_ss}

:: <{search.gEq_sss;}> = {!search.gEq_sss}

:: <{search.gEq_ssss;}> = {!search.gEq_ssss}

:: <{search.gEq_sssss;}> = {!search.gEq_sssss}

:: <{search.gEq_ssssss;}> = {!search.gEq_ssssss}

:: <{search.gEq_sssssss;}> = {!search.gEq_sssssss}

:: <{search.gEq_ssssssss;}> = {!search.gEq_ssssssss}

:: <{search.gEq_sssssssss;}> = {!search.gEq_sssssssss}

:: <{search.bimap_s;}> = {search.bimap_s}

:: <{search.bimap_ss;}> = {search.bimap_ss}

:: <{search.bimap_sss;}> = {search.bimap_sss}

