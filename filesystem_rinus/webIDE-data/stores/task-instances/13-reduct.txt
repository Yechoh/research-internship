20170209-112755{"task":["_DYNAMICENCODE_","gipdADIzWwBii1wACudcABqbWwBu_1wARiJdAD7TWgB2-10A0v1dAA7TWgB2_V0ADtNaANrRWgDSZFsAuNVFAA7TWgDa0VoABmVbAHb9XQAO01oA2tFaAPH___92_V0ADtNaANrRWgBuZVsA0v1dAA7TWgBCA14ABgNeAA7TWgBm0VoAAAAAAObSWgB2_V0ADtNaANrRWgDSZFsAuNVFAA7TWgDa0VoABmVbAMzRRQAO01oA2tFaAMplWwB2_V0ADtNaANrRWgA6ZVsA0v1dAA7TWgDS_V0ADtNaAEIDXgAGA14A5tJaABYFXgBm0VoAAQAAANJFXQDSSl0AXFFMAIn___8O01oA0v9dAE7-XQB5____lmVbAMIxXQAO01oAZtFaAAEAAAAO01oAVf___1n___8O01oAQgNeAO77XQAO01oA3f___0H___9Kc1sAOf___w7TWgBCA14A4vxdACn____-ZVsAdv1dAA7TWgDa0VoA0mRbAHb9XQAO01oA2tFaANJkWwDS_V0ADtNaAEIDXgAGA14ADtNaAIX____p_v__dv1dAA7TWgDa0VoA6mFbAHDXRQAO01oA2tFaAB5iWwAk2EUADtNaANrRWgBSYlsA8NhFAA7TWgDa0VoAlmRbABTaRQAO01oA2tFaAEYiXQB-0VoAAQAAAEIDXgDi_F0Ahf7__z5kWwCY2kUAef7__w7TWgB6B14Abf7__w7TWgBd_v__Yf7__1hsUQBGIl0AftFaAAEAAAA2B14AwjFdAA7TWgCi01oAMtFaAAUAAAB0aXRsZQAAAC3-__8O01oAdv1dAA7TWgDa0VoAvmFbAAgSVgAO01oABf7__wn-__8F_v__DtNaAJIJXgAuSl0A9f3___H9__8O01oA2tFaAFz1RQDM0UUADtNaANrRWgDw90UAPNNFAA7TWgDa0VoARiJdAH7RWgABAAAAwANWALX9__-N_v__lNRFAKn9__8O01oAkgleAKX___-Z_f__DtNaANrRWgDw90UAyAlWAA7TWgDAA1YAff3__1X-__-U1EUADtNaABydVgAKSl0AZf3__2H9__8O01oA2tFaAEYiXQB-0VoAAQAAAMADVgBF_f__Hf7__5TURQA5_f__DtNaANL9XQAO01oAQgNeAAYDXgDm0loAFgVeAGbRWgABAAAA0kVdAH39__9cUUwABf3__w7TWgDS_10ATv5dAPX8__-WZVsAwjFdAA7TWgB9_f__DtNaANX8___Z_P__DtNaAEIDXgDu-10ADtNaAF39___B_P__SnNbALn8__8O01oAkgleALX-__-p_P__DtNaANrRWgBGIl0AftFaAAEAAADS_V0ADtNaAFoFXgAO01oAdv1dAA7TWgDa0VoAJfz__7jVRQAO01oA2tFaACX8__92_V0ADtNaANrRWgAV_P__dv1dAA7TWgDa0VoAJfz__8gJVgAO01oAMGNWAA7TWgAp_P__Lfz__5TURQAO01oAzPVFAA7TWgAcnVYAHf7__xH8__8O01oA2tFaAEYiXQB-0VoAAQAAANL9XQAO01oAaf___w7TWgB2_V0ADtNaANrRWgCN-___uNVFAA7TWgDa0VoAjfv__3b9XQAO01oA2tFaAH37__92_V0ADtNaANrRWgCN-___0v1dAA7TWgBCA14ABgNeAA7TWgCN-___kfv__3b9XQAO01oA2tFaADH7__92_V0ADtNaANrRWgAh-___0v1dAA7TWgBCA14ABgNeAA7TWgDx-___Vfv__3b9XQAO01oA2tFaAOphWwBw10UADtNaANrRWgAeYlsAJNhFAA7TWgDa0VoAUmJbAPDYRQAO01oA2tFaAG38__8U2kUADtNaANrRWgBGIl0AftFaAAEAAABCA14A4vxdAPH6__9t_P__mNpFAOX6__8O01oAegdeANn6__8O01oAyfr__836__9YbFEARiJdAH7RWgABAAAAbfz__8IxXQAO01oAotNaADLRWgAFAAAAdGl0bGUAAACZ-v__DtNaAHb9XQAO01oA2tFaAG38__8IElYADtNaAHH6__91-v__cfr__w7TWgCSCV4Abfz__2H6__9d-v__DtNaANrRWgBc9UUAzNFFAA7TWgDa0VoA8PdFADzTRQAO01oA2tFaAEYiXQB-0VoAAQAAAMADVgAh-v__-fr__5TURQAV-v__DtNaANL9XQAO01oAQgNeAAYDXgD9-f__FgVeAI36___SRV0AXfr__1xRTADl-f__DtNaANL_XQBO_l0A1fn__5ZlWwDCMV0ADtNaAF36__8O01oAtfn__7n5__8O01oAQgNeAO77XQAO01oAPfr__6H5__9Kc1sAmfn__w7TWgCSCV4Alfv__4n5__8O01oA2tFaAEYiXQB-0VoAAQAAAMgJVgAO01oAeINWAA7TWgCU1EUAXfn__1n5__9V-f__DtNaANrRWgDw90UAPNNFAA7TWgDa0VoARiJdAH7RWgABAAAAwANWACn5__8B-v__lNRFAB35__8Z-f__Ffn__xH5__8O01oA2tFaAPD3RQA800UADtNaANrRWgBGIl0AftFaAAEAAADAA1YA5fj__735__-U1EUA2fj__9X4___R-P__zfj__w7TWgDa0VoA8PdFADzTRQAO01oA2tFaAEYiXQB-0VoAAQAAAMADVgCh-P__efn__5TURQCV-P__DtNaANL_XQDG_l0Ahfj__1ZmWwCeMV0ADtNaALYIXgC8ZFIAektdAP3___9l-P__GptbAG7_XABGIl0A6ff__z6YWwDeCF0A3ghdALoIXQCOC10A3ghdAN4IXQC6CF0A8f___94IXQC6CF0AOhBdALoIXQCmCV0A3ghdALoIXQCOCl0A3ghdALoIXQDh____ughdAOH____eCF0AughdANoxXQDeCF0AughdAMH___-6CF0Awf___2KLXABO2FoAYotcAILYWgBGIl0ASf___w7TWgBWhVsAFvpdAD7bWgCx9___PphbAN4IXQC6CF0Aff___7oIXQB9____YotcAIo9XQBii1wApjpdAEYiXQAF____DtNaAFaFWwAW-l0A2uRaAJ7fWgBp9___ji5dAN4IXQC6CF0ANf___7oIXQA1____YotcALn___9ii1wAuf___z7QXQDeCF0AughdAA3___-6CF0ADf___9YHXQAiIF0AguRaAA=="],"tree":["TCLayout",[[1,[0,[0,[["ChildBranchLayout",[[0,["BranchLayout",[2,[0,[[["BranchLayout",null],[[2,["BranchMoved"]],[3,["BranchMoved"]],[4,["BranchMoved"]],[5,["BranchMoved"]]],["ChildBranchLayout",[[1,["ChildBranchLayout",[[0,["BranchLayout",null]],[1,["BranchLayout",null]],[2,["BranchLayout",null]],[3,["BranchLayout",null]]]]]]]],["ChildBranchLayout",[[0,["BranchLayout",[0,[0,[["ChildBranchLayout",[[1,["BranchLayout",[4,["ChildBranchLayout",[]]]]]]],null,null,null]]]]]]],null]]]]]]],[["BranchLayout",null],[[2,["BranchMoved"]]],["ChildBranchLayout",[[1,["ChildBranchLayout",[[0,["BranchLayout",null]]]]]]]],null]]]],[],null],["TCStep",["TaskId",13,0],6,["Right",[["Value",[["C:\\Users\\Martin\\Documents\\clean-classic-itasks-windows-x86-20161223\\Libraries\\iTasks-SDK\\research internship\\filesystem_rinus",["Clean System Files","sapl","webIDE-data","createAndRunExec.dcl","createAndRunExec.icl","directoryBrowsing.dcl","directoryBrowsing.icl","webIDE.icl","webIDE.prj"]],["Just","webIDE.icl"]],true],0,["TCStep",["TaskId",13,38],6,["Right",[["Value","module webIDE\r\n\r\nimport iTasks\r\n\r\nimport iTasks.API.Extensions.Admin.WorkflowAdmin\r\nimport iTasks.UI.Layout, iTasks.UI.Definition, iTasks.UI.Editor.Builtin\r\nimport iTasks.API.Extensions.Editors.Ace\r\nimport StdFile, System.File\r\nimport System.Directory\r\nimport System.FilePath\r\nimport Data.Error\r\n\r\nimport createAndRunExec\r\nimport directoryBrowsing\r\n\r\n\/\/ -------------\r\n\r\nimport qualified Data.Map as DM\r\n:: Settings = \t{ dirCpm \t:: FilePath\r\n\t\t\t\t, dirClean\t:: FilePath\r\n\t\t\t\t}\r\nderive class iTask Settings\r\n\r\nsettings = sharedStore \"settings\" \t{ dirCpm = \"C:\/Users\/Martin\/Documents\/clean-classic-itasks-windows-x86-20161223\/cpm.exe\"\r\n\t\t\t\t\t\t\t\t\t, dirClean = \"C:\/Users\/Martin\/Documents\/clean-classic-itasks-windows-x86-20161223\"\r\n\t\t\t\t\t\t\t\t\t}\r\nupdSettings \r\n\t= \t\tupdateSharedInformation \"Current Setting: \" [] settings\r\n\r\n\/\/ utility functions\r\n\r\nisCleanFile file = isMember (takeExtension file) [\"icl\", \"dcl\", \"prj\", \"abc\", \"sapl\"]\r\n\r\nselectIcon pwd _ \t = Nothing\t\/\/ don't know where to store icons yet\r\nselectIcon pwd \"icl\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.icl.ico\")\r\nselectIcon pwd \"dcl\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.dcl.ico\")\r\nselectIcon pwd \"prj\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.prj.ico\")\r\nselectIcon pwd \"abc\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.abc.ico\")\r\nselectIcon pwd _ \t = Nothing\r\n\r\n\/\/ missing operator hack for avoiding continues \r\n\r\n(>>|-) infixl 1 :: (Task a) (Task b) -> Task b | iTask a & iTask b\r\n(>>|-) ma mb = ma >>- \\_ -> mb\r\n\r\n\/\/ -------------\r\n\r\nStart :: *World -> *World\r\nStart world = startEngine (manageWorklist ide) world\r\n\/\/Start world = startEngine ideDashboard world\r\n\r\n\/\/ ------------- to do:\r\n\r\nideDashboard :: Task ()\r\nideDashboard\r\n\t=  \tforever treePanel <<@ ApplyLayout layout\r\nwhere\r\n\ttreePanel = treeEdit2\r\n\r\n\tlayout = sequenceLayouts\r\n\t\t[ arrangeWithSideBar 0 LeftSide 260 True\r\n\t\t]\r\n\r\ntreeEdit2 :: Task ()\r\ntreeEdit2 \r\n\t=\t\t\t\tgetPwdName\r\n \t>>= \\pwd ->\t\tselectFromTree pwd isCleanFile\r\n\/\/\t>>= \\path ->\tviewInformation \"selected fule\" [] path\r\n\t>^*\t\t\t\t[ \tOnAction  (Action \"Open\") (hasValue edit2)\r\n\t \t\t\t\t]\r\n\t>>|\t\t\t\treturn ()\r\nwhere\r\n edit2 path\r\n\t=\t\t\t\treadFromFile path\r\n\t>>= \\content ->\tappendTopLevelTask ('DM'.fromList [(\"title\",\"malcom x\")]) True (editFile path (dropDirectory path) content)\r\n\t\t\t\t\t\t <<@ ToWindow FloatingWindow AlignMiddle AlignCenter\r\n\t>>|-\t\t\treturn ()\r\n\r\n\/\/ ------------- ide try outs\r\n\r\nide :: [Workflow]\r\nide =\r\n\t[ workflow \"Brose & Edit\"\t\t\"Browse and Edit a file\" \t\tbrowseEdit\r\n\t, workflow \"Tree browse & Edit\"\t\"Browse and Edit a file\" \t\ttreeEdit\r\n\t, workflow \"Settings\"\t\t\t\"View and change settings\"  \tupdSettings\r\n\r\n\t, workflow \"Browse\"\t\t\t\t\"Browse through file system\" \t(browseDirectory isCleanFile <<@ ApplyLayout (toWindow FloatingWindow AlignTop AlignLeft))\r\n\t]\r\n\r\ntreeEdit :: Task ()\r\ntreeEdit \r\n\t=\t\t\t\t\t\t\tgetPwdName\r\n \t>>= \\pwd ->\t\t\t\t\tselectFromTree pwd isCleanFile \r\n\t>>= \\path ->\t\t\t\tviewInformation \"selected fule\" [] path\r\n\t>>= \\path ->\t\t\t\treadFromFile path\r\n\t>>- \\content -> \t\t\teditFile (takeDirectory path) (dropDirectory path) content\r\n\r\nbrowseEdit :: Task ()\r\nbrowseEdit \r\n\t=\t\t\t\t\t\t\tbrowseDirectory isCleanFile\r\n\t>>- \\((path,_),mbName) -> \t\r\n\tif (isNothing mbName)\t\t(return ())\r\n\t(\t\t\t\t\t\t\treadFromFile (path <\/> fromJust mbName)\r\n\t>>- \\content -> \t\t\teditFile path (fromJust mbName) content\r\n\t)\r\n\r\n\/\/ very simple editor\r\n\r\neditFile :: String String String -> Task ()\r\neditFile path name content \r\n= withShared content \r\n    (\\sc ->\r\n\t \t\t(updateSharedInformation (path <\/> name) [UpdateUsing id (\\_ nsc -> nsc) aceTextArea] sc)\t\t\t\t\/\/ seems to be a bug in the current UpdateUsing ... no change returned\r\n\r\n\t >^*\t[ \tOnAction  ActionSave    \t(hasValue (saveFile (path <\/> name)))\r\n\t \t\t,\tOnAction  ActionSaveAs\t\t(hasValue (saveFileAs (path <\/> name)))\r\n\t \t\t]\r\n\t \t\t++ \r\n\t \t\tif (takeExtension name <> \"icl\") []\r\n\t \t\t[\tOnAction (Action \"Build\")\t(hasValue (const (buildProject path (dropExtension name))))\r\n\t \t\t,\tOnAction (Action \"Run\")\t\t(always (runExec (path <\/> dropExtension name +++ \".exe\") 8080))\r\n\t \t\t]\r\n\t >>*\t[   OnAction  ActionQuit    \t(always (return ()))\r\n\t\t    ]\r\n\t)\r\nwhere\r\n\tsaveFile path content \r\n\t\t= writeToFile path content @! () \r\n\t\r\n\tsaveFileAs path content \r\n\t\t= \t\tupdateInformation \"Where to write to ?\" [] path\r\n\t\t>>*\t\t[\tOnAction ActionSave\t\t(hasValue (\\name -> saveFile name content))\r\n\t\t\t \t,\tOnAction ActionCancel\t(always (return ()))\r\n\t\t\t \t]\r\n\t\t\r\n\tbuildProject buildPath iclFileName \r\n\t\t= \t\t\t\t\tget settings \r\n\t\t>>- \\curSet ->\t\tviewInformation \"Calling cpm : \" [] (curSet.dirCpm, buildPath, iclFileName)\r\n\t\t>>|\t\t\t\t\tcreateExec curSet.dirCpm buildPath iclFileName\r\n\r\n\r\n\r\n\r\n\r\n",true],0,["TCShared",["TaskId",13,40],6,["TCStep",["TaskId",13,41],6,["Left",[["TCParallel",["TaskId",13,42],5,[[["TaskId",13,43],["TCInteract",["TaskId",13,43],6,"module webIDE\r\n\r\nimport iTasks\r\n\r\nimport iTasks.API.Extensions.Admin.WorkflowAdmin\r\nimport iTasks.UI.Layout, iTasks.UI.Definition, iTasks.UI.Editor.Builtin\r\nimport iTasks.API.Extensions.Editors.Ace\r\nimport StdFile, System.File\r\nimport System.Directory\r\nimport System.FilePath\r\nimport Data.Error\r\n\r\nimport createAndRunExec\r\nimport directoryBrowsing\r\n\r\n\/\/ -------------\r\n\r\nimport qualified Data.Map as DM\r\n:: Settings = \t{ dirCpm \t:: FilePath\r\n\t\t\t\t, dirClean\t:: FilePath\r\n\t\t\t\t}\r\nderive class iTask Settings\r\n\r\nsettings = sharedStore \"settings\" \t{ dirCpm = \"C:\/Users\/Martin\/Documents\/clean-classic-itasks-windows-x86-20161223\/cpm.exe\"\r\n\t\t\t\t\t\t\t\t\t, dirClean = \"C:\/Users\/Martin\/Documents\/clean-classic-itasks-windows-x86-20161223\"\r\n\t\t\t\t\t\t\t\t\t}\r\nupdSettings \r\n\t= \t\tupdateSharedInformation \"Current Setting: \" [] settings\r\n\r\n\/\/ utility functions\r\n\r\nisCleanFile file = isMember (takeExtension file) [\"icl\", \"dcl\", \"prj\", \"abc\", \"sapl\"]\r\n\r\nselectIcon pwd _ \t = Nothing\t\/\/ don't know where to store icons yet\r\nselectIcon pwd \"icl\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.icl.ico\")\r\nselectIcon pwd \"dcl\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.dcl.ico\")\r\nselectIcon pwd \"prj\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.prj.ico\")\r\nselectIcon pwd \"abc\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.abc.ico\")\r\nselectIcon pwd _ \t = Nothing\r\n\r\n\/\/ missing operator hack for avoiding continues \r\n\r\n(>>|-) infixl 1 :: (Task a) (Task b) -> Task b | iTask a & iTask b\r\n(>>|-) ma mb = ma >>- \\_ -> mb\r\n\r\n\/\/ -------------\r\n\r\nStart :: *World -> *World\r\nStart world = startEngine (manageWorklist ide) world\r\n\/\/Start world = startEngine ideDashboard world\r\n\r\n\/\/ ------------- to do:\r\n\r\nideDashboard :: Task ()\r\nideDashboard\r\n\t=  \tforever treePanel <<@ ApplyLayout layout\r\nwhere\r\n\ttreePanel = treeEdit2\r\n\r\n\tlayout = sequenceLayouts\r\n\t\t[ arrangeWithSideBar 0 LeftSide 260 True\r\n\t\t]\r\n\r\ntreeEdit2 :: Task ()\r\ntreeEdit2 \r\n\t=\t\t\t\tgetPwdName\r\n \t>>= \\pwd ->\t\tselectFromTree pwd isCleanFile\r\n\/\/\t>>= \\path ->\tviewInformation \"selected fule\" [] path\r\n\t>^*\t\t\t\t[ \tOnAction  (Action \"Open\") (hasValue edit2)\r\n\t \t\t\t\t]\r\n\t>>|\t\t\t\treturn ()\r\nwhere\r\n edit2 path\r\n\t=\t\t\t\treadFromFile path\r\n\t>>= \\content ->\tappendTopLevelTask ('DM'.fromList [(\"title\",\"malcom x\")]) True (editFile path (dropDirectory path) content)\r\n\t\t\t\t\t\t <<@ ToWindow FloatingWindow AlignMiddle AlignCenter\r\n\t>>|-\t\t\treturn ()\r\n\r\n\/\/ ------------- ide try outs\r\n\r\nide :: [Workflow]\r\nide =\r\n\t[ workflow \"Brose & Edit\"\t\t\"Browse and Edit a file\" \t\tbrowseEdit\r\n\t, workflow \"Tree browse & Edit\"\t\"Browse and Edit a file\" \t\ttreeEdit\r\n\t, workflow \"Settings\"\t\t\t\"View and change settings\"  \tupdSettings\r\n\r\n\t, workflow \"Browse\"\t\t\t\t\"Browse through file system\" \t(browseDirectory isCleanFile <<@ ApplyLayout (toWindow FloatingWindow AlignTop AlignLeft))\r\n\t]\r\n\r\ntreeEdit :: Task ()\r\ntreeEdit \r\n\t=\t\t\t\t\t\t\tgetPwdName\r\n \t>>= \\pwd ->\t\t\t\t\tselectFromTree pwd isCleanFile \r\n\t>>= \\path ->\t\t\t\tviewInformation \"selected fule\" [] path\r\n\t>>= \\path ->\t\t\t\treadFromFile path\r\n\t>>- \\content -> \t\t\teditFile (takeDirectory path) (dropDirectory path) content\r\n\r\nbrowseEdit :: Task ()\r\nbrowseEdit \r\n\t=\t\t\t\t\t\t\tbrowseDirectory isCleanFile\r\n\t>>- \\((path,_),mbName) -> \t\r\n\tif (isNothing mbName)\t\t(return ())\r\n\t(\t\t\t\t\t\t\treadFromFile (path <\/> fromJust mbName)\r\n\t>>- \\content -> \t\t\teditFile path (fromJust mbName) content\r\n\t)\r\n\r\n\/\/ very simple editor\r\n\r\neditFile :: String String String -> Task ()\r\neditFile path name content \r\n= withShared content \r\n    (\\sc ->\r\n\t \t\t(updateSharedInformation (path <\/> name) [UpdateUsing id (\\_ nsc -> nsc) aceTextArea] sc)\t\t\t\t\/\/ seems to be a bug in the current UpdateUsing ... no change returned\r\n\r\n\t >^*\t[ \tOnAction  ActionSave    \t(hasValue (saveFile (path <\/> name)))\r\n\t \t\t,\tOnAction  ActionSaveAs\t\t(hasValue (saveFileAs (path <\/> name)))\r\n\t \t\t]\r\n\t \t\t++ \r\n\t \t\tif (takeExtension name <> \"icl\") []\r\n\t \t\t[\tOnAction (Action \"Build\")\t(hasValue (const (buildProject path (dropExtension name))))\r\n\t \t\t,\tOnAction (Action \"Run\")\t\t(always (runExec (path <\/> dropExtension name +++ \".exe\") 8080))\r\n\t \t\t]\r\n\t >>*\t[   OnAction  ActionQuit    \t(always (return ()))\r\n\t\t    ]\r\n\t)\r\nwhere\r\n\tsaveFile path content \r\n\t\t= writeToFile path content @! () \r\n\t\r\n\tsaveFileAs path content \r\n\t\t= \t\tupdateInformation \"Where to write to ?\" [] path\r\n\t\t>>*\t\t[\tOnAction ActionSave\t\t(hasValue (\\name -> saveFile name content))\r\n\t\t\t \t,\tOnAction ActionCancel\t(always (return ()))\r\n\t\t\t \t]\r\n\t\t\r\n\tbuildProject buildPath iclFileName \r\n\t\t= \t\t\t\t\tget settings \r\n\t\t>>- \\curSet ->\t\tviewInformation \"Calling cpm : \" [] (curSet.dirCpm, buildPath, iclFileName)\r\n\t\t>>|\t\t\t\t\tcreateExec curSet.dirCpm buildPath iclFileName\r\n\r\n\r\n\r\n\r\n\r\n","module webIDE\r\n\r\nimport iTasks\r\n\r\nimport iTasks.API.Extensions.Admin.WorkflowAdmin\r\nimport iTasks.UI.Layout, iTasks.UI.Definition, iTasks.UI.Editor.Builtin\r\nimport iTasks.API.Extensions.Editors.Ace\r\nimport StdFile, System.File\r\nimport System.Directory\r\nimport System.FilePath\r\nimport Data.Error\r\n\r\nimport createAndRunExec\r\nimport directoryBrowsing\r\n\r\n\/\/ -------------\r\n\r\nimport qualified Data.Map as DM\r\n:: Settings = \t{ dirCpm \t:: FilePath\r\n\t\t\t\t, dirClean\t:: FilePath\r\n\t\t\t\t}\r\nderive class iTask Settings\r\n\r\nsettings = sharedStore \"settings\" \t{ dirCpm = \"C:\/Users\/Martin\/Documents\/clean-classic-itasks-windows-x86-20161223\/cpm.exe\"\r\n\t\t\t\t\t\t\t\t\t, dirClean = \"C:\/Users\/Martin\/Documents\/clean-classic-itasks-windows-x86-20161223\"\r\n\t\t\t\t\t\t\t\t\t}\r\nupdSettings \r\n\t= \t\tupdateSharedInformation \"Current Setting: \" [] settings\r\n\r\n\/\/ utility functions\r\n\r\nisCleanFile file = isMember (takeExtension file) [\"icl\", \"dcl\", \"prj\", \"abc\", \"sapl\"]\r\n\r\nselectIcon pwd _ \t = Nothing\t\/\/ don't know where to store icons yet\r\nselectIcon pwd \"icl\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.icl.ico\")\r\nselectIcon pwd \"dcl\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.dcl.ico\")\r\nselectIcon pwd \"prj\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.prj.ico\")\r\nselectIcon pwd \"abc\" = Just (pwd <\/> \"WebPublic\" <\/> \"Clean.abc.ico\")\r\nselectIcon pwd _ \t = Nothing\r\n\r\n\/\/ missing operator hack for avoiding continues \r\n\r\n(>>|-) infixl 1 :: (Task a) (Task b) -> Task b | iTask a & iTask b\r\n(>>|-) ma mb = ma >>- \\_ -> mb\r\n\r\n\/\/ -------------\r\n\r\nStart :: *World -> *World\r\nStart world = startEngine (manageWorklist ide) world\r\n\/\/Start world = startEngine ideDashboard world\r\n\r\n\/\/ ------------- to do:\r\n\r\nideDashboard :: Task ()\r\nideDashboard\r\n\t=  \tforever treePanel <<@ ApplyLayout layout\r\nwhere\r\n\ttreePanel = treeEdit2\r\n\r\n\tlayout = sequenceLayouts\r\n\t\t[ arrangeWithSideBar 0 LeftSide 260 True\r\n\t\t]\r\n\r\ntreeEdit2 :: Task ()\r\ntreeEdit2 \r\n\t=\t\t\t\tgetPwdName\r\n \t>>= \\pwd ->\t\tselectFromTree pwd isCleanFile\r\n\/\/\t>>= \\path ->\tviewInformation \"selected fule\" [] path\r\n\t>^*\t\t\t\t[ \tOnAction  (Action \"Open\") (hasValue edit2)\r\n\t \t\t\t\t]\r\n\t>>|\t\t\t\treturn ()\r\nwhere\r\n edit2 path\r\n\t=\t\t\t\treadFromFile path\r\n\t>>= \\content ->\tappendTopLevelTask ('DM'.fromList [(\"title\",\"malcom x\")]) True (editFile path (dropDirectory path) content)\r\n\t\t\t\t\t\t <<@ ToWindow FloatingWindow AlignMiddle AlignCenter\r\n\t>>|-\t\t\treturn ()\r\n\r\n\/\/ ------------- ide try outs\r\n\r\nide :: [Workflow]\r\nide =\r\n\t[ workflow \"Brose & Edit\"\t\t\"Browse and Edit a file\" \t\tbrowseEdit\r\n\t, workflow \"Tree browse & Edit\"\t\"Browse and Edit a file\" \t\ttreeEdit\r\n\t, workflow \"Settings\"\t\t\t\"View and change settings\"  \tupdSettings\r\n\r\n\t, workflow \"Browse\"\t\t\t\t\"Browse through file system\" \t(browseDirectory isCleanFile <<@ ApplyLayout (toWindow FloatingWindow AlignTop AlignLeft))\r\n\t]\r\n\r\ntreeEdit :: Task ()\r\ntreeEdit \r\n\t=\t\t\t\t\t\t\tgetPwdName\r\n \t>>= \\pwd ->\t\t\t\t\tselectFromTree pwd isCleanFile \r\n\t>>= \\path ->\t\t\t\tviewInformation \"selected fule\" [] path\r\n\t>>= \\path ->\t\t\t\treadFromFile path\r\n\t>>- \\content -> \t\t\teditFile (takeDirectory path) (dropDirectory path) content\r\n\r\nbrowseEdit :: Task ()\r\nbrowseEdit \r\n\t=\t\t\t\t\t\t\tbrowseDirectory isCleanFile\r\n\t>>- \\((path,_),mbName) -> \t\r\n\tif (isNothing mbName)\t\t(return ())\r\n\t(\t\t\t\t\t\t\treadFromFile (path <\/> fromJust mbName)\r\n\t>>- \\content -> \t\t\teditFile path (fromJust mbName) content\r\n\t)\r\n\r\n\/\/ very simple editor\r\n\r\neditFile :: String String String -> Task ()\r\neditFile path name content \r\n= withShared content \r\n    (\\sc ->\r\n\t \t\t(updateSharedInformation (path <\/> name) [UpdateUsing id (\\_ nsc -> nsc) aceTextArea] sc)\t\t\t\t\/\/ seems to be a bug in the current UpdateUsing ... no change returned\r\n\r\n\t >^*\t[ \tOnAction  ActionSave    \t(hasValue (saveFile (path <\/> name)))\r\n\t \t\t,\tOnAction  ActionSaveAs\t\t(hasValue (saveFileAs (path <\/> name)))\r\n\t \t\t]\r\n\t \t\t++ \r\n\t \t\tif (takeExtension name <> \"icl\") []\r\n\t \t\t[\tOnAction (Action \"Build\")\t(hasValue (const (buildProject path (dropExtension name))))\r\n\t \t\t,\tOnAction (Action \"Run\")\t\t(always (runExec (path <\/> dropExtension name +++ \".exe\") 8080))\r\n\t \t\t]\r\n\t >>*\t[   OnAction  ActionQuit    \t(always (return ()))\r\n\t\t    ]\r\n\t)\r\nwhere\r\n\tsaveFile path content \r\n\t\t= writeToFile path content @! () \r\n\t\r\n\tsaveFileAs path content \r\n\t\t= \t\tupdateInformation \"Where to write to ?\" [] path\r\n\t\t>>*\t\t[\tOnAction ActionSave\t\t(hasValue (\\name -> saveFile name content))\r\n\t\t\t \t,\tOnAction ActionCancel\t(always (return ()))\r\n\t\t\t \t]\r\n\t\t\r\n\tbuildProject buildPath iclFileName \r\n\t\t= \t\t\t\t\tget settings \r\n\t\t>>- \\curSet ->\t\tviewInformation \"Calling cpm : \" [] (curSet.dirCpm, buildPath, iclFileName)\r\n\t\t>>|\t\t\t\t\tcreateExec curSet.dirCpm buildPath iclFileName\r\n\r\n\r\n\r\n\r\n\r\n",["FieldMask",{"touched":false,"valid":true}]]]],["\/File\/Save","\/File\/Save as","Build","Run"]],["\/File\/Quit"]]]]]]]]]]]],"tonicRedOpts":{"captureParallel":false,"currBlueprintModuleName":"","currBlueprintFuncName":"","currBlueprintTaskId":["TaskId",0,0],"currBlueprintExprId":[],"callTrace":{"maxSize":1024,"actualSize":0,"nextIdx":0,"stackData":["Nil"]}},"nextTaskNo":44,"nextTaskTime":7,"tasks":["Bin",1,["TaskId",13,43],["_DYNAMIC_","CghdAIIqXQAam1sAbv9cAH7rXQBiq1sAYotcAKY6XQBii1wA-f___4KLXADs-EkAMstdACrMXQBii1wAij1dAGKLXAD5_____uldAGoiXQC-aV0AwjFdAA5pXQDqbl0AZvZaABr5WgBm-FoAHvhaAG7pXQBe3VoAotNaADLRWgCIAAAAQzpcVXNlcnNcTWFydGluXERvY3VtZW50c1xjbGVhbi1jbGFzc2ljLWl0YXNrcy13aW5kb3dzLXg4Ni0yMDE2MTIyM1xMaWJyYXJpZXNcaVRhc2tzLVNES1xyZXNlYXJjaCBpbnRlcm5zaGlwXGZpbGVzeXN0ZW1fcmludXNcd2ViSURFLmljbDLpXQA9____0iVcAAosXADQ3E8AFvpcAJL5XAAO-VwA2NdPAI71XAC6CF0A7pFcANIlXAAKLFwA1PpJABJnXQA2Pl0AUjtdAGjjUgCiNV0AughdAIYJXQDSJVwACixcAOz4SQCaZl0Ayf7__6X-___Q4lIADjVdAN4IXQC6CF0AOhBdALoIXQCmCV0AqiVcAKLTWgAy0VoAIgAAAHRhc2staW5zdGFuY2VzOmNhY2hlZEpTT05GaWxlU3RvcmUAABo6XgDeCF0A3ghdALoIXQDiOVwAughdAFX___-6CF0AhjhdAGKLXACqQ1sAYotcAHZDWwB-0VoAAQAAAH7RWgAAAAAAftFaAAAAAADCMV0AXFFMAKLTWgAy0VoADgAAAHRhc2staW5zdGFuY2VzAAB-Ol4Akf___2KLXAC1____ftFaAAAAAACi01oAzf___8YmXACi01oAMtFaABIAAAB0YXNrSW5zdGFuY2VTaGFyZXMAAN5DWwDqJlwAooBbAFonXADegFsAridcABqBWwDGJlwAotNaADLRWgAKAAAAbG9jYWxTaGFyZQAAGkNbAOomXAAqQlsAYotcAFX9__82J1wAskJbAGKLXABl_f__ridcAOpCWwDGJlwAotNaADLRWgATAAAAKFsiVGFza0lkIiwxMyw0MF0pLwBGIl0AYo1cAA0AAAAoAAAA6iZcAG3___9aJ1wAbf___64nXABt____3ghdALoIXQBKLl0A3ghdALoIXQBJ_v__ughdAEn-__8="],["Tip"],["Tip"]]}